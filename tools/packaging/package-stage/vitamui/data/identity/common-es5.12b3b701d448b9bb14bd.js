!function(){function e(){return(e="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,n,i){var r=t(e,n);if(r){var o=Object.getOwnPropertyDescriptor(r,n);return o.get?o.get.call(arguments.length<3?e:i):o.value}}).apply(this,arguments)}function t(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=i(e)););return e}function n(e,t,n){return t=i(t),function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}()?Reflect.construct(t,n||[],i(e).constructor):t.apply(e,n))}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&o(e,t)}function o(e,t){return(o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,u(i.key),i)}}function l(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function u(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{"+9k3":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n("Sv/w"),r=n("ZTXN"),o=n("OWX3"),c=n("EM62"),u=n("HYj3"),s=function(){var e=function(){function e(t,n){a(this,e),this.overlay=t,this.snackBarService=n,this.cancelDownload=new r.a;var i=this.overlay.position().global();i.left("0"),i.right("0"),i.bottom("0"),this.overlayRef=this.overlay.create({width:"100%",height:"80px",positionStrategy:i})}return l(e,[{key:"openDownloadBar",value:function(){this.initBar()}},{key:"close",value:function(){this.overlayRef.detach()}},{key:"initBar",value:function(){var e=this;this.overlayRef.hasAttached()&&this.overlayRef.detach();var t=new i.d(o.y);this.downloadBarRef=this.overlayRef.attach(t),this.downloadBarRef.instance.cancel.subscribe((function(){e.overlayRef.detach(),e.snackBarService.open({message:"DOWNLOAD.CANCELLED",icon:"vitamui-icon-info"}),e.cancelDownload.next()}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(c.bc(u.c),c.bc(o.Ab))},e.\u0275prov=c.Jb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},"4Xmu":function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));var o=i("ZTXN"),c=i("8j5Y"),u=i("OWX3"),s=i("EM62"),f=function(){var e=function(e){function t(e,i){var r;return a(this,t),(r=n(this,t,[e,"ALL"])).profileApi=e,r.snackBarService=i,r.updated=new o.a,r}return r(t,e),l(t,[{key:"get",value:function(e){return this.profileApi.getOneWithEmbedded(e,"ALL")}},{key:"exists",value:function(e,t,n,i){var r=[];r.push({key:"name",value:i,operator:u.W.equalsIgnoreCase},{key:"tenantIdentifier",value:e,operator:u.W.equals},{key:"level",value:t,operator:u.W.equals},{key:"applicationName",value:n,operator:u.W.equals});var o=[{key:"criteria",value:JSON.stringify({criteria:r})}];return this.profileApi.checkExistsByParam(o,this.headers)}},{key:"patch",value:function(e){var t=this;return this.profileApi.patch(e).pipe(Object(c.a)((function(e){return t.updated.next(e)})),Object(c.a)((function(e){t.snackBarService.open({message:"SHARED.SNACKBAR.PROFILE_UPDATE",translateParams:{param1:e.name},icon:"vitamui-icon-admin-key"})}),(function(e){t.snackBarService.open({message:e.error.message,translate:!1})})))}},{key:"create",value:function(e){var t=this;return this.profileApi.create(e).pipe(Object(c.a)((function(e){t.snackBarService.open({message:"SHARED.SNACKBAR.PROFILE_CREATE",translateParams:{param1:e.name}})}),(function(e){t.snackBarService.open({message:e.error.message,translate:!1})})))}},{key:"convertToAdminUserProfile",value:function(e){var t={multifactorAllowed:!1,createUser:!1,genericAllowed:!1,anonymizationAllowed:!1,standardAttrsAllowed:!1,type:"",profilGroupIds:[]};return this.hasRole(e,u.db.ROLE_CREATE_USERS)&&(t.createUser=!0),this.hasRole(e,u.db.ROLE_ANONYMIZATION_USERS)&&(t.anonymizationAllowed=!0),this.hasRole(e,u.db.ROLE_GENERIC_USERS)&&(t.genericAllowed=!0),this.hasRole(e,u.db.ROLE_MFA_USERS)&&(t.multifactorAllowed=!0),this.hasRole(e,u.db.ROLE_UPDATE_STANDARD_USERS)&&(t.standardAttrsAllowed=!0),t}},{key:"hasRole",value:function(e,t){return e.some((function(e){return e.name===t}))}}]),t}(u.jb);return e.\u0275fac=function(t){return new(t||e)(s.bc(u.ab),s.bc(u.Ab))},e.\u0275prov=s.Jb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},O4oY:function(e,t,n){"use strict";n.d(t,"b",(function(){return v})),n.d(t,"a",(function(){return m}));var i,r=n("ZTXN"),o=n("wTjk"),c=n("8j5Y"),u=n("YtkY"),s=n("OWX3"),f=function(e){return e.Header="HEADER",e.Footer="FOOTER",e.Portal="PORTAL",e}({}),p=n("guXd"),d=n("EM62"),h=n("e4iD"),v=20,m=((i=function(){function e(t,n,i,o){a(this,e),this.customerApi=t,this.snackBarService=n,this.sanitizer=i,this.themeService=o,this.updated=new r.a}return l(e,[{key:"get",value:function(e){return this.customerApi.getOne(e)}},{key:"getMyCustomer",value:function(){return this.customerApi.getMyCustomer()}},{key:"exists",value:function(e){var t=[];e.code&&t.push({key:"code",value:e.code,operator:s.W.equals}),e.domain&&t.push({key:"emailDomains",value:e.domain,operator:s.W.equalsIgnoreCase});var n=[{key:"criteria",value:JSON.stringify({criteria:t})}];return this.customerApi.checkExistsByParam(n)}},{key:"create",value:function(e,t){var n=this;return this.customerApi.createCustomer(e,t).pipe(Object(c.a)((function(e){n.snackBarService.open({message:"SHARED.SNACKBAR.CUSTOMER_CREATE",icon:"vitamui-icon-bank",translateParams:{param1:e.code}})}),(function(){n.snackBarService.open({message:"SHARED.SNACKBAR.CUSTOMER_CREATE_ERROR",icon:"vitamui-icon-danger"})})))}},{key:"patch",value:function(e,t){var n=this;return this.customerApi.patchCustomer(e,t).pipe(Object(c.a)((function(e){return n.updated.next(e)})),Object(c.a)((function(e){n.snackBarService.open({message:"SHARED.SNACKBAR.CUSTOMER_UPDATE",icon:"vitamui-icon-bank",translateParams:{param1:e.code}})}),(function(e){n.snackBarService.open({message:e.error.message,translate:!1})})))}},{key:"getLogoUrl",value:function(e,t){var n=this;return this.customerApi.getLogo(e,t).pipe(Object(u.a)((function(e){if(204===e.status){switch(t){case f.Header:return n.themeService.defaultTheme.headerUrl;case f.Footer:return n.themeService.defaultTheme.footerUrl;case f.Portal:return n.themeService.defaultTheme.portalUrl}return null}return n.sanitizer.bypassSecurityTrustResourceUrl(window.URL.createObjectURL(e.body))})))}},{key:"getLogos",value:function(e){var t=this.getLogoUrl(e,f.Header),n=this.getLogoUrl(e,f.Footer),i=this.getLogoUrl(e,f.Portal);return Object(o.a)(t,n,i)}},{key:"getGdprReadOnlySettingStatus",value:function(){return this.customerApi.getGdprSettingStatus()}}]),e}()).\u0275fac=function(e){return new(e||i)(d.bc(p.a),d.bc(s.Ab),d.bc(h.b),d.bc(s.vb))},i.\u0275prov=d.Jb({token:i,factory:i.\u0275fac,providedIn:"root"}),i)},bWz1:function(t,o,c){"use strict";c.d(o,"a",(function(){return g}));var u,s,f=c("vobO"),p=c("ZTXN"),d=c("8j5Y"),h=c("YtkY"),v=c("OWX3"),m=c("EM62"),b=((s=function(t){function o(e,t){return a(this,o),n(this,o,[e,t+"/groups"])}return r(o,t),l(o,[{key:"getAllByParams",value:function(t,n){return e(i(o.prototype),"getAllByParams",this).call(this,t,n)}},{key:"getAllPaginated",value:function(t,n,r){return e(i(o.prototype),"getAllPaginated",this).call(this,t,n,r)}},{key:"getOne",value:function(t,n){return e(i(o.prototype),"getOne",this).call(this,t,n)}},{key:"getOneWithEmbedded",value:function(t,n,r){return e(i(o.prototype),"getOneWithEmbedded",this).call(this,t,n,r)}},{key:"checkExistsByParam",value:function(t,n){return e(i(o.prototype),"checkExistsByParam",this).call(this,t,n)}},{key:"create",value:function(t,n){return e(i(o.prototype),"create",this).call(this,t,n)}},{key:"patch",value:function(t,n){return e(i(o.prototype),"patch",this).call(this,t,n)}},{key:"getLevels",value:function(e,t){var n=new f.g;return e&&(n=n.set("criteria",JSON.stringify(e))),this.http.get(this.apiUrl+"/levels",{params:n,headers:t})}},{key:"export",value:function(){return this.http.get(this.apiUrl+"/export",{observe:"response",responseType:"blob"})}}]),o}(v.o)).\u0275fac=function(e){return new(e||s)(m.bc(f.c),m.bc(v.n))},s.\u0275prov=m.Jb({token:s,factory:s.\u0275fac,providedIn:"root"}),s),g=((u=function(e){function t(e,i){var r;return a(this,t),(r=n(this,t,[e])).groupApi=e,r.snackBarService=i,r.updated=new p.a,r}return r(t,e),l(t,[{key:"create",value:function(e){var t=this;return this.groupApi.create(e).pipe(Object(d.a)((function(e){t.snackBarService.open({message:"SHARED.SNACKBAR.GROUP_CREATE",translateParams:{param1:e.name},icon:"vitamui-icon-keys"})}),(function(e){t.snackBarService.open({message:e.error.message,translate:!1})})))}},{key:"get",value:function(e){return this.groupApi.getOneWithEmbedded(e,"ALL")}},{key:"exists",value:function(e,t){var n=[];e&&n.push({key:"customerId",value:e,operator:v.W.equals}),t&&n.push({key:"name",value:t,operator:v.W.equals});var i=[{key:"criteria",value:JSON.stringify({criteria:n})}];return this.groupApi.checkExistsByParam(i)}},{key:"unitExists",value:function(e,t){var n=[];n.push({key:"units",value:t,operator:v.W.equalsIgnoreCase}),n.push({key:"customerId",value:e,operator:v.W.equals});var i=[{key:"criteria",value:JSON.stringify({criteria:n})}];return this.groupApi.checkExistsByParam(i)}},{key:"patch",value:function(e){var t=this;return this.groupApi.patch(e).pipe(Object(d.a)((function(e){return t.updated.next(e)})),Object(d.a)((function(e){t.snackBarService.open({message:"SHARED.SNACKBAR.GROUP_UPDATE",translateParams:{param1:e.name},icon:"vitamui-icon-keys"})}),(function(e){t.snackBarService.open({message:e.error.message,translate:!1})})))}},{key:"getAll",value:function(e){var t=[];e&&t.push({key:"enabled",value:e,operator:v.W.equals});var n={criteria:t},i=new f.g;return t.length>0&&(i=i.set("criteria",JSON.stringify(n))),this.groupApi.getAllByParams(i)}},{key:"getNonEmptyLevels",value:function(e){return this.groupApi.getLevels(e).pipe(Object(h.a)((function(e){return e.filter((function(e){return!!e}))})))}},{key:"export",value:function(){return this.groupApi.export()}}]),t}(v.jb)).\u0275fac=function(e){return new(e||u)(m.bc(b),m.bc(v.Ab))},u.\u0275prov=m.Jb({token:u,factory:u.\u0275fac,providedIn:"root"}),u)},guXd:function(t,o,c){"use strict";c.d(o,"a",(function(){return p}));var u=c("OWX3"),s=c("EM62"),f=c("vobO"),p=function(){var t=function(t){function o(e,t,i){var r;return a(this,o),(r=n(this,o,[e,t+"/customers"])).logger=i,r}return r(o,t),l(o,[{key:"getAllByParams",value:function(t,n){return e(i(o.prototype),"getAllByParams",this).call(this,t,n)}},{key:"getAllPaginated",value:function(t,n,r){return e(i(o.prototype),"getAllPaginated",this).call(this,t,n,r)}},{key:"getOne",value:function(t,n){return e(i(o.prototype),"getOne",this).call(this,t,n)}},{key:"checkExistsByParam",value:function(t,n){return e(i(o.prototype),"checkExistsByParam",this).call(this,t,n)}},{key:"createCustomer",value:function(t,n,r){var a=new FormData,c=Object.assign({},t);return a.append("tenantName",c.tenantName),c.tenantName=void 0,a.append("customerDto",JSON.stringify(c)),n&&n.forEach((function(e){a.append(e.attr.toLowerCase(),e.file)})),e(i(o.prototype),"getHttp",this).call(this).post(e(i(o.prototype),"getApiUrl",this).call(this),a,{headers:r})}},{key:"patchCustomer",value:function(t,n,r){var a=new FormData;return a.append("partialCustomerDto",JSON.stringify({id:t.id,hasCustomGraphicIdentity:t.hasCustomGraphicIdentity,themeColors:t.themeColors,portalTitles:t.portalTitles,portalMessages:t.portalMessages,identifier:t.identifier,code:t.code,name:t.name,companyName:t.companyName,passwordRevocationDelay:t.passwordRevocationDelay,otp:t.otp,address:t.address,internalCode:t.internalCode,language:t.language,emailDomains:t.emailDomains,defaultEmailDomain:t.defaultEmailDomain,gdprAlert:t.gdprAlert,gdprAlertDelay:t.gdprAlertDelay})),n&&n.forEach((function(e){a.append(e.attr.toLowerCase(),e.file)})),this.logger.log(this,"Form data => ",a),e(i(o.prototype),"getHttp",this).call(this).patch(e(i(o.prototype),"getApiUrl",this).call(this)+"/"+t.id,a,{headers:r})}},{key:"getMyCustomer",value:function(){return e(i(o.prototype),"getHttp",this).call(this).get(e(i(o.prototype),"getApiUrl",this).call(this)+"/me")}},{key:"getLogo",value:function(t,n){return e(i(o.prototype),"getHttp",this).call(this).get(e(i(o.prototype),"getApiUrl",this).call(this)+"/"+t+"/logo?type="+n,{observe:"response",responseType:"blob"})}},{key:"getGdprSettingStatus",value:function(){return this.http.get(this.apiUrl+"/gdpr-status")}}]),o}(u.o);return t.\u0275fac=function(e){return new(e||t)(s.bc(f.c),s.bc(u.n),s.bc(u.U))},t.\u0275prov=s.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t}()},"l7x+":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n("2kYt"),r=n("Y2X+"),o=n("OWX3"),c=n("PCNd"),u=n("EM62"),s=function(){var e=l((function e(){a(this,e)}));return e.\u0275mod=u.Lb({type:e}),e.\u0275inj=u.Kb({factory:function(t){return new(t||e)},imports:[[i.c,c.a,r.b,o.r,o.ib,o.xb]]}),e}()},nrt1:function(e,t,n){"use strict";n.d(t,"a",(function(){return B}));var i=n("EM62"),r=n("nIj0"),o=n("8j5Y"),c=n("TLy2"),u=n("vobO"),s=n("OWX3"),f=n("2kYt"),p=n("csyo"),d=n("s2Ay"),h=["tenantInput"],v=["profileInput"],m=["addButton"];function b(e,t){1&e&&(i.Tb(0,"vitamui-common-input-error"),i.Oc(1),i.jc(2,"translate"),i.Sb()),2&e&&(i.Bb(1),i.Pc(i.kc(2,1,"COMMON.ERROR.REQUIRED")))}function g(e,t){1&e&&(i.Tb(0,"vitamui-common-input-error"),i.Oc(1),i.jc(2,"translate"),i.Sb()),2&e&&(i.Bb(1),i.Pc(i.kc(2,1,"COMMON.INCORRECT_VALUE")))}function y(e,t){1&e&&(i.Tb(0,"vitamui-common-input-error"),i.Oc(1),i.jc(2,"translate"),i.Sb()),2&e&&(i.Bb(1),i.Pc(i.kc(2,1,"COMMON.ERROR.REQUIRED")))}function O(e,t){1&e&&(i.Tb(0,"vitamui-common-input-error"),i.Oc(1),i.jc(2,"translate"),i.Sb()),2&e&&(i.Bb(1),i.Pc(i.kc(2,1,"COMMON.INCORRECT_VALUE")))}function k(e,t){if(1&e&&(i.Rb(0),i.Tb(1,"vitamui-common-vitamui-autocomplete",1,16),i.jc(3,"translate"),i.Mc(4,y,3,3,"vitamui-common-input-error",2),i.Mc(5,O,3,3,"vitamui-common-input-error",2),i.Sb(),i.Qb()),2&e){var n=i.ic();i.Bb(1),i.oc("options",n.filteredTenants)("formControl",n.tenantSelect)("placeholder",i.kc(3,5,"GROUP.PROFILE.MODAL.SAFE")),i.Bb(3),i.oc("ngIf",n.tenantSelect.touched&&n.tenantSelect.hasError("required")),i.Bb(1),i.oc("ngIf",n.tenantSelect.touched&&n.tenantSelect.hasError("match"))}}function S(e,t){1&e&&(i.Tb(0,"vitamui-common-input-error"),i.Oc(1),i.jc(2,"translate"),i.Sb()),2&e&&(i.Bb(1),i.Pc(i.kc(2,1,"COMMON.ERROR.REQUIRED")))}function A(e,t){1&e&&(i.Tb(0,"vitamui-common-input-error"),i.Oc(1),i.jc(2,"translate"),i.Sb()),2&e&&(i.Bb(1),i.Pc(i.kc(2,1,"COMMON.INCORRECT_VALUE")))}function P(e,t){1&e&&(i.Tb(0,"div",11),i.Oc(1),i.jc(2,"translate"),i.Sb()),2&e&&(i.Bb(1),i.Pc(i.kc(2,1,"GROUP.PROFILE.MODAL.SAFE")))}function E(e,t){if(1&e&&(i.Tb(0,"div",21),i.Oc(1),i.Sb()),2&e){var n,r=i.ic().$implicit,o=i.ic(2);i.Bb(1),i.Pc(null==(n=o.getProfileFromId(r))?null:n.tenantName)}}var R=function(e,t){return{"col-1":e,"col-4":t}};function I(e,t){if(1&e){var n=i.Ub();i.Tb(0,"div",19),i.Tb(1,"div",20),i.Tb(2,"div",21),i.Oc(3),i.Sb(),i.Mc(4,E,2,1,"div",22),i.Tb(5,"div",23),i.Oc(6),i.Sb(),i.Tb(7,"div",24),i.Tb(8,"button",25),i.ec("click",(function(){i.Dc(n);var e=t.index;return i.ic(2).remove(e)})),i.Tb(9,"i",8),i.Oc(10,"clear"),i.Sb(),i.Sb(),i.Sb(),i.Sb(),i.Sb()}if(2&e){var r,o,a=t.$implicit,c=i.ic(2);i.Bb(3),i.Pc(null==(r=c.getApplicationFromId(a))?null:r.name),i.Bb(1),i.oc("ngIf",!c.tenantIdentifier),i.Bb(2),i.Pc(null==(o=c.getProfileFromId(a))?null:o.name),i.Bb(1),i.oc("ngClass",i.uc(4,R,!c.tenantIdentifier,c.tenantIdentifier))}}function T(e,t){if(1&e&&(i.Tb(0,"div",17),i.Mc(1,I,11,7,"div",18),i.Sb()),2&e){var n=i.ic();i.Bb(1),i.oc("ngForOf",n.profileIds)}}function C(e,t){1&e&&(i.Tb(0,"div",26),i.Ob(1,"mat-spinner",27),i.Sb())}var w={provide:r.o,useExisting:Object(i.V)((function(){return B})),multi:!0},B=function(){var e=function(){function e(t,n){a(this,e),this.rngProfileService=t,this.appApiService=n,this.profiles=[],this.profileIds=[],this.applicationsDetails=[],this.loading=!0,this.showLevel=!1,this.appSelect=new r.e(null,[r.x.required]),this.tenantSelect=new r.e(null,[r.x.required]),this.profileSelect=new r.e(null,[r.x.required]),this.applications=[],this.filteredTenants=[],this.filteredProfiles=[],this.onChange=function(e){},this.onTouched=function(){}}return l(e,[{key:"level",get:function(){return this._level},set:function(e){this._level=e,this.getProfiles()}},{key:"ngOnInit",value:function(){var e=this;this.getProfiles(),this.appSelect.valueChanges.subscribe((function(){e.filterTenants(),1===e.filteredTenants.length?e.tenantSelect.setValue(e.filteredTenants[0].key):(e.tenantSelect.setValue(null),e.tenantIdentifier||setTimeout((function(){return e.tenantInput.focus()}),0)),e.toggleSelects()})),this.tenantSelect.valueChanges.subscribe((function(){e.filterProfiles(),e.profileSelect.setValue(1===e.filteredProfiles.length?e.filteredProfiles[0].key:null),e.toggleSelects(),1===e.filteredProfiles.length?setTimeout((function(){return e.addButton.nativeElement.focus()}),0):setTimeout((function(){return e.profileInput.focus()}),0)}))}},{key:"getProfiles",value:function(){var e=this,t=(new u.g).set("filterApp","false");this.appApiService.getAllByParams(t).pipe(Object(o.a)((function(t){return e.applicationsDetails=t.APPLICATION_CONFIGURATION})),Object(c.a)((function(){return e.rngProfileService.list(e.level,e.tenantIdentifier,e.applicationNameExclude)}))).subscribe((function(t){e.profiles=t,e.profileIds=e.filterProfileIds(e.profileIds,e.profiles,e.applicationsDetails),e.profileIds=e.profileIds.sort(N(e.profiles,e.applicationsDetails)),e.updateApplicationTree(),e.loading=!1}))}},{key:"writeValue",value:function(e){this.profileIds=e||[],this.updateApplicationTree()}},{key:"registerOnChange",value:function(e){this.onChange=e}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"add",value:function(){this.profileSelect.value&&(this.profileIds.includes(this.profileSelect.value)||(this.profileIds.push(this.profileSelect.value),this.profileIds=this.profileIds.sort(N(this.profiles,this.applicationsDetails)),this.updateApplicationTree(),this.onChange(this.profileIds)))}},{key:"remove",value:function(e){this.profileIds=this.profileIds.filter((function(t,n){return n!==e})),this.updateApplicationTree(),this.onChange(this.profileIds)}},{key:"getProfileFromId",value:function(e){return this.profiles.find((function(t){return t.id===e}))}},{key:"getApplicationFromId",value:function(e){var t=this.profiles.find((function(t){return t.id===e}));return t?this.applicationsDetails.find((function(e){return e.identifier===t.applicationName})):{name:"Non d\xe9fini"}}},{key:"canAddProfile",get:function(){return this.getProfileFromId(this.profileSelect.value)&&!this.profileIds.includes(this.profileSelect.value)}},{key:"updateApplicationTree",value:function(){var e=this;this.applications=[];var t=this.getSelectedProfiles();this.profiles.filter((function(e){return e.applicationName})).filter((function(e){return!t.find((function(t){return t.applicationName===e.applicationName&&t.tenantIdentifier===e.tenantIdentifier}))})).filter((function(t){return!e.profileIds.includes(t.id)})).filter((function(t){return e.applicationsDetails.some((function(e){return e.identifier===t.applicationName}))})).forEach((function(t){var n=e.applications.find((function(e){return e.key===t.applicationName}));if(n){var i=n.children.find((function(e){return e.key===t.tenantIdentifier.toString()}));i?i.children.find((function(e){return e.key===t.id}))||i.children.push({key:t.id,label:e.getProfileLabel(t),info:t.description}):n.children.push(e.buildTenantOption(t))}else e.applications.push(e.buildApplicationOption(t))})),this.filterTenants(),this.filterProfiles(),this.toggleSelects(),this.appSelect.reset()}},{key:"getSelectedProfiles",value:function(){var e=this;return this.profiles.filter((function(t){return e.profileIds.includes(t.id)}))}},{key:"toggleSelects",value:function(){this.filteredTenants.length>0?this.tenantSelect.enable({emitEvent:!1}):this.tenantSelect.disable({emitEvent:!1}),this.filteredProfiles.length>0?this.profileSelect.enable({emitEvent:!1}):this.profileSelect.disable({emitEvent:!1})}},{key:"buildApplicationOption",value:function(e){var t=this.applicationsDetails.find((function(t){return t.identifier===e.applicationName})),n=this.applicationsDetails.find((function(e){return e.identifier===t.identifier})).name;return{key:e.applicationName,label:n,children:[{key:e.tenantIdentifier.toString(),label:e.tenantName,children:[{key:e.id,label:this.getProfileLabel(e),info:e.description}]}]}}},{key:"getProfileLabel",value:function(e){var t=e.name;return this.showLevel&&e.level&&(t=t.concat(" Niveau ".concat(e.level))),t}},{key:"buildTenantOption",value:function(e){return{key:e.tenantIdentifier.toString(),label:e.tenantName,children:[{key:e.id,label:this.getProfileLabel(e),info:e.description}]}}},{key:"filterTenants",value:function(){var e=this,t=this.applications.find((function(t){return t.key===e.appSelect.value}));this.filteredTenants=t?t.children:[]}},{key:"filterProfiles",value:function(){var e=this,t=this.filteredTenants.find((function(t){return t.key===e.tenantSelect.value}));this.filteredProfiles=t?t.children:[]}},{key:"resetTree",value:function(){this.appSelect.setValue(null)}},{key:"filterProfileIds",value:function(e,t,n){return t.filter((function(e){return n.some((function(t){return t.identifier===e.applicationName}))})).map((function(e){return e.id})).filter((function(t){return e.includes(t)}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(i.Nb(s.bb),i.Nb(s.g))},e.\u0275cmp=i.Hb({type:e,selectors:[["app-profiles-form"]],viewQuery:function(e,t){var n;1&e&&(i.Uc(h,!0),i.Ic(v,!0),i.Ic(m,!0)),2&e&&(i.yc(n=i.fc())&&(t.tenantInput=n.first),i.yc(n=i.fc())&&(t.profileInput=n.first),i.yc(n=i.fc())&&(t.addButton=n.first))},inputs:{showLevel:"showLevel",tenantIdentifier:"tenantIdentifier",applicationNameExclude:"applicationNameExclude",level:"level"},features:[i.Ab([w])],decls:32,vars:28,consts:[[1,"d-flex","align-items-center"],[3,"options","formControl","placeholder"],[4,"ngIf"],["profileInput",""],[1,"d-flex","flex-column","align-items-center","justify-content-center"],["type","button",1,"btn","primary",3,"disabled","click"],["addButton",""],["type","button",1,"btn","link",3,"click"],[1,"material-icons"],[1,"vitamui-table","mt-2","unscrollable"],[1,"vitamui-table-head"],[1,"col-3"],["class","col-3",4,"ngIf"],[1,"col-5"],["class","vitamui-table-body",4,"ngIf"],["class","vitamui-min-content",4,"ngIf"],["tenantInput",""],[1,"vitamui-table-body"],["class","vitamui-table-rows",4,"ngFor","ngForOf"],[1,"vitamui-table-rows"],[1,"vitamui-row","d-flex","align-items-center"],["vitamuiCommonEllipsis","",1,"col-3"],["class","col-3","vitamuiCommonEllipsis","",4,"ngIf"],["vitamuiCommonEllipsis","",1,"col-5"],[1,"d-flex","justify-content-end",3,"ngClass"],[1,"btn","link",3,"click"],[1,"vitamui-min-content"],[1,"vitamui-spinner","medium"]],template:function(e,t){1&e&&(i.Tb(0,"div",0),i.Tb(1,"div"),i.Tb(2,"vitamui-common-vitamui-autocomplete",1),i.jc(3,"translate"),i.Mc(4,b,3,3,"vitamui-common-input-error",2),i.Mc(5,g,3,3,"vitamui-common-input-error",2),i.Sb(),i.Mc(6,k,6,7,"ng-container",2),i.Tb(7,"vitamui-common-vitamui-autocomplete",1,3),i.jc(9,"translate"),i.Mc(10,S,3,3,"vitamui-common-input-error",2),i.Mc(11,A,3,3,"vitamui-common-input-error",2),i.Sb(),i.Sb(),i.Tb(12,"div"),i.Tb(13,"div",4),i.Tb(14,"button",5,6),i.ec("click",(function(){return t.add()})),i.Oc(16),i.jc(17,"translate"),i.Sb(),i.Tb(18,"button",7),i.ec("click",(function(){return t.resetTree()})),i.Tb(19,"i",8),i.Oc(20,"replay"),i.Sb(),i.Sb(),i.Sb(),i.Sb(),i.Sb(),i.Tb(21,"div",9),i.Tb(22,"div",10),i.Tb(23,"div",11),i.Oc(24),i.jc(25,"translate"),i.Sb(),i.Mc(26,P,3,3,"div",12),i.Tb(27,"div",13),i.Oc(28),i.jc(29,"translate"),i.Sb(),i.Sb(),i.Mc(30,T,2,1,"div",14),i.Sb(),i.Mc(31,C,2,0,"div",15)),2&e&&(i.Bb(2),i.oc("options",t.applications)("formControl",t.appSelect)("placeholder",i.kc(3,18,"GROUP.PROFILE.MODAL.APP")),i.Bb(2),i.oc("ngIf",t.appSelect.touched&&t.appSelect.hasError("required")),i.Bb(1),i.oc("ngIf",t.appSelect.touched&&t.appSelect.hasError("match")),i.Bb(1),i.oc("ngIf",!t.tenantIdentifier),i.Bb(1),i.oc("options",t.filteredProfiles)("formControl",t.profileSelect)("placeholder",i.kc(9,20,"GROUP.PROFILE.MODAL.PROFILE")),i.Bb(3),i.oc("ngIf",t.profileSelect.touched&&t.profileSelect.hasError("required")),i.Bb(1),i.oc("ngIf",t.profileSelect.touched&&t.profileSelect.hasError("match")),i.Bb(3),i.oc("disabled",!t.canAddProfile),i.Bb(2),i.Qc(" ",i.kc(17,22,"COMMON.ADD")," "),i.Bb(8),i.Pc(i.kc(25,24,"GROUP.PROFILE.MODAL.APP")),i.Bb(2),i.oc("ngIf",!t.tenantIdentifier),i.Bb(2),i.Pc(i.kc(29,26,"GROUP.PROFILE.MODAL.PROFILE")),i.Bb(2),i.oc("ngIf",!t.loading),i.Bb(1),i.oc("ngIf",t.loading))},directives:[s.wb,r.q,r.f,f.p,s.Rb,f.o,s.Zb,f.n,p.b],pipes:[d.d],styles:[".d-flex[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-of-type{width:65%}.d-flex[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-of-type > div[_ngcontent-%COMP%]{height:60px}.d-flex[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-of-type{width:25%}[_nghost-%COMP%]   .unscrollable[_ngcontent-%COMP%]{max-height:none}"]}),e}();function N(e,t){return function(n,i){var r=L(e,n,t),o=L(e,i,t);return r.toLowerCase()>o.toLowerCase()?1:r.toLowerCase()<o.toLowerCase()?-1:0}}function L(e,t,n){var i=e.find((function(e){return e.id===t}));if(!i)return"";var r=n.find((function(e){return e.identifier===i.applicationName}));return r?r.name:""}}}])}();