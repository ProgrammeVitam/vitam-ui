(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{t9wn:function(e,t,i){"use strict";i.r(t),i.d(t,"HierarchyModule",(function(){return pe}));var r=i("2kYt"),a=i("nIj0"),n=i("jdnZ"),c=i("66mq"),o=i("lQ7A"),l=i("OWX3"),s=i("PCNd"),b=i("OZ4H"),u=i("29Wa"),d=i("Cd2c"),p=i("R7+U"),m=i("W1gw"),f=i("EM62");let h=(()=>{class e{}return e.\u0275mod=f.Lb({type:e}),e.\u0275inj=f.Kb({factory:function(t){return new(t||e)},imports:[[r.c,l.xb,s.a,n.c,u.d,d.c,c.b,p.b,m.c,a.v,b.f]]}),e})();var v=i("Jb3d"),S=i("KZIX"),O=i("Y2X+");let I=(()=>{class e{}return e.\u0275mod=f.Lb({type:e}),e.\u0275inj=f.Kb({factory:function(t){return new(t||e)},imports:[[r.c,s.a,v.b,S.c,O.b,a.v,l.xb]]}),e})();var T=i("csyo");let g=(()=>{class e{}return e.\u0275mod=f.Lb({type:e}),e.\u0275inj=f.Kb({factory:function(t){return new(t||e)},imports:[[r.c,s.a,T.a,l.xb]]}),e})();var R=i("sEIs"),E=i("vobO"),y=i("ZTXN"),C=i("8j5Y");let A=(()=>{class e extends l.jb{constructor(e,t){super(e,"ALL"),this.profileApi=e,this.snackBarService=t,this.updated=new y.a}setTenantId(e){this.headers=new E.f({"X-Tenant-Id":e.toString()})}getAllByParams(e,t){const i=(new E.g).set("criteria",JSON.stringify(e));return this.profileApi.getAllByParams(i,t)}get(e){return this.profileApi.getOneWithEmbedded(e,"ALL",this.headers)}exists(e,t,i,r){const a=[];a.push({key:"name",value:r,operator:l.W.equalsIgnoreCase},{key:"tenantIdentifier",value:e,operator:l.W.equals},{key:"level",value:t,operator:l.W.equals},{key:"applicationName",value:i,operator:l.W.equals});const n=[{key:"criteria",value:JSON.stringify({criteria:a})}];return this.profileApi.checkExistsByParam(n,this.headers)}patch(e){return this.profileApi.patch(e,this.headers).pipe(Object(C.a)(e=>this.updated.next(e)),Object(C.a)(e=>{this.snackBarService.open({message:"SHARED.SNACKBAR.PROFILE_UPDATE",translateParams:{param1:e.name}})},e=>{this.snackBarService.open({message:e.error.message,translate:!1})}))}create(e){return this.profileApi.create(e,this.headers).pipe(Object(C.a)(e=>{this.snackBarService.open({message:"SHARED.SNACKBAR.PROFILE_CREATE_ERROR",translateParams:{param1:e.name}})},e=>{this.snackBarService.open({message:e.error.message,translate:!1})}))}}return e.\u0275fac=function(t){return new(t||e)(f.bc(l.ab),f.bc(l.Ab))},e.\u0275prov=f.Jb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var N=i("g6G6"),B=i("ROBh"),P=i("mWib"),k=i("YtkY"),H=i("xVbo"),M=i("TLy2"),j=i("4e/d"),L=i("6WTZ"),w=i("8lHc"),x=i("J+dc");let D=(()=>{class e{constructor(e){this.rngProfileService=e,this.debounceTime=400,this.nameExists=(e,t,i,r)=>a=>Object(w.a)(this.debounceTime).pipe(Object(M.a)(()=>a.value!==r?this.rngProfileService.exists(e,t,i,a.value):Object(B.a)(!1)),Object(x.a)(1),Object(k.a)(e=>e?{nameExists:!0}:null))}}return e.\u0275fac=function(t){return new(t||e)(f.bc(A))},e.\u0275prov=f.Jb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var _=i("s2Ay");function F(e,t){1&e&&(f.Tb(0,"span"),f.Oc(1),f.jc(2,"translate"),f.Sb()),2&e&&(f.Bb(1),f.Pc(f.kc(2,1,"HIERARCHY.INFORMATIONS.INACTIVE_SWITCH")))}function V(e,t){1&e&&(f.Tb(0,"span"),f.Oc(1),f.jc(2,"translate"),f.Sb()),2&e&&(f.Bb(1),f.Pc(f.kc(2,1,"HIERARCHY.INFORMATIONS.ACTIVE_SWITCH")))}let Y=(()=>{class e{constructor(e,t,i,r){this.formBuilder=e,this.hierarchyService=t,this.profileValidators=i,this.authService=r,this.userLevel=this.authService.user.level,this.form=this.formBuilder.group({name:[null,a.x.required],identifier:[{value:null,disabled:!0},a.x.required],description:[null,a.x.required],level:[null,Object(l.Gb)(this.authService.user)],enabled:null}),this.updateSub=Object(N.a)(this.form.valueChanges,this.form.statusChanges).pipe(Object(P.a)(400),Object(k.a)(()=>Object(l.Ib)(this.form.value,this.previousValue)),Object(H.a)(e=>!Object(L.c)(e)),Object(k.a)(e=>Object(L.a)({id:this.profile.id,customerId:this.profile.customerId,tenantIdentifier:this.profile.tenantIdentifier},e)),Object(M.a)(e=>this.hierarchyService.patch(e).pipe(Object(j.a)(()=>Object(B.a)(null))))).subscribe(e=>this.resetForm(this.form,e,this.readOnly))}ngOnInit(){}ngOnDestroy(){this.updateSub.unsubscribe()}ngOnChanges(e){(e.hasOwnProperty("profile")||e.hasOwnProperty("readOnly"))&&this.profile&&(this.resetForm(this.form,this.profile,this.readOnly),this.previousValue=this.form.value)}resetForm(e,t,i){e.reset(t,{emitEvent:!1}),this.initFormValidators(e,t),this.initFormActivationState(e,t,i),e.updateValueAndValidity({emitEvent:!1})}initFormValidators(e,t){e.get("name").setAsyncValidators(this.profileValidators.nameExists(t.tenantIdentifier,t.level,t.applicationName,t.name))}initFormActivationState(e,t,i){i?e.disable({emitEvent:!1}):(e.enable({emitEvent:!1}),e.get("identifier").disable({emitEvent:!1}),t.groupsCount&&t.groupsCount>0&&(e.get("enabled").disable({emitEvent:!1}),e.get("level").disable({emitEvent:!1})))}}return e.\u0275fac=function(t){return new(t||e)(f.Nb(a.d),f.Nb(A),f.Nb(D),f.Nb(l.k))},e.\u0275cmp=f.Hb({type:e,selectors:[["app-information-tab"]],inputs:{profile:"profile",readOnly:"readOnly"},features:[f.zb],decls:44,vars:49,consts:[[3,"formGroup"],["formControlName","enabled","matTooltipClass","vitamui-tooltip",3,"matTooltip","matTooltipDisabled"],[4,"ngIf"],[1,"row"],[1,"col-12"],["formControlName","identifier","maxlength","12",3,"label","validator","asyncValidator"],[1,"col-8"],["formControlName","name","maxlength","100",3,"label","validator","asyncValidator"],["errorKey","required"],["errorKey","nameExists"],[1,"col-5"],[1,"read-only-field"],["matTooltipClass","vitamui-tooltip",1,"col-5",3,"matTooltip","matTooltipDisabled"],["formControlName","level","maxlength","250",3,"prefix","label","validator"],["formControlName","description","maxlength","250",3,"label","validator"]],template:function(e,t){if(1&e&&(f.Tb(0,"form",0),f.Tb(1,"vitamui-common-slide-toggle",1),f.jc(2,"translate"),f.Mc(3,F,3,3,"span",2),f.Mc(4,V,3,3,"span",2),f.Sb(),f.Tb(5,"div",3),f.Tb(6,"div",4),f.Ob(7,"vitamui-common-editable-input",5),f.jc(8,"translate"),f.Sb(),f.Sb(),f.Tb(9,"div",3),f.Tb(10,"div",6),f.Tb(11,"vitamui-common-editable-input",7),f.jc(12,"translate"),f.Tb(13,"vitamui-common-field-error",8),f.Oc(14),f.jc(15,"translate"),f.Sb(),f.Tb(16,"vitamui-common-field-error",9),f.Oc(17),f.jc(18,"translate"),f.Sb(),f.Sb(),f.Sb(),f.Sb(),f.Tb(19,"div",3),f.Tb(20,"div",10),f.Tb(21,"div",11),f.Tb(22,"label"),f.Oc(23),f.jc(24,"translate"),f.Sb(),f.Tb(25,"div"),f.Oc(26),f.Sb(),f.Sb(),f.Sb(),f.Tb(27,"div",12),f.jc(28,"translate"),f.Tb(29,"vitamui-common-editable-level-input",13),f.jc(30,"translate"),f.Tb(31,"vitamui-common-field-error",8),f.Oc(32),f.jc(33,"translate"),f.Sb(),f.Tb(34,"vitamui-common-field-error",9),f.Oc(35),f.jc(36,"translate"),f.Sb(),f.Sb(),f.Sb(),f.Sb(),f.Tb(37,"div",3),f.Tb(38,"div",4),f.Tb(39,"vitamui-common-editable-textarea",14),f.jc(40,"translate"),f.Tb(41,"vitamui-common-field-error",8),f.Oc(42),f.jc(43,"translate"),f.Sb(),f.Sb(),f.Sb(),f.Sb(),f.Sb()),2&e){var i=null,r=null,a=null,n=null,c=null,o=null;f.oc("formGroup",t.form),f.Bb(1),f.oc("matTooltip",f.kc(2,25,"HIERARCHY.INFORMATIONS.ACTIVE_SWITCH_TOOLTIP"))("matTooltipDisabled",0==(null==t.profile?null:t.profile.groupsCount)),f.Bb(2),f.oc("ngIf",!(null!=t.form&&t.form.get("enabled").value)),f.Bb(1),f.oc("ngIf",null==t.form?null:t.form.get("enabled").value),f.Bb(3),f.oc("label",f.kc(8,27,"COMMON.ID"))("validator",null==t.form||null==(i=t.form.get("identifier"))?null:i.validator)("asyncValidator",null==t.form||null==(r=t.form.get("identifier"))?null:r.asyncValidator),f.Bb(4),f.oc("label",f.kc(12,29,"HIERARCHY.INFORMATIONS.NAME"))("validator",null==t.form||null==(a=t.form.get("name"))?null:a.validator)("asyncValidator",null==t.form||null==(n=t.form.get("name"))?null:n.asyncValidator),f.Bb(3),f.Pc(f.kc(15,31,"COMMON.ERROR.REQUIRED")),f.Bb(3),f.Pc(f.kc(18,33,"HIERARCHY.INFORMATIONS.EXISTING_NAME")),f.Bb(6),f.Pc(f.kc(24,35,"HIERARCHY.INFORMATIONS.LEVEL")),f.Bb(3),f.Pc(t.userLevel),f.Bb(1),f.oc("matTooltip",f.kc(28,37,"HIERARCHY.INFORMATIONS.SUBLEVEL_TOOLTIP"))("matTooltipDisabled",0==(null==t.profile?null:t.profile.groupsCount)),f.Bb(2),f.oc("prefix",t.userLevel)("label",f.kc(30,39,"HIERARCHY.INFORMATIONS.SUBLEVEL"))("validator",null==t.form||null==(c=t.form.get("level"))?null:c.validator),f.Bb(3),f.Pc(f.kc(33,41,"COMMON.ERROR.REQUIRED")),f.Bb(3),f.Pc(f.kc(36,43,"HIERARCHY.INFORMATIONS.WRONG_FORMAT")),f.Bb(4),f.oc("label",f.kc(40,45,"HIERARCHY.INFORMATIONS.DESCRIPTION"))("validator",null==t.form||null==(o=t.form.get("description"))?null:o.validator),f.Bb(3),f.Pc(f.kc(43,47,"COMMON.ERROR.REQUIRED"))}},directives:[a.y,a.r,a.i,l.ac,a.q,a.g,O.a,r.p,l.F,a.l,l.zb,l.G,l.J],pipes:[_.d],styles:[""]}),e})(),U=(()=>{class e{constructor(e,t,i){this.hierarchyService=e,this.authService=t,this.startupService=i,this.previewClose=new f.n}set id(e){this.hierarchyService.get(e).subscribe(e=>this.profile=e)}ngOnInit(){this.profileUpdateSub=this.hierarchyService.updated.subscribe(e=>{e&&(this.profile=e)})}ngOnDestroy(){this.profileUpdateSub.unsubscribe()}openPopup(){window.open(this.startupService.getConfigStringValue("UI_URL")+"/profile-hierarchy/"+this.profile.id,"detailPopup","width=584, height=713, resizable=no, location=no"),this.emitClose()}emitClose(){this.previewClose.emit()}levelNotAllowed(){if(this.profile)return!Object(l.Kb)(this.authService.user,this.profile.level)}filterEvents(e){return e.outDetail&&(e.outDetail.includes("EXT_VITAMUI_CREATE_PROFILE")||e.outDetail.includes("EXT_VITAMUI_UPDATE_PROFILE"))}}return e.\u0275fac=function(t){return new(t||e)(f.Nb(A),f.Nb(l.k),f.Nb(l.lb))},e.\u0275cmp=f.Hb({type:e,selectors:[["app-hierarchy-detail"]],inputs:{id:"id",profile:"profile",isPopup:"isPopup"},outputs:{previewClose:"previewClose"},decls:9,vars:15,consts:[[3,"title","subtitle","icon","badge","onclose"],[1,"vitamui-sidepanel-body"],[1,"preview-tab-group"],[3,"label"],[3,"profile","readOnly"],["collectionName","profiles",3,"id","identifier","filter"]],template:function(e,t){1&e&&(f.Tb(0,"vitamui-common-sidenav-header",0),f.ec("onclose",(function(){return t.emitClose()})),f.Sb(),f.Tb(1,"div",1),f.Tb(2,"mat-tab-group",2),f.Tb(3,"mat-tab",3),f.jc(4,"translate"),f.Ob(5,"app-information-tab",4),f.Sb(),f.Tb(6,"mat-tab",3),f.jc(7,"translate"),f.Ob(8,"vitamui-common-operation-history-tab",5),f.Sb(),f.Sb(),f.Sb()),2&e&&(f.oc("title",null==t.profile?null:t.profile.name)("subtitle","("+(null==t.profile?null:t.profile.identifier)+")")("icon","vitamui-icon-admin-key")("badge",null!=t.profile&&t.profile.enabled?"green":"grey"),f.Bb(3),f.oc("label",f.kc(4,11,"HIERARCHY.TAB.INFORMATIONS")),f.Bb(2),f.oc("profile",t.profile)("readOnly",t.isPopup||(null==t.profile?null:t.profile.readonly)||t.levelNotAllowed()),f.Bb(1),f.oc("label",f.kc(7,13,"HIERARCHY.TAB.HISTORY")),f.Bb(2),f.oc("id",null==t.profile?null:t.profile.id)("identifier",null==t.profile?null:t.profile.identifier)("filter",t.filterEvents))},directives:[l.mc,S.b,S.a,Y,l.Xb],pipes:[_.d],styles:[""]}),e})(),W=(()=>{class e{constructor(e){this.route=e,this.profile=this.route.snapshot.data.profile}ngOnInit(){}closePopup(){window.close()}}return e.\u0275fac=function(t){return new(t||e)(f.Nb(R.a))},e.\u0275cmp=f.Hb({type:e,selectors:[["app-hierarchy-popup"]],decls:1,vars:2,consts:[[3,"profile","isPopup","previewClose"]],template:function(e,t){1&e&&(f.Tb(0,"app-hierarchy-detail",0),f.ec("previewClose",(function(){return t.closePopup()})),f.Sb()),2&e&&f.oc("profile",t.profile)("isPopup",!0)},directives:[U],encapsulation:2}),e})(),q=(()=>{class e{constructor(e,t){this.hierarchyService=e,this.router=t}resolve(e){const t=e.paramMap.get("id");return this.hierarchyService.get(t).pipe(Object(x.a)(1),Object(k.a)(e=>e||(this.router.navigate(["/"]),null)))}}return e.\u0275fac=function(t){return new(t||e)(f.bc(A),f.bc(R.d))},e.\u0275prov=f.Jb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var K=i("P4Xx"),J=i("nrt1");function G(e,t){1&e&&(f.Tb(0,"span"),f.Oc(1),f.jc(2,"translate"),f.Sb()),2&e&&(f.Bb(1),f.Pc(f.kc(2,1,"HIERARCHY.INFORMATIONS.INACTIVE_SWITCH")))}function z(e,t){1&e&&(f.Tb(0,"span"),f.Oc(1),f.jc(2,"translate"),f.Sb()),2&e&&(f.Bb(1),f.Pc(f.kc(2,1,"HIERARCHY.INFORMATIONS.ACTIVE_SWITCH")))}function X(e,t){1&e&&(f.Tb(0,"vitamui-common-input-error"),f.Oc(1),f.jc(2,"translate"),f.Sb()),2&e&&(f.Bb(1),f.Qc(" ",f.kc(2,1,"COMMON.ERROR.REQUIRED")," "))}function Q(e,t){1&e&&(f.Tb(0,"vitamui-common-input-error"),f.Oc(1),f.jc(2,"translate"),f.Sb()),2&e&&(f.Bb(1),f.Qc(" ",f.kc(2,1,"HIERARCHY.INFORMATIONS.MODAL.WRONG_FORMAT")," "))}const Z=function(){return["USERS_APP","ARCHIVE_APP"]};let $=(()=>{class e{constructor(e,t,i,r,a,n){this.dialogRef=e,this.data=t,this.authService=i,this.formBuilder=r,this.hierarchyService=a,this.confirmDialogService=n,this.stepIndex=0}ngOnInit(){this.form=this.formBuilder.group({enabled:[!0],level:["",Object(l.Gb)(this.authService.user)],profileIds:[null,a.x.required],customerId:[this.authService.user.customerId]}),this.keyPressSubscription=this.confirmDialogService.listenToEscapeKeyPress(this.dialogRef).subscribe(()=>this.onCancel())}ngOnDestroy(){this.keyPressSubscription.unsubscribe()}onCancel(){this.form.dirty?this.confirmDialogService.confirmBeforeClosing(this.dialogRef):this.dialogRef.close()}onSubmit(){if(this.form.invalid)return;const e=this.form.getRawValue(),t=[];this.hierarchyService.getAllByParams({criteria:[{key:"id",value:e.profileIds,operator:l.W.in}]}).subscribe(i=>{i.forEach(i=>{i.id=null,i.identifier=null,i.level=e.level,i.enabled=e.enabled,i.readonly=!1,t.push(this.hierarchyService.create(i))}),Object(K.a)(t).subscribe(()=>this.dialogRef.close(!0),()=>this.dialogRef.close())})}formValid(){return this.form.pending||this.form.invalid}}return e.\u0275fac=function(t){return new(t||e)(f.Nb(b.g),f.Nb(b.a),f.Nb(l.k),f.Nb(a.d),f.Nb(A),f.Nb(l.t))},e.\u0275cmp=f.Hb({type:e,selectors:[["app-hierarchy-create"]],decls:33,vars:28,consts:[[1,"header"],[3,"index","count"],[3,"formGroup","ngSubmit"],[1,"content"],[1,"text","large","bold"],[1,"d-flex","justify-content-between"],[1,"mt-2"],["formControlName","enabled"],[4,"ngIf"],[1,"d-flex"],[1,"mr-4","mt-2"],[1,"text","normal","light"],[1,"text","medium","bold"],["formControlName","level",3,"prefix"],[1,"text","medium","bold","mb-3"],["formControlName","profileIds","showLevel","true",3,"tenantIdentifier","applicationNameExclude"],[1,"actions"],["type","submit",1,"btn","primary",3,"disabled"],["type","button",1,"btn","cancel","link",3,"click"]],template:function(e,t){if(1&e&&(f.Tb(0,"div",0),f.Ob(1,"vitamui-common-progress-bar",1),f.Sb(),f.Tb(2,"form",2),f.ec("ngSubmit",(function(){return t.onSubmit()})),f.Tb(3,"div",3),f.Tb(4,"div",4),f.Oc(5),f.jc(6,"translate"),f.Sb(),f.Tb(7,"div",5),f.Tb(8,"div",6),f.Tb(9,"vitamui-common-slide-toggle",7),f.Mc(10,G,3,3,"span",8),f.Mc(11,z,3,3,"span",8),f.Sb(),f.Sb(),f.Tb(12,"div",9),f.Tb(13,"div",10),f.Tb(14,"div",11),f.Oc(15),f.jc(16,"translate"),f.Sb(),f.Tb(17,"div",12),f.Oc(18),f.Sb(),f.Sb(),f.Tb(19,"vitamui-common-level-input",13),f.Mc(20,X,3,3,"vitamui-common-input-error",8),f.Mc(21,Q,3,3,"vitamui-common-input-error",8),f.Sb(),f.Sb(),f.Sb(),f.Tb(22,"div",14),f.Oc(23),f.jc(24,"translate"),f.Sb(),f.Ob(25,"app-profiles-form",15),f.Tb(26,"div",16),f.Tb(27,"button",17),f.Oc(28),f.jc(29,"translate"),f.Sb(),f.Tb(30,"button",18),f.ec("click",(function(){return t.onCancel()})),f.Oc(31),f.jc(32,"translate"),f.Sb(),f.Sb(),f.Sb(),f.Sb()),2&e){var i=null,r=null;f.Bb(1),f.oc("index",t.stepIndex)("count",1),f.Bb(1),f.oc("formGroup",t.form),f.Bb(3),f.Pc(f.kc(6,17,"HIERARCHY.INFORMATIONS.MODAL.TITLE")),f.Bb(5),f.oc("ngIf",!(null!=t.form&&t.form.get("enabled").value)),f.Bb(1),f.oc("ngIf",null==t.form?null:t.form.get("enabled").value),f.Bb(4),f.Pc(f.kc(16,19,"HIERARCHY.INFORMATIONS.LEVEL")),f.Bb(3),f.Pc(t.authService.user.level),f.Bb(1),f.oc("prefix",t.authService.user.level),f.Bb(1),f.oc("ngIf",(null==t.form||null==(i=t.form.get("level"))?null:i.touched)&&(null==t.form||null==(i=t.form.get("level"))?null:i.hasError("required"))),f.Bb(1),f.oc("ngIf",(null==t.form||null==(r=t.form.get("level"))?null:r.touched)&&(null==t.form||null==(r=t.form.get("level"))?null:r.hasError("pattern"))),f.Bb(2),f.Pc(f.kc(24,21,"HIERARCHY.INFORMATIONS.MODAL.DUPLICATE_PROFILE")),f.Bb(2),f.oc("tenantIdentifier",t.data.tenantId)("applicationNameExclude",f.sc(27,Z)),f.Bb(2),f.oc("disabled",t.formValid()),f.Bb(1),f.Pc(f.kc(29,23,"COMMON.SUBMIT")),f.Bb(3),f.Pc(f.kc(32,25,"COMMON.UNDO"))}},directives:[l.dc,a.y,a.r,a.i,l.ac,a.q,a.g,r.p,l.R,J.a,l.Rb],pipes:[_.d],styles:[""],data:{animation:[l.Hb,l.Ob]}}),e})();var ee=i("Ohay"),te=i("O4oY");function ie(e,t){if(1&e){const e=f.Ub();f.Tb(0,"div",13),f.ec("click",(function(){f.Dc(e);const i=t.$implicit;return f.ic().profileClick.emit(i)})),f.Tb(1,"div",14),f.Tb(2,"div",3),f.Ob(3,"i",15),f.Sb(),f.Tb(4,"div",16),f.Oc(5),f.Sb(),f.Tb(6,"div",17),f.Oc(7),f.jc(8,"translate"),f.Sb(),f.Tb(9,"div",16),f.Oc(10),f.jc(11,"truncate"),f.Sb(),f.Tb(12,"div",18),f.Oc(13),f.Sb(),f.Tb(14,"div",18),f.Oc(15),f.Sb(),f.Tb(16,"div",18),f.Oc(17),f.Sb(),f.Sb(),f.Sb()}if(2&e){const e=t.$implicit;f.Bb(3),f.Jc("font-size",30,"px"),f.oc("ngClass",null!=e&&e.enabled?"status-badge-green":"status-badge-grey"),f.Bb(2),f.Pc(e.name),f.Bb(2),f.Pc(f.kc(8,9,"APPLICATION."+e.applicationName+".NAME")),f.Bb(3),f.Pc(f.lc(11,11,e.description,50)),f.Bb(3),f.Pc(e.level),f.Bb(2),f.Pc(e.identifier),f.Bb(2),f.Pc(e.usersCount)}}function re(e,t){1&e&&f.Ob(0,"div")}function ae(e,t){1&e&&f.Ob(0,"div")}function ne(e,t){1&e&&f.Ob(0,"div")}function ce(e,t){1&e&&(f.Tb(0,"div",19),f.Oc(1),f.jc(2,"translate"),f.Sb()),2&e&&(f.Bb(1),f.Pc(f.kc(2,1,"COMMON.NO_RESULT")))}function oe(e,t){if(1&e){const e=f.Ub();f.Tb(0,"div",20),f.ec("click",(function(){return f.Dc(e),f.ic().hierarchyService.loadMore()})),f.Tb(1,"span",21),f.Oc(2),f.jc(3,"translate"),f.Sb(),f.Sb()}2&e&&(f.Bb(2),f.Pc(f.kc(3,1,"COMMON.SHOW_MORE_RESULTS")))}function le(e,t){1&e&&(f.Tb(0,"div",22),f.Ob(1,"mat-spinner",23),f.Sb())}let se=(()=>{class e extends l.O{constructor(e,t){super(e),this.hierarchyService=e,this.route=t,this.profileClick=new f.n,this.filterChange=new y.a,this.searchChange=new y.a,this.orderChange=new y.a,this.searchKeys=["name","description","identifier"],this.updatedProfileSub=this.hierarchyService.updated.subscribe(e=>{const t=this.dataSource.findIndex(t=>e.id===t.id);t>-1&&(this.dataSource[t]={id:this.dataSource[t].id,enabled:e.enabled,name:e.name,level:e.level,customerId:this.dataSource[t].customerId,groupsCount:this.dataSource[t].groupsCount,description:e.description,usersCount:this.dataSource[t].usersCount,tenantName:this.dataSource[t].tenantName,tenantIdentifier:this.dataSource[t].tenantIdentifier,applicationName:this.dataSource[t].applicationName,roles:this.dataSource[t].roles,readonly:this.dataSource[t].readonly,externalParamId:this.dataSource[t].externalParamId})})}set searchText(e){this._searchText=e,this.searchChange.next(e)}ngOnInit(){const e=this.route.paramMap.pipe(Object(H.a)(e=>!!e.get("tenantIdentifier")),Object(k.a)(e=>+e.get("tenantIdentifier")),Object(ee.a)(),Object(C.a)(e=>{this.tenantIdentifier=e,this.hierarchyService.setTenantId(e)}));Object(N.a)(e,this.searchChange,this.filterChange,this.orderChange).pipe(Object(P.a)(400)).subscribe(()=>this.search())}ngOnDestroy(){this.updatedProfileSub.unsubscribe()}search(){const e={criteria:[{key:"applicationName",value:[l.h.USERS_APP],operator:l.W.notin},{key:"externalParamId",value:null,operator:l.W.equals},{key:"tenantIdentifier",value:this.tenantIdentifier,operator:l.W.equals},...Object(l.Fb)(this._searchText,this.searchKeys)]};super.search(new l.Z(0,te.b,"name",l.x.ASCENDANT,JSON.stringify(e)))}}return e.\u0275fac=function(t){return new(t||e)(f.Nb(A),f.Nb(R.a))},e.\u0275cmp=f.Hb({type:e,selectors:[["app-hierarchy-list"]],inputs:{searchText:["search","searchText"]},outputs:{profileClick:"profileClick"},features:[f.yb],decls:34,vars:27,consts:[["vitamuiCommonInfiniteScroll","",3,"vitamuiScroll"],[1,"vitamui-table"],[1,"vitamui-table-head"],[1,"col-1"],[1,"vitamui-icon","vitamui-icon-admin-key"],[1,"col-3"],[1,"col-2"],[1,"vitamui-table-body"],["class","vitamui-table-rows",3,"click",4,"ngFor","ngForOf"],[4,"ngIf","ngIfThen"],["noResults",""],["loadMore",""],["loadingSpinner",""],[1,"vitamui-table-rows",3,"click"],[1,"vitamui-row","d-flex","align-items-center","clickable"],[1,"vitamui-icon","vitamui-icon-admin-key",3,"ngClass"],["vitamuiCommonEllipsis","",1,"col-3"],["vitamuiCommonEllipsis","",1,"col-2"],["vitamuiCommonEllipsis","",1,"col-1"],[1,"vitamui-min-content","vitamui-table-message"],[1,"vitamui-min-content","vitamui-table-message",3,"click"],[1,"clickable"],[1,"vitamui-min-content"],[1,"vitamui-spinner","medium"]],template:function(e,t){if(1&e&&(f.Tb(0,"div",0),f.ec("vitamuiScroll",(function(){return t.onScroll()})),f.Tb(1,"div",1),f.Tb(2,"div",2),f.Tb(3,"div",3),f.Ob(4,"i",4),f.Sb(),f.Tb(5,"div",5),f.Oc(6),f.jc(7,"translate"),f.Sb(),f.Tb(8,"div",6),f.Oc(9),f.jc(10,"translate"),f.Sb(),f.Tb(11,"div",5),f.Oc(12),f.jc(13,"translate"),f.Sb(),f.Tb(14,"div",3),f.Oc(15),f.jc(16,"translate"),f.Sb(),f.Tb(17,"div",3),f.Oc(18),f.jc(19,"translate"),f.Sb(),f.Tb(20,"div",3),f.Oc(21),f.jc(22,"translate"),f.Sb(),f.Sb(),f.Tb(23,"div",7),f.Mc(24,ie,18,14,"div",8),f.Sb(),f.Sb(),f.Mc(25,re,1,0,"div",9),f.Mc(26,ae,1,0,"div",9),f.Mc(27,ne,1,0,"div",9),f.Sb(),f.Mc(28,ce,3,3,"ng-template",null,10,f.Nc),f.Mc(30,oe,4,3,"ng-template",null,11,f.Nc),f.Mc(32,le,2,0,"ng-template",null,12,f.Nc)),2&e){const e=f.zc(29),i=f.zc(31),r=f.zc(33);f.Bb(4),f.Jc("font-size",30,"px"),f.Bb(2),f.Pc(f.kc(7,15,"HIERARCHY.HOME.RESULTS_TABLE.NAME")),f.Bb(3),f.Pc(f.kc(10,17,"HIERARCHY.HOME.RESULTS_TABLE.APP")),f.Bb(3),f.Pc(f.kc(13,19,"HIERARCHY.HOME.RESULTS_TABLE.DESCRIPTION")),f.Bb(3),f.Pc(f.kc(16,21,"HIERARCHY.HOME.RESULTS_TABLE.LEVEL")),f.Bb(3),f.Pc(f.kc(19,23,"COMMON.ID")),f.Bb(3),f.Pc(f.kc(22,25,"HIERARCHY.HOME.RESULTS_TABLE.USERS_NUMBER")),f.Bb(3),f.oc("ngForOf",t.dataSource),f.Bb(1),f.oc("ngIf",!t.dataSource||t.pending)("ngIfThen",r),f.Bb(1),f.oc("ngIf",!t.pending&&0===(null==t.dataSource?null:t.dataSource.length))("ngIfThen",e),f.Bb(1),f.oc("ngIf",t.infiniteScrollDisabled&&t.hierarchyService.canLoadMore&&!t.pending)("ngIfThen",i)}},directives:[l.N,r.o,r.p,r.n,l.Zb,T.b],pipes:[_.d,l.qc],styles:[""]}),e})();function be(e,t){if(1&e){const e=f.Ub();f.Tb(0,"app-hierarchy-detail",9),f.ec("previewClose",(function(){return f.Dc(e),f.ic().closePanel()})),f.Sb()}if(2&e){const e=f.ic();f.oc("id",null==e.openedItem?null:e.openedItem.id)}}const ue=[{path:"",redirectTo:"tenant",pathMatch:"full"},{path:"tenant",component:l.Bb,canActivate:[l.tb],pathMatch:"full"},{path:"tenant/:tenantIdentifier",component:(()=>{class e extends l.kb{constructor(e,t,i){super(t,i),this.dialog=e,this.route=t,this.globalEventService=i}ngOnInit(){this.route.paramMap.subscribe(e=>{this.tenantIdentifier=+e.get("tenantIdentifier")})}openHierarchyDuplicateDialog(){this.dialog.open($,{panelClass:"vitamui-modal",disableClose:!0,data:{tenantId:this.tenantIdentifier}}).afterClosed().subscribe(e=>{e&&this.refreshList()})}onSearchSubmit(e){this.search=e}refreshList(){this.hierarchyListComponent&&this.hierarchyListComponent.search()}}return e.\u0275fac=function(t){return new(t||e)(f.Nb(b.b),f.Nb(R.a),f.Nb(l.M))},e.\u0275cmp=f.Hb({type:e,selectors:[["app-hierarchy"]],viewQuery:function(e,t){var i;1&e&&f.Ic(se,!0),2&e&&f.yc(i=f.fc())&&(t.hierarchyListComponent=i.first)},features:[f.yb],decls:17,vars:14,consts:[[3,"autosize","hasBackdrop"],["mode","side","position","end",3,"fixedInViewport"],["panel",""],[3,"id","previewClose",4,"ngIf"],[1,"vitamui-heading"],[3,"searchbarPlaceholder","search"],[1,"btn","primary","ml-5",3,"click"],[1,"vitamui-content"],[3,"search","profileClick"],[3,"id","previewClose"]],template:function(e,t){1&e&&(f.Tb(0,"mat-sidenav-container",0),f.Tb(1,"mat-sidenav",1,2),f.Mc(3,be,1,1,"app-hierarchy-detail",3),f.Sb(),f.Tb(4,"mat-sidenav-content"),f.Tb(5,"div",4),f.Tb(6,"vitamui-common-title-breadcrumb"),f.Oc(7),f.jc(8,"translate"),f.Sb(),f.Tb(9,"vitamui-common-banner",5),f.ec("search",(function(e){return t.onSearchSubmit(e)})),f.jc(10,"translate"),f.Tb(11,"button",6),f.ec("click",(function(){return t.openHierarchyDuplicateDialog()})),f.Tb(12,"span"),f.Oc(13),f.jc(14,"translate"),f.Sb(),f.Sb(),f.Sb(),f.Sb(),f.Tb(15,"div",7),f.Tb(16,"app-hierarchy-list",8),f.ec("profileClick",(function(e){return t.openPanel(e)})),f.Sb(),f.Sb(),f.Sb(),f.Sb()),2&e&&(f.oc("autosize",!0)("hasBackdrop",!1),f.Bb(1),f.oc("fixedInViewport",!0),f.Bb(2),f.oc("ngIf",t.openedItem),f.Bb(4),f.Qc(" ",f.kc(8,8,"APPLICATION.HIERARCHY_PROFILE_APP.NAME")," "),f.Bb(2),f.oc("searchbarPlaceholder",f.kc(10,10,"HIERARCHY.HOME.TITLE_PLACEHOLDER")),f.Bb(4),f.Pc(f.kc(14,12,"HIERARCHY.HOME.ACTION_BUTTON")),f.Bb(3),f.oc("search",t.search))},directives:[o.b,o.a,r.p,o.c,l.cc,l.jc,se,U],pipes:[_.d],styles:[""]}),e})(),canActivate:[l.c]},{path:":id",component:W,resolve:{profile:q},data:{isPopup:!0,appId:"HIERARCHY_PROFILE_APP"}}];let de=(()=>{class e{}return e.\u0275mod=f.Lb({type:e}),e.\u0275inj=f.Kb({factory:function(t){return new(t||e)},imports:[[r.c,R.g.forChild(ue)],R.g]}),e})(),pe=(()=>{class e{}return e.\u0275mod=f.Lb({type:e}),e.\u0275inj=f.Kb({factory:function(t){return new(t||e)},imports:[[r.c,l.xb,s.a,g,I,h,n.c,c.b,a.v,o.d,de]]}),e})()}}]);