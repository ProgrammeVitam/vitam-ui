(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{J4zT:function(e,t,i){"use strict";i.r(t),i.d(t,"GroupModule",(function(){return we}));var n=i("2kYt"),r=i("vobO"),o=i("OZ4H"),c=i("Jb3d"),a=i("lQ7A"),l=i("OWX3"),s=i("PCNd"),u=i("nIj0"),b=i("jdnZ"),d=i("29Wa"),p=i("Cd2c"),m=i("66mq"),f=i("R7+U"),v=i("W1gw"),g=i("Y2X+"),h=i("EM62");let O=(()=>{class e{}return e.\u0275mod=h.Lb({type:e}),e.\u0275inj=h.Kb({factory:function(t){return new(t||e)},imports:[[n.c,n.c,u.v,f.b,g.b,l.xb]]}),e})(),S=(()=>{class e{}return e.\u0275mod=h.Lb({type:e}),e.\u0275inj=h.Kb({factory:function(t){return new(t||e)},imports:[[n.c,s.a,b.c,d.d,p.c,m.b,f.b,v.c,u.v,o.f,l.xb,O]]}),e})();var T=i("mFH5"),C=i("csyo"),B=i("sEIs");let I=(()=>{class e{}return e.\u0275mod=h.Lb({type:e}),e.\u0275inj=h.Kb({factory:function(t){return new(t||e)},imports:[[n.c,s.a,B.g,T.q,C.a,l.xb]]}),e})();var y=i("KZIX");let N=(()=>{class e{}return e.\u0275mod=h.Lb({type:e}),e.\u0275inj=h.Kb({factory:function(t){return new(t||e)},imports:[[n.c,s.a,B.g,c.b,y.c,g.b,m.b,u.v,l.xb,O]]}),e})();var M=i("bWz1"),R=i("g6G6"),P=i("ROBh"),E=i("mWib"),k=i("YtkY"),A=i("xVbo"),j=i("TLy2"),U=i("4e/d"),x=i("6WTZ"),D=i("8lHc"),w=i("J+dc");let L=(()=>{class e{constructor(e){this.groupService=e,this.debounceTime=400,this.nameExists=(e,t)=>i=>Object(D.a)(this.debounceTime).pipe(Object(j.a)(()=>i.value!==t?this.groupService.exists(e,i.value):Object(P.a)(!1)),Object(w.a)(1),Object(k.a)(e=>e?{nameExists:!0}:null)),this.unitExists=(e,t=[])=>i=>Object(D.a)(this.debounceTime).pipe(Object(j.a)(()=>{var n;return(null===(n=i.value)||void 0===n?void 0:n.trim())?t.includes(i.value)?Object(P.a)(!1):this.groupService.unitExists(e,i.value.trim()):Object(P.a)(!1)}),Object(w.a)(1),Object(k.a)(e=>e?{unitExists:!0}:null))}}return e.\u0275fac=function(t){return new(t||e)(h.bc(M.a))},e.\u0275prov=h.Jb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var F=i("IrDo"),G=i("s2Ay");function _(e,t){1&e&&(h.Tb(0,"vitamui-common-input-error"),h.Oc(1),h.jc(2,"translate"),h.Sb()),2&e&&(h.Bb(1),h.Qc(" ",h.kc(2,1,"GROUP.UNITS_FORM.UNIT_ALREADY_EXIST")," "))}function V(e,t){1&e&&(h.Tb(0,"vitamui-common-input-error"),h.Oc(1),h.jc(2,"translate"),h.Sb()),2&e&&(h.Bb(1),h.Qc(" ",h.kc(2,1,"GROUP.UNITS_FORM.UNIT_ALREADY_ADDED")," "))}function H(e,t){if(1&e&&(h.Rb(0),h.Mc(1,_,3,3,"vitamui-common-input-error",3),h.Mc(2,V,3,3,"vitamui-common-input-error",3),h.Qb()),2&e){const e=h.ic();h.Bb(1),h.oc("ngIf",!(null==e.unitControl||null==e.unitControl.errors||!e.unitControl.errors.unitExists)),h.Bb(1),h.oc("ngIf",!(null==e.unitControl||null==e.unitControl.errors||!e.unitControl.errors.unitAlreadyAdd))}}function q(e,t){if(1&e){const e=h.Ub();h.Tb(0,"div",9),h.Tb(1,"div",10),h.Tb(2,"div",11),h.Oc(3),h.Sb(),h.Tb(4,"div",12),h.Tb(5,"button",13),h.ec("click",(function(){h.Dc(e);const i=t.$implicit;return h.ic().remove(i)})),h.Tb(6,"i",14),h.Oc(7,"clear"),h.Sb(),h.Sb(),h.Sb(),h.Sb(),h.Sb()}if(2&e){const e=t.$implicit;h.Bb(3),h.Pc(e)}}const K={provide:u.o,useExisting:Object(h.V)(()=>Q),multi:!0};let Q=(()=>{class e{constructor(e){this.groupValidators=e,this.units=[],this.removedUnits=[],this.onChange=e=>{},this.onTouched=()=>{}}writeValue(e){this.units=e||[]}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}ngOnInit(){this.unitControl=new u.e("",[this.unitAlreadyAdd.bind(this)],this.groupValidators.unitExists(this.customer,this.removedUnits))}add(){let e=this.unitControl.value;if(!e||this.unitControl.pending||this.unitControl.invalid)return;this.unitControl.reset(),e=e.trim();const t=this.removedUnits.indexOf(e);t>-1&&this.removedUnits.splice(t,1),this.units.push(e),this.sortUnits(),this.onChange(this.units)}remove(e){this.removedUnits.push(e),this.units=this.units.filter(t=>t!==e),this.onChange(this.units)}sortUnits(){this.units.sort((e,t)=>e.localeCompare(t))}unitAlreadyAdd(e){const t=e.value;return t&&this.units.map(e=>e.toLocaleLowerCase()).includes(t.trim().toLocaleLowerCase())?{unitAlreadyAdd:!0}:null}}return e.\u0275fac=function(t){return new(t||e)(h.Nb(L))},e.\u0275cmp=h.Hb({type:e,selectors:[["app-units-form"]],inputs:{customer:"customer"},features:[h.Ab([K])],decls:14,vars:10,consts:[[1,"d-flex","align-items-center","mb-3"],[1,"mb-9"],[1,"col-12","p-0",3,"formControl","placeholder","keydown.enter"],[4,"ngIf"],[1,"d-flex","flex-column","align-items-center","justify-content-center"],["type","button",1,"btn","primary",3,"disabled","click"],[1,"vitamui-table","mt-2"],[1,"vitamui-table-body"],["class","vitamui-table-rows",4,"ngFor","ngForOf"],[1,"vitamui-table-rows"],[1,"vitamui-row","d-flex","align-items-center"],["vitamuiCommonEllipsis","",1,"col-11"],[1,"col-1"],[1,"btn","link",3,"click"],[1,"material-icons"]],template:function(e,t){1&e&&(h.Tb(0,"div",0),h.Tb(1,"div"),h.Tb(2,"div",1),h.Tb(3,"vitamui-common-input",2),h.ec("keydown.enter",(function(){return t.add()})),h.jc(4,"translate"),h.Mc(5,H,3,2,"ng-container",3),h.Sb(),h.Sb(),h.Sb(),h.Tb(6,"div"),h.Tb(7,"div",4),h.Tb(8,"button",5),h.ec("click",(function(){return t.add()})),h.Oc(9),h.jc(10,"translate"),h.Sb(),h.Sb(),h.Sb(),h.Sb(),h.Tb(11,"div",6),h.Tb(12,"div",7),h.Mc(13,q,8,1,"div",8),h.Sb(),h.Sb()),2&e&&(h.Bb(3),h.oc("formControl",t.unitControl)("placeholder",h.kc(4,6,"GROUP.UNITS_FORM.INPUT_PLACEHOLDER")),h.Bb(2),h.oc("ngIf",null==t.unitControl?null:t.unitControl.touched),h.Bb(3),h.oc("disabled",!(null!=t.unitControl&&null!=t.unitControl.value&&t.unitControl.value.trim())||t.unitControl.invalid),h.Bb(1),h.Qc(" ",h.kc(10,8,"COMMON.ADD")," "),h.Bb(4),h.oc("ngForOf",t.units))},directives:[l.Qb,u.q,u.f,n.p,n.o,l.Rb,l.Zb],pipes:[G.d],styles:[".d-flex[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-of-type{width:65%}.d-flex[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-of-type > div[_ngcontent-%COMP%]{height:60px}.d-flex[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-of-type{width:25%}"]}),e})(),z=(()=>{class e{constructor(e,t,i,n,r){this.dialogRef=e,this.data=t,this.groupService=i,this.confirmDialogService=n,this.form=r.group({units:[this.data.group.units]})}ngOnInit(){this.keyPressSubscription=this.confirmDialogService.listenToEscapeKeyPress(this.dialogRef).subscribe(()=>this.onCancel())}ngOnDestroy(){this.keyPressSubscription.unsubscribe()}onSubmit(){this.form.pristine||this.form.invalid||this.groupService.patch({id:this.data.group.id,units:this.form.value.units}).pipe(Object(w.a)(1)).subscribe(e=>this.dialogRef.close(e),e=>{console.error(e)})}onCancel(){this.form.dirty?this.confirmDialogService.confirmBeforeClosing(this.dialogRef):this.dialogRef.close()}}return e.\u0275fac=function(t){return new(t||e)(h.Nb(o.g),h.Nb(o.a),h.Nb(M.a),h.Nb(l.t),h.Nb(u.d))},e.\u0275cmp=h.Hb({type:e,selectors:[["app-units-edit"]],decls:17,vars:14,consts:[[1,"header"],["count","1",3,"index"],[3,"formGroup","ngSubmit"],[1,"content"],[1,"text","large","bold"],["formControlName","units",3,"customer"],[1,"actions"],["type","submit",1,"btn","primary",3,"disabled"],["type","button",1,"btn","cancel","link",3,"click"]],template:function(e,t){1&e&&(h.Tb(0,"div",0),h.Ob(1,"vitamui-common-progress-bar",1),h.Sb(),h.Tb(2,"form",2),h.ec("ngSubmit",(function(){return t.onSubmit()})),h.Tb(3,"vitamui-common-stepper"),h.Tb(4,"cdk-step"),h.Tb(5,"div",3),h.Tb(6,"div",4),h.Oc(7),h.jc(8,"translate"),h.Sb(),h.Ob(9,"app-units-form",5),h.Tb(10,"div",6),h.Tb(11,"button",7),h.Oc(12),h.jc(13,"translate"),h.Sb(),h.Tb(14,"button",8),h.ec("click",(function(){return t.onCancel()})),h.Oc(15),h.jc(16,"translate"),h.Sb(),h.Sb(),h.Sb(),h.Sb(),h.Sb(),h.Sb()),2&e&&(h.Bb(1),h.oc("index",0),h.Bb(1),h.oc("formGroup",t.form),h.Bb(5),h.Rc("",h.kc(8,8,"GROUP.INFORMATIONS.MODAL.UPDATE_UNITS"),' "',null==t.data||null==t.data.group?null:t.data.group.name,'"'),h.Bb(2),h.oc("customer",null==t.data||null==t.data.group?null:t.data.group.customerId),h.Bb(2),h.oc("disabled",t.form.pristine||t.form.invalid),h.Bb(1),h.Pc(h.kc(13,10,"COMMON.SUBMIT")),h.Bb(3),h.Pc(h.kc(16,12,"COMMON.UNDO")))},directives:[l.dc,u.y,u.r,u.i,l.mb,F.a,Q,u.q,u.g],pipes:[G.d],styles:[""]}),e})();function W(e,t){1&e&&(h.Tb(0,"span"),h.Oc(1),h.jc(2,"translate"),h.Sb()),2&e&&(h.Bb(1),h.Pc(h.kc(2,1,"GROUP.INFORMATIONS.INACTIVE_SWITCH")))}function X(e,t){1&e&&(h.Tb(0,"span"),h.Oc(1),h.jc(2,"translate"),h.Sb()),2&e&&(h.Bb(1),h.Pc(h.kc(2,1,"GROUP.INFORMATIONS.ACTIVE_SWITCH")))}function Y(e,t){if(1&e){const e=h.Ub();h.Tb(0,"button",22),h.ec("click",(function(){return h.Dc(e),h.ic().openEditUnitsDialog()})),h.Oc(1),h.jc(2,"translate"),h.Sb()}2&e&&(h.Bb(1),h.Qc(" ",h.kc(2,1,"GROUP.INFORMATIONS.MODIF_UNITS_BUTTON")," "))}function J(e,t){if(1&e&&(h.Tb(0,"div",23),h.Oc(1),h.Sb()),2&e){const e=t.$implicit;h.Bb(1),h.Pc(e)}}let Z=(()=>{class e{constructor(e,t,i,n,r){this.formBuilder=e,this.groupService=t,this.groupValidators=i,this.authService=n,this.dialog=r,this.form=this.formBuilder.group({id:[null,u.x.required],identifier:[{value:null,disabled:!0},u.x.required],enabled:[!1],name:[null,u.x.required],description:[null,u.x.required],level:[null,Object(l.Gb)(this.authService.user)]}),this.updateSub=Object(R.a)(this.form.valueChanges,this.form.statusChanges).pipe(Object(E.a)(200),Object(k.a)(()=>Object(l.Ib)(this.form.value,this.previousValue)),Object(A.a)(e=>!Object(x.c)(e)),Object(k.a)(e=>Object(x.a)({id:this.group.id},e)),Object(j.a)(e=>this.groupService.patch(e).pipe(Object(U.a)(()=>Object(P.a)(null))))).subscribe(()=>this.previousValue=this.form.value)}ngOnChanges(e){(e.hasOwnProperty("group")||e.hasOwnProperty("readOnly"))&&this.group&&(this.resetForm(this.form,this.group,this.readOnly),this.previousValue=this.form.value)}resetForm(e,t,i){e.reset(t,{emitEvent:!1}),this.initFormValidators(e,t),this.initFormActivationState(e,t,i),e.updateValueAndValidity({emitEvent:!1})}initFormValidators(e,t){e.get("name").setAsyncValidators(this.groupValidators.nameExists(t.customerId,t.name))}initFormActivationState(e,t,i){i?e.disable({emitEvent:!1}):(e.enable({emitEvent:!1}),e.get("identifier").disable({emitEvent:!1}),t.usersCount&&this.form.get("enabled").disable({emitEvent:!1}),t.profileIds&&t.profileIds.length&&this.form.get("level").disable({emitEvent:!1}))}ngOnDestroy(){this.updateSub.unsubscribe()}openEditUnitsDialog(){this.dialog.open(z,{data:{group:this.group},autoFocus:!1,disableClose:!0,panelClass:"vitamui-modal"})}getUnits(e){var t;return null===(t=null==e?void 0:e.units)||void 0===t?void 0:t.sort((e,t)=>e.localeCompare(t))}}return e.\u0275fac=function(t){return new(t||e)(h.Nb(u.d),h.Nb(M.a),h.Nb(L),h.Nb(l.k),h.Nb(o.b))},e.\u0275cmp=h.Hb({type:e,selectors:[["app-information-tab"]],inputs:{group:"group",readOnly:"readOnly"},features:[h.zb],decls:53,vars:55,consts:[[3,"formGroup"],["clas","row"],["formControlName","enabled","matTooltipClass","vitamui-tooltip",3,"matTooltip","matTooltipDisabled"],[4,"ngIf"],[1,"row"],[1,"col-8","form-control"],["formControlName","identifier",3,"label","validator","asyncValidator"],["formControlName","name","minlength","2","maxlength","100",3,"label","validator","asyncValidator"],["errorKey","required"],["errorKey","nameExists"],[1,"col-12","form-control"],["formControlName","description","maxlength","250","minlength","4","maxlength","100",3,"label","validator","asyncValidator"],[1,"row","d-flex"],[1,"col-5"],[1,"read-only-field"],["matTooltipClass","vitamui-tooltip",1,"col-7",3,"matTooltip","matTooltipDisabled"],["formControlName","level","maxlength","250",3,"prefix","label","validator"],[1,"vitamui-separator"],["class","btn primary mb-3",3,"click",4,"ngIf"],[1,"align-items-center"],[1,"text","small","primary","mb-2"],["class","text medium",4,"ngFor","ngForOf"],[1,"btn","primary","mb-3",3,"click"],[1,"text","medium"]],template:function(e,t){if(1&e&&(h.Tb(0,"form",0),h.Tb(1,"div",1),h.Tb(2,"vitamui-common-slide-toggle",2),h.jc(3,"translate"),h.Mc(4,W,3,3,"span",3),h.Mc(5,X,3,3,"span",3),h.Sb(),h.Sb(),h.Tb(6,"div",4),h.Tb(7,"div",5),h.Ob(8,"vitamui-common-editable-input",6),h.jc(9,"translate"),h.Sb(),h.Sb(),h.Tb(10,"div",4),h.Tb(11,"div",5),h.Tb(12,"vitamui-common-editable-input",7),h.jc(13,"translate"),h.Tb(14,"vitamui-common-field-error",8),h.Oc(15),h.jc(16,"translate"),h.Sb(),h.Tb(17,"vitamui-common-field-error",9),h.Oc(18),h.jc(19,"translate"),h.Sb(),h.Sb(),h.Sb(),h.Sb(),h.Tb(20,"div",4),h.Tb(21,"div",10),h.Tb(22,"vitamui-common-editable-textarea",11),h.jc(23,"translate"),h.Tb(24,"vitamui-common-field-error",8),h.Oc(25),h.jc(26,"translate"),h.Sb(),h.Sb(),h.Sb(),h.Sb(),h.Tb(27,"div",12),h.Tb(28,"div",13),h.Tb(29,"div",14),h.Tb(30,"label"),h.Oc(31),h.jc(32,"translate"),h.Sb(),h.Tb(33,"div"),h.Oc(34),h.Sb(),h.Sb(),h.Sb(),h.Tb(35,"div",15),h.jc(36,"translate"),h.Tb(37,"vitamui-common-editable-level-input",16),h.jc(38,"translate"),h.Tb(39,"vitamui-common-field-error",8),h.Oc(40),h.jc(41,"translate"),h.Sb(),h.Tb(42,"vitamui-common-field-error",9),h.Oc(43),h.jc(44,"translate"),h.Sb(),h.Sb(),h.Sb(),h.Sb(),h.Ob(45,"div",17),h.Tb(46,"div"),h.Mc(47,Y,3,3,"button",18),h.Tb(48,"div",19),h.Tb(49,"div",20),h.Oc(50),h.jc(51,"translate"),h.Sb(),h.Mc(52,J,2,1,"div",21),h.Sb(),h.Sb(),h.Sb()),2&e){var i=null,n=null,r=null,o=null,c=null,a=null,l=null;h.oc("formGroup",t.form),h.Bb(2),h.oc("matTooltip",h.kc(3,29,"GROUP.INFORMATIONS.ACTIVE_SWITCH_TOOLTIP"))("matTooltipDisabled",t.form.get("enabled").enabled||t.readOnly),h.Bb(2),h.oc("ngIf",!(null!=t.form&&t.form.get("enabled").value)),h.Bb(1),h.oc("ngIf",null==t.form?null:t.form.get("enabled").value),h.Bb(3),h.oc("label",h.kc(9,31,"COMMON.ID"))("validator",null==t.form||null==(i=t.form.get("identifier"))?null:i.validator)("asyncValidator",null==t.form||null==(n=t.form.get("identifier"))?null:n.asyncValidator),h.Bb(4),h.oc("label",h.kc(13,33,"GROUP.INFORMATIONS.NAME"))("validator",null==t.form||null==(r=t.form.get("name"))?null:r.validator)("asyncValidator",null==t.form||null==(o=t.form.get("name"))?null:o.asyncValidator),h.Bb(3),h.Pc(h.kc(16,35,"COMMON.ERROR.REQUIRED")),h.Bb(3),h.Pc(h.kc(19,37,"GROUP.INFORMATIONS.EXISTING_NAME")),h.Bb(4),h.oc("label",h.kc(23,39,"GROUP.INFORMATIONS.DESCRIPTION"))("validator",null==t.form||null==(c=t.form.get("description"))?null:c.validator)("asyncValidator",null==t.form||null==(a=t.form.get("description"))?null:a.asyncValidator),h.Bb(3),h.Pc(h.kc(26,41,"COMMON.ERROR.REQUIRED")),h.Bb(6),h.Pc(h.kc(32,43,"GROUP.INFORMATIONS.LEVEL")),h.Bb(3),h.Pc(t.authService.user.level),h.Bb(1),h.oc("matTooltip",h.kc(36,45,"GROUP.INFORMATIONS.SUBLEVEL_TOOLTIP"))("matTooltipDisabled",(null==t.form?null:t.form.get("level").enabled)||t.readOnly),h.Bb(2),h.oc("prefix",t.authService.user.level)("label",h.kc(38,47,"GROUP.INFORMATIONS.SUBLEVEL"))("validator",null==t.form||null==(l=t.form.get("level"))?null:l.validator),h.Bb(3),h.Pc(h.kc(41,49,"COMMON.ERROR.REQUIRED")),h.Bb(3),h.Pc(h.kc(44,51,"GROUP.INFORMATIONS.WRONG_FORMAT")),h.Bb(4),h.oc("ngIf",!t.readOnly),h.Bb(3),h.Pc(h.kc(51,53,"GROUP.INFORMATIONS.UNITS_TABLE_TITLE")),h.Bb(2),h.oc("ngForOf",t.getUnits(t.group))}},directives:[u.y,u.r,u.i,l.ac,u.q,u.g,g.a,n.p,l.F,u.m,u.l,l.zb,l.J,l.G,n.o],pipes:[G.d],styles:[""]}),e})();var $=i("nrt1");let ee=(()=>{class e{constructor(e,t,i,n,r){this.dialogRef=e,this.data=t,this.groupService=i,this.confirmDialogService=n,this.stepIndex=0,this.stepCount=1,this.form=r.group({profileIds:[this.data.group.profileIds,u.x.required]})}ngOnInit(){this.keyPressSubscription=this.confirmDialogService.listenToEscapeKeyPress(this.dialogRef).subscribe(()=>this.onCancel())}ngOnDestroy(){this.keyPressSubscription.unsubscribe()}onSubmit(){this.form.pristine||this.form.invalid||this.groupService.patch({id:this.data.group.id,profileIds:this.form.value.profileIds}).subscribe(e=>this.dialogRef.close(e),e=>{console.error(e)})}onCancel(){this.form.dirty?this.confirmDialogService.confirmBeforeClosing(this.dialogRef):this.dialogRef.close()}}return e.\u0275fac=function(t){return new(t||e)(h.Nb(o.g),h.Nb(o.a),h.Nb(M.a),h.Nb(l.t),h.Nb(u.d))},e.\u0275cmp=h.Hb({type:e,selectors:[["app-profiles-edit"]],decls:17,vars:15,consts:[[1,"header"],[3,"index","count"],[3,"formGroup","ngSubmit"],[3,"selectionChange"],[1,"content"],[1,"text","large","bold"],["formControlName","profileIds",3,"level"],[1,"actions"],["type","submit",1,"btn","primary",3,"disabled"],["type","button",1,"btn","cancel","link",3,"click"]],template:function(e,t){1&e&&(h.Tb(0,"div",0),h.Ob(1,"vitamui-common-progress-bar",1),h.Sb(),h.Tb(2,"form",2),h.ec("ngSubmit",(function(){return t.onSubmit()})),h.Tb(3,"vitamui-common-stepper",3),h.ec("selectionChange",(function(e){return t.stepIndex=e.selectedIndex})),h.Tb(4,"cdk-step"),h.Tb(5,"div",4),h.Tb(6,"div",5),h.Oc(7),h.jc(8,"translate"),h.Sb(),h.Ob(9,"app-profiles-form",6),h.Tb(10,"div",7),h.Tb(11,"button",8),h.Oc(12),h.jc(13,"translate"),h.Sb(),h.Tb(14,"button",9),h.ec("click",(function(){return t.onCancel()})),h.Oc(15),h.jc(16,"translate"),h.Sb(),h.Sb(),h.Sb(),h.Sb(),h.Sb(),h.Sb()),2&e&&(h.Bb(1),h.oc("index",t.stepIndex)("count",t.stepCount),h.Bb(1),h.oc("formGroup",t.form),h.Bb(5),h.Rc("",h.kc(8,9,"GROUP.PROFILE.MODAL.TITLE"),' "',null==t.data||null==t.data.group?null:t.data.group.name,'"'),h.Bb(2),h.oc("level",null==t.data||null==t.data.group?null:t.data.group.level),h.Bb(2),h.oc("disabled",t.form.pristine||t.form.invalid),h.Bb(1),h.Pc(h.kc(13,11,"COMMON.SUBMIT")),h.Bb(3),h.Pc(h.kc(16,13,"COMMON.UNDO")))},directives:[l.dc,u.y,u.r,u.i,l.mb,F.a,$.a,u.q,u.g],pipes:[G.d],styles:[""]}),e})();function te(e,t){if(1&e){const e=h.Ub();h.Tb(0,"button",2),h.ec("click",(function(){return h.Dc(e),h.ic().openEditProfilesDialog()})),h.Oc(1),h.jc(2,"translate"),h.Sb()}2&e&&(h.Bb(1),h.Qc(" ",h.kc(2,1,"COMMON.UPDATE"),"\n"))}function ie(e,t){if(1&e&&(h.Tb(0,"div",3),h.Tb(1,"div"),h.Tb(2,"div",4),h.Oc(3),h.jc(4,"translate"),h.Sb(),h.Tb(5,"div",5),h.Oc(6),h.jc(7,"titlecase"),h.Sb(),h.Sb(),h.Tb(8,"div"),h.Ob(9,"i",6),h.jc(10,"translate"),h.Sb(),h.Sb()),2&e){const e=t.$implicit;h.Bb(3),h.Pc(h.kc(4,4,"APPLICATION."+e.appId+".NAME")),h.Bb(3),h.Rc("",null==e?null:e.tenantName," : ",h.kc(7,6,null==e?null:e.profileName),""),h.Bb(3),h.oc("matTooltip",null!=e&&e.description?e.description:h.kc(10,8,"MISC.NO_DESC"))}}let ne=(()=>{class e{constructor(e,t){this.dialog=e,this.groupService=t}ngOnInit(){var e;this.initializeProfilesList(null===(e=this.group)||void 0===e?void 0:e.profiles),this.updatedGroup=this.groupService.updated.subscribe(e=>{var t;this.group=e,this.initializeProfilesList(null===(t=this.group)||void 0===t?void 0:t.profiles)})}initializeProfilesList(e){this.profilesDisplay=[],e&&(e.forEach(e=>this.profilesDisplay.push({id:e.id,appId:e.applicationName,tenantName:e.tenantName,profileName:e.name,description:e.description})),this.profilesDisplay.sort((e,t)=>e.appName>t.appName?1:t.appName>e.appName?-1:0))}openEditProfilesDialog(){this.dialog.open(ee,{data:{group:this.group},autoFocus:!1,disableClose:!0,panelClass:"vitamui-modal"})}ngOnDestroy(){this.updatedGroup.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(h.Nb(o.b),h.Nb(M.a))},e.\u0275cmp=h.Hb({type:e,selectors:[["app-profiles-tab"]],inputs:{group:"group",readOnly:"readOnly"},decls:2,vars:2,consts:[["class","btn primary mb-3",3,"click",4,"ngIf"],["class","d-flex justify-content-between align-items-center p-3 mb-2 vitamui-profile-list",4,"ngFor","ngForOf"],[1,"btn","primary","mb-3",3,"click"],[1,"d-flex","justify-content-between","align-items-center","p-3","mb-2","vitamui-profile-list"],[1,"text","caption","spaced","light","mb-1"],[1,"text","medium"],["matTooltipClass","vitamui-tooltip",1,"vitamui-icon","vitamui-icon-info","primary","clickable",3,"matTooltip"]],template:function(e,t){1&e&&(h.Mc(0,te,3,3,"button",0),h.Mc(1,ie,11,10,"div",1)),2&e&&(h.oc("ngIf",!t.readOnly),h.Bb(1),h.oc("ngForOf",t.profilesDisplay))},directives:[n.p,n.o,g.a],pipes:[G.d,n.y],styles:[""]}),e})(),re=(()=>{class e{constructor(e,t,i){this.groupService=e,this.authService=t,this.startupService=i,this.previewClose=new h.n}ngOnInit(){this.group&&this.groupService.get(this.group.id).subscribe(e=>{this.group=e,this.groupService.updated.next(e)}),this.groupUpdateSub=this.groupService.updated.subscribe(e=>{e&&(this.group=e)})}ngOnChanges(e){e.hasOwnProperty("group")&&this.group&&this.groupService.get(this.group.id).subscribe(e=>{this.group=e,this.groupService.updated.next(e)})}openPopup(){window.open(this.startupService.getConfigStringValue("UI_URL")+"/group/"+this.group.id,"detailPopup","width=584, height=713, resizable=no, location=no"),this.emitClose()}levelNotAllowed(){if(this.group)return!Object(l.Kb)(this.authService.user,this.group.level)}emitClose(){this.previewClose.emit()}ngOnDestroy(){this.groupUpdateSub.unsubscribe()}filterEvents(e){return e.outDetail&&(e.outDetail.includes("EXT_VITAMUI_CREATE_GROUP")||e.outDetail.includes("EXT_VITAMUI_UPDATE_GROUP"))}}return e.\u0275fac=function(t){return new(t||e)(h.Nb(M.a),h.Nb(l.k),h.Nb(l.lb))},e.\u0275cmp=h.Hb({type:e,selectors:[["app-group-preview"]],inputs:{isPopup:"isPopup",group:"group"},outputs:{previewClose:"previewClose"},features:[h.zb],decls:12,vars:19,consts:[[3,"title","icon","badge","onclose"],[1,"vitamui-sidepanel-body"],[1,"preview-tab-group"],[3,"label"],[3,"group","readOnly"],["collectionName","groups",3,"id","identifier","filter"]],template:function(e,t){1&e&&(h.Tb(0,"vitamui-common-sidenav-header",0),h.ec("onclose",(function(){return t.emitClose()})),h.Sb(),h.Tb(1,"div",1),h.Tb(2,"mat-tab-group",2),h.Tb(3,"mat-tab",3),h.jc(4,"translate"),h.Ob(5,"app-information-tab",4),h.Sb(),h.Tb(6,"mat-tab",3),h.jc(7,"translate"),h.Ob(8,"app-profiles-tab",4),h.Sb(),h.Tb(9,"mat-tab",3),h.jc(10,"translate"),h.Ob(11,"vitamui-common-operation-history-tab",5),h.Sb(),h.Sb(),h.Sb()),2&e&&(h.oc("title",null==t.group?null:t.group.name)("icon","vitamui-icon-keys")("badge",null!=t.group&&t.group.enabled?"green":"grey"),h.Bb(3),h.oc("label",h.kc(4,13,"GROUP.TAB.INFORMATIONS")),h.Bb(2),h.oc("group",t.group)("readOnly",t.isPopup||(null==t.group?null:t.group.readonly)||t.levelNotAllowed()),h.Bb(1),h.oc("label",h.kc(7,15,"GROUP.TAB.PROFILE")),h.Bb(2),h.oc("group",t.group)("readOnly",t.isPopup||(null==t.group?null:t.group.readonly)||t.levelNotAllowed()),h.Bb(1),h.oc("label",h.kc(10,17,"GROUP.TAB.HISTORY")),h.Bb(2),h.oc("id",null==t.group?null:t.group.id)("identifier",null==t.group?null:t.group.identifier)("filter",t.filterEvents))},directives:[l.mc,y.b,y.a,Z,ne,l.Xb],pipes:[G.d],styles:[""]}),e})(),oe=(()=>{class e{constructor(e){this.route=e,this.group=this.route.snapshot.data.group}ngOnInit(){}closePopup(){window.close()}}return e.\u0275fac=function(t){return new(t||e)(h.Nb(B.a))},e.\u0275cmp=h.Hb({type:e,selectors:[["app-group-popup"]],decls:1,vars:2,consts:[[3,"group","isPopup","previewClose"]],template:function(e,t){1&e&&(h.Tb(0,"app-group-preview",0),h.ec("previewClose",(function(){return t.closePopup()})),h.Sb()),2&e&&h.oc("group",t.group)("isPopup",!0)},directives:[re],encapsulation:2}),e})(),ce=(()=>{class e{constructor(e,t){this.groupService=e,this.router=t}resolve(e){const t=e.paramMap.get("id");return this.groupService.get(t).pipe(Object(w.a)(1),Object(k.a)(e=>e||(this.router.navigate(["/"]),null)))}}return e.\u0275fac=function(t){return new(t||e)(h.bc(M.a),h.bc(B.d))},e.\u0275prov=h.Jb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function ae(e,t){1&e&&(h.Tb(0,"span"),h.Oc(1),h.jc(2,"translate"),h.Sb()),2&e&&(h.Bb(1),h.Pc(h.kc(2,1,"GROUP.INFORMATIONS.INACTIVE_SWITCH")))}function le(e,t){1&e&&(h.Tb(0,"span"),h.Oc(1),h.jc(2,"translate"),h.Sb()),2&e&&(h.Bb(1),h.Pc(h.kc(2,1,"GROUP.INFORMATIONS.ACTIVE_SWITCH")))}function se(e,t){1&e&&(h.Tb(0,"vitamui-common-input-error"),h.Oc(1),h.jc(2,"translate"),h.Sb()),2&e&&(h.Bb(1),h.Pc(h.kc(2,1,"COMMON.ERROR.REQUIRED")))}function ue(e,t){1&e&&(h.Tb(0,"vitamui-common-input-error"),h.Oc(1),h.jc(2,"translate"),h.Sb()),2&e&&(h.Bb(1),h.Pc(h.kc(2,1,"GROUP.INFORMATIONS.MODAL.EXISTING_NAME")))}function be(e,t){if(1&e&&(h.Rb(0),h.Mc(1,se,3,3,"vitamui-common-input-error",7),h.Mc(2,ue,3,3,"vitamui-common-input-error",7),h.Qb()),2&e){const e=h.ic();var i,n=null;h.Bb(1),h.oc("ngIf",!(null==(i=e.form.get("name"))||null==i.errors||!i.errors.required)),h.Bb(1),h.oc("ngIf",!(null==e.form||null==(n=e.form.get("name"))||null==n.errors||!n.errors.nameExists))}}function de(e,t){1&e&&(h.Tb(0,"vitamui-common-input-error"),h.Oc(1),h.jc(2,"translate"),h.Sb()),2&e&&(h.Bb(1),h.Pc(h.kc(2,1,"COMMON.ERROR.REQUIRED")))}function pe(e,t){1&e&&(h.Tb(0,"vitamui-common-input-error"),h.Oc(1),h.jc(2,"translate"),h.Sb()),2&e&&(h.Bb(1),h.Pc(h.kc(2,1,"COMMON.ERROR.REQUIRED")))}function me(e,t){1&e&&(h.Tb(0,"vitamui-common-input-error"),h.Oc(1),h.jc(2,"translate"),h.Sb()),2&e&&(h.Bb(1),h.Qc("",h.kc(2,1,"GROUP.INFORMATIONS.MODAL.WRONG_FORMAT")," "))}function fe(e,t){if(1&e&&(h.Rb(0),h.Mc(1,pe,3,3,"vitamui-common-input-error",7),h.Mc(2,me,3,3,"vitamui-common-input-error",7),h.Qb()),2&e){const e=h.ic();var i=null,n=null;h.Bb(1),h.oc("ngIf",null==e.form||null==(i=e.form.get("level"))?null:i.hasError("required")),h.Bb(1),h.oc("ngIf",(null==e.form||null==(n=e.form.get("level"))?null:n.touched)&&(null==e.form||null==(n=e.form.get("level"))?null:n.hasError("pattern")))}}function ve(e,t){if(1&e&&(h.Tb(0,"div",28),h.Oc(1),h.jc(2,"translate"),h.Sb()),2&e){const e=h.ic();h.Bb(1),h.Rc(" ",h.kc(2,2,"GROUP.INFORMATIONS.LEVEL")," : ",e.form.get("level").value," ")}}const ge=function(e){return{"mb-0":e}};let he=(()=>{class e{constructor(e,t,i,n,r,o,c){this.dialogRef=e,this.data=t,this.authService=i,this.formBuilder=n,this.groupService=r,this.groupValidators=o,this.confirmDialogService=c,this.stepIndex=0,this.stepCount=3}ngOnInit(){this.form=this.formBuilder.group({name:[null,u.x.required,this.groupValidators.nameExists(this.authService.user.customerId)],enabled:[!0],level:["",Object(l.Gb)(this.authService.user)],description:[null,u.x.required],profileIds:[null,u.x.required],customerId:[this.authService.user.customerId],units:[null]}),this.keyPressSubscription=this.confirmDialogService.listenToEscapeKeyPress(this.dialogRef).subscribe(()=>this.onCancel())}ngOnDestroy(){this.keyPressSubscription.unsubscribe()}onCancel(){this.form.dirty?this.confirmDialogService.confirmBeforeClosing(this.dialogRef):this.dialogRef.close()}onSubmit(){this.form.invalid||this.groupService.create(this.form.getRawValue()).subscribe(()=>this.dialogRef.close(!0),e=>{console.error(e)})}firstStepInvalid(){return this.form.get("name").invalid||this.form.get("description").invalid||this.form.get("level").invalid}secondStepInvalid(){return this.form.get("profileIds").invalid}formValid(){return this.form.pending||this.form.invalid}}return e.\u0275fac=function(t){return new(t||e)(h.Nb(o.g),h.Nb(o.a),h.Nb(l.k),h.Nb(u.d),h.Nb(M.a),h.Nb(L),h.Nb(l.t))},e.\u0275cmp=h.Hb({type:e,selectors:[["app-group-create"]],decls:76,vars:62,consts:[[1,"header"],[3,"index","count"],[3,"formGroup","ngSubmit","keydown.enter"],[3,"selectionChange"],[1,"content"],[1,"text","large","bold"],["formControlName","enabled"],[4,"ngIf"],[1,"mt-3"],["formControlName","name","minlength","2","maxlength","100","required","",1,"col-5","p-0",3,"placeholder"],["formControlName","description","minlength","4","maxlength","100","required","",1,"col-10","p-0",3,"placeholder"],[1,"d-flex"],[1,"mr-4","p-2"],[1,"text","normal","light"],[1,"text","medium","bold"],[1,"col-3","p-0"],["formControlName","level",3,"prefix"],[1,"actions"],["type","button","cdkStepperNext","",1,"btn","primary",3,"disabled"],["type","button",1,"btn","cancel","link",3,"click"],[1,"text","large","bold",3,"ngClass"],["class","text medium bold mb-4",4,"ngIf"],["formControlName","profileIds",3,"level"],["type","button","cdkStepperPrevious","",1,"btn","link"],[1,"vitamui-icon","vitamui-icon-chevron-left"],[1,"underline"],["formControlName","units",3,"customer"],["type","submit",1,"btn","primary",3,"disabled"],[1,"text","medium","bold","mb-4"]],template:function(e,t){if(1&e&&(h.Tb(0,"div",0),h.Ob(1,"vitamui-common-progress-bar",1),h.Sb(),h.Tb(2,"form",2),h.ec("ngSubmit",(function(){return t.onSubmit()}))("keydown.enter",(function(e){return e.preventDefault()})),h.Tb(3,"vitamui-common-stepper",3),h.ec("selectionChange",(function(e){return t.stepIndex=e.selectedIndex})),h.Tb(4,"cdk-step"),h.Tb(5,"div",4),h.Tb(6,"div",5),h.Oc(7),h.jc(8,"translate"),h.Sb(),h.Tb(9,"vitamui-common-slide-toggle",6),h.Mc(10,ae,3,3,"span",7),h.Mc(11,le,3,3,"span",7),h.Sb(),h.Tb(12,"div",8),h.Tb(13,"vitamui-common-input",9),h.jc(14,"translate"),h.Mc(15,be,3,2,"ng-container",7),h.Sb(),h.Sb(),h.Tb(16,"div"),h.Tb(17,"vitamui-common-input",10),h.jc(18,"translate"),h.Mc(19,de,3,3,"vitamui-common-input-error",7),h.Sb(),h.Sb(),h.Tb(20,"div",11),h.Tb(21,"div",12),h.Tb(22,"div",13),h.Oc(23),h.jc(24,"translate"),h.Sb(),h.Tb(25,"div",14),h.Oc(26),h.Sb(),h.Sb(),h.Tb(27,"div",15),h.Tb(28,"vitamui-common-level-input",16),h.Mc(29,fe,3,2,"ng-container",7),h.Sb(),h.Sb(),h.Sb(),h.Tb(30,"div",17),h.Tb(31,"button",18),h.Oc(32),h.jc(33,"translate"),h.Sb(),h.Tb(34,"button",19),h.ec("click",(function(){return t.onCancel()})),h.Oc(35),h.jc(36,"translate"),h.Sb(),h.Sb(),h.Sb(),h.Sb(),h.Tb(37,"cdk-step"),h.Tb(38,"div",4),h.Tb(39,"div",20),h.Oc(40),h.jc(41,"translate"),h.Sb(),h.Mc(42,ve,3,4,"div",21),h.Ob(43,"app-profiles-form",22),h.Tb(44,"div",17),h.Tb(45,"button",18),h.Oc(46),h.jc(47,"translate"),h.Sb(),h.Tb(48,"button",19),h.ec("click",(function(){return t.onCancel()})),h.Oc(49),h.jc(50,"translate"),h.Sb(),h.Sb(),h.Tb(51,"button",23),h.Ob(52,"i",24),h.Rb(53),h.Tb(54,"span",25),h.Oc(55),h.jc(56,"translate"),h.Sb(),h.Qb(),h.Sb(),h.Sb(),h.Sb(),h.Tb(57,"cdk-step"),h.Tb(58,"div",4),h.Tb(59,"div",5),h.Oc(60),h.jc(61,"translate"),h.Sb(),h.Ob(62,"app-units-form",26),h.Tb(63,"div",17),h.Tb(64,"button",27),h.Oc(65),h.jc(66,"translate"),h.Sb(),h.Tb(67,"button",19),h.ec("click",(function(){return t.onCancel()})),h.Oc(68),h.jc(69,"translate"),h.Sb(),h.Sb(),h.Tb(70,"button",23),h.Ob(71,"i",24),h.Rb(72),h.Tb(73,"span",25),h.Oc(74),h.jc(75,"translate"),h.Sb(),h.Qb(),h.Sb(),h.Sb(),h.Sb(),h.Sb(),h.Sb()),2&e){var i,n,r=null;h.Bb(1),h.oc("index",t.stepIndex)("count",t.stepCount),h.Bb(1),h.oc("formGroup",t.form),h.Bb(5),h.Pc(h.kc(8,32,"GROUP.INFORMATIONS.MODAL.TITLE")),h.Bb(3),h.oc("ngIf",!(null!=t.form&&t.form.get("enabled").value)),h.Bb(1),h.oc("ngIf",null==t.form?null:t.form.get("enabled").value),h.Bb(2),h.oc("placeholder",h.kc(14,34,"GROUP.INFORMATIONS.NAME")),h.Bb(2),h.oc("ngIf",null==(i=t.form.get("name"))?null:i.touched),h.Bb(2),h.oc("placeholder",h.kc(18,36,"GROUP.INFORMATIONS.DESCRIPTION")),h.Bb(2),h.oc("ngIf",(null==(r=t.form.get("description"))?null:r.touched)&&(null==(r=t.form.get("description"))?null:r.hasError("required"))),h.Bb(4),h.Pc(h.kc(24,38,"GROUP.INFORMATIONS.LEVEL")),h.Bb(3),h.Pc(t.authService.user.level),h.Bb(2),h.oc("prefix",t.authService.user.level),h.Bb(1),h.oc("ngIf",null==(n=t.form.get("level"))?null:n.touched),h.Bb(2),h.oc("disabled",t.firstStepInvalid()),h.Bb(1),h.Pc(h.kc(33,40,"COMMON.NEXT")),h.Bb(3),h.Pc(h.kc(36,42,"COMMON.UNDO")),h.Bb(4),h.oc("ngClass",h.tc(60,ge,t.form.get("level").value)),h.Bb(1),h.Rc(" ",h.kc(41,44,"GROUP.INFORMATIONS.MODAL.PROVISIONNING_GROUP")," \u201c",t.form.get("name").value,"\u201d "),h.Bb(2),h.oc("ngIf",t.form.get("level").value),h.Bb(1),h.oc("level",t.form.get("level").value),h.Bb(2),h.oc("disabled",t.secondStepInvalid()),h.Bb(1),h.Pc(h.kc(47,46,"COMMON.NEXT")),h.Bb(3),h.Pc(h.kc(50,48,"COMMON.UNDO")),h.Bb(6),h.Pc(h.kc(56,50,"COMMON.BACK")),h.Bb(5),h.Pc(h.kc(61,52,"GROUP.INFORMATIONS.MODAL.UNITS_INFORMATION")),h.Bb(2),h.oc("customer",t.authService.user.customerId),h.Bb(2),h.oc("disabled",t.formValid()),h.Bb(1),h.Pc(h.kc(66,54,"COMMON.SUBMIT")),h.Bb(3),h.Pc(h.kc(69,56,"COMMON.UNDO")),h.Bb(6),h.Pc(h.kc(75,58,"COMMON.BACK"))}},directives:[l.dc,u.y,u.r,u.i,l.mb,F.a,l.ac,u.q,u.g,n.p,l.Qb,u.m,u.l,u.w,l.R,F.d,n.n,$.a,F.e,Q,l.Rb],pipes:[G.d],styles:[""],data:{animation:[l.Hb,l.Ob]}}),e})();var Oe=i("ZTXN");const Se={status:e=>{if(0===e.length)return[];const t=[];return e.forEach(e=>{switch(e){case"ENABLED":t.push(!0);break;case"DISABLED":t.push(!1)}}),[{key:"enabled",value:t,operator:l.W.in}]},level:e=>0===e.length?[]:(e.some(e=>null===e)&&e.push(""),[{key:"level",value:e,operator:l.W.in}])};function Te(e,t){if(1&e){const e=h.Ub();h.Tb(0,"vitamui-common-table-filter",22),h.ec("filterChange",(function(t){return h.Dc(e),h.ic().filterMap.status=t}))("filterChange",(function(t){return h.Dc(e),h.ic().onFilterChange("status",t)})),h.Tb(1,"vitamui-common-table-filter-option",23),h.Tb(2,"div",24),h.Tb(3,"span",25),h.Oc(4),h.jc(5,"translate"),h.Sb(),h.Sb(),h.Sb(),h.Tb(6,"vitamui-common-table-filter-option",26),h.Tb(7,"div",24),h.Tb(8,"span",25),h.Oc(9),h.jc(10,"translate"),h.Sb(),h.Sb(),h.Sb(),h.Sb()}if(2&e){const e=h.ic();h.oc("filter",e.filterMap.status),h.Bb(4),h.Pc(h.kc(5,3,"GROUP.HOME.RESULTS_TABLE.STATUS_FILTER.ACTIVE")),h.Bb(5),h.Pc(h.kc(10,5,"GROUP.HOME.RESULTS_TABLE.STATUS_FILTER.INACTIVE"))}}function Ce(e,t){if(1&e){const e=h.Ub();h.Tb(0,"vitamui-common-table-filter-search",27),h.ec("filterChange",(function(t){return h.Dc(e),h.ic().filterMap.level=t}))("filterChange",(function(t){return h.Dc(e),h.ic().onFilterChange("level",t)}))("filterClose",(function(){h.Dc(e),h.ic();const t=h.zc(28);return null==t?null:t.close()})),h.jc(1,"translate"),h.Sb()}if(2&e){const e=h.ic();h.oc("filter",e.filterMap.level)("options",e.levelFilterOptions)("emptyValueOption",h.kc(1,3,"GROUP.HOME.RESULTS_TABLE.EMPTY_LEVEL"))}}function Be(e,t){if(1&e){const e=h.Ub();h.Tb(0,"div",28),h.ec("click",(function(){h.Dc(e);const i=t.$implicit;return h.ic().groupClick.emit(i)})),h.Tb(1,"div",29),h.Tb(2,"div",3),h.Ob(3,"i",30),h.Sb(),h.Tb(4,"div",31),h.Oc(5),h.Sb(),h.Tb(6,"div",32),h.Oc(7),h.Sb(),h.Tb(8,"div",31),h.Oc(9),h.jc(10,"truncate"),h.Sb(),h.Tb(11,"div",32),h.Oc(12),h.Sb(),h.Sb(),h.Sb()}if(2&e){const e=t.$implicit;h.Bb(3),h.oc("ngClass",null!=e&&e.enabled?"status-badge-green":"status-badge-grey"),h.Bb(2),h.Pc(e.name),h.Bb(2),h.Pc(e.identifier),h.Bb(2),h.Pc(h.lc(10,5,e.description,50)),h.Bb(3),h.Pc(e.level)}}function Ie(e,t){1&e&&h.Ob(0,"div")}function ye(e,t){1&e&&h.Ob(0,"div")}function Ne(e,t){1&e&&h.Ob(0,"div")}function Me(e,t){1&e&&(h.Tb(0,"div",33),h.Oc(1),h.jc(2,"translate"),h.Sb()),2&e&&(h.Bb(1),h.Pc(h.kc(2,1,"COMMON.NO_RESULT")))}function Re(e,t){if(1&e){const e=h.Ub();h.Tb(0,"div",34),h.ec("click",(function(){return h.Dc(e),h.ic().groupService.loadMore()})),h.Tb(1,"span",35),h.Oc(2),h.jc(3,"translate"),h.Sb(),h.Sb()}2&e&&(h.Bb(2),h.Pc(h.kc(3,1,"COMMON.SHOW_MORE_RESULTS")))}function Pe(e,t){1&e&&(h.Tb(0,"div",36),h.Ob(1,"mat-spinner",37),h.Sb())}let Ee=(()=>{class e extends l.O{constructor(e,t){super(e),this.groupService=e,this.locale=t,this.groupClick=new h.n,this.searchKeys=["identifier","name","level","description","units"],this.filterMap={status:["ENABLED"],level:null},this.orderBy="name",this.direction=l.x.ASCENDANT,this.filterChange=new Oe.a,this.orderChange=new Oe.a,this.searchChange=new Oe.a,this.levelFilterOptions=[]}set searchText(e){this._search=e,this.searchChange.next(e)}ngOnInit(){this.search(),this.refreshLevelOptions(),this.updatedGroupSub=this.groupService.updated.subscribe(e=>{const t=this.dataSource.findIndex(t=>e.id===t.id);t>-1&&(this.dataSource[t]=e)}),Object(R.a)(this.searchChange,this.filterChange,this.orderChange).subscribe(()=>{const e={criteria:[...(t=this.filterMap,Object(l.Eb)(t,Se)),...Object(l.Fb)(this._search,this.searchKeys)]};var t;const i=new l.Z(0,l.w,this.orderBy,this.direction,JSON.stringify(e));this.search(i)})}onFilterChange(e,t){this.filterMap[e]=t,this.filterChange.next(this.filterMap)}emitOrderChange(){this.orderChange.next()}ngOnDestroy(){this.updatedGroupSub.unsubscribe()}refreshLevelOptions(e){this.groupService.getNonEmptyLevels(e).subscribe(e=>{var t;this.levelFilterOptions=e.map(e=>({value:e,label:e})),this.levelFilterOptions.sort((t=this.locale,(e,i)=>e.label.localeCompare(i.label,t)))})}}return e.\u0275fac=function(t){return new(t||e)(h.Nb(M.a),h.Nb(h.v))},e.\u0275cmp=h.Hb({type:e,selectors:[["app-group-list"]],inputs:{searchText:["search","searchText"]},outputs:{groupClick:"groupClick"},features:[h.yb],decls:48,vars:33,consts:[["vitamuiCommonInfiniteScroll","",3,"vitamuiScroll"],[1,"vitamui-table"],[1,"vitamui-table-head"],[1,"col-2","d-flex","align-items-center"],[1,"vitamui-filter-button",3,"vitamuiCommonTableFilter"],[1,"material-icons","vitamui-row-icon"],["statusFilterTemplate",""],[1,"vitamui-icon","vitamui-icon-keys","vitamui-row-icon"],["orderByKey","status",3,"orderBy","direction","orderByChange","directionChange","orderChange"],[1,"col-3","d-flex","align-items-center"],["orderByKey","name",3,"orderBy","direction","orderByChange","directionChange","orderChange"],["orderByKey","identifier",3,"orderBy","direction","orderByChange","directionChange","orderChange"],["orderByKey","description",3,"orderBy","direction","orderByChange","directionChange","orderChange"],["levelFilterTrigger","vitamuiCommonTableFilter"],["levelFilterTemplate",""],["orderByKey","level",3,"orderBy","direction","orderByChange","directionChange","orderChange"],[1,"vitamui-table-body"],["class","vitamui-table-rows",3,"click",4,"ngFor","ngForOf"],[4,"ngIf","ngIfThen"],["noResults",""],["loadMore",""],["loadingSpinner",""],[3,"filter","filterChange"],["value","ENABLED"],[1,"table-filter-icon"],[1,"badge-state"],["value","DISABLED"],[3,"filter","options","emptyValueOption","filterChange","filterClose"],[1,"vitamui-table-rows",3,"click"],[1,"vitamui-row","d-flex","align-items-center","clickable"],[1,"vitamui-icon","vitamui-icon-keys",3,"ngClass"],["vitamuiCommonEllipsis","",1,"col-3"],["vitamuiCommonEllipsis","",1,"col-2"],[1,"vitamui-min-content","vitamui-table-message"],[1,"vitamui-min-content","vitamui-table-message",3,"click"],[1,"clickable"],[1,"vitamui-min-content"],[1,"vitamui-spinner","medium"]],template:function(e,t){if(1&e&&(h.Tb(0,"div",0),h.ec("vitamuiScroll",(function(){return t.onScroll()})),h.Tb(1,"div",1),h.Tb(2,"div",2),h.Tb(3,"div",3),h.Tb(4,"button",4),h.Tb(5,"i",5),h.Oc(6,"filter_list"),h.Sb(),h.Sb(),h.Mc(7,Te,11,7,"ng-template",null,6,h.Nc),h.Ob(9,"i",7),h.Tb(10,"vitamui-common-order-by-button",8),h.ec("orderByChange",(function(e){return t.orderBy=e}))("directionChange",(function(e){return t.direction=e}))("orderChange",(function(){return t.emitOrderChange()})),h.Sb(),h.Sb(),h.Tb(11,"div",9),h.Tb(12,"span"),h.Oc(13),h.jc(14,"translate"),h.Sb(),h.Tb(15,"vitamui-common-order-by-button",10),h.ec("orderByChange",(function(e){return t.orderBy=e}))("directionChange",(function(e){return t.direction=e}))("orderChange",(function(){return t.emitOrderChange()})),h.Sb(),h.Sb(),h.Tb(16,"div",3),h.Tb(17,"span"),h.Oc(18),h.jc(19,"translate"),h.Sb(),h.Tb(20,"vitamui-common-order-by-button",11),h.ec("orderByChange",(function(e){return t.orderBy=e}))("directionChange",(function(e){return t.direction=e}))("orderChange",(function(){return t.emitOrderChange()})),h.Sb(),h.Sb(),h.Tb(21,"div",9),h.Tb(22,"span"),h.Oc(23),h.jc(24,"translate"),h.Sb(),h.Tb(25,"vitamui-common-order-by-button",12),h.ec("orderByChange",(function(e){return t.orderBy=e}))("directionChange",(function(e){return t.direction=e}))("orderChange",(function(){return t.emitOrderChange()})),h.Sb(),h.Sb(),h.Tb(26,"div",3),h.Tb(27,"button",4,13),h.Tb(29,"i",5),h.Oc(30,"filter_list"),h.Sb(),h.Sb(),h.Mc(31,Ce,2,5,"ng-template",null,14,h.Nc),h.Tb(33,"span"),h.Oc(34),h.jc(35,"translate"),h.Sb(),h.Tb(36,"vitamui-common-order-by-button",15),h.ec("orderByChange",(function(e){return t.orderBy=e}))("directionChange",(function(e){return t.direction=e}))("orderChange",(function(){return t.emitOrderChange()})),h.Sb(),h.Sb(),h.Sb(),h.Tb(37,"div",16),h.Mc(38,Be,13,8,"div",17),h.Sb(),h.Sb(),h.Mc(39,Ie,1,0,"div",18),h.Mc(40,ye,1,0,"div",18),h.Mc(41,Ne,1,0,"div",18),h.Sb(),h.Mc(42,Me,3,3,"ng-template",null,19,h.Nc),h.Mc(44,Re,4,3,"ng-template",null,20,h.Nc),h.Mc(46,Pe,2,0,"ng-template",null,21,h.Nc)),2&e){const e=h.zc(8),i=h.zc(32),n=h.zc(43),r=h.zc(45),o=h.zc(47);h.Bb(4),h.oc("vitamuiCommonTableFilter",e),h.Bb(6),h.oc("orderBy",t.orderBy)("direction",t.direction),h.Bb(3),h.Pc(h.kc(14,25,"GROUP.HOME.RESULTS_TABLE.NAME")),h.Bb(2),h.oc("orderBy",t.orderBy)("direction",t.direction),h.Bb(3),h.Pc(h.kc(19,27,"COMMON.ID")),h.Bb(2),h.oc("orderBy",t.orderBy)("direction",t.direction),h.Bb(3),h.Pc(h.kc(24,29,"GROUP.HOME.RESULTS_TABLE.DESCRIPTION")),h.Bb(2),h.oc("orderBy",t.orderBy)("direction",t.direction),h.Bb(2),h.Fb("active",t.filterMap.level&&t.filterMap.level.length>0),h.oc("vitamuiCommonTableFilter",i),h.Bb(7),h.Pc(h.kc(35,31,"GROUP.HOME.RESULTS_TABLE.LEVEL")),h.Bb(2),h.oc("orderBy",t.orderBy)("direction",t.direction),h.Bb(2),h.oc("ngForOf",t.dataSource),h.Bb(1),h.oc("ngIf",!t.dataSource||t.pending)("ngIfThen",o),h.Bb(1),h.oc("ngIf",!t.pending&&0===(null==t.dataSource?null:t.dataSource.length))("ngIfThen",n),h.Bb(1),h.oc("ngIf",t.infiniteScrollDisabled&&t.groupService.canLoadMore&&!t.pending)("ngIfThen",r)}},directives:[l.N,l.qb,l.X,n.o,n.p,l.pb,l.bc,l.sb,n.n,l.Zb,C.b],pipes:[G.d,l.qc],styles:[".vitamui-table-body[_ngcontent-%COMP%]   .vitamui-icon-keys[_ngcontent-%COMP%]{padding-left:2rem}"],data:{animation:[l.Hb,l.Ob]}}),e})();var ke=i("+9k3"),Ae=i("wgY5"),je=i.n(Ae);function Ue(e,t){if(1&e){const e=h.Ub();h.Tb(0,"app-group-preview",10),h.ec("previewClose",(function(){return h.Dc(e),h.ic().closePanel()})),h.Sb()}if(2&e){const e=h.ic();h.oc("group",e.openedItem)}}const xe=[{path:"",component:(()=>{class e extends l.kb{constructor(e,t,i,n,r,o){super(e,t),this.route=e,this.globalEventService=t,this.dialog=i,this.downloadSnackBarService=n,this.snackBarService=r,this.groupService=o,this.exportButtonDisabled=!1}openCreateGroupDialog(){this.dialog.open(he,{panelClass:"vitamui-modal",disableClose:!0}).afterClosed().subscribe(e=>{e&&this.refreshList()})}onSearchSubmit(e){this.search=e}refreshList(){this.groupListComponent&&this.groupListComponent.search()}exportProfilesAsExcel(){this.exportButtonDisabled=!0,this.downloadSnackBarService.openDownloadBar();let e=this.groupService.export().subscribe(e=>{const t=this.getFileName(e.headers.get("Content-Disposition"));l.z.loadFromBlob(e,e.body.type,t),this.downloadSnackBarService.close(),this.snackBarService.open({message:"SHARED.SNACKBAR.GROUP_EXPORT_SUCCESS"}),this.exportButtonDisabled=!1},()=>{this.downloadSnackBarService.close(),this.exportButtonDisabled=!1});this.downloadSnackBarService.cancelDownload.subscribe(()=>{this.exportButtonDisabled=!1,e.unsubscribe()})}getFileName(e){const t=null==e?void 0:e.match(/filename=(.+);?/);return(null==t?void 0:t.length)>1?t[1]:`lexport-groupes-${je()(Object(Ae.now)()).format("YYYY-MM-DDTHH_mm_ss")}.xlsx`}}return e.\u0275fac=function(t){return new(t||e)(h.Nb(B.a),h.Nb(l.M),h.Nb(o.b),h.Nb(ke.a),h.Nb(l.Ab),h.Nb(M.a))},e.\u0275cmp=h.Hb({type:e,selectors:[["app-group"]],viewQuery:function(e,t){var i;1&e&&h.Ic(Ee,!0),2&e&&h.yc(i=h.fc())&&(t.groupListComponent=i.first)},features:[h.yb],decls:21,vars:18,consts:[[3,"autosize","hasBackdrop"],["mode","side","position","end",3,"fixedInViewport"],["panel",""],[3,"group","previewClose",4,"ngIf"],[1,"vitamui-heading"],[3,"searchbarPlaceholder","search"],[1,"btn","primary","ml-5",3,"click"],[1,"btn","secondary","ml-3",3,"disabled","click"],[1,"vitamui-content"],[3,"search","groupClick"],[3,"group","previewClose"]],template:function(e,t){1&e&&(h.Tb(0,"mat-sidenav-container",0),h.Tb(1,"mat-sidenav",1,2),h.Mc(3,Ue,1,1,"app-group-preview",3),h.Sb(),h.Tb(4,"mat-sidenav-content"),h.Tb(5,"div",4),h.Tb(6,"vitamui-common-title-breadcrumb"),h.Oc(7),h.jc(8,"translate"),h.Sb(),h.Tb(9,"vitamui-common-banner",5),h.ec("search",(function(e){return t.onSearchSubmit(e)})),h.jc(10,"translate"),h.Tb(11,"button",6),h.ec("click",(function(){return t.openCreateGroupDialog()})),h.Tb(12,"span"),h.Oc(13),h.jc(14,"translate"),h.Sb(),h.Sb(),h.Tb(15,"button",7),h.ec("click",(function(){return t.exportProfilesAsExcel()})),h.Tb(16,"span"),h.Oc(17),h.jc(18,"translate"),h.Sb(),h.Sb(),h.Sb(),h.Sb(),h.Tb(19,"div",8),h.Tb(20,"app-group-list",9),h.ec("groupClick",(function(e){return t.openPanel(e)})),h.Sb(),h.Sb(),h.Sb(),h.Sb()),2&e&&(h.oc("autosize",!0)("hasBackdrop",!1),h.Bb(1),h.oc("fixedInViewport",!0),h.Bb(2),h.oc("ngIf",t.openedItem),h.Bb(4),h.Qc(" ",h.kc(8,10,"APPLICATION.GROUPS_APP.NAME")," "),h.Bb(2),h.oc("searchbarPlaceholder",h.kc(10,12,"GROUP.HOME.TITLE_PLACEHOLDER")),h.Bb(4),h.Pc(h.kc(14,14,"GROUP.HOME.ACTION_BUTTON")),h.Bb(2),h.oc("disabled",t.exportButtonDisabled),h.Bb(2),h.Pc(h.kc(18,16,"GROUP.HOME.EXPORT")),h.Bb(3),h.oc("search",t.search))},directives:[a.b,a.a,n.p,a.c,l.cc,l.jc,Ee,re],pipes:[G.d],styles:[""]}),e})(),pathMatch:"full"},{path:":id",component:oe,resolve:{group:ce},data:{isPopup:!0,appId:"GROUPS_APP"}}];let De=(()=>{class e{}return e.\u0275mod=h.Lb({type:e}),e.\u0275inj=h.Kb({factory:function(t){return new(t||e)},imports:[[n.c,B.g.forChild(xe)],B.g]}),e})(),we=(()=>{class e{}return e.\u0275mod=h.Lb({type:e}),e.\u0275inj=h.Kb({factory:function(t){return new(t||e)},imports:[[n.c,l.xb,s.a,S,I,N,o.f,c.b,r.d,a.d,De]]}),e})()}}]);