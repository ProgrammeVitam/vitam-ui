(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{"7UCR":function(e,t,i){"use strict";i.r(t),i.d(t,"UserModule",(function(){return Tt}));var r=i("2kYt"),n=i("nIj0"),o=i("OZ4H"),s=i("Jb3d"),a=i("lQ7A"),l=i("OWX3"),c=i("PCNd"),u=i("l7x+"),b=i("jdnZ"),m=i("29Wa"),d=i("Cd2c"),p=i("R7+U"),f=i("W1gw"),h=i("EM62");let S=(()=>{class e{}return e.\u0275mod=h.Lb({type:e}),e.\u0275inj=h.Kb({factory:function(t){return new(t||e)},imports:[[r.c,c.a,b.c,m.d,d.c,p.b,f.c,n.v,u.a,l.xb]]}),e})();var g=i("csyo"),v=i("sEIs");let O=(()=>{class e{}return e.\u0275mod=h.Lb({type:e}),e.\u0275inj=h.Kb({factory:function(t){return new(t||e)},imports:[[r.c,v.g,g.a,l.xb,c.a,p.b]]}),e})();var T=i("KZIX"),E=i("Y2X+");let I=(()=>{class e{}return e.\u0275mod=h.Lb({type:e}),e.\u0275inj=h.Kb({factory:function(t){return new(t||e)},imports:[[r.c,c.a,v.g,b.c,s.b,T.c,E.b,n.v,o.f,l.xb]]}),e})();var N=i("xVbo"),C=i("6Oco"),R=i("ZTXN"),A=i("8j5Y");let B=(()=>{class e extends l.jb{constructor(e,t){super({getAllPaginated:()=>C.a},""),this.userInfoServiceApi=e,this.snackBarService=t,this.userInfoUpdated=new R.a}create(e){return this.userInfoServiceApi.create(e)}get(e){return this.userInfoServiceApi.getOne(e)}getMyUserInfo(){return this.userInfoServiceApi.getMyUserInfo()}patch(e,t){return this.userInfoServiceApi.patch(e).pipe(Object(A.a)(e=>this.userInfoUpdated.next(e)),Object(A.a)(()=>{this.snackBarService.open({message:"SHARED.SNACKBAR.PROFILE_UPDATE",translateParams:{param1:t.firstname,param2:t.lastname},icon:"vitamui-icon-key"})},e=>{this.snackBarService.open({message:e.error.message,translate:!1})}))}}return e.\u0275fac=function(t){return new(t||e)(h.bc(l.p),h.bc(l.Ab))},e.\u0275prov=h.Jb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var M=i("vobO");let U=(()=>{class e extends l.o{constructor(e,t){super(e,t+"/users")}getAllByParams(e,t){return super.getAllByParams(e,t)}getAllPaginated(e,t,i){return super.getAllPaginated(e,t,i)}getOne(e,t){return super.getOne(e,t)}checkExistsByParam(e,t){return super.checkExistsByParam(e,t)}create(e,t){return super.create(e,t)}patch(e,t){return super.patch(e,t)}getLevels(e,t){let i=new M.g;return e&&(i=i.set("criteria",JSON.stringify(e))),this.http.get(this.apiUrl+"/levels",{params:i,headers:t})}export(){return this.http.get(this.apiUrl+"/export",{observe:"response",responseType:"blob"})}}return e.\u0275fac=function(t){return new(t||e)(h.bc(M.c),h.bc(l.n))},e.\u0275prov=h.Jb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var y=i("bWz1"),P=i("YtkY"),k=i("4Xmu");let D=(()=>{class e extends l.jb{constructor(e,t,i){super(e,""),this.userApi=e,this.snackBarService=t,this.rngProfileService=i,this.userUpdated=new R.a}create(e){return e.email=e.email,this.userApi.create(e).pipe(Object(A.a)(e=>{this.snackBarService.open({message:"SHARED.SNACKBAR.USER_CREATE",icon:"vitamui-icon-key",translateParams:{param1:e.firstname,param2:e.lastname}})}))}get(e){return this.userApi.getOne(e)}exists(e){const t=[];t.push({key:"email",value:e,operator:l.W.equalsIgnoreCase});const i=[{key:"criteria",value:JSON.stringify({criteria:t})}];return this.userApi.checkExistsByParam(i)}patch(e){return this.userApi.patch(e).pipe(Object(A.a)(e=>this.userUpdated.next(e)),Object(A.a)(e=>{this.snackBarService.open({message:"SHARED.SNACKBAR.USER_UPDATE",icon:"vitamui-icon-key",translateParams:{param1:e.firstname,param2:e.lastname}})}))}deleteUser(e){return this.userApi.patch(e).pipe(Object(A.a)(e=>this.userUpdated.next(e)),Object(A.a)(e=>{this.snackBarService.open({message:"SHARED.SNACKBAR.USER_DELETE",icon:"vitamui-icon-key",translateParams:{param1:e.firstname,param2:e.lastname}})}))}getUserProfileInfo(e){let t=null;return e.profileGroup.profiles.forEach(e=>{"USERS_APP"===e.applicationName&&(t=this.rngProfileService.convertToAdminUserProfile(e.roles))}),t}getLevelsNoEmpty(e){return this.userApi.getLevels(e).pipe(Object(P.a)(e=>e.filter(e=>!!e)))}export(){return this.userApi.export()}}return e.\u0275fac=function(t){return new(t||e)(h.bc(U),h.bc(l.Ab),h.bc(k.a))},e.\u0275prov=h.Jb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var _=i("g6G6"),j=i("ROBh"),L=i("mWib"),x=i("TLy2"),F=i("4e/d"),w=i("6WTZ"),G=i("8lHc"),V=i("J+dc");let H=(()=>{class e{constructor(e){this.userService=e,this.debounceTime=400,this.uniqueEmail=e=>t=>Object(G.a)(this.debounceTime).pipe(Object(x.a)(()=>t.value!==e?this.userService.exists(t.value):Object(j.a)(!1)),Object(V.a)(1),Object(P.a)(e=>e?{uniqueEmail:!0}:null))}}return e.\u0275fac=function(t){return new(t||e)(h.bc(D))},e.\u0275prov=h.Jb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Q=i("s2Ay");function z(e,t){1&e&&(h.Tb(0,"p"),h.Oc(1),h.jc(2,"translate"),h.Sb()),2&e&&(h.Bb(1),h.Pc(h.kc(2,1,"USER.INFORMATIONS.ACTIVE_SWITCH")))}function q(e,t){1&e&&(h.Tb(0,"p"),h.Oc(1),h.jc(2,"translate"),h.Sb()),2&e&&(h.Bb(1),h.Pc(h.kc(2,1,"USER.INFORMATIONS.INACTIVE_SWITCH")))}function K(e,t){if(1&e&&(h.Rb(0),h.Oc(1),h.jc(2,"translate"),h.jc(3,"dateTime"),h.Qb()),2&e){const e=h.ic(3);h.Bb(1),h.Rc("(",h.kc(2,2,"USER.INFORMATIONS.BLOCKED_ACCOUNT_SINCE")," ",h.lc(3,4,null==e.user?null:e.user.lastConnection,"medium"),") ")}}function Y(e,t){if(1&e&&(h.Tb(0,"p",40),h.Oc(1),h.jc(2,"translate"),h.Mc(3,K,4,7,"ng-container",1),h.Sb()),2&e){const e=h.ic(2);h.Bb(1),h.Qc(" ",h.kc(2,2,"USER.INFORMATIONS.BLOCKED_ACCOUNT")," "),h.Bb(2),h.oc("ngIf",null==e.user?null:e.user.lastConnection)}}function X(e,t){1&e&&(h.Tb(0,"p",40),h.Oc(1),h.jc(2,"translate"),h.Sb()),2&e&&(h.Bb(1),h.Qc(" ",h.kc(2,1,"USER.INFORMATIONS.ERASED_ACCOUNT")," "))}function $(e,t){if(1&e&&h.Ob(0,"vitamui-common-editable-option",41),2&e){const e=t.$implicit;h.oc("value",e.code)("content",e.name)}}function W(e,t){if(1&e&&(h.Tb(0,"form",2),h.Tb(1,"div",3),h.Tb(2,"div",4),h.Mc(3,z,3,3,"p",1),h.Mc(4,q,3,3,"p",1),h.Mc(5,Y,4,4,"p",5),h.Mc(6,X,3,3,"p",5),h.Sb(),h.Sb(),h.Tb(7,"div",3),h.Tb(8,"div",6),h.Ob(9,"vitamui-common-editable-input",7),h.jc(10,"translate"),h.Sb(),h.Sb(),h.Tb(11,"div",3),h.Tb(12,"div",8),h.Tb(13,"vitamui-common-editable-input",9),h.jc(14,"translate"),h.Tb(15,"vitamui-common-field-error",10),h.Oc(16),h.jc(17,"translate"),h.Sb(),h.Sb(),h.Sb(),h.Tb(18,"div",8),h.Tb(19,"vitamui-common-editable-input",11),h.jc(20,"translate"),h.Tb(21,"vitamui-common-field-error",10),h.Oc(22),h.jc(23,"translate"),h.Sb(),h.Sb(),h.Sb(),h.Sb(),h.Tb(24,"div",3),h.Tb(25,"div",12),h.Tb(26,"vitamui-common-editable-email-input",13),h.jc(27,"translate"),h.Tb(28,"vitamui-common-field-error",14),h.Oc(29),h.jc(30,"translate"),h.Sb(),h.Tb(31,"vitamui-common-field-error",15),h.Oc(32),h.jc(33,"translate"),h.Sb(),h.Sb(),h.Sb(),h.Sb(),h.Tb(34,"div",3),h.Tb(35,"div",8),h.Tb(36,"vitamui-common-editable-input",16),h.jc(37,"translate"),h.Tb(38,"vitamui-common-field-error",10),h.Oc(39),h.jc(40,"translate"),h.Sb(),h.Tb(41,"vitamui-common-field-error",17),h.Oc(42),h.jc(43,"translate"),h.Sb(),h.Sb(),h.Sb(),h.Tb(44,"div",8),h.Tb(45,"vitamui-common-editable-input",18),h.jc(46,"translate"),h.Tb(47,"vitamui-common-field-error",17),h.Oc(48),h.jc(49,"translate"),h.Sb(),h.Sb(),h.Sb(),h.Sb(),h.Rb(50,19),h.Tb(51,"div",3),h.Tb(52,"div",12),h.Tb(53,"vitamui-common-editable-input",20),h.jc(54,"translate"),h.Tb(55,"vitamui-common-field-error",10),h.Oc(56),h.jc(57,"translate"),h.Sb(),h.Sb(),h.Sb(),h.Sb(),h.Tb(58,"div",3),h.Tb(59,"div",8),h.Tb(60,"vitamui-common-editable-input",21),h.jc(61,"translate"),h.Tb(62,"vitamui-common-field-error",10),h.Oc(63),h.jc(64,"translate"),h.Sb(),h.Sb(),h.Sb(),h.Tb(65,"div",8),h.Tb(66,"vitamui-common-editable-input",22),h.jc(67,"translate"),h.Tb(68,"vitamui-common-field-error",10),h.Oc(69),h.jc(70,"translate"),h.Sb(),h.Sb(),h.Sb(),h.Sb(),h.Tb(71,"div",3),h.Tb(72,"div",12),h.Tb(73,"vitamui-common-editable-select",23),h.jc(74,"translate"),h.Mc(75,$,1,2,"vitamui-common-editable-option",24),h.Sb(),h.Sb(),h.Sb(),h.Qb(),h.Tb(76,"div",3),h.Tb(77,"div",25),h.Ob(78,"vitamui-common-editable-input",26),h.jc(79,"translate"),h.Sb(),h.Tb(80,"div",25),h.Ob(81,"vitamui-common-editable-input",27),h.jc(82,"translate"),h.Sb(),h.Sb(),h.Tb(83,"div",3),h.Tb(84,"div",25),h.Ob(85,"vitamui-common-editable-input",28),h.jc(86,"translate"),h.Sb(),h.Sb(),h.Tb(87,"div",3),h.Tb(88,"div",8),h.Tb(89,"form",2),h.Tb(90,"div"),h.Tb(91,"vitamui-common-editable-select",29),h.jc(92,"translate"),h.Ob(93,"vitamui-common-editable-option",30),h.jc(94,"translate"),h.Ob(95,"vitamui-common-editable-option",31),h.jc(96,"translate"),h.Sb(),h.Sb(),h.Sb(),h.Sb(),h.Tb(97,"div",8),h.Ob(98,"vitamui-common-editable-input",32),h.jc(99,"translate"),h.Sb(),h.Sb(),h.Tb(100,"div",3),h.Tb(101,"div",8),h.Tb(102,"vitamui-common-editable-select",33),h.jc(103,"translate"),h.Ob(104,"vitamui-common-editable-option",34),h.jc(105,"translate"),h.Ob(106,"vitamui-common-editable-option",35),h.jc(107,"translate"),h.Sb(),h.Sb(),h.Sb(),h.Tb(108,"div",3),h.Tb(109,"div",8),h.Tb(110,"vitamui-common-slide-toggle",36),h.Oc(111),h.jc(112,"translate"),h.Sb(),h.Sb(),h.Sb(),h.Tb(113,"div",3),h.Tb(114,"div",8),h.Tb(115,"vitamui-common-slide-toggle",37),h.Tb(116,"span",38),h.jc(117,"translate"),h.Oc(118),h.jc(119,"translate"),h.Sb(),h.Sb(),h.Sb(),h.Sb(),h.Tb(120,"div",3),h.Tb(121,"div",8),h.Tb(122,"vitamui-common-slide-toggle",39),h.Oc(123),h.jc(124,"translate"),h.Sb(),h.Sb(),h.Sb(),h.Sb()),2&e){const e=h.ic();var i=null,r=null,n=null,o=null,s=null,a=null,l=null,c=null,u=null,b=null,m=null,d=null,p=null,f=null,S=null,g=null;h.oc("formGroup",e.form),h.Bb(3),h.oc("ngIf","ENABLED"===(null==e.user?null:e.user.status)),h.Bb(1),h.oc("ngIf","DISABLED"===(null==e.user?null:e.user.status)),h.Bb(1),h.oc("ngIf","BLOCKED"===(null==e.user?null:e.user.status)),h.Bb(1),h.oc("ngIf","ANONYM"===(null==e.user?null:e.user.status)),h.Bb(3),h.oc("label",h.kc(10,61,"COMMON.ID"))("validator",null==e.form||null==(i=e.form.get("identifier"))?null:i.validator)("asyncValidator",null==e.form||null==(r=e.form.get("identifier"))?null:r.asyncValidator),h.Bb(4),h.oc("validator",null==e.form||null==(n=e.form.get("lastname"))?null:n.validator)("label",h.kc(14,63,"USER.INFORMATIONS.LASTNAME")),h.Bb(3),h.Pc(h.kc(17,65,"COMMON.ERROR.REQUIRED")),h.Bb(3),h.oc("validator",null==e.form||null==(o=e.form.get("firstname"))?null:o.validator)("label",h.kc(20,67,"USER.INFORMATIONS.FIRSTNAME")),h.Bb(3),h.Pc(h.kc(23,69,"COMMON.ERROR.REQUIRED")),h.Bb(4),h.oc("validator",null==e.form||null==(s=e.form.get("email"))?null:s.validator)("asyncValidator",null==e.form||null==(a=e.form.get("email"))?null:a.asyncValidator)("domains",e.customerEmailDomains)("label",h.kc(27,71,"USER.INFORMATIONS.MAIL")),h.Bb(3),h.Qc("",h.kc(30,73,"COMMON.ERROR.REQUIRED")," "),h.Bb(3),h.Qc(" ",h.kc(33,75,"USER.INFORMATIONS.MAIL_ALREADY_EXIST"),""),h.Bb(4),h.oc("validator",null==e.form||null==(l=e.form.get("mobile"))?null:l.validator)("label",h.kc(37,77,"USER.INFORMATIONS.PHONE.MOBILE")),h.Bb(3),h.Pc(h.kc(40,79,"COMMON.ERROR.REQUIRED")),h.Bb(3),h.Pc(h.kc(43,81,"USER.INFORMATIONS.PHONE_FIELD_FORMAT")),h.Bb(3),h.oc("validator",null==e.form||null==(c=e.form.get("phone"))?null:c.validator)("label",h.kc(46,83,"USER.INFORMATIONS.PHONE.FIX")),h.Bb(3),h.Pc(h.kc(49,85,"USER.INFORMATIONS.PHONE_FIELD_FORMAT")),h.Bb(5),h.pc("maxlength",e.maxStreetLength),h.oc("label",h.kc(54,87,"COMMON.ADRESS.STREET"))("validator",null==e.form||null==(u=e.form.get("address.street"))?null:u.validator)("asyncValidator",null==e.form||null==(b=e.form.get("address.street"))?null:b.asyncValidator),h.Bb(3),h.Pc(h.kc(57,89,"COMMON.ERROR.REQUIRED")),h.Bb(4),h.oc("label",h.kc(61,91,"COMMON.ADRESS.ZIPCODE"))("validator",null==e.form||null==(m=e.form.get("address.zipCode"))?null:m.validator)("asyncValidator",null==e.form||null==(d=e.form.get("address.zipCode"))?null:d.asyncValidator),h.Bb(3),h.Pc(h.kc(64,93,"COMMON.ERROR.REQUIRED")),h.Bb(3),h.oc("label",h.kc(67,95,"COMMON.ADRESS.CITY"))("validator",null==e.form||null==(p=e.form.get("address.city"))?null:p.validator)("asyncValidator",null==e.form||null==(f=e.form.get("address.city"))?null:f.asyncValidator),h.Bb(3),h.Pc(h.kc(70,97,"COMMON.ERROR.REQUIRED")),h.Bb(4),h.oc("label",h.kc(74,99,"COMMON.ADRESS.COUNTRY"))("validator",null==e.form||null==(S=e.form.get("address.country"))?null:S.validator)("asyncValidator",null==e.form||null==(g=e.form.get("address.country"))?null:g.asyncValidator),h.Bb(2),h.oc("ngForOf",e.countries),h.Bb(3),h.oc("label",h.kc(79,101,"USER.INFORMATIONS.CENTER_CODES")),h.Bb(3),h.oc("label",h.kc(82,103,"USER.INFORMATIONS.SITE_CODE")),h.Bb(4),h.oc("label",h.kc(86,105,"USER.INFORMATIONS.INTERNAL_CODE"))("maxlength",20),h.Bb(4),h.oc("formGroup",e.userInfoForm),h.Bb(2),h.oc("label",h.kc(92,107,"USER.INFORMATIONS.DEFAULT_LANGUAGE")),h.Bb(2),h.oc("content",h.kc(94,109,"COMMON.LANGUAGE.ENGLISH")),h.Bb(2),h.oc("content",h.kc(96,111,"COMMON.LANGUAGE.FRENCH")),h.Bb(3),h.oc("label",h.kc(99,113,"USER.INFORMATIONS.GROUP_LEVEL")),h.Bb(4),h.oc("label",h.kc(103,115,"USER.INFORMATIONS.TYPE")),h.Bb(2),h.oc("content",h.kc(105,117,"USER.INFORMATIONS.MODAL.INFORMATIONS_STEP.GROUP_TYPE_NOMINATIVE")),h.Bb(2),h.oc("content",h.kc(107,119,"USER.INFORMATIONS.MODAL.INFORMATIONS_STEP.GROUP_TYPE_GENERIC")),h.Bb(5),h.Qc(" ",h.kc(112,121,"USER.INFORMATIONS.ALLOW_SUBROGATION"),""),h.Bb(5),h.pc("vitamuiCommonToolTip",h.kc(117,123,"USER.INFORMATIONS.VALIDATIONS_TOOLTIP")),h.pc("vitamuiCommonToolTipDisabled",!e.showTooltip),h.Bb(2),h.Qc(" ",h.kc(119,125,"USER.INFORMATIONS.VALIDATIONS")," "),h.Bb(5),h.Qc(" ",h.kc(124,127,"USER.INFORMATIONS.ACTIVATE_AUTO_PROVISIONING"),"")}}function Z(e,t){1&e&&(h.Tb(0,"div"),h.Tb(1,"h2"),h.Oc(2,"ATTENTION"),h.Sb(),h.Oc(3," L'utilisateur que vous cherchez est d\xe9ja supprim\xe9\n"),h.Sb())}let J=(()=>{class e{constructor(e,t,i,r,o,s){this.userService=e,this.userInfoService=t,this.formBuilder=i,this.userCreateValidators=r,this.countryService=o,this.startupService=s,this.maxStreetLength=this.startupService.getConfigNumberValue("MAX_STREET_LENGTH"),this.form=this.formBuilder.group({id:[null],identifier:[{value:null,disabled:!0},n.x.required],firstname:[null,n.x.required],lastname:[null,n.x.required],email:[null,[n.x.required,n.x.email],this.userCreateValidators.uniqueEmail()],mobile:[null,[n.x.pattern(/^[+]{1}[0-9]{11,12}$/)]],phone:[null,[n.x.pattern(/^[+]{1}[0-9]{11,12}$/)]],level:[{value:"",disabled:!0}],otp:[null],type:[null],status:[null],customerId:[null],groupId:[null],subrogeable:!1,address:this.formBuilder.group({street:[null,[n.x.required,n.x.maxLength(this.maxStreetLength)]],zipCode:[null,n.x.required],city:[null,n.x.required],country:[null,n.x.required]}),siteCode:[null],centerCodes:[null],internalCode:[null],autoProvisioningEnabled:null}),this.userInfoForm=this.formBuilder.group({language:[null,n.x.required]})}ngOnInit(){this.form.get("mobile").valueChanges.subscribe(()=>{this.updateOtpState(this.form,this.adminUserProfile,this.customer)}),this.form.get("otp").valueChanges.subscribe(()=>{this.initMobileValidators(this.form)}),Object(_.a)(this.form.valueChanges,this.form.statusChanges).pipe(Object(L.a)(200),Object(P.a)(()=>Object(l.Ib)(this.form.getRawValue(),this.previousValue)),Object(N.a)(e=>!Object(w.c)(e)),Object(P.a)(e=>Object(w.a)({id:this.user.id},e)),Object(x.a)(e=>this.userService.patch(e).pipe(Object(F.a)(()=>Object(j.a)(null))))).subscribe(e=>{e&&this.resetForm(this.form,e,this.customer,this.adminUserProfile,this.readOnly)}),Object(_.a)(this.userInfoForm.valueChanges,this.userInfoForm.statusChanges).pipe(Object(L.a)(200),Object(P.a)(()=>Object(l.Ib)(this.userInfoForm.getRawValue(),this.previousUserInfoValue)),Object(N.a)(e=>!Object(w.c)(e)),Object(P.a)(e=>Object(w.a)({id:this.userInfo.id},e)),Object(x.a)(e=>this.userInfoService.patch(e,this.user).pipe(Object(F.a)(()=>Object(j.a)(null))))).subscribe(e=>this.resetUserInfoForm(this.form,e)),this.countryService.getAvailableCountries().subscribe(e=>{this.countries=e})}updateOtpState(e,t,i){this.canModifyOtp(t,i)&&(!e.get("mobile")||e.get("mobile").value&&""!==e.get("mobile").value?e.get("otp").disable&&(this.showTooltip=!1,e.get("otp").enable({emitEvent:!0})):(this.showTooltip=!0,e.get("otp").disable({emitEvent:!1})))}canModifyOtp(e,t){return e||!e.multifactorAllowed||t&&t.otp!==l.Y.OPTIONAL}ngOnChanges(e){(e.hasOwnProperty("user")||e.hasOwnProperty("readOnly")||e.hasOwnProperty("customer")||e.hasOwnProperty("adminUserProfile"))&&this.user&&this.customer&&this.adminUserProfile&&this.resetForm(this.form,this.user,this.customer,this.adminUserProfile,this.readOnly),e.hasOwnProperty("userInfo")&&this.userInfo&&this.resetUserInfoForm(this.userInfoForm,this.userInfo)}resetForm(e,t,i,r,n){e.reset(t,{emitEvent:!1}),this.previousValue=this.form.value,this.initFormValidators(e,t),this.initFormActivationState(e,i,r,n),e.updateValueAndValidity({emitEvent:!1})}resetUserInfoForm(e,t){t&&(e.reset(t,{emitEvent:!1}),this.previousUserInfoValue=this.userInfoForm.value,e.updateValueAndValidity({emitEvent:!1}))}initFormValidators(e,t){e.get("email").setAsyncValidators(this.userCreateValidators.uniqueEmail(t.email)),this.initMobileValidators(e)}initMobileValidators(e){const t=[n.x.pattern(/^[+]{1}[0-9]{11,12}$/)];e.get("otp").value&&t.push(n.x.required),e.get("mobile").setValidators(t)}initFormActivationState(e,t,i,r){this.customerEmailDomains=[],t.emailDomains.forEach(e=>this.customerEmailDomains.push(e.replace("*.",""))),!r&&i.standardAttrsAllowed?(e.enable({emitEvent:!1}),e.get("identifier").disable({emitEvent:!1}),e.get("level").disable({emitEvent:!1}),i.genericAllowed||e.get("type").disable({emitEvent:!1}),this.updateOtpState(e,i,t)):e.disable({emitEvent:!1})}}return e.\u0275fac=function(t){return new(t||e)(h.Nb(D),h.Nb(B),h.Nb(n.d),h.Nb(H),h.Nb(l.u),h.Nb(l.lb))},e.\u0275cmp=h.Hb({type:e,selectors:[["app-user-info-tab"]],inputs:{user:"user",userInfo:"userInfo",customer:"customer",readOnly:"readOnly",adminUserProfile:"adminUserProfile"},features:[h.zb],decls:2,vars:2,consts:[[3,"formGroup",4,"ngIf"],[4,"ngIf"],[3,"formGroup"],[1,"row"],[1,"col-10"],["class","status-warning",4,"ngIf"],[1,"col-8"],["formControlName","identifier",3,"label","validator","asyncValidator"],[1,"col-6"],["formControlName","lastname",3,"validator","label"],["errorKey","required"],["formControlName","firstname",3,"validator","label"],[1,"col-12"],["formControlName","email",3,"validator","asyncValidator","domains","label"],["errorKey","email"],["errorKey","uniqueEmail"],["formControlName","mobile",3,"validator","label"],["errorKey","pattern"],["formControlName","phone",3,"validator","label"],["formGroupName","address"],["formControlName","street",3,"maxlength","label","validator","asyncValidator"],["formControlName","zipCode","maxlength","10",3,"label","validator","asyncValidator"],["formControlName","city","maxlength","100",3,"label","validator","asyncValidator"],["formControlName","country",3,"label","validator","asyncValidator"],[3,"value","content",4,"ngFor","ngForOf"],[1,"col-6","form-control"],["formControlName","centerCodes",3,"label"],["formControlName","siteCode",3,"label"],["formControlName","internalCode",3,"label","maxlength"],["formControlName","language",3,"label"],["value","ENGLISH",3,"content"],["value","FRENCH",3,"content"],["formControlName","level",3,"label"],["formControlName","type",3,"label"],["value","NOMINATIVE",3,"content"],["value","GENERIC",3,"content"],["formControlName","subrogeable"],["formControlName","otp"],["vitamuiCommonToolTipPosition","TOP",3,"vitamuiCommonToolTip","vitamuiCommonToolTipDisabled"],["formControlName","autoProvisioningEnabled"],[1,"status-warning"],[3,"value","content"]],template:function(e,t){1&e&&(h.Mc(0,W,125,129,"form",0),h.Mc(1,Z,4,0,"div",1)),2&e&&(h.oc("ngIf","REMOVED"!==(null==t.user?null:t.user.status)),h.Bb(1),h.oc("ngIf","REMOVED"===(null==t.user?null:t.user.status)))},directives:[r.p,n.y,n.r,n.i,l.F,n.q,n.g,l.zb,l.C,n.j,n.l,l.I,r.o,l.H,l.ac,l.Ub],pipes:[Q.d,l.nc],styles:[".form-group[_ngcontent-%COMP%]{padding-bottom:30px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{padding-right:30px;font-size:16px;font-weight:500;font-style:normal;line-height:normal;letter-spacing:normal;text-align:left}.status-warning[_ngcontent-%COMP%]{color:#c10000}"]}),e})();function ee(e,t){if(1&e&&(h.Tb(0,"div",11),h.Tb(1,"div"),h.Tb(2,"div",12),h.Oc(3),h.jc(4,"titlecase"),h.Sb(),h.Sb(),h.Tb(5,"div"),h.Ob(6,"i",13),h.jc(7,"translate"),h.Sb(),h.Sb()),2&e){const e=t.$implicit;h.Bb(3),h.Pc(h.kc(4,2,null==e?null:e.name)),h.Bb(3),h.oc("matTooltip",null!=e&&e.description?e.description:h.kc(7,4,"MISC.NO_DESC"))}}let te=(()=>{class e{constructor(e){this.groupService=e}ngOnInit(){this.getGroupProfiles(this.group)}getGroupProfiles(e){e&&this.groupService.get(e.id).subscribe(e=>{this.groupProfiles=e.profiles})}}return e.\u0275fac=function(t){return new(t||e)(h.Nb(y.a))},e.\u0275cmp=h.Hb({type:e,selectors:[["app-group-detail"]],inputs:{group:"group"},decls:20,vars:12,consts:[[1,"vitamui-dialog-subtable"],[1,"vitamui-dialog-subtable-header","d-flex"],[1,"col-4"],[1,"col-3"],[1,"col-5"],[1,"vitamui-dialog-subtable-body"],[1,"vitamui-dialog-subtable-rows"],[1,"vitamui-dialog-subtable-row","d-flex"],["vitamuiCommonEllipsis","",1,"col-4"],["vitamuiCommonEllipsis","",1,"col-3"],["class","d-flex justify-content-between align-items-center py-1 px-2 mb-2 vitamui-profile-list",4,"ngFor","ngForOf"],[1,"d-flex","justify-content-between","align-items-center","py-1","px-2","mb-2","vitamui-profile-list"],[1,"profile-value"],["matTooltipClass","vitamui-tooltip",1,"vitamui-icon","vitamui-icon-info","primary","clickable",3,"matTooltip"]],template:function(e,t){1&e&&(h.Tb(0,"div",0),h.Tb(1,"div",1),h.Tb(2,"div",2),h.Oc(3),h.jc(4,"translate"),h.Sb(),h.Tb(5,"div",3),h.Oc(6),h.jc(7,"translate"),h.Sb(),h.Tb(8,"div",4),h.Oc(9),h.jc(10,"translate"),h.Sb(),h.Sb(),h.Tb(11,"div",5),h.Tb(12,"div",6),h.Tb(13,"div",7),h.Tb(14,"div",8),h.Oc(15),h.Sb(),h.Tb(16,"div",9),h.Oc(17),h.Sb(),h.Tb(18,"div",4),h.Mc(19,ee,8,6,"div",10),h.Sb(),h.Sb(),h.Sb(),h.Sb(),h.Sb()),2&e&&(h.Bb(3),h.Pc(h.kc(4,6,"USER.GROUP.DESCRIPTION")),h.Bb(3),h.Pc(h.kc(7,8,"USER.GROUP.LEVEL")),h.Bb(3),h.Pc(h.kc(10,10,"USER.GROUP.PROFILE")),h.Bb(6),h.Pc(null==t.group?null:t.group.description),h.Bb(2),h.Pc(null==t.group?null:t.group.level),h.Bb(2),h.oc("ngForOf",t.groupProfiles))},directives:[l.Zb,r.o,E.a],pipes:[Q.d,r.y],styles:[".vitamui-dialog-subtable[_ngcontent-%COMP%]   .vitamui-dialog-subtable-header[_ngcontent-%COMP%]{font-size:14px;font-weight:700;height:30px}.vitamui-dialog-subtable[_ngcontent-%COMP%]   .vitamui-dialog-subtable-rows[_ngcontent-%COMP%]   .vitamui-dialog-subtable-row[_ngcontent-%COMP%]{font-weight:400;font-size:16px;line-height:24px}"]}),e})();function ie(e,t){if(1&e&&(h.Tb(0,"div",9),h.Tb(1,"div",10),h.Oc(2),h.jc(3,"translate"),h.Sb(),h.Oc(4," \xa0"),h.Tb(5,"span",11),h.Oc(6),h.Sb(),h.Sb()),2&e){const e=h.ic();h.Bb(2),h.Qc("",h.kc(3,2,"USER.GROUP.MODAL.AUTORISATION_STEP.ATTRIBUATE_GROUP")," :"),h.Bb(4),h.Pc(e.groupName)}}function re(e,t){if(1&e&&h.Ob(0,"app-group-detail",19),2&e){const e=h.ic(2).$implicit;h.oc("group",e)("@collapseAnimation",void 0)}}function ne(e,t){if(1&e){const e=h.Ub();h.Tb(0,"div",13,14),h.Tb(2,"div",15),h.ec("click",(function(){h.Dc(e);const t=h.zc(1),i=h.ic().$implicit;return h.ic().updateGroup(null==i?null:i.id,null==i?null:i.name,t)})),h.Tb(3,"div",16),h.Oc(4),h.Sb(),h.Tb(5,"button",17),h.ec("click",(function(t){h.Dc(e);const i=h.zc(1);return t.stopPropagation(),i.toggle()})),h.Oc(6),h.jc(7,"translate"),h.jc(8,"translate"),h.Sb(),h.Sb(),h.Mc(9,re,1,2,"app-group-detail",18),h.Sb()}if(2&e){const e=h.zc(1),t=h.ic().$implicit;h.Fb("no-hover","expanded"===e.state),h.Bb(4),h.Pc(null==t?null:t.name),h.Bb(2),h.Qc(" ","collapsed"===e.state?h.kc(7,5,"USER.GROUP.MODAL.AUTORISATION_STEP.RESULTS_TABLE.MORE_DETAIL"):h.kc(8,7,"USER.GROUP.MODAL.AUTORISATION_STEP.RESULTS_TABLE.LESS_DETAIL")," "),h.Bb(3),h.oc("ngIf","expanded"===e.state)}}function oe(e,t){if(1&e&&(h.Rb(0),h.Mc(1,ne,10,9,"div",12),h.Qb()),2&e){const e=t.$implicit;h.Bb(1),h.oc("ngIf",!(null!=e&&e.selected))}}let se=(()=>{class e{constructor(e){this.data=e,this.groupProfiles=[],this.searchActiv=!1,this.selectedGroupEvent=new h.n,this.CUSTOMER_ACTIVE_PROFILE_GROUPS_INDEX=2}set userGroupName(e){this.groupName=e}ngOnInit(){this.initialGroups=this.groups.slice()}updateGroup(e,t){this.groupName=t,this.unselectAllGroups();const i=this.groups.find(t=>t.id===e);i.selected=!0,this.selectedGroupEvent.emit(i)}unselectAllGroups(){this.groups.forEach(e=>e.selected=!1)}findGroup(e){return this.groups.find(t=>t.id===e)}onSearch(e){this.resetgroups(),null!==e&&e.length>0&&(this.groups=this.groups.filter(t=>t.name.toLocaleLowerCase().includes(e.toLocaleLowerCase())||t.description.toLocaleLowerCase().includes(e.toLocaleLowerCase())))}resetgroups(){if(this.groups=this.data[this.CUSTOMER_ACTIVE_PROFILE_GROUPS_INDEX]?this.data[this.CUSTOMER_ACTIVE_PROFILE_GROUPS_INDEX]:this.initialGroups,this.groups.sort((e,t)=>e.name.toUpperCase()<t.name.toUpperCase()?-1:1),this.data[1]){const e=this.groups.find(e=>e.id===this.data[1].id);e&&(e.selected=!0)}}}return e.\u0275fac=function(t){return new(t||e)(h.Nb(o.a))},e.\u0275cmp=h.Hb({type:e,selectors:[["app-group-list"]],inputs:{groups:"groups",searchActiv:"searchActiv",userGroupName:"userGroupName"},outputs:{selectedGroupEvent:"selectedGroupEvent"},decls:14,vars:12,consts:[[1,"text","large","bold"],[1,"my-3",3,"placeholder","disabled","search"],["class","d-flex mt-4 mb-3",4,"ngIf"],[1,"vitamui-table"],[1,"vitamui-table-head","p-0","py-3","d-flex","align-items-center"],[1,"pl-4"],[1,"vitamui-table-body"],[1,"vitamui-table-rows"],[4,"ngFor","ngForOf"],[1,"d-flex","mt-4","mb-3"],[1,"text","medium","bold"],[1,"text","medium"],["class","vitamui-row p-0 px-4",3,"no-hover","vitamuiCommonCollapse",4,"ngIf"],[1,"vitamui-row","p-0","px-4",3,"vitamuiCommonCollapse"],["row","vitamuiCommonCollapse"],[1,"d-flex","justify-content-between","align-items-center","clickable",3,"click"],["vitamuiCommonEllipsis","",1,"align-items-center","w-100"],[1,"btn","link","underline",3,"click"],[3,"group",4,"ngIf"],[3,"group"]],template:function(e,t){1&e&&(h.Tb(0,"div",0),h.Oc(1),h.jc(2,"translate"),h.Sb(),h.Tb(3,"vitamui-common-search-bar",1),h.ec("search",(function(e){return t.onSearch(e)})),h.jc(4,"translate"),h.Sb(),h.Mc(5,ie,7,4,"div",2),h.Tb(6,"div",3),h.Tb(7,"div",4),h.Tb(8,"div",5),h.Oc(9),h.jc(10,"translate"),h.Sb(),h.Sb(),h.Tb(11,"div",6),h.Tb(12,"div",7),h.Mc(13,oe,2,1,"ng-container",8),h.Sb(),h.Sb(),h.Sb()),2&e&&(h.Bb(1),h.Pc(h.kc(2,6,"USER.GROUP.MODAL.AUTORISATION_STEP.TITLE")),h.Bb(2),h.oc("placeholder",h.kc(4,8,"USER.GROUP.MODAL.AUTORISATION_STEP.INPUT_PLACEHOLDER"))("disabled",t.searchActiv),h.Bb(2),h.oc("ngIf",t.groupName),h.Bb(4),h.Pc(h.kc(10,10,"USER.GROUP.MODAL.AUTORISATION_STEP.RESULTS_TABLE.GROUP_LABEL")),h.Bb(4),h.oc("ngForOf",t.groups))},directives:[l.hb,r.p,r.o,l.q,l.Zb,te],pipes:[Q.d],styles:[""],data:{animation:[l.Hb,l.Ob]}}),e})();const ae={provide:n.o,useExisting:Object(h.V)(()=>le),multi:!0};let le=(()=>{class e{constructor(e,t,i){this.userService=e,this.dialogRef=t,this.data=i,this.CUSTOMER_ACTIVE_PROFILE_GROUPS_INDEX=2,this.stepIndex=0,this.stepCount=1}profileGroupChange(e){this.user.groupId=e.id,this.selectedGroupName=e.name}ngOnInit(){this.user=this.data[0],this.userGroupName=this.data[1].name,this.resetActiveGroups()}resetActiveGroups(){if(this.activeGroups=this.data[this.CUSTOMER_ACTIVE_PROFILE_GROUPS_INDEX],this.activeGroups.sort((e,t)=>e.name.toUpperCase()<t.name.toUpperCase()?-1:1),this.data[1]){this.selectedGroupName=this.data[1].name;const e=this.activeGroups.find(e=>e.id===this.data[1].id);e&&(e.selected=!0)}}updateGroup(e){const t=e;this.selectedGroupName=t.name,this.user.groupId=t.id,this.user.level=t.level}saveUserUpdate(){this.userService.patch({id:this.user.id,groupId:this.user.groupId}).subscribe(()=>this.dialogRef.close(!0),e=>{console.error(e)})}onCancel(){this.dialogRef.close()}}return e.\u0275fac=function(t){return new(t||e)(h.Nb(D),h.Nb(o.g),h.Nb(o.a))},e.\u0275cmp=h.Hb({type:e,selectors:[["app-group-attribution"]],features:[h.Ab([ae])],decls:12,vars:11,consts:[[1,"header"],[3,"index","count"],[1,"mt-3","content"],[3,"groups","userGroupName","selectedGroupEvent"],[1,"actions"],["type","button",1,"btn","primary",3,"disabled","click"],["type","button",1,"btn","cancel","link",3,"click"]],template:function(e,t){1&e&&(h.Tb(0,"div",0),h.Ob(1,"vitamui-common-progress-bar",1),h.Sb(),h.Tb(2,"div",2),h.Tb(3,"div"),h.Tb(4,"app-group-list",3),h.ec("selectedGroupEvent",(function(e){return t.updateGroup(e)})),h.Sb(),h.Sb(),h.Tb(5,"div",4),h.Tb(6,"button",5),h.ec("click",(function(){return t.saveUserUpdate()})),h.Oc(7),h.jc(8,"translate"),h.Sb(),h.Tb(9,"button",6),h.ec("click",(function(){return t.onCancel()})),h.Oc(10),h.jc(11,"translate"),h.Sb(),h.Sb(),h.Sb()),2&e&&(h.Bb(1),h.oc("index",t.stepIndex)("count",t.stepCount),h.Bb(3),h.oc("groups",t.activeGroups)("userGroupName",t.userGroupName),h.Bb(2),h.oc("disabled",!t.selectedGroupName),h.Bb(1),h.Qc(" ",h.kc(8,7,"COMMON.UPDATE")," "),h.Bb(3),h.Pc(h.kc(11,9,"COMMON.UNDO")))},directives:[l.dc,se],pipes:[Q.d],styles:[""]}),e})();function ce(e,t){if(1&e){const e=h.Ub();h.Tb(0,"button",4),h.ec("click",(function(){return h.Dc(e),h.ic(2).openAttributionGroupe()})),h.Tb(1,"div"),h.Oc(2),h.jc(3,"translate"),h.Sb(),h.Sb()}if(2&e){const e=h.ic(2);h.oc("disabled","NONE"===e.userInfo.type),h.Bb(2),h.Qc(" ",h.kc(3,2,"COMMON.UPDATE")," ")}}function ue(e,t){if(1&e&&(h.Tb(0,"div"),h.Tb(1,"div",5),h.Tb(2,"p",6),h.Oc(3),h.jc(4,"translate"),h.Sb(),h.Tb(5,"p",7),h.Oc(6),h.Sb(),h.Sb(),h.Tb(7,"div",5),h.Tb(8,"p",6),h.Oc(9),h.jc(10,"translate"),h.Sb(),h.Tb(11,"p",7),h.Oc(12),h.Sb(),h.Sb(),h.Tb(13,"div",5),h.Tb(14,"p",6),h.Oc(15),h.jc(16,"translate"),h.Sb(),h.Tb(17,"p",7),h.Oc(18),h.Sb(),h.Sb(),h.Sb()),2&e){const e=h.ic(2);h.Bb(3),h.Pc(h.kc(4,6,"USER.GROUP.GROUP")),h.Bb(3),h.Pc(null==e.userGroup?null:e.userGroup.name),h.Bb(3),h.Pc(h.kc(10,8,"USER.GROUP.LEVEL")),h.Bb(3),h.Pc(null==e.userGroup?null:e.userGroup.level),h.Bb(3),h.Pc(h.kc(16,10,"USER.GROUP.DESCRIPTION")),h.Bb(3),h.Pc(null==e.userGroup?null:e.userGroup.description)}}function be(e,t){if(1&e&&(h.Tb(0,"div",8),h.Tb(1,"div"),h.Tb(2,"div",9),h.Oc(3),h.Sb(),h.Sb(),h.Tb(4,"div"),h.Ob(5,"i",10),h.jc(6,"translate"),h.Sb(),h.Sb()),2&e){const e=t.$implicit;h.Bb(3),h.Pc(null==e?null:e.name),h.Bb(2),h.oc("matTooltip",null!=e&&e.description?e.description:h.kc(6,2,"MISC.NO_DESC"))}}function me(e,t){if(1&e&&(h.Tb(0,"div"),h.Mc(1,ce,4,4,"button",1),h.Mc(2,ue,19,12,"div",0),h.Tb(3,"p",2),h.Oc(4),h.jc(5,"translate"),h.Sb(),h.Mc(6,be,7,4,"div",3),h.Sb()),2&e){const e=h.ic();h.Bb(1),h.oc("ngIf",e.showUpdateButton),h.Bb(1),h.oc("ngIf",e.userGroup),h.Bb(2),h.Pc(h.kc(5,4,"USER.GROUP.PROFILE")),h.Bb(2),h.oc("ngForOf",e.groupProfiles)}}function de(e,t){1&e&&(h.Tb(0,"div"),h.Tb(1,"h2"),h.Oc(2,"ATTENTION"),h.Sb(),h.Oc(3," L'utilisateur que vous cherchez est d\xe9ja supprim\xe9\n"),h.Sb())}let pe=(()=>{class e{constructor(e,t,i,r){this.groupAttrDialog=e,this.userService=t,this.groupService=i,this.authService=r,this.groupProfiles=[],this.destroy=new R.a}set user(e){this._user=e}get user(){return this._user}set readOnly(e){this.showUpdateButton=!e}get readOnly(){return this._readOnly}set userInfo(e){this._userInfo=e}get userInfo(){return this._userInfo}get groups(){return this._groups}set groups(e){this._groups=e}ngOnDestroy(){this.destroy.next()}ngOnInit(){}ngOnChanges(){this.getUserProfileDetail(),this.getGroupProfiles()}getGroupProfiles(){this.userGroup&&this.groupService.get(this.userGroup.id).subscribe(e=>{this.groupProfiles=e.profiles})}getUserProfileDetail(){this.activeGroups=this.groups.map(e=>Object({id:e.id,name:e.name,description:e.description,level:e.level,selected:!1,profiles:e.profiles})),Object(l.Lb)(this.authService.user)||(this.activeGroups=this.activeGroups.filter(e=>e.id!==this.authService.user.groupId)),this.user.groupId&&(this.userGroup=this.groups.find(e=>e.id===this.user.groupId))}getAttributableGroups(){return"LIST"===this.userInfo.type&&(this.activeGroups=[],this.userInfo.profilGroup.forEach(e=>{const t=this.groups.find(t=>t.id===e.id),i=Object({id:e.id,name:e.name,description:e.description,selected:!1,profiles:null==t?void 0:t.profiles});this.activeGroups.push(i)})),this.activeGroups}openAttributionGroupe(){this.activeGroups=this.getAttributableGroups(),this.groupAttrDialog.open(le,{panelClass:"vitamui-modal",disableClose:!0,data:[this.user,this.userGroup,this.activeGroups]}).afterClosed().subscribe(e=>{e&&this.refreshTab()})}refreshTab(){this.userService.get(this.user.id).subscribe(e=>this.user=e,e=>{console.error(e)})}}return e.\u0275fac=function(t){return new(t||e)(h.Nb(o.b),h.Nb(D),h.Nb(y.a),h.Nb(l.k))},e.\u0275cmp=h.Hb({type:e,selectors:[["app-user-group-tab"]],inputs:{user:"user",readOnly:"readOnly",userInfo:"userInfo",groups:"groups"},features:[h.zb],decls:2,vars:2,consts:[[4,"ngIf"],["class","btn primary mb-4",3,"disabled","click",4,"ngIf"],[1,"text","normal","spaced","light","mt-5"],["class","d-flex justify-content-between align-items-center p-3 mb-2 vitamui-profile-list",4,"ngFor","ngForOf"],[1,"btn","primary","mb-4",3,"disabled","click"],[1,"mb-3"],[1,"text","normal","spaced","light","mb-1"],[1,"text","medium","m-0"],[1,"d-flex","justify-content-between","align-items-center","p-3","mb-2","vitamui-profile-list"],[1,"text","medium"],["matTooltipClass","vitamui-tooltip",1,"vitamui-icon","vitamui-icon-info","primary","clickable",3,"matTooltip"]],template:function(e,t){1&e&&(h.Mc(0,me,7,6,"div",0),h.Mc(1,de,4,0,"div",0)),2&e&&(h.oc("ngIf","REMOVED"!==(null==t.user?null:t.user.status)),h.Bb(1),h.oc("ngIf","REMOVED"===(null==t.user?null:t.user.status)))},directives:[r.p,r.o,E.a],pipes:[Q.d],styles:[""]}),e})();const fe=["confirmDisabledUserDialog"],he=["confirmEnabledUserDialog"],Se=["confirmdeleteUserDialog"];function ge(e,t){if(1&e&&(h.Tb(0,"mat-tab",6),h.jc(1,"translate"),h.Ob(2,"vitamui-common-multi-operation-history-tab",14),h.Sb()),2&e){const e=h.ic();h.oc("label",h.kc(1,4,"USER.TAB.HISTORY")),h.Bb(2),h.oc("collectionsMap",e.collectionsMap)("identifiers",e.identifiers)("filter",e.filterAuthenticationEvents)}}const ve=function(e,t,i){return{param1:e,param2:t,param3:i}};function Oe(e,t){if(1&e&&(h.Tb(0,"mat-dialog-content"),h.Tb(1,"p"),h.Oc(2),h.jc(3,"translate"),h.Sb(),h.Sb(),h.Tb(4,"mat-dialog-actions"),h.Tb(5,"button",15),h.Oc(6),h.jc(7,"translate"),h.Sb(),h.Tb(8,"button",16),h.Oc(9),h.jc(10,"translate"),h.Sb(),h.Sb()),2&e){const e=h.ic();h.Bb(2),h.Qc(" ",h.lc(3,4,"USER.OTHER_ACTION.DESACTIVATE_MESSAGE",h.vc(11,ve,null==e.user?null:e.user.firstname,null==e.user?null:e.user.lastname,null==e.user?null:e.user.email))," "),h.Bb(3),h.oc("matDialogClose",!0),h.Bb(1),h.Pc(h.kc(7,7,"COMMON.CONFIRM")),h.Bb(3),h.Pc(h.kc(10,9,"COMMON.BACK"))}}function Te(e,t){if(1&e&&(h.Tb(0,"mat-dialog-content"),h.Tb(1,"p"),h.Oc(2),h.jc(3,"translate"),h.Sb(),h.Sb(),h.Tb(4,"mat-dialog-actions"),h.Tb(5,"button",15),h.Oc(6),h.jc(7,"translate"),h.Sb(),h.Tb(8,"button",16),h.Oc(9),h.jc(10,"translate"),h.Sb(),h.Sb()),2&e){const e=h.ic();h.Bb(2),h.Qc(" ",h.lc(3,4,"USER.OTHER_ACTION.REACTIVATE_MESSAGE",h.vc(11,ve,null==e.user?null:e.user.firstname,null==e.user?null:e.user.lastname,null==e.user?null:e.user.email))," "),h.Bb(3),h.oc("matDialogClose",!0),h.Bb(1),h.Pc(h.kc(7,7,"COMMON.CONFIRM")),h.Bb(3),h.Pc(h.kc(10,9,"COMMON.BACK"))}}function Ee(e,t){if(1&e&&(h.Tb(0,"mat-dialog-content"),h.Tb(1,"p"),h.Xb(2,17),h.Sb(),h.Sb(),h.Tb(3,"mat-dialog-actions"),h.Tb(4,"button",15),h.Oc(5),h.jc(6,"translate"),h.Sb(),h.Tb(7,"button",16),h.Oc(8),h.jc(9,"translate"),h.Sb(),h.Sb()),2&e){const e=h.ic();h.Bb(2),h.ac(null==e.user?null:e.user.firstname)(null==e.user?null:e.user.lastname),h.Yb(2),h.Bb(2),h.oc("matDialogClose",!0),h.Bb(1),h.Pc(h.kc(6,5,"COMMON.CONFIRM")),h.Bb(3),h.Pc(h.kc(9,7,"COMMON.BACK"))}}let Ie=(()=>{class e{constructor(e,t,i,r,n,o,s){this.matDialog=e,this.userService=t,this.authService=i,this.userApi=r,this.startupService=n,this.groupService=o,this.userInfoService=s,this.previewClose=new h.n}get user(){return this._user}set user(e){this._user=e,this.collectionsMap=new Map;const t=new Map,i=[];this._user&&(t.set(this._user.id,"users"),i.push(this._user.identifier),this._user.userInfoId?this.userInfoService.get(this._user.userInfoId).subscribe(e=>{this.userInfo=e,i.push(this.userInfo.identifier),t.set(this.userInfo.id,"userinfos"),this.collectionsMap=t,this.identifiers=i}):(this.collectionsMap=t,this.identifiers=i))}get groups(){return this._groups}set groups(e){this._groups=e}get isVitamEnabled(){return this.startupService.isVitamEnabled()}ngOnInit(){this.connectedUserInfo=this.userService.getUserProfileInfo(this.authService.user),this.userUpdatedSub=this.userService.userUpdated.subscribe(e=>{this.user=e})}ngOnDestroy(){this.userUpdatedSub.unsubscribe()}openPopup(){window.open(this.startupService.getConfigStringValue("UI_URL")+"/user/"+this.user.id,"detailPopup","width=584, height=713, resizable=no, location=no"),this.emitClose()}updateStatus(e){let t;"ENABLED"===e?t=this.confirmEnabledUserDialog:"DISABLED"===e&&(t=this.confirmDisabledUserDialog),this.matDialog.open(t,{panelClass:"vitamui-dialog"}).afterClosed().pipe(Object(N.a)(e=>!!e)).subscribe(()=>{this.userService.patch({id:this.user.id,status:e}).subscribe(e=>{this.user=e})})}levelNotAllowed(){if(this.user)return!Object(l.Kb)(this.authService.user,this.user.level)}emitClose(){this.previewClose.emit()}filterAuthenticationEvents(e){return e.outDetail&&(e.outDetail.includes("EXT_VITAMUI_CREATE_USER")||e.outDetail.includes("EXT_VITAMUI_UPDATE_USER")||e.outDetail.includes("EXT_VITAMUI_BLOCK_USER")||e.outDetail.includes("EXT_VITAMUI_PASSWORD_REVOCATION")||e.outDetail.includes("EXT_VITAMUI_PASSWORD_INIT")||e.outDetail.includes("EXT_VITAMUI_PASSWORD_CHANGE")||e.outDetail.includes("EXT_VITAMUI_CREATE_USER_INFO")||e.outDetail.includes("EXT_VITAMUI_UPDATE_USER_INFO"))}deleteUser(e,t){const i=e.email.split("@"),r="anonyme-"+e.identifier+"@"+i[1],n={street:"",zipCode:"",city:"",country:""};let o;o=this.confirmdeleteUserDialog,this.matDialog.open(o,{panelClass:"vitamui-dialog"}).afterClosed().pipe(Object(N.a)(e=>!!e)).subscribe(()=>{this.userService.deleteUser({id:this.user.id,lastname:"",email:r,address:n,mobile:null,phone:null,status:t,groupId:"",firstname:"",siteCode:"",internalCode:""}).subscribe(e=>{this.user=e,this.emitClose()})})}}return e.\u0275fac=function(t){return new(t||e)(h.Nb(o.b),h.Nb(D),h.Nb(l.k),h.Nb(U),h.Nb(l.lb),h.Nb(y.a),h.Nb(B))},e.\u0275cmp=h.Hb({type:e,selectors:[["app-user-preview"]],viewQuery:function(e,t){var i;1&e&&(h.Ic(fe,!0),h.Ic(he,!0),h.Ic(Se,!0)),2&e&&(h.yc(i=h.fc())&&(t.confirmDisabledUserDialog=i.first),h.yc(i=h.fc())&&(t.confirmEnabledUserDialog=i.first),h.yc(i=h.fc())&&(t.confirmdeleteUserDialog=i.first))},inputs:{isPopup:"isPopup",user:"user",customer:"customer",groups:"groups"},outputs:{previewClose:"previewClose"},decls:25,vars:31,consts:function(){return[[3,"badge","title","subtitle","icon","onclose"],[3,"overlayPos","icon"],["mat-menu-item","",3,"disabled","click"],$localize`:@@userPreviewDeleted␟26a9cb8525f6413a0cdcda727d9ac45d98dd95db␟2552240154184994944: Supprimer les données personnelles `,[1,"vitamui-sidepanel-body"],[1,"preview-tab-group"],[3,"label"],[3,"user","customer","readOnly","adminUserProfile","userInfo"],[1,"no-padding",3,"label"],[3,"user","readOnly","userInfo","groups"],[3,"label",4,"ngIf"],["confirmDisabledUserDialog",""],["confirmEnabledUserDialog",""],["confirmdeleteUserDialog",""],[3,"collectionsMap","identifiers","filter"],[1,"btn","primary","mr-2",3,"matDialogClose"],["matDialogClose","",1,"btn","link","cancel"],$localize`:@@disabledUserConfirm␟4c67edc882053d5ade00fee4c9fa9828e1a92e99␟2953856490548959546: Vous allez procéder à l'effacement des données personnelles de l'utilisateur ${"\ufffd0\ufffd"}:INTERPOLATION: ${"\ufffd1\ufffd"}:INTERPOLATION_1:. Cette action ne peut pas être annulée, voulez-vous confirmer ? `]},template:function(e,t){1&e&&(h.Tb(0,"vitamui-common-sidenav-header",0),h.ec("onclose",(function(){return t.emitClose()})),h.Tb(1,"vitamui-common-menu-button",1),h.Tb(2,"button",2),h.ec("click",(function(){return t.updateStatus("ENABLED")})),h.Oc(3),h.jc(4,"translate"),h.Sb(),h.Tb(5,"button",2),h.ec("click",(function(){return t.updateStatus("DISABLED")})),h.Oc(6),h.jc(7,"translate"),h.Sb(),h.Tb(8,"button",2),h.ec("click",(function(){return t.deleteUser(t.user,"REMOVED")})),h.Xb(9,3),h.Sb(),h.Sb(),h.Sb(),h.Tb(10,"div",4),h.Tb(11,"mat-tab-group",5),h.Tb(12,"mat-tab",6),h.jc(13,"translate"),h.Ob(14,"app-user-info-tab",7),h.Sb(),h.Tb(15,"mat-tab",8),h.jc(16,"translate"),h.Ob(17,"app-user-group-tab",9),h.Sb(),h.Mc(18,ge,3,6,"mat-tab",10),h.Sb(),h.Sb(),h.Mc(19,Oe,11,15,"ng-template",null,11,h.Nc),h.Mc(21,Te,11,15,"ng-template",null,12,h.Nc),h.Mc(23,Ee,10,9,"ng-template",null,13,h.Nc)),2&e&&(h.oc("badge","ENABLED"===(null==t.user?null:t.user.status)?"green":"DISABLED"===(null==t.user?null:t.user.status)||"ANONYM"===(null==t.user?null:t.user.status)?"grey":"orange")("title",(null==t.user?null:t.user.lastname.toUpperCase())+" "+(null==t.user?null:t.user.firstname))("subtitle","("+(null==t.user?null:t.user.identifier)+")")("icon","vitamui-icon-user"),h.Bb(1),h.oc("overlayPos","end")("icon","vitamui-icon-more-horiz"),h.Bb(1),h.oc("disabled","ENABLED"===(null==t.user?null:t.user.status)),h.Bb(1),h.Qc(" ",h.kc(4,23,"USER.OTHER_ACTION.ACTIVATE")," "),h.Bb(2),h.oc("disabled","DISABLED"===(null==t.user?null:t.user.status)),h.Bb(1),h.Qc(" ",h.kc(7,25,"USER.OTHER_ACTION.DESACTIVATE")," "),h.Bb(2),h.oc("disabled","ENABLED"===(null==t.user?null:t.user.status)||"REMOVED"===(null==t.user?null:t.user.status)||"BLOCKED"===(null==t.user?null:t.user.status)||"ANONYM"===(null==t.user?null:t.user.status)),h.Bb(4),h.oc("label",h.kc(13,27,"USER.TAB.INFORMATIONS")),h.Bb(2),h.oc("user",t.user)("customer",t.customer)("readOnly",t.isPopup||(null==t.user?null:t.user.readonly)||t.levelNotAllowed())("adminUserProfile",t.connectedUserInfo)("userInfo",t.userInfo),h.Bb(1),h.oc("label",h.kc(16,29,"USER.TAB.GROUP")),h.Bb(2),h.oc("user",t.user)("readOnly",t.isPopup||(null==t.user?null:t.user.readonly)||t.levelNotAllowed())("userInfo",t.connectedUserInfo)("groups",t.groups),h.Bb(1),h.oc("ngIf",t.isVitamEnabled))},directives:[l.mc,l.Tb,s.a,T.b,T.a,J,pe,r.p,l.Yb,o.e,o.c,o.d],pipes:[Q.d],styles:[""]}),e})();var Ne=i("O4oY");let Ce=(()=>{class e{constructor(e,t){this.route=e,this.customerService=t,this.customerService.getMyCustomer().subscribe(e=>this.customer=e),this.user=this.route.snapshot.data.user}ngOnInit(){}closePopup(){window.close()}}return e.\u0275fac=function(t){return new(t||e)(h.Nb(v.a),h.Nb(Ne.a))},e.\u0275cmp=h.Hb({type:e,selectors:[["app-profile-group-popup"]],decls:1,vars:3,consts:[[3,"user","customer","isPopup","previewClose"]],template:function(e,t){1&e&&(h.Tb(0,"app-user-preview",0),h.ec("previewClose",(function(){return t.closePopup()})),h.Sb()),2&e&&h.oc("user",t.user)("customer",t.customer)("isPopup",!0)},directives:[Ie],encapsulation:2}),e})(),Re=(()=>{class e{constructor(e,t){this.userService=e,this.router=t}resolve(e){const t=e.paramMap.get("id");return this.userService.get(t).pipe(Object(V.a)(1),Object(P.a)(e=>e||(this.router.navigate(["/"]),null)))}}return e.\u0275fac=function(t){return new(t||e)(h.bc(D),h.bc(v.d))},e.\u0275prov=h.Jb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Ae=i("+9k3"),Be=i("Ohay");class Me{static missingPhoneNumber(e){return e&&e.get("otp").value&&!e.get("mobile").value?{missingPhoneNumber:!0}:null}}var Ue=i("IrDo"),ye=i("mFH5");function Pe(e,t){1&e&&(h.Tb(0,"span"),h.Oc(1),h.jc(2,"translate"),h.Sb()),2&e&&(h.Bb(1),h.Pc(h.kc(2,1,"USER.INFORMATIONS.INACTIVE_SWITCH")))}function ke(e,t){1&e&&(h.Tb(0,"span"),h.Oc(1),h.jc(2,"translate"),h.Sb()),2&e&&(h.Bb(1),h.Pc(h.kc(2,1,"USER.INFORMATIONS.ACTIVE_SWITCH")))}function De(e,t){1&e&&(h.Tb(0,"vitamui-common-input-error"),h.Oc(1),h.jc(2,"translate"),h.Sb()),2&e&&(h.Bb(1),h.Qc(" ",h.kc(2,1,"COMMON.ERROR.REQUIRED"),""))}function _e(e,t){1&e&&(h.Tb(0,"vitamui-common-input-error"),h.Oc(1),h.jc(2,"translate"),h.Sb()),2&e&&(h.Bb(1),h.Pc(h.kc(2,1,"COMMON.ERROR.REQUIRED")))}function je(e,t){1&e&&(h.Tb(0,"vitamui-common-input-error"),h.Oc(1),h.jc(2,"translate"),h.Sb()),2&e&&(h.Bb(1),h.Pc(h.kc(2,1,"COMMON.ERROR.REQUIRED")))}function Le(e,t){1&e&&(h.Tb(0,"vitamui-common-input-error"),h.Oc(1),h.jc(2,"translate"),h.Sb()),2&e&&(h.Bb(1),h.Qc("",h.kc(2,1,"USER.INFORMATIONS.MODAL.INFORMATIONS_STEP.WRONG_FORMAT")," "))}function xe(e,t){1&e&&(h.Tb(0,"vitamui-common-input-error"),h.Oc(1),h.jc(2,"translate"),h.Sb()),2&e&&(h.Bb(1),h.Pc(h.kc(2,1,"USER.INFORMATIONS.MODAL.INFORMATIONS_STEP.MAIL_ALREADY_EXIST")))}function Fe(e,t){if(1&e&&(h.Rb(0),h.Mc(1,je,3,3,"vitamui-common-input-error",8),h.Mc(2,Le,3,3,"vitamui-common-input-error",8),h.Mc(3,xe,3,3,"vitamui-common-input-error",8),h.Qb()),2&e){const e=h.ic();var i=null,r=null,n=null;h.Bb(1),h.oc("ngIf",null==e.form||null==(i=e.form.get("email"))?null:i.hasError("required")),h.Bb(1),h.oc("ngIf",null==e.form||null==(r=e.form.get("email"))?null:r.hasError("pattern")),h.Bb(1),h.oc("ngIf",null==e.form||null==(n=e.form.get("email"))?null:n.hasError("uniqueEmail"))}}function we(e,t){if(1&e&&(h.Tb(0,"mat-option",56),h.Oc(1),h.Sb()),2&e){const e=t.$implicit;h.pc("value",e),h.Bb(1),h.Qc(" ",e," ")}}function Ge(e,t){if(1&e&&(h.Tb(0,"button",36),h.Oc(1),h.jc(2,"translate"),h.Sb()),2&e){const e=h.ic();h.oc("disabled",e.firstStepInvalid()),h.Bb(1),h.Qc(" ",h.kc(2,2,"COMMON.NEXT")," ")}}function Ve(e,t){if(1&e){const e=h.Ub();h.Tb(0,"button",57),h.ec("click",(function(){return h.Dc(e),h.ic().passGroupStep()})),h.Oc(1),h.jc(2,"translate"),h.Sb()}if(2&e){const e=h.ic();h.oc("disabled",e.firstStepInvalid()),h.Bb(1),h.Qc(" ",h.kc(2,2,"USER.INFORMATIONS.MODAL.INFORMATIONS_STEP.CONTINUE_AUTH")," ")}}function He(e,t){1&e&&(h.Tb(0,"vitamui-common-input-error"),h.Oc(1),h.jc(2,"translate"),h.Sb()),2&e&&(h.Bb(1),h.Pc(h.kc(2,1,"COMMON.ERROR.REQUIRED")))}function Qe(e,t){1&e&&(h.Tb(0,"vitamui-common-input-error"),h.Oc(1),h.jc(2,"translate"),h.Sb()),2&e&&(h.Bb(1),h.Pc(h.kc(2,1,"COMMON.ERROR.REQUIRED")))}function ze(e,t){1&e&&(h.Tb(0,"vitamui-common-input-error"),h.Oc(1),h.jc(2,"translate"),h.Sb()),2&e&&(h.Bb(1),h.Pc(h.kc(2,1,"COMMON.ERROR.REQUIRED")))}function qe(e,t){if(1&e&&(h.Tb(0,"mat-option",56),h.Oc(1),h.Sb()),2&e){const e=t.$implicit;h.oc("value",e.code),h.Bb(1),h.Qc(" ",e.name," ")}}function Ke(e,t){1&e&&(h.Tb(0,"vitamui-common-input-error"),h.Oc(1),h.jc(2,"translate"),h.Sb()),2&e&&(h.Bb(1),h.Qc(" ",h.kc(2,1,"USER.INFORMATIONS.MODAL.SECURITY_STEP.PHONE_FIELD_FORMAT")," "))}function Ye(e,t){1&e&&(h.Tb(0,"vitamui-common-input-error"),h.Oc(1),h.jc(2,"translate"),h.Sb()),2&e&&(h.Bb(1),h.Qc(" ",h.kc(2,1,"COMMON.ERROR.REQUIRED"),""))}function Xe(e,t){1&e&&(h.Tb(0,"vitamui-common-input-error"),h.Oc(1),h.jc(2,"translate"),h.Sb()),2&e&&(h.Bb(1),h.Pc(h.kc(2,1,"USER.INFORMATIONS.MODAL.SECURITY_STEP.PHONE_FIELD_FORMAT")))}const $e=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;let We=(()=>{class e{constructor(e,t,i,r,n,o,s,a,l,c,u){this.dialogRef=e,this.data=t,this.formBuilder=i,this.userService=r,this.userInfoService=n,this.authService=o,this.userCreateValidators=s,this.confirmDialogService=a,this.countryService=l,this.startupService=c,this.loggerService=u,this.groups=[],this.stepIndex=0,this.addressEmpty=!0,this.creating=!1,this.stepCount=4}ngOnInit(){this.fullGroup=this.data.groups,this.groups=this.fullGroup.map(e=>({id:e.id,name:e.name,description:e.description,selected:!1,profiles:e.profiles,level:e.level})),this.maxStreetLength=this.startupService.getConfigNumberValue("MAX_STREET_LENGTH"),Object(l.Lb)(this.authService.user)||(this.groups=this.groups.filter(e=>e.id!==this.authService.user.groupId)),this.groups.sort((e,t)=>e.name.toUpperCase()<t.name.toUpperCase()?-1:e.name.toUpperCase()>t.name.toUpperCase()?1:0),this.customer=this.data.customer,this.connectedUserInfo=this.data.userInfo,this.formEmail=this.formBuilder.group({emailFirstPart:null,domain:[this.customer.emailDomains[0]]}),this.form=this.formBuilder.group({enabled:!0,email:[null,[n.x.required,n.x.pattern($e)],this.userCreateValidators.uniqueEmail()],firstname:[null,n.x.required],lastname:[null,n.x.required],mobile:[null,[n.x.pattern(/^[+]{1}[0-9]{11,12}$/)]],phone:[null,[n.x.pattern(/^[+]{1}[0-9]{11,12}$/)]],domain:[this.customer.emailDomains[0],n.x.required],groupId:[null,n.x.required],customerId:this.authService.user.customerId,otp:[{value:this.customer.otp!==l.Y.DEACTIVATED,disabled:this.customer.otp!==l.Y.OPTIONAL}],type:[{value:"NOMINATIVE",disabled:!this.connectedUserInfo.genericAllowed}],subrogeable:!1,status:null,userInfoId:null,address:this.formBuilder.group({street:[null,n.x.maxLength(this.maxStreetLength)],zipCode:[null],city:[null],country:["FR"]}),internalCode:[null],siteCode:[null],centerCodes:[null],autoProvisioningEnabled:!1},{validator:Me.missingPhoneNumber}),this.applyUserProfile(),this.onChanges(),this.keyPressSubscription=this.confirmDialogService.listenToEscapeKeyPress(this.dialogRef).subscribe(()=>this.onCancel()),this.form.get("address").valueChanges.pipe(Object(P.a)(e=>!e.street&&!e.zipCode&&!e.city),Object(Be.a)()).subscribe(e=>{this.addressEmpty=e,e?(this.form.get("address.street").clearValidators(),this.form.get("address.zipCode").clearValidators(),this.form.get("address.city").clearValidators()):(this.form.get("address.street").setValidators(n.x.required),this.form.get("address.zipCode").setValidators(n.x.required),this.form.get("address.city").setValidators(n.x.required)),this.form.get("address").updateValueAndValidity({emitEvent:!1})}),this.countryService.getAvailableCountries().subscribe(e=>{this.countries=e})}ngOnDestroy(){this.keyPressSubscription.unsubscribe()}applyUserProfile(){"NONE"===this.connectedUserInfo.type?(this.form.get("enabled").setValue(!1),this.form.get("enabled").disable(),this.form.get("groupId").setValidators(null),this.form.updateValueAndValidity({emitEvent:!1})):"LIST"===this.connectedUserInfo.type&&(this.groups=this.connectedUserInfo.profilGroup.map(e=>{const t=this.groups.find(t=>t.id===e.id);return Object({id:e.id,name:e.name,description:e.description,selected:!1,profiles:null==t?void 0:t.profiles})}),this.groups.sort((e,t)=>e.name<t.name?-1:e.name>t.name?1:0))}onCancel(){this.form.dirty?this.confirmDialogService.confirmBeforeClosing(this.dialogRef):this.dialogRef.close()}onSubmit(){if(this.form.invalid)return;this.creating=!0;let e="";e=this.form.get("enabled").value?"ENABLED":"DISABLED",this.form.get("status").setValue(e),this.userInfoService.create({id:null,language:this.customer.language}).subscribe(e=>{this.form.get("userInfoId").setValue(e.id),this.userService.create(this.form.getRawValue()).subscribe(()=>this.dialogRef.close(!0),e=>{this.creating=!1,this.loggerService.error(e)})},e=>{this.creating=!1,this.loggerService.error(e)})}onChanges(){this.formEmail.valueChanges.subscribe(e=>{this.form.patchValue({email:e.emailFirstPart+"@"+e.domain})})}firstStepInvalid(){return this.form.pending||this.form.get("email").invalid||this.form.get("email").pending||this.form.get("firstname").invalid||this.form.get("lastname").invalid||this.form.get("domain").invalid||this.form.get("enabled").invalid}thirdStepInvalid(){return this.form.get("address").pending||this.form.get("address").invalid||this.form.get("internalCode").pending||this.form.get("internalCode").invalid}passGroupStep(){this.stepIndex=2}formInvalid(){return this.form.pending||this.form.invalid}updateGroup(e){const t=e;this.groupName=t.name,this.form.patchValue({groupId:t.id})}}return e.\u0275fac=function(t){return new(t||e)(h.Nb(o.g),h.Nb(o.a),h.Nb(n.d),h.Nb(D),h.Nb(B),h.Nb(l.k),h.Nb(H),h.Nb(l.t),h.Nb(l.u),h.Nb(l.lb),h.Nb(l.U))},e.\u0275cmp=h.Hb({type:e,selectors:[["app-user-create"]],decls:155,vars:127,consts:[[1,"header"],[3,"index","count"],[3,"formGroup","ngSubmit"],[3,"selectedIndex","selectionChange"],[1,"content"],[1,"text","large","bold"],[1,"mt-4"],["formControlName","enabled"],[4,"ngIf"],[1,"d-flex","mt-2"],["formControlName","lastname","minlength","2","maxlength","50","required","",1,"col-5","p-0",3,"placeholder"],["formControlName","firstname","minlength","2","maxlength","50","required","",1,"col-5","ml-3","p-0",3,"placeholder"],[3,"formGroup"],[1,"d-flex"],["formControlName","emailFirstPart","maxlength","50","required","",1,"col-6","p-0",3,"placeholder"],[1,"mx-2","mt-1"],[1,"vitamui-mat-select"],["formControlName","domain","required","","panelClass","vitamui-mat-select"],[3,"value",4,"ngFor","ngForOf"],[1,"select-arrow"],[1,"material-icons"],["for","type"],[1,"mt-2"],["formControlName","type",1,"vitamui-button-toggle-group"],["group","matButtonToggleGroup"],["value","NOMINATIVE"],["value","GENERIC"],["formControlName","subrogeable"],["formControlName","autoProvisioningEnabled"],[1,"row","actions"],["type","button","class","btn primary","cdkStepperNext","",3,"disabled",4,"ngIf","ngIfElse"],["noGroup",""],["type","button",1,"btn","cancel","link","ml-1",3,"click"],[1,"mt-3","content"],[3,"groups","selectedGroupEvent"],[1,"actions"],["type","button","cdkStepperNext","",1,"btn","primary",3,"disabled"],["type","button",1,"btn","cancel","link",3,"click"],["type","button","cdkStepperPrevious","",1,"btn","link"],[1,"vitamui-icon","vitamui-icon-chevron-left"],[1,"underline"],["formGroupName","address"],[1,"row"],["formControlName","street",1,"col-12",3,"required","maxlength","placeholder"],["formControlName","zipCode","maxlength","10",1,"col-4",3,"required","placeholder"],["formControlName","city","maxlength","100",1,"col-4",3,"required","placeholder"],[1,"col-4","vitamui-mat-select"],["formControlName","country","panelClass","vitamui-mat-select",3,"placeholder"],["formControlName","centerCode",1,"col-4",3,"placeholder"],["formControlName","siteCode",1,"col-4",3,"placeholder"],["formControlName","internalCode","maxlength","20",1,"col-4",3,"placeholder"],["formControlName","otp"],[1,"d-flex","mt-3"],["formControlName","mobile",1,"col-5","p-0","mr-4",3,"placeholder"],["formControlName","phone",1,"col-5","p-0",3,"placeholder"],["type","submit",1,"btn","primary",3,"disabled"],[3,"value"],["type","button",1,"btn","primary",3,"disabled","click"]],template:function(e,t){if(1&e&&(h.Tb(0,"div",0),h.Ob(1,"vitamui-common-progress-bar",1),h.Sb(),h.Tb(2,"form",2),h.ec("ngSubmit",(function(){return t.onSubmit()})),h.Tb(3,"vitamui-common-stepper",3),h.ec("selectionChange",(function(e){return t.stepIndex=e.selectedIndex})),h.Tb(4,"cdk-step"),h.Tb(5,"div",4),h.Tb(6,"div",5),h.Oc(7),h.jc(8,"translate"),h.Sb(),h.Tb(9,"div",6),h.Tb(10,"vitamui-common-slide-toggle",7),h.Mc(11,Pe,3,3,"span",8),h.Mc(12,ke,3,3,"span",8),h.Sb(),h.Sb(),h.Tb(13,"div",9),h.Tb(14,"vitamui-common-input",10),h.jc(15,"translate"),h.Mc(16,De,3,3,"vitamui-common-input-error",8),h.Sb(),h.Tb(17,"vitamui-common-input",11),h.jc(18,"translate"),h.Mc(19,_e,3,3,"vitamui-common-input-error",8),h.Sb(),h.Sb(),h.Tb(20,"form",12),h.Tb(21,"div",13),h.Tb(22,"vitamui-common-input",14),h.jc(23,"translate"),h.Mc(24,Fe,4,3,"ng-container",8),h.Sb(),h.Tb(25,"h4",15),h.Oc(26,"@"),h.Sb(),h.Tb(27,"mat-form-field",16),h.Tb(28,"mat-select",17),h.Mc(29,we,2,2,"mat-option",18),h.Sb(),h.Tb(30,"div",19),h.Tb(31,"i",20),h.Oc(32,"keyboard_arrow_up"),h.Sb(),h.Tb(33,"i",20),h.Oc(34,"keyboard_arrow_down"),h.Sb(),h.Sb(),h.Sb(),h.Sb(),h.Sb(),h.Tb(35,"div"),h.Tb(36,"label",21),h.Oc(37),h.jc(38,"translate"),h.Sb(),h.Tb(39,"div",22),h.Tb(40,"mat-button-toggle-group",23,24),h.Tb(42,"mat-button-toggle",25),h.Oc(43),h.jc(44,"translate"),h.Sb(),h.Tb(45,"mat-button-toggle",26),h.Oc(46),h.jc(47,"translate"),h.Sb(),h.Sb(),h.Sb(),h.Sb(),h.Tb(48,"div",6),h.Tb(49,"vitamui-common-slide-toggle",27),h.Oc(50),h.jc(51,"translate"),h.Sb(),h.Sb(),h.Tb(52,"div",6),h.Tb(53,"vitamui-common-slide-toggle",28),h.Oc(54),h.jc(55,"translate"),h.Sb(),h.Sb(),h.Tb(56,"div",29),h.Mc(57,Ge,3,4,"button",30),h.Mc(58,Ve,3,4,"ng-template",null,31,h.Nc),h.Tb(60,"button",32),h.ec("click",(function(){return t.onCancel()})),h.Oc(61),h.jc(62,"translate"),h.Sb(),h.Sb(),h.Sb(),h.Sb(),h.Tb(63,"cdk-step"),h.Tb(64,"div",33),h.Tb(65,"div"),h.Tb(66,"app-group-list",34),h.ec("selectedGroupEvent",(function(e){return t.updateGroup(e)})),h.Sb(),h.Sb(),h.Tb(67,"div",35),h.Tb(68,"button",36),h.Oc(69),h.jc(70,"translate"),h.Sb(),h.Tb(71,"button",37),h.ec("click",(function(){return t.onCancel()})),h.Oc(72),h.jc(73,"translate"),h.Sb(),h.Sb(),h.Tb(74,"button",38),h.Ob(75,"i",39),h.Rb(76),h.Tb(77,"span",40),h.Oc(78),h.jc(79,"translate"),h.Sb(),h.Qb(),h.Sb(),h.Sb(),h.Sb(),h.Tb(80,"cdk-step"),h.Tb(81,"div",4),h.Tb(82,"div",5),h.Oc(83),h.jc(84,"translate"),h.Sb(),h.Rb(85,41),h.Tb(86,"div",42),h.Tb(87,"vitamui-common-input",43),h.jc(88,"translate"),h.Mc(89,He,3,3,"vitamui-common-input-error",8),h.Sb(),h.Sb(),h.Tb(90,"div",42),h.Tb(91,"vitamui-common-input",44),h.jc(92,"translate"),h.Mc(93,Qe,3,3,"vitamui-common-input-error",8),h.Sb(),h.Tb(94,"vitamui-common-input",45),h.jc(95,"translate"),h.Mc(96,ze,3,3,"vitamui-common-input-error",8),h.Sb(),h.Tb(97,"mat-form-field",46),h.Tb(98,"mat-select",47),h.jc(99,"translate"),h.Mc(100,qe,2,2,"mat-option",18),h.Sb(),h.Tb(101,"div",19),h.Tb(102,"i",20),h.Oc(103,"keyboard_arrow_up"),h.Sb(),h.Tb(104,"i",20),h.Oc(105,"keyboard_arrow_down"),h.Sb(),h.Sb(),h.Sb(),h.Sb(),h.Qb(),h.Tb(106,"div",42),h.Ob(107,"vitamui-common-input",48),h.jc(108,"translate"),h.Ob(109,"vitamui-common-input",49),h.jc(110,"translate"),h.Ob(111,"vitamui-common-input",50),h.jc(112,"translate"),h.Sb(),h.Tb(113,"div",35),h.Tb(114,"button",36),h.Oc(115),h.jc(116,"translate"),h.Sb(),h.Tb(117,"button",37),h.ec("click",(function(){return t.onCancel()})),h.Oc(118),h.jc(119,"translate"),h.Sb(),h.Sb(),h.Tb(120,"button",38),h.Ob(121,"i",39),h.Rb(122),h.Tb(123,"span",40),h.Oc(124),h.jc(125,"translate"),h.Sb(),h.Qb(),h.Sb(),h.Sb(),h.Sb(),h.Tb(126,"cdk-step"),h.Tb(127,"div",4),h.Tb(128,"div",5),h.Oc(129),h.jc(130,"translate"),h.Sb(),h.Tb(131,"vitamui-common-slide-toggle",51),h.Oc(132),h.jc(133,"translate"),h.Sb(),h.Tb(134,"div",52),h.Tb(135,"vitamui-common-input",53),h.jc(136,"translate"),h.Mc(137,Ke,3,3,"vitamui-common-input-error",8),h.Mc(138,Ye,3,3,"vitamui-common-input-error",8),h.Sb(),h.Tb(139,"vitamui-common-input",54),h.jc(140,"translate"),h.Mc(141,Xe,3,3,"vitamui-common-input-error",8),h.Sb(),h.Sb(),h.Tb(142,"div",35),h.Tb(143,"button",55),h.Oc(144),h.jc(145,"translate"),h.Sb(),h.Tb(146,"button",37),h.ec("click",(function(){return t.onCancel()})),h.Oc(147),h.jc(148,"translate"),h.Sb(),h.Sb(),h.Tb(149,"button",38),h.Ob(150,"i",39),h.Rb(151),h.Tb(152,"span",40),h.Oc(153),h.jc(154,"translate"),h.Sb(),h.Qb(),h.Sb(),h.Sb(),h.Sb(),h.Sb(),h.Sb()),2&e){const e=h.zc(59);var i,r=null,n=null,o=null,s=null,a=null,l=null,c=null,u=null,b=null,m=null;h.Bb(1),h.oc("index",t.stepIndex)("count",t.stepCount),h.Bb(1),h.oc("formGroup",t.form),h.Bb(1),h.oc("selectedIndex",t.stepIndex),h.Bb(4),h.Pc(h.kc(8,65,"USER.INFORMATIONS.MODAL.INFORMATIONS_STEP.TITLE")),h.Bb(4),h.oc("ngIf",!(null!=t.form&&t.form.get("enabled").value)),h.Bb(1),h.oc("ngIf",null==t.form?null:t.form.get("enabled").value),h.Bb(2),h.oc("placeholder",h.kc(15,67,"USER.INFORMATIONS.LASTNAME")),h.Bb(2),h.oc("ngIf",(null==(r=t.form.get("lastname"))?null:r.touched)&&(null==(r=t.form.get("lastname"))?null:r.hasError("required"))),h.Bb(1),h.oc("placeholder",h.kc(18,69,"USER.INFORMATIONS.FIRSTNAME")),h.Bb(2),h.oc("ngIf",(null==(n=t.form.get("firstname"))?null:n.touched)&&(null==(n=t.form.get("firstname"))?null:n.hasError("required"))),h.Bb(1),h.oc("formGroup",t.formEmail),h.Bb(2),h.Fb("ng-pending",null==t.form||null==(o=t.form.get("email"))?null:o.pending)("ng-invalid",null==t.form||null==(s=t.form.get("email"))?null:s.errors),h.oc("placeholder",h.kc(23,71,"USER.INFORMATIONS.MAIL")),h.Bb(2),h.oc("ngIf",null==(i=t.formEmail.get("emailFirstPart"))?null:i.touched),h.Bb(5),h.oc("ngForOf",null==t.customer?null:t.customer.emailDomains),h.Bb(8),h.Qc(" ",h.kc(38,73,"USER.INFORMATIONS.TYPE")," "),h.Bb(6),h.Qc(" ",h.kc(44,75,"USER.INFORMATIONS.MODAL.INFORMATIONS_STEP.GROUP_TYPE_NOMINATIVE")," "),h.Bb(3),h.Qc(" ",h.kc(47,77,"USER.INFORMATIONS.MODAL.INFORMATIONS_STEP.GROUP_TYPE_GENERIC")," "),h.Bb(4),h.Qc("",h.kc(51,79,"USER.INFORMATIONS.ALLOW_SUBROGATION")," "),h.Bb(4),h.Qc("",h.kc(55,81,"USER.INFORMATIONS.ACTIVATE_AUTO_PROVISIONING")," "),h.Bb(3),h.oc("ngIf","NONE"!==t.connectedUserInfo.type)("ngIfElse",e),h.Bb(4),h.Qc(" ",h.kc(62,83,"COMMON.UNDO")," "),h.Bb(5),h.oc("groups",t.groups),h.Bb(2),h.oc("disabled",!t.groupName),h.Bb(1),h.Qc(" ",h.kc(70,85,"COMMON.NEXT")," "),h.Bb(3),h.Pc(h.kc(73,87,"COMMON.UNDO")),h.Bb(6),h.Pc(h.kc(79,89,"COMMON.BACK")),h.Bb(5),h.Pc(h.kc(84,91,"USER.INFORMATIONS.MODAL.CONTACT_STEP.TITLE")),h.Bb(4),h.pc("maxlength",t.maxStreetLength),h.oc("required",!t.addressEmpty)("placeholder",h.kc(88,93,"COMMON.ADRESS.STREET")),h.Bb(2),h.oc("ngIf",(null==(a=t.form.get("address.street"))?null:a.touched)&&(null==(a=t.form.get("address.street"))?null:a.hasError("required"))),h.Bb(2),h.oc("required",!t.addressEmpty)("placeholder",h.kc(92,95,"COMMON.ADRESS.ZIPCODE")),h.Bb(2),h.oc("ngIf",(null==(l=t.form.get("address.zipCode"))?null:l.touched)&&(null==(l=t.form.get("address.zipCode"))?null:l.hasError("required"))),h.Bb(1),h.oc("required",!t.addressEmpty)("placeholder",h.kc(95,97,"COMMON.ADRESS.CITY")),h.Bb(2),h.oc("ngIf",(null==(c=t.form.get("address.city"))?null:c.touched)&&(null==(c=t.form.get("address.city"))?null:c.hasError("required"))),h.Bb(2),h.oc("placeholder",h.kc(99,99,"COMMON.ADRESS.COUNTRY")),h.Bb(2),h.oc("ngForOf",t.countries),h.Bb(7),h.oc("placeholder",h.kc(108,101,"USER.INFORMATIONS.CENTER_CODES")),h.Bb(2),h.oc("placeholder",h.kc(110,103,"USER.INFORMATIONS.SITE_CODE")),h.Bb(2),h.oc("placeholder",h.kc(112,105,"USER.INFORMATIONS.INTERNAL_CODE")),h.Bb(3),h.oc("disabled",t.thirdStepInvalid()),h.Bb(1),h.Qc(" ",h.kc(116,107,"COMMON.NEXT")," "),h.Bb(3),h.Pc(h.kc(119,109,"COMMON.UNDO")),h.Bb(6),h.Pc(h.kc(125,111,"COMMON.BACK")),h.Bb(5),h.Pc(h.kc(130,113,"USER.INFORMATIONS.MODAL.SECURITY_STEP.TITLE")),h.Bb(3),h.Qc("",h.kc(133,115,"USER.INFORMATIONS.VALIDATIONS")," "),h.Bb(3),h.Fb("ng-invalid",null==t.form?null:t.form.hasError("missingPhoneNumber")),h.oc("placeholder",h.kc(136,117,"USER.INFORMATIONS.PHONE.MOBILE")),h.Bb(2),h.oc("ngIf",null==t.form||null==(u=t.form.get("mobile"))?null:u.hasError("pattern")),h.Bb(1),h.oc("ngIf",(null==t.form||null==(b=t.form.get("mobile"))?null:b.touched)&&(null==t.form?null:t.form.hasError("missingPhoneNumber"))),h.Bb(1),h.oc("placeholder",h.kc(140,119,"USER.INFORMATIONS.PHONE.FIX")),h.Bb(2),h.oc("ngIf",null==t.form||null==(m=t.form.get("phone"))?null:m.hasError("pattern")),h.Bb(2),h.oc("disabled",t.formInvalid()||t.creating),h.Bb(1),h.Pc(h.kc(145,121,"COMMON.SUBMIT")),h.Bb(3),h.Pc(h.kc(148,123,"COMMON.UNDO")),h.Bb(6),h.Pc(h.kc(154,125,"COMMON.BACK"))}},directives:[l.dc,n.y,n.r,n.i,l.mb,Ue.a,l.ac,n.q,n.g,r.p,l.Qb,n.m,n.l,n.w,m.b,p.a,r.o,b.b,b.a,se,Ue.d,Ue.e,n.j,l.Rb,ye.k],pipes:[Q.d],styles:[""]}),e})();const Ze={status:e=>{const t=e.filter(e=>"GENERIC"!==e),i=[];return t.length>0&&i.push({key:"status",value:t,operator:l.W.in}),e.find(e=>"GENERIC"===e)&&i.push({key:"type",value:"GENERIC",operator:l.W.equals}),[{queryOperator:l.cb.AND,criteria:i}]},level:e=>0===e.length?[]:(e.some(e=>null===e)&&e.push(""),[{key:"level",value:e,operator:l.W.in}]),group:e=>0===e.length?[]:[{key:"groupId",value:e,operator:l.W.in}]},Je=["filterTemplate"],et=["filterButton"];function tt(e,t){1&e&&(h.Tb(0,"vitamui-common-table-filter-option",28),h.Tb(1,"div",22),h.Tb(2,"span",23),h.Oc(3),h.jc(4,"translate"),h.Sb(),h.Sb(),h.Sb()),2&e&&(h.oc("separator",!0),h.Bb(3),h.Pc(h.kc(4,2,"USER.HOME.RESULTS_TABLE.STATUS_FILTER.GENERIC")))}function it(e,t){if(1&e){const e=h.Ub();h.Tb(0,"vitamui-common-table-filter",20),h.ec("filterChange",(function(t){return h.Dc(e),h.ic().filterMap.status=t}))("filterChange",(function(t){return h.Dc(e),h.ic().onFilterChange("status",t)})),h.Tb(1,"vitamui-common-table-filter-option",21),h.Tb(2,"div",22),h.Tb(3,"span",23),h.Oc(4),h.jc(5,"translate"),h.Sb(),h.Sb(),h.Sb(),h.Tb(6,"vitamui-common-table-filter-option",24),h.Tb(7,"div",22),h.Tb(8,"span",23),h.Oc(9),h.jc(10,"translate"),h.Sb(),h.Sb(),h.Sb(),h.Tb(11,"vitamui-common-table-filter-option",25),h.Tb(12,"div",22),h.Tb(13,"span",23),h.Oc(14),h.jc(15,"translate"),h.Sb(),h.Sb(),h.Sb(),h.Tb(16,"vitamui-common-table-filter-option",26),h.Tb(17,"div",22),h.Tb(18,"span",23),h.Oc(19),h.jc(20,"translate"),h.Sb(),h.Sb(),h.Sb(),h.Mc(21,tt,5,4,"vitamui-common-table-filter-option",27),h.Sb()}if(2&e){const e=h.ic();h.oc("filter",e.filterMap.status),h.Bb(4),h.Pc(h.kc(5,6,"USER.HOME.RESULTS_TABLE.STATUS_FILTER.ACTIVE")),h.Bb(5),h.Pc(h.kc(10,8,"USER.HOME.RESULTS_TABLE.STATUS_FILTER.BLOCKED")),h.Bb(5),h.Pc(h.kc(15,10,"USER.HOME.RESULTS_TABLE.STATUS_FILTER.INACTIVE")),h.Bb(5),h.Pc(h.kc(20,12,"USER.HOME.RESULTS_TABLE.STATUS_FILTER.DELETED")),h.Bb(2),h.oc("vitamuiCommonHasAnyRole",e.genericUserRole)}}function rt(e,t){if(1&e){const e=h.Ub();h.Tb(0,"vitamui-common-table-filter-search",29),h.ec("filterChange",(function(t){return h.Dc(e),h.ic().filterMap.level=t}))("filterChange",(function(t){return h.Dc(e),h.ic().onFilterChange("level",t)}))("filterClose",(function(){h.Dc(e),h.ic();const t=h.zc(28);return null==t?null:t.close()})),h.jc(1,"translate"),h.Sb()}if(2&e){const e=h.ic();h.oc("filter",e.filterMap.level)("options",e.levelFilterOptions)("emptyValueOption",h.kc(1,3,"USER.HOME.RESULTS_TABLE.EMPTY_LEVEL"))}}function nt(e,t){if(1&e){const e=h.Ub();h.Tb(0,"vitamui-common-table-filter-search",30),h.ec("filterChange",(function(t){return h.Dc(e),h.ic().filterMap.group=t}))("filterChange",(function(t){return h.Dc(e),h.ic().onFilterChange("group",t)}))("filterClose",(function(){h.Dc(e),h.ic();const t=h.zc(39);return null==t?null:t.close()})),h.Sb()}if(2&e){const e=h.ic();h.oc("filter",e.filterMap.group)("options",e.groupFilterOptions)}}function ot(e,t){1&e&&(h.Tb(0,"div"),h.Ob(1,"i",44),h.Sb()),2&e&&(h.Bb(1),h.Jc("font-size",30,"px"))}function st(e,t){1&e&&(h.Tb(0,"div"),h.Ob(1,"i",45),h.Sb()),2&e&&(h.Bb(1),h.Jc("font-size",30,"px"))}function at(e,t){1&e&&(h.Tb(0,"div"),h.Ob(1,"i",46),h.Sb()),2&e&&(h.Bb(1),h.Jc("font-size",30,"px"))}function lt(e,t){1&e&&(h.Tb(0,"div"),h.Ob(1,"i",47),h.Tb(2,"span",48),h.Oc(3,"x"),h.Sb(),h.Sb()),2&e&&(h.Bb(1),h.Jc("font-size",30,"px"))}function ct(e,t){if(1&e&&(h.Rb(0),h.Rb(1,41),h.Mc(2,ot,2,2,"div",42),h.Mc(3,st,2,2,"div",42),h.Mc(4,at,2,2,"div",42),h.Qb(),h.Mc(5,lt,4,2,"div",43),h.Qb()),2&e){const e=h.ic().$implicit;h.Bb(1),h.oc("ngSwitch",null==e?null:e.status),h.Bb(1),h.oc("ngSwitchCase","ENABLED"),h.Bb(1),h.oc("ngSwitchCase","BLOCKED"),h.Bb(1),h.oc("ngSwitchCase","DISABLED"),h.Bb(1),h.oc("ngIf","REMOVED"===(null==e?null:e.status))}}function ut(e,t){1&e&&h.Ob(0,"i",7),2&e&&h.Jc("font-size",30,"px")}function bt(e,t){if(1&e){const e=h.Ub();h.Tb(0,"div",33),h.ec("click",(function(){h.Dc(e);const i=t.$implicit;return h.ic(2).userClick.emit(i)})),h.Tb(1,"div",34),h.Tb(2,"div",35),h.Mc(3,ct,6,5,"ng-container",36),h.Mc(4,ut,1,2,"ng-template",null,37,h.Nc),h.Sb(),h.Tb(6,"div",3),h.Tb(7,"div",38),h.Oc(8),h.jc(9,"uppercase"),h.Sb(),h.Tb(10,"span",39),h.Oc(11),h.Sb(),h.Sb(),h.Tb(12,"div",40),h.Oc(13),h.Sb(),h.Tb(14,"div",40),h.Oc(15),h.jc(16,"empty"),h.jc(17,"date"),h.Sb(),h.Tb(18,"div",40),h.Oc(19),h.Sb(),h.Tb(20,"div",40),h.Oc(21),h.Sb(),h.Sb(),h.Sb()}if(2&e){const e=t.$implicit,r=h.zc(5),n=h.ic(2);var i;h.Bb(3),h.oc("ngIf","GENERIC"!==(null==e?null:e.type))("ngIfElse",r),h.Bb(5),h.Rc("",h.kc(9,9,null==e?null:e.lastname)," ",null==e?null:e.firstname,""),h.Bb(3),h.Qc(" ",null==e?null:e.email,""),h.Bb(2),h.Pc(null==e?null:e.identifier),h.Bb(2),h.Pc(h.kc(16,11,h.lc(17,13,null==e?null:e.lastConnection,"dd/MM/yyyy"))),h.Bb(4),h.Pc(null==e?null:e.level),h.Bb(2),h.Pc(null==(i=n.getGroup(e))?null:i.name)}}function mt(e,t){if(1&e&&(h.Tb(0,"div",31),h.Mc(1,bt,22,16,"div",32),h.Sb()),2&e){const e=h.ic();h.Bb(1),h.oc("ngForOf",e.dataSource)}}function dt(e,t){1&e&&h.Ob(0,"div")}function pt(e,t){1&e&&(h.Tb(0,"div",49),h.Ob(1,"mat-spinner",50),h.Sb())}let ft=(()=>{class e extends l.O{constructor(e,t,i,r,n){super(t),this.customerService=e,this.userService=t,this.locale=i,this.authService=r,this.snackBarService=n,this.userClick=new h.n,this.statusFilter=[],this.filterMap={status:[],level:null,group:null},this.groupFilterOptions=[],this.levelFilterOptions=[],this.orderBy="lastname",this.direction=l.x.ASCENDANT,this.isInactifUsers=!1,this.userGroups=[],this.filterChange=new R.a,this.searchChange=new R.a,this.orderChange=new R.a,this.searchKeys=["firstname","lastname","email","mobile","phone","identifier"],this.genericUserRole={appId:l.h.USERS_APP,tenantIdentifier:+this.authService.user.proofTenantIdentifier,roles:[l.db.ROLE_GENERIC_USERS]}}set searchText(e){this._searchText=e,this.searchChange.next(e)}get connectedUserInfo(){return this._connectedUserInfo}set connectedUserInfo(e){this._connectedUserInfo=e}get groups(){return this._groups}set groups(e){this._groups=e,e&&(this.updateData(e),this.updatedData.subscribe(()=>{this.updateData(e)}))}ngOnInit(){this.search(new l.Z(0,l.w,this.orderBy,l.x.ASCENDANT)),this.refreshLevelOptions(),this.updatedUserSub=this.userService.userUpdated.subscribe(e=>{const t=this.dataSource.findIndex(t=>e.id===t.id);t>-1&&this.userService.get(e.id).subscribe(e=>{this.dataSource[t]=e})}),Object(_.a)(this.searchChange,this.filterChange,this.orderChange).pipe(Object(L.a)(400)).subscribe(()=>{const e={criteria:[...(t=this.filterMap,Object(l.Eb)(t,Ze)),...Object(l.Fb)(this._searchText,this.searchKeys)]};var t;const i=new l.Z(0,l.w,this.orderBy,this.direction,JSON.stringify(e));this.search(i)})}updateData(e){new Set(this.dataSource.map(e=>e.groupId)).forEach(t=>{if(!this.userGroups.find(e=>e.id===t)){const i=e.find(e=>e.id===t);i&&this.userGroups.push({id:i.id,group:i})}}),this.groupFilterOptions=this.userGroups.map(e=>({value:e.id,label:e.group.name})),this.groupFilterOptions.sort(ht(this.locale))}refreshLevelOptions(e){this.userService.getLevelsNoEmpty(e).subscribe(e=>{this.levelFilterOptions=e.map(e=>({value:e,label:e})),this.levelFilterOptions.sort(ht(this.locale))})}ngOnDestroy(){this.updatedUserSub.unsubscribe(),this.updatedData.unsubscribe()}getGroup(e){return this.groups.find(t=>t.id===e.groupId)||void 0}onFilterChange(e,t){this.filterMap[e]=t,this.filterChange.next(this.filterMap)}emitOrderChange(){this.orderChange.next()}showUser(e){"REMOVED"===e.status?this.snackBarService.open({message:"SHARED.SNACKBAR.USER_ALREADY_DELETED",icon:"vitamui-icon-bank"}):this.userClick.emit(e)}checkInactifUsers(){this.customerService.getMyCustomer().subscribe(e=>{e.gdprAlert&&(this.dataSource.filter(e=>"DISABLED"===e.status&&null!==e.disablingDate).forEach(t=>{this.totalMonth=12*((new Date).getFullYear()-new Date(t.disablingDate).getFullYear())-new Date(t.disablingDate).getMonth()+(new Date).getMonth(),this.totalMonth>e.gdprAlertDelay&&t.email.split("@")[1]===e.defaultEmailDomain&&(this.isInactifUsers=!0)}),this.isInactifUsers&&this.snackBarService.open({message:"SHARED.SNACKBAR.USER_TO_DELETE",icon:"vitamui-icon-bank"}))})}}return e.\u0275fac=function(t){return new(t||e)(h.Nb(Ne.a),h.Nb(D),h.Nb(h.v),h.Nb(l.k),h.Nb(l.Ab))},e.\u0275cmp=h.Hb({type:e,selectors:[["app-user-list"]],viewQuery:function(e,t){var i;1&e&&(h.Uc(Je,!0),h.Uc(et,!0)),2&e&&(h.yc(i=h.fc())&&(t.filterTemplate=i.first),h.yc(i=h.fc())&&(t.filterButton=i.first))},inputs:{searchText:["search","searchText"],connectedUserInfo:"connectedUserInfo",groups:"groups"},outputs:{userClick:"userClick"},features:[h.yb],decls:51,vars:39,consts:[["vitamuiCommonInfiniteScroll","",3,"vitamuiScroll"],[1,"vitamui-table"],[1,"vitamui-table-head"],[1,"col-2"],[1,"vitamui-filter-button",3,"vitamuiCommonTableFilter"],[1,"material-icons","vitamui-row-icon"],["statusFilterTemplate",""],[1,"vitamui-icon","vitamui-icon-user","vitamui-row-icon"],["orderByKey","status",3,"orderBy","direction","orderByChange","directionChange","orderChange"],["orderByKey","lastname",3,"orderBy","direction","orderByChange","directionChange","orderChange"],["orderByKey","identifier",3,"orderBy","direction","orderByChange","directionChange","orderChange"],["orderByKey","lastConnection",3,"orderBy","direction","orderByChange","directionChange","orderChange"],["levelFilterTrigger","vitamuiCommonTableFilter"],["levelFilterTemplate",""],["orderByKey","level",3,"orderBy","direction","orderByChange","directionChange","orderChange"],["groupFilterTrigger","vitamuiCommonTableFilter"],["groupFilterTemplate",""],["class","vitamui-table-body",4,"ngIf"],[4,"ngIf","ngIfThen"],["loadingSpinner",""],[3,"filter","filterChange"],["value","ENABLED"],[1,"table-filter-icon"],[1,"badge-state"],["value","BLOCKED"],["value","DISABLED"],["value","REMOVED"],["value","GENERIC",3,"separator",4,"vitamuiCommonHasAnyRole"],["value","GENERIC",3,"separator"],[3,"filter","options","emptyValueOption","filterChange","filterClose"],[3,"filter","options","filterChange","filterClose"],[1,"vitamui-table-body"],["class","vitamui-table-rows",3,"click",4,"ngFor","ngForOf"],[1,"vitamui-table-rows",3,"click"],[1,"vitamui-row","d-flex","align-items-center","clickable"],[1,"col-2","padding-user"],[4,"ngIf","ngIfElse"],["genericUserIcon",""],["vitamuiCommonEllipsis",""],["vitamuiCommonEllipsis","",1,"email"],["vitamuiCommonEllipsis","",1,"col-2"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngIf"],[1,"vitamui-icon","vitamui-icon-user","vitamui-row-icon","status-badge","status-badge-green","close"],[1,"vitamui-icon","vitamui-icon-user","vitamui-row-icon","status-badge","status-badge-orange"],[1,"vitamui-icon","vitamui-icon-user","vitamui-row-icon","status-badge","status-badge-grey"],[1,"vitamui-icon","vitamui-icon-user","vitamui-row-icon","parent"],[1,"status-badge-anonym"],[1,"vitamui-min-content"],[1,"vitamui-spinner","medium"]],template:function(e,t){if(1&e&&(h.Tb(0,"div",0),h.ec("vitamuiScroll",(function(){return t.onScroll()})),h.Tb(1,"div",1),h.Tb(2,"div",2),h.Tb(3,"div",3),h.Tb(4,"button",4),h.Tb(5,"i",5),h.Oc(6,"filter_list"),h.Sb(),h.Sb(),h.Mc(7,it,22,14,"ng-template",null,6,h.Nc),h.Ob(9,"i",7),h.Tb(10,"vitamui-common-order-by-button",8),h.ec("orderByChange",(function(e){return t.orderBy=e}))("directionChange",(function(e){return t.direction=e}))("orderChange",(function(){return t.emitOrderChange()})),h.Sb(),h.Sb(),h.Tb(11,"div",3),h.Tb(12,"span"),h.Oc(13),h.jc(14,"translate"),h.Sb(),h.Tb(15,"vitamui-common-order-by-button",9),h.ec("orderByChange",(function(e){return t.orderBy=e}))("directionChange",(function(e){return t.direction=e}))("orderChange",(function(){return t.emitOrderChange()})),h.Sb(),h.Sb(),h.Tb(16,"div",3),h.Tb(17,"span"),h.Oc(18),h.jc(19,"translate"),h.Sb(),h.Tb(20,"vitamui-common-order-by-button",10),h.ec("orderByChange",(function(e){return t.orderBy=e}))("directionChange",(function(e){return t.direction=e}))("orderChange",(function(){return t.emitOrderChange()})),h.Sb(),h.Sb(),h.Tb(21,"div",3),h.Tb(22,"span"),h.Oc(23),h.jc(24,"translate"),h.Sb(),h.Tb(25,"vitamui-common-order-by-button",11),h.ec("orderByChange",(function(e){return t.orderBy=e}))("directionChange",(function(e){return t.direction=e}))("orderChange",(function(){return t.emitOrderChange()})),h.Sb(),h.Sb(),h.Tb(26,"div",3),h.Tb(27,"button",4,12),h.Tb(29,"i",5),h.Oc(30,"filter_list"),h.Sb(),h.Sb(),h.Mc(31,rt,2,5,"ng-template",null,13,h.Nc),h.Tb(33,"span"),h.Oc(34),h.jc(35,"translate"),h.Sb(),h.Tb(36,"vitamui-common-order-by-button",14),h.ec("orderByChange",(function(e){return t.orderBy=e}))("directionChange",(function(e){return t.direction=e}))("orderChange",(function(){return t.emitOrderChange()})),h.Sb(),h.Sb(),h.Tb(37,"div",3),h.Tb(38,"button",4,15),h.Tb(40,"i",5),h.Oc(41,"filter_list"),h.Sb(),h.Sb(),h.Mc(42,nt,1,2,"ng-template",null,16,h.Nc),h.Tb(44,"span"),h.Oc(45),h.jc(46,"translate"),h.Sb(),h.Sb(),h.Sb(),h.Mc(47,mt,2,1,"div",17),h.Sb(),h.Mc(48,dt,1,0,"div",18),h.Sb(),h.Mc(49,pt,2,0,"ng-template",null,19,h.Nc)),2&e){const e=h.zc(8),i=h.zc(32),r=h.zc(43),n=h.zc(50);h.Bb(4),h.Fb("active",t.filterMap.status&&t.filterMap.status.length>0),h.oc("vitamuiCommonTableFilter",e),h.Bb(5),h.Jc("font-size",30,"px"),h.Bb(1),h.oc("orderBy",t.orderBy)("direction",t.direction),h.Bb(3),h.Pc(h.kc(14,29,"USER.HOME.RESULTS_TABLE.NAME")),h.Bb(2),h.oc("orderBy",t.orderBy)("direction",t.direction),h.Bb(3),h.Pc(h.kc(19,31,"COMMON.ID")),h.Bb(2),h.oc("orderBy",t.orderBy)("direction",t.direction),h.Bb(3),h.Pc(h.kc(24,33,"USER.HOME.RESULTS_TABLE.LAST_CONNEXION")),h.Bb(2),h.oc("orderBy",t.orderBy)("direction",t.direction),h.Bb(2),h.Fb("active",t.filterMap.level&&t.filterMap.level.length>0),h.oc("vitamuiCommonTableFilter",i),h.Bb(7),h.Pc(h.kc(35,35,"USER.HOME.RESULTS_TABLE.GROUP_LEVEL")),h.Bb(2),h.oc("orderBy",t.orderBy)("direction",t.direction),h.Bb(2),h.Fb("active",t.filterMap.group&&t.filterMap.group.length>0),h.oc("vitamuiCommonTableFilter",r),h.Bb(7),h.Pc(h.kc(46,37,"USER.HOME.RESULTS_TABLE.GROUP")),h.Bb(2),h.oc("ngIf",t.groups),h.Bb(1),h.oc("ngIf",!t.dataSource||t.pending||!t.groups)("ngIfThen",n)}},directives:[l.N,l.qb,l.X,r.p,l.pb,l.bc,l.gc,l.sb,r.o,l.Zb,r.r,r.s,g.b],pipes:[Q.d,r.z,l.oc,r.e],styles:[".parent[_ngcontent-%COMP%]{position:relative}.status-badge-anonym[_ngcontent-%COMP%]{box-shadow:0 1px 4px rgba(var(--vitamui-grey-rgb),.2),0 2px 8px rgba(var(--vitamui-grey-rgb),.05);font-family:Helvetica,sans-serif;font-size:10px;font-weight:200;color:#fff;width:16px;height:16px;display:block;position:absolute;margin-left:15px;margin-top:-9px;padding:0 3px 3px 4px;border-radius:50%;background-color:var(--vitamui-grey-600);border:2px solid #fff}span.email[_ngcontent-%COMP%]{font-size:14px;text-align:left;font-weight:400;color:var(--vitamui-grey-600)}vitamui-common-table-filter-option[_ngcontent-%COMP%]   .vitamui-icon[_ngcontent-%COMP%]{font-size:24px;color:var(--vitamui-grey);margin-right:15px}.table-filter-icon[_ngcontent-%COMP%]{display:flex;align-items:center}.table-filter-icon[_ngcontent-%COMP%]   span.badge-state[_ngcontent-%COMP%]{color:var(--vitamui-grey-900);margin-left:18px;font-size:14px;line-height:22px;letter-spacing:.1px}.vitamui-table-head[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:flex;align-items:center;flex-wrap:nowrap}.padding-user[_ngcontent-%COMP%]{padding-left:2.5rem}.text-right[_ngcontent-%COMP%]{text-align:right}"],data:{animation:[l.Hb,l.Ob]}}),e})();function ht(e){return(t,i)=>t.label.localeCompare(i.label,e)}function St(e,t){if(1&e){const e=h.Ub();h.Tb(0,"app-user-preview",10),h.ec("previewClose",(function(){return h.Dc(e),h.ic().closePanel()})),h.Sb()}if(2&e){const e=h.ic();h.oc("user",e.openedItem)("customer",e.customer)("groups",e.groups)}}function gt(e,t){if(1&e){const e=h.Ub();h.Tb(0,"button",11),h.ec("click",(function(){return h.Dc(e),h.ic().openCreateUserDialog()})),h.Tb(1,"span"),h.Oc(2),h.jc(3,"translate"),h.Sb(),h.Sb()}if(2&e){const e=h.ic();h.oc("disabled",!e.connectedUserInfo.createUser),h.Bb(2),h.Pc(h.kc(3,2,"USER.HOME.ACTION_BUTTON"))}}const vt=[{path:"",component:(()=>{class e extends l.kb{constructor(e,t,i,r,n,o,s,a,l){super(i,n),this.dialog=e,this.userService=t,this.route=i,this.customerService=r,this.globalEventService=n,this.groupService=o,this.authService=s,this.downloadSnackBarService=a,this.snackBarService=l,this.exportLoading=!1}ngOnInit(){this.customerService.getMyCustomer().subscribe(e=>this.customer=e),this.groupService.getAll(!0).subscribe(e=>this.groups=e),this.connectedUserInfo=this.userService.getUserProfileInfo(this.authService.user)}openCreateUserDialog(){this.dialog.open(We,{panelClass:"vitamui-modal",disableClose:!0,data:{userInfo:this.connectedUserInfo,customer:this.customer,groups:this.groups}}).afterClosed().subscribe(e=>{e&&this.refreshList()})}onSearchSubmit(e){this.search=e}export(){this.exportLoading=!0,this.downloadSnackBarService.openDownloadBar();const e=this.userService.export().subscribe(e=>{const t="export-utilisateurs-"+this.buildExportDateTime()+".xlsx";l.z.loadFromBlob(e,e.body.type,t),this.downloadSnackBarService.close(),this.exportLoading=!1,this.snackBarService.open({message:"SHARED.SNACKBAR.USER_EXPORT_SUCCESS"})},()=>{this.downloadSnackBarService.close(),this.exportLoading=!1});this.downloadSnackBarService.cancelDownload.subscribe(()=>e.unsubscribe())}buildExportDateTime(){const e=(new Date).toLocaleTimeString().replace(":","_"),t=(new Date).toISOString();return t.substring(0,t.indexOf("T")+1)+e}refreshList(){this.userListComponent&&this.userListComponent.search(new l.Z(0,l.w,"lastname",l.x.ASCENDANT))}}return e.\u0275fac=function(t){return new(t||e)(h.Nb(o.b),h.Nb(D),h.Nb(v.a),h.Nb(Ne.a),h.Nb(l.M),h.Nb(y.a),h.Nb(l.k),h.Nb(Ae.a),h.Nb(l.Ab))},e.\u0275cmp=h.Hb({type:e,selectors:[["app-user"]],viewQuery:function(e,t){var i;1&e&&h.Ic(ft,!0),2&e&&h.yc(i=h.fc())&&(t.userListComponent=i.first)},features:[h.yb],decls:18,vars:18,consts:[[3,"autosize","hasBackdrop"],["mode","side","position","end",3,"fixedInViewport"],["panel",""],[3,"user","customer","groups","previewClose",4,"ngIf"],[1,"vitamui-heading"],[3,"searchbarPlaceholder","search"],["class","btn primary mr-3",3,"disabled","click",4,"ngIf"],[1,"btn","secondary",3,"disabled","click"],[1,"vitamui-content"],[3,"search","connectedUserInfo","groups","userClick"],[3,"user","customer","groups","previewClose"],[1,"btn","primary","mr-3",3,"disabled","click"]],template:function(e,t){1&e&&(h.Tb(0,"mat-sidenav-container",0),h.Tb(1,"mat-sidenav",1,2),h.Mc(3,St,1,3,"app-user-preview",3),h.Sb(),h.Tb(4,"mat-sidenav-content"),h.Tb(5,"div",4),h.Tb(6,"vitamui-common-title-breadcrumb"),h.Oc(7),h.jc(8,"translate"),h.Sb(),h.Tb(9,"vitamui-common-banner",5),h.ec("search",(function(e){return t.onSearchSubmit(e)})),h.jc(10,"translate"),h.Mc(11,gt,4,4,"button",6),h.Tb(12,"button",7),h.ec("click",(function(){return t.export()})),h.Tb(13,"span"),h.Oc(14),h.jc(15,"translate"),h.Sb(),h.Sb(),h.Sb(),h.Sb(),h.Tb(16,"div",8),h.Tb(17,"app-user-list",9),h.ec("userClick",(function(e){return t.openPanel(e)})),h.Sb(),h.Sb(),h.Sb(),h.Sb()),2&e&&(h.oc("autosize",!0)("hasBackdrop",!1),h.Bb(1),h.oc("fixedInViewport",!0),h.Bb(2),h.oc("ngIf",t.openedItem),h.Bb(4),h.Qc(" ",h.kc(8,12,"APPLICATION.USERS_APP.TITLE")," "),h.Bb(2),h.oc("searchbarPlaceholder",h.kc(10,14,"USER.HOME.TITLE_PLACEHOLDER")),h.Bb(2),h.oc("ngIf",t.groups),h.Bb(1),h.oc("disabled",t.exportLoading),h.Bb(2),h.Pc(h.kc(15,16,"USER.HOME.EXPORT")),h.Bb(3),h.oc("search",t.search)("connectedUserInfo",t.connectedUserInfo)("groups",t.groups))},directives:[a.b,a.a,r.p,a.c,l.cc,l.jc,ft,Ie],pipes:[Q.d],styles:[""]}),e})()},{path:":id",component:Ce,resolve:{user:Re}}];let Ot=(()=>{class e{}return e.\u0275mod=h.Lb({type:e}),e.\u0275inj=h.Kb({factory:function(t){return new(t||e)},imports:[[r.c,v.g.forChild(vt)],v.g]}),e})(),Tt=(()=>{class e{}return e.\u0275mod=h.Lb({type:e}),e.\u0275inj=h.Kb({factory:function(t){return new(t||e)},imports:[[r.c,l.xb,c.a,S,O,o.f,s.b,I,u.a,a.d,n.k,Ot]]}),e})()}}]);