!function(){function e(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"==typeof e)return t(e,n);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return t(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function n(e,t,n){return t=i(t),function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}()?Reflect.construct(t,n||[],i(e).constructor):t.apply(e,n))}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&o(e,t)}function o(e,t){return(o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function c(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,l(i.key),i)}}function a(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{J4zT:function(t,i,o){"use strict";o.r(i),o.d(i,"GroupModule",(function(){return ct}));var c,l,s,b,d,p=o("2kYt"),f=o("vobO"),m=o("OZ4H"),v=o("Jb3d"),g=o("lQ7A"),h=o("OWX3"),O=o("PCNd"),S=o("nIj0"),T=o("jdnZ"),y=o("29Wa"),C=o("Cd2c"),B=o("66mq"),I=o("R7+U"),k=o("W1gw"),N=o("Y2X+"),P=o("EM62"),R=((l=a((function e(){u(this,e)}))).\u0275mod=P.Lb({type:l}),l.\u0275inj=P.Kb({factory:function(e){return new(e||l)},imports:[[p.c,p.c,S.v,I.b,N.b,h.xb]]}),l),M=((c=a((function e(){u(this,e)}))).\u0275mod=P.Lb({type:c}),c.\u0275inj=P.Kb({factory:function(e){return new(e||c)},imports:[[p.c,O.a,T.c,y.d,C.c,B.b,I.b,k.c,S.v,m.f,h.xb,R]]}),c),E=o("mFH5"),j=o("csyo"),A=o("sEIs"),U=((s=a((function e(){u(this,e)}))).\u0275mod=P.Lb({type:s}),s.\u0275inj=P.Kb({factory:function(e){return new(e||s)},imports:[[p.c,O.a,A.g,E.q,j.a,h.xb]]}),s),w=o("KZIX"),x=((b=a((function e(){u(this,e)}))).\u0275mod=P.Lb({type:b}),b.\u0275inj=P.Kb({factory:function(e){return new(e||b)},imports:[[p.c,O.a,A.g,v.b,w.c,N.b,B.b,S.v,h.xb,R]]}),b),D=o("bWz1"),L=o("g6G6"),F=o("ROBh"),_=o("mWib"),G=o("YtkY"),V=o("xVbo"),H=o("TLy2"),q=o("4e/d"),K=o("6WTZ"),Q=o("8lHc"),z=o("J+dc"),W=((d=a((function e(t){var n=this;u(this,e),this.groupService=t,this.debounceTime=400,this.nameExists=function(e,t){return function(i){return Object(Q.a)(n.debounceTime).pipe(Object(H.a)((function(){return i.value!==t?n.groupService.exists(e,i.value):Object(F.a)(!1)})),Object(z.a)(1),Object(G.a)((function(e){return e?{nameExists:!0}:null})))}},this.unitExists=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return function(i){return Object(Q.a)(n.debounceTime).pipe(Object(H.a)((function(){var r;return(null===(r=i.value)||void 0===r?void 0:r.trim())?t.includes(i.value)?Object(F.a)(!1):n.groupService.unitExists(e,i.value.trim()):Object(F.a)(!1)})),Object(z.a)(1),Object(G.a)((function(e){return e?{unitExists:!0}:null})))}}}))).\u0275fac=function(e){return new(e||d)(P.bc(D.a))},d.\u0275prov=P.Jb({token:d,factory:d.\u0275fac,providedIn:"root"}),d),X=o("IrDo"),Y=o("s2Ay");function J(e,t){1&e&&(P.Tb(0,"vitamui-common-input-error"),P.Oc(1),P.jc(2,"translate"),P.Sb()),2&e&&(P.Bb(1),P.Qc(" ",P.kc(2,1,"GROUP.UNITS_FORM.UNIT_ALREADY_EXIST")," "))}function Z(e,t){1&e&&(P.Tb(0,"vitamui-common-input-error"),P.Oc(1),P.jc(2,"translate"),P.Sb()),2&e&&(P.Bb(1),P.Qc(" ",P.kc(2,1,"GROUP.UNITS_FORM.UNIT_ALREADY_ADDED")," "))}function $(e,t){if(1&e&&(P.Rb(0),P.Mc(1,J,3,3,"vitamui-common-input-error",3),P.Mc(2,Z,3,3,"vitamui-common-input-error",3),P.Qb()),2&e){var n=P.ic();P.Bb(1),P.oc("ngIf",!(null==n.unitControl||null==n.unitControl.errors||!n.unitControl.errors.unitExists)),P.Bb(1),P.oc("ngIf",!(null==n.unitControl||null==n.unitControl.errors||!n.unitControl.errors.unitAlreadyAdd))}}function ee(e,t){if(1&e){var n=P.Ub();P.Tb(0,"div",9),P.Tb(1,"div",10),P.Tb(2,"div",11),P.Oc(3),P.Sb(),P.Tb(4,"div",12),P.Tb(5,"button",13),P.ec("click",(function(){P.Dc(n);var e=t.$implicit;return P.ic().remove(e)})),P.Tb(6,"i",14),P.Oc(7,"clear"),P.Sb(),P.Sb(),P.Sb(),P.Sb(),P.Sb()}if(2&e){var i=t.$implicit;P.Bb(3),P.Pc(i)}}var te,ne,ie={provide:S.o,useExisting:Object(P.V)((function(){return re})),multi:!0},re=((ne=function(){function e(t){u(this,e),this.groupValidators=t,this.units=[],this.removedUnits=[],this.onChange=function(e){},this.onTouched=function(){}}return a(e,[{key:"writeValue",value:function(e){this.units=e||[]}},{key:"registerOnChange",value:function(e){this.onChange=e}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"ngOnInit",value:function(){this.unitControl=new S.e("",[this.unitAlreadyAdd.bind(this)],this.groupValidators.unitExists(this.customer,this.removedUnits))}},{key:"add",value:function(){var e=this.unitControl.value;if(e&&!this.unitControl.pending&&!this.unitControl.invalid){this.unitControl.reset(),e=e.trim();var t=this.removedUnits.indexOf(e);t>-1&&this.removedUnits.splice(t,1),this.units.push(e),this.sortUnits(),this.onChange(this.units)}}},{key:"remove",value:function(e){this.removedUnits.push(e),this.units=this.units.filter((function(t){return t!==e})),this.onChange(this.units)}},{key:"sortUnits",value:function(){this.units.sort((function(e,t){return e.localeCompare(t)}))}},{key:"unitAlreadyAdd",value:function(e){var t=e.value;return t&&this.units.map((function(e){return e.toLocaleLowerCase()})).includes(t.trim().toLocaleLowerCase())?{unitAlreadyAdd:!0}:null}}]),e}()).\u0275fac=function(e){return new(e||ne)(P.Nb(W))},ne.\u0275cmp=P.Hb({type:ne,selectors:[["app-units-form"]],inputs:{customer:"customer"},features:[P.Ab([ie])],decls:14,vars:10,consts:[[1,"d-flex","align-items-center","mb-3"],[1,"mb-9"],[1,"col-12","p-0",3,"formControl","placeholder","keydown.enter"],[4,"ngIf"],[1,"d-flex","flex-column","align-items-center","justify-content-center"],["type","button",1,"btn","primary",3,"disabled","click"],[1,"vitamui-table","mt-2"],[1,"vitamui-table-body"],["class","vitamui-table-rows",4,"ngFor","ngForOf"],[1,"vitamui-table-rows"],[1,"vitamui-row","d-flex","align-items-center"],["vitamuiCommonEllipsis","",1,"col-11"],[1,"col-1"],[1,"btn","link",3,"click"],[1,"material-icons"]],template:function(e,t){1&e&&(P.Tb(0,"div",0),P.Tb(1,"div"),P.Tb(2,"div",1),P.Tb(3,"vitamui-common-input",2),P.ec("keydown.enter",(function(){return t.add()})),P.jc(4,"translate"),P.Mc(5,$,3,2,"ng-container",3),P.Sb(),P.Sb(),P.Sb(),P.Tb(6,"div"),P.Tb(7,"div",4),P.Tb(8,"button",5),P.ec("click",(function(){return t.add()})),P.Oc(9),P.jc(10,"translate"),P.Sb(),P.Sb(),P.Sb(),P.Sb(),P.Tb(11,"div",6),P.Tb(12,"div",7),P.Mc(13,ee,8,1,"div",8),P.Sb(),P.Sb()),2&e&&(P.Bb(3),P.oc("formControl",t.unitControl)("placeholder",P.kc(4,6,"GROUP.UNITS_FORM.INPUT_PLACEHOLDER")),P.Bb(2),P.oc("ngIf",null==t.unitControl?null:t.unitControl.touched),P.Bb(3),P.oc("disabled",!(null!=t.unitControl&&null!=t.unitControl.value&&t.unitControl.value.trim())||t.unitControl.invalid),P.Bb(1),P.Qc(" ",P.kc(10,8,"COMMON.ADD")," "),P.Bb(4),P.oc("ngForOf",t.units))},directives:[h.Qb,S.q,S.f,p.p,p.o,h.Rb,h.Zb],pipes:[Y.d],styles:[".d-flex[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-of-type{width:65%}.d-flex[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-of-type > div[_ngcontent-%COMP%]{height:60px}.d-flex[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-of-type{width:25%}"]}),ne),oe=((te=function(){function e(t,n,i,r,o){u(this,e),this.dialogRef=t,this.data=n,this.groupService=i,this.confirmDialogService=r,this.form=o.group({units:[this.data.group.units]})}return a(e,[{key:"ngOnInit",value:function(){var e=this;this.keyPressSubscription=this.confirmDialogService.listenToEscapeKeyPress(this.dialogRef).subscribe((function(){return e.onCancel()}))}},{key:"ngOnDestroy",value:function(){this.keyPressSubscription.unsubscribe()}},{key:"onSubmit",value:function(){var e=this;this.form.pristine||this.form.invalid||this.groupService.patch({id:this.data.group.id,units:this.form.value.units}).pipe(Object(z.a)(1)).subscribe((function(t){return e.dialogRef.close(t)}),(function(e){console.error(e)}))}},{key:"onCancel",value:function(){this.form.dirty?this.confirmDialogService.confirmBeforeClosing(this.dialogRef):this.dialogRef.close()}}]),e}()).\u0275fac=function(e){return new(e||te)(P.Nb(m.g),P.Nb(m.a),P.Nb(D.a),P.Nb(h.t),P.Nb(S.d))},te.\u0275cmp=P.Hb({type:te,selectors:[["app-units-edit"]],decls:17,vars:14,consts:[[1,"header"],["count","1",3,"index"],[3,"formGroup","ngSubmit"],[1,"content"],[1,"text","large","bold"],["formControlName","units",3,"customer"],[1,"actions"],["type","submit",1,"btn","primary",3,"disabled"],["type","button",1,"btn","cancel","link",3,"click"]],template:function(e,t){1&e&&(P.Tb(0,"div",0),P.Ob(1,"vitamui-common-progress-bar",1),P.Sb(),P.Tb(2,"form",2),P.ec("ngSubmit",(function(){return t.onSubmit()})),P.Tb(3,"vitamui-common-stepper"),P.Tb(4,"cdk-step"),P.Tb(5,"div",3),P.Tb(6,"div",4),P.Oc(7),P.jc(8,"translate"),P.Sb(),P.Ob(9,"app-units-form",5),P.Tb(10,"div",6),P.Tb(11,"button",7),P.Oc(12),P.jc(13,"translate"),P.Sb(),P.Tb(14,"button",8),P.ec("click",(function(){return t.onCancel()})),P.Oc(15),P.jc(16,"translate"),P.Sb(),P.Sb(),P.Sb(),P.Sb(),P.Sb(),P.Sb()),2&e&&(P.Bb(1),P.oc("index",0),P.Bb(1),P.oc("formGroup",t.form),P.Bb(5),P.Rc("",P.kc(8,8,"GROUP.INFORMATIONS.MODAL.UPDATE_UNITS"),' "',null==t.data||null==t.data.group?null:t.data.group.name,'"'),P.Bb(2),P.oc("customer",null==t.data||null==t.data.group?null:t.data.group.customerId),P.Bb(2),P.oc("disabled",t.form.pristine||t.form.invalid),P.Bb(1),P.Pc(P.kc(13,10,"COMMON.SUBMIT")),P.Bb(3),P.Pc(P.kc(16,12,"COMMON.UNDO")))},directives:[h.dc,S.y,S.r,S.i,h.mb,X.a,re,S.q,S.g],pipes:[Y.d],styles:[""]}),te);function ce(e,t){1&e&&(P.Tb(0,"span"),P.Oc(1),P.jc(2,"translate"),P.Sb()),2&e&&(P.Bb(1),P.Pc(P.kc(2,1,"GROUP.INFORMATIONS.INACTIVE_SWITCH")))}function ae(e,t){1&e&&(P.Tb(0,"span"),P.Oc(1),P.jc(2,"translate"),P.Sb()),2&e&&(P.Bb(1),P.Pc(P.kc(2,1,"GROUP.INFORMATIONS.ACTIVE_SWITCH")))}function le(e,t){if(1&e){var n=P.Ub();P.Tb(0,"button",22),P.ec("click",(function(){return P.Dc(n),P.ic().openEditUnitsDialog()})),P.Oc(1),P.jc(2,"translate"),P.Sb()}2&e&&(P.Bb(1),P.Qc(" ",P.kc(2,1,"GROUP.INFORMATIONS.MODIF_UNITS_BUTTON")," "))}function ue(e,t){if(1&e&&(P.Tb(0,"div",23),P.Oc(1),P.Sb()),2&e){var n=t.$implicit;P.Bb(1),P.Pc(n)}}var se,be,de=((se=function(){function e(t,n,i,r,o){var c=this;u(this,e),this.formBuilder=t,this.groupService=n,this.groupValidators=i,this.authService=r,this.dialog=o,this.form=this.formBuilder.group({id:[null,S.x.required],identifier:[{value:null,disabled:!0},S.x.required],enabled:[!1],name:[null,S.x.required],description:[null,S.x.required],level:[null,Object(h.Gb)(this.authService.user)]}),this.updateSub=Object(L.a)(this.form.valueChanges,this.form.statusChanges).pipe(Object(_.a)(200),Object(G.a)((function(){return Object(h.Ib)(c.form.value,c.previousValue)})),Object(V.a)((function(e){return!Object(K.c)(e)})),Object(G.a)((function(e){return Object(K.a)({id:c.group.id},e)})),Object(H.a)((function(e){return c.groupService.patch(e).pipe(Object(q.a)((function(){return Object(F.a)(null)})))}))).subscribe((function(){return c.previousValue=c.form.value}))}return a(e,[{key:"ngOnChanges",value:function(e){(e.hasOwnProperty("group")||e.hasOwnProperty("readOnly"))&&this.group&&(this.resetForm(this.form,this.group,this.readOnly),this.previousValue=this.form.value)}},{key:"resetForm",value:function(e,t,n){e.reset(t,{emitEvent:!1}),this.initFormValidators(e,t),this.initFormActivationState(e,t,n),e.updateValueAndValidity({emitEvent:!1})}},{key:"initFormValidators",value:function(e,t){e.get("name").setAsyncValidators(this.groupValidators.nameExists(t.customerId,t.name))}},{key:"initFormActivationState",value:function(e,t,n){n?e.disable({emitEvent:!1}):(e.enable({emitEvent:!1}),e.get("identifier").disable({emitEvent:!1}),t.usersCount&&this.form.get("enabled").disable({emitEvent:!1}),t.profileIds&&t.profileIds.length&&this.form.get("level").disable({emitEvent:!1}))}},{key:"ngOnDestroy",value:function(){this.updateSub.unsubscribe()}},{key:"openEditUnitsDialog",value:function(){this.dialog.open(oe,{data:{group:this.group},autoFocus:!1,disableClose:!0,panelClass:"vitamui-modal"})}},{key:"getUnits",value:function(e){var t;return null===(t=null==e?void 0:e.units)||void 0===t?void 0:t.sort((function(e,t){return e.localeCompare(t)}))}}]),e}()).\u0275fac=function(e){return new(e||se)(P.Nb(S.d),P.Nb(D.a),P.Nb(W),P.Nb(h.k),P.Nb(m.b))},se.\u0275cmp=P.Hb({type:se,selectors:[["app-information-tab"]],inputs:{group:"group",readOnly:"readOnly"},features:[P.zb],decls:53,vars:55,consts:[[3,"formGroup"],["clas","row"],["formControlName","enabled","matTooltipClass","vitamui-tooltip",3,"matTooltip","matTooltipDisabled"],[4,"ngIf"],[1,"row"],[1,"col-8","form-control"],["formControlName","identifier",3,"label","validator","asyncValidator"],["formControlName","name","minlength","2","maxlength","100",3,"label","validator","asyncValidator"],["errorKey","required"],["errorKey","nameExists"],[1,"col-12","form-control"],["formControlName","description","maxlength","250","minlength","4","maxlength","100",3,"label","validator","asyncValidator"],[1,"row","d-flex"],[1,"col-5"],[1,"read-only-field"],["matTooltipClass","vitamui-tooltip",1,"col-7",3,"matTooltip","matTooltipDisabled"],["formControlName","level","maxlength","250",3,"prefix","label","validator"],[1,"vitamui-separator"],["class","btn primary mb-3",3,"click",4,"ngIf"],[1,"align-items-center"],[1,"text","small","primary","mb-2"],["class","text medium",4,"ngFor","ngForOf"],[1,"btn","primary","mb-3",3,"click"],[1,"text","medium"]],template:function(e,t){if(1&e&&(P.Tb(0,"form",0),P.Tb(1,"div",1),P.Tb(2,"vitamui-common-slide-toggle",2),P.jc(3,"translate"),P.Mc(4,ce,3,3,"span",3),P.Mc(5,ae,3,3,"span",3),P.Sb(),P.Sb(),P.Tb(6,"div",4),P.Tb(7,"div",5),P.Ob(8,"vitamui-common-editable-input",6),P.jc(9,"translate"),P.Sb(),P.Sb(),P.Tb(10,"div",4),P.Tb(11,"div",5),P.Tb(12,"vitamui-common-editable-input",7),P.jc(13,"translate"),P.Tb(14,"vitamui-common-field-error",8),P.Oc(15),P.jc(16,"translate"),P.Sb(),P.Tb(17,"vitamui-common-field-error",9),P.Oc(18),P.jc(19,"translate"),P.Sb(),P.Sb(),P.Sb(),P.Sb(),P.Tb(20,"div",4),P.Tb(21,"div",10),P.Tb(22,"vitamui-common-editable-textarea",11),P.jc(23,"translate"),P.Tb(24,"vitamui-common-field-error",8),P.Oc(25),P.jc(26,"translate"),P.Sb(),P.Sb(),P.Sb(),P.Sb(),P.Tb(27,"div",12),P.Tb(28,"div",13),P.Tb(29,"div",14),P.Tb(30,"label"),P.Oc(31),P.jc(32,"translate"),P.Sb(),P.Tb(33,"div"),P.Oc(34),P.Sb(),P.Sb(),P.Sb(),P.Tb(35,"div",15),P.jc(36,"translate"),P.Tb(37,"vitamui-common-editable-level-input",16),P.jc(38,"translate"),P.Tb(39,"vitamui-common-field-error",8),P.Oc(40),P.jc(41,"translate"),P.Sb(),P.Tb(42,"vitamui-common-field-error",9),P.Oc(43),P.jc(44,"translate"),P.Sb(),P.Sb(),P.Sb(),P.Sb(),P.Ob(45,"div",17),P.Tb(46,"div"),P.Mc(47,le,3,3,"button",18),P.Tb(48,"div",19),P.Tb(49,"div",20),P.Oc(50),P.jc(51,"translate"),P.Sb(),P.Mc(52,ue,2,1,"div",21),P.Sb(),P.Sb(),P.Sb()),2&e){var n=null,i=null,r=null,o=null,c=null,a=null,l=null;P.oc("formGroup",t.form),P.Bb(2),P.oc("matTooltip",P.kc(3,29,"GROUP.INFORMATIONS.ACTIVE_SWITCH_TOOLTIP"))("matTooltipDisabled",t.form.get("enabled").enabled||t.readOnly),P.Bb(2),P.oc("ngIf",!(null!=t.form&&t.form.get("enabled").value)),P.Bb(1),P.oc("ngIf",null==t.form?null:t.form.get("enabled").value),P.Bb(3),P.oc("label",P.kc(9,31,"COMMON.ID"))("validator",null==t.form||null==(n=t.form.get("identifier"))?null:n.validator)("asyncValidator",null==t.form||null==(i=t.form.get("identifier"))?null:i.asyncValidator),P.Bb(4),P.oc("label",P.kc(13,33,"GROUP.INFORMATIONS.NAME"))("validator",null==t.form||null==(r=t.form.get("name"))?null:r.validator)("asyncValidator",null==t.form||null==(o=t.form.get("name"))?null:o.asyncValidator),P.Bb(3),P.Pc(P.kc(16,35,"COMMON.ERROR.REQUIRED")),P.Bb(3),P.Pc(P.kc(19,37,"GROUP.INFORMATIONS.EXISTING_NAME")),P.Bb(4),P.oc("label",P.kc(23,39,"GROUP.INFORMATIONS.DESCRIPTION"))("validator",null==t.form||null==(c=t.form.get("description"))?null:c.validator)("asyncValidator",null==t.form||null==(a=t.form.get("description"))?null:a.asyncValidator),P.Bb(3),P.Pc(P.kc(26,41,"COMMON.ERROR.REQUIRED")),P.Bb(6),P.Pc(P.kc(32,43,"GROUP.INFORMATIONS.LEVEL")),P.Bb(3),P.Pc(t.authService.user.level),P.Bb(1),P.oc("matTooltip",P.kc(36,45,"GROUP.INFORMATIONS.SUBLEVEL_TOOLTIP"))("matTooltipDisabled",(null==t.form?null:t.form.get("level").enabled)||t.readOnly),P.Bb(2),P.oc("prefix",t.authService.user.level)("label",P.kc(38,47,"GROUP.INFORMATIONS.SUBLEVEL"))("validator",null==t.form||null==(l=t.form.get("level"))?null:l.validator),P.Bb(3),P.Pc(P.kc(41,49,"COMMON.ERROR.REQUIRED")),P.Bb(3),P.Pc(P.kc(44,51,"GROUP.INFORMATIONS.WRONG_FORMAT")),P.Bb(4),P.oc("ngIf",!t.readOnly),P.Bb(3),P.Pc(P.kc(51,53,"GROUP.INFORMATIONS.UNITS_TABLE_TITLE")),P.Bb(2),P.oc("ngForOf",t.getUnits(t.group))}},directives:[S.y,S.r,S.i,h.ac,S.q,S.g,N.a,p.p,h.F,S.m,S.l,h.zb,h.J,h.G,p.o],pipes:[Y.d],styles:[""]}),se),pe=o("nrt1"),fe=((be=function(){function e(t,n,i,r,o){u(this,e),this.dialogRef=t,this.data=n,this.groupService=i,this.confirmDialogService=r,this.stepIndex=0,this.stepCount=1,this.form=o.group({profileIds:[this.data.group.profileIds,S.x.required]})}return a(e,[{key:"ngOnInit",value:function(){var e=this;this.keyPressSubscription=this.confirmDialogService.listenToEscapeKeyPress(this.dialogRef).subscribe((function(){return e.onCancel()}))}},{key:"ngOnDestroy",value:function(){this.keyPressSubscription.unsubscribe()}},{key:"onSubmit",value:function(){var e=this;this.form.pristine||this.form.invalid||this.groupService.patch({id:this.data.group.id,profileIds:this.form.value.profileIds}).subscribe((function(t){return e.dialogRef.close(t)}),(function(e){console.error(e)}))}},{key:"onCancel",value:function(){this.form.dirty?this.confirmDialogService.confirmBeforeClosing(this.dialogRef):this.dialogRef.close()}}]),e}()).\u0275fac=function(e){return new(e||be)(P.Nb(m.g),P.Nb(m.a),P.Nb(D.a),P.Nb(h.t),P.Nb(S.d))},be.\u0275cmp=P.Hb({type:be,selectors:[["app-profiles-edit"]],decls:17,vars:15,consts:[[1,"header"],[3,"index","count"],[3,"formGroup","ngSubmit"],[3,"selectionChange"],[1,"content"],[1,"text","large","bold"],["formControlName","profileIds",3,"level"],[1,"actions"],["type","submit",1,"btn","primary",3,"disabled"],["type","button",1,"btn","cancel","link",3,"click"]],template:function(e,t){1&e&&(P.Tb(0,"div",0),P.Ob(1,"vitamui-common-progress-bar",1),P.Sb(),P.Tb(2,"form",2),P.ec("ngSubmit",(function(){return t.onSubmit()})),P.Tb(3,"vitamui-common-stepper",3),P.ec("selectionChange",(function(e){return t.stepIndex=e.selectedIndex})),P.Tb(4,"cdk-step"),P.Tb(5,"div",4),P.Tb(6,"div",5),P.Oc(7),P.jc(8,"translate"),P.Sb(),P.Ob(9,"app-profiles-form",6),P.Tb(10,"div",7),P.Tb(11,"button",8),P.Oc(12),P.jc(13,"translate"),P.Sb(),P.Tb(14,"button",9),P.ec("click",(function(){return t.onCancel()})),P.Oc(15),P.jc(16,"translate"),P.Sb(),P.Sb(),P.Sb(),P.Sb(),P.Sb(),P.Sb()),2&e&&(P.Bb(1),P.oc("index",t.stepIndex)("count",t.stepCount),P.Bb(1),P.oc("formGroup",t.form),P.Bb(5),P.Rc("",P.kc(8,9,"GROUP.PROFILE.MODAL.TITLE"),' "',null==t.data||null==t.data.group?null:t.data.group.name,'"'),P.Bb(2),P.oc("level",null==t.data||null==t.data.group?null:t.data.group.level),P.Bb(2),P.oc("disabled",t.form.pristine||t.form.invalid),P.Bb(1),P.Pc(P.kc(13,11,"COMMON.SUBMIT")),P.Bb(3),P.Pc(P.kc(16,13,"COMMON.UNDO")))},directives:[h.dc,S.y,S.r,S.i,h.mb,X.a,pe.a,S.q,S.g],pipes:[Y.d],styles:[""]}),be);function me(e,t){if(1&e){var n=P.Ub();P.Tb(0,"button",2),P.ec("click",(function(){return P.Dc(n),P.ic().openEditProfilesDialog()})),P.Oc(1),P.jc(2,"translate"),P.Sb()}2&e&&(P.Bb(1),P.Qc(" ",P.kc(2,1,"COMMON.UPDATE"),"\n"))}function ve(e,t){if(1&e&&(P.Tb(0,"div",3),P.Tb(1,"div"),P.Tb(2,"div",4),P.Oc(3),P.jc(4,"translate"),P.Sb(),P.Tb(5,"div",5),P.Oc(6),P.jc(7,"titlecase"),P.Sb(),P.Sb(),P.Tb(8,"div"),P.Ob(9,"i",6),P.jc(10,"translate"),P.Sb(),P.Sb()),2&e){var n=t.$implicit;P.Bb(3),P.Pc(P.kc(4,4,"APPLICATION."+n.appId+".NAME")),P.Bb(3),P.Rc("",null==n?null:n.tenantName," : ",P.kc(7,6,null==n?null:n.profileName),""),P.Bb(3),P.oc("matTooltip",null!=n&&n.description?n.description:P.kc(10,8,"MISC.NO_DESC"))}}var ge,he,Oe,Se,Te=((Se=function(){function e(t,n){u(this,e),this.dialog=t,this.groupService=n}return a(e,[{key:"ngOnInit",value:function(){var e,t=this;this.initializeProfilesList(null===(e=this.group)||void 0===e?void 0:e.profiles),this.updatedGroup=this.groupService.updated.subscribe((function(e){var n;t.group=e,t.initializeProfilesList(null===(n=t.group)||void 0===n?void 0:n.profiles)}))}},{key:"initializeProfilesList",value:function(e){var t=this;this.profilesDisplay=[],e&&(e.forEach((function(e){return t.profilesDisplay.push({id:e.id,appId:e.applicationName,tenantName:e.tenantName,profileName:e.name,description:e.description})})),this.profilesDisplay.sort((function(e,t){return e.appName>t.appName?1:t.appName>e.appName?-1:0})))}},{key:"openEditProfilesDialog",value:function(){this.dialog.open(fe,{data:{group:this.group},autoFocus:!1,disableClose:!0,panelClass:"vitamui-modal"})}},{key:"ngOnDestroy",value:function(){this.updatedGroup.unsubscribe()}}]),e}()).\u0275fac=function(e){return new(e||Se)(P.Nb(m.b),P.Nb(D.a))},Se.\u0275cmp=P.Hb({type:Se,selectors:[["app-profiles-tab"]],inputs:{group:"group",readOnly:"readOnly"},decls:2,vars:2,consts:[["class","btn primary mb-3",3,"click",4,"ngIf"],["class","d-flex justify-content-between align-items-center p-3 mb-2 vitamui-profile-list",4,"ngFor","ngForOf"],[1,"btn","primary","mb-3",3,"click"],[1,"d-flex","justify-content-between","align-items-center","p-3","mb-2","vitamui-profile-list"],[1,"text","caption","spaced","light","mb-1"],[1,"text","medium"],["matTooltipClass","vitamui-tooltip",1,"vitamui-icon","vitamui-icon-info","primary","clickable",3,"matTooltip"]],template:function(e,t){1&e&&(P.Mc(0,me,3,3,"button",0),P.Mc(1,ve,11,10,"div",1)),2&e&&(P.oc("ngIf",!t.readOnly),P.Bb(1),P.oc("ngForOf",t.profilesDisplay))},directives:[p.p,p.o,N.a],pipes:[Y.d,p.y],styles:[""]}),Se),ye=((Oe=function(){function e(t,n,i){u(this,e),this.groupService=t,this.authService=n,this.startupService=i,this.previewClose=new P.n}return a(e,[{key:"ngOnInit",value:function(){var e=this;this.group&&this.groupService.get(this.group.id).subscribe((function(t){e.group=t,e.groupService.updated.next(t)})),this.groupUpdateSub=this.groupService.updated.subscribe((function(t){t&&(e.group=t)}))}},{key:"ngOnChanges",value:function(e){var t=this;e.hasOwnProperty("group")&&this.group&&this.groupService.get(this.group.id).subscribe((function(e){t.group=e,t.groupService.updated.next(e)}))}},{key:"openPopup",value:function(){window.open(this.startupService.getConfigStringValue("UI_URL")+"/group/"+this.group.id,"detailPopup","width=584, height=713, resizable=no, location=no"),this.emitClose()}},{key:"levelNotAllowed",value:function(){if(this.group)return!Object(h.Kb)(this.authService.user,this.group.level)}},{key:"emitClose",value:function(){this.previewClose.emit()}},{key:"ngOnDestroy",value:function(){this.groupUpdateSub.unsubscribe()}},{key:"filterEvents",value:function(e){return e.outDetail&&(e.outDetail.includes("EXT_VITAMUI_CREATE_GROUP")||e.outDetail.includes("EXT_VITAMUI_UPDATE_GROUP"))}}]),e}()).\u0275fac=function(e){return new(e||Oe)(P.Nb(D.a),P.Nb(h.k),P.Nb(h.lb))},Oe.\u0275cmp=P.Hb({type:Oe,selectors:[["app-group-preview"]],inputs:{isPopup:"isPopup",group:"group"},outputs:{previewClose:"previewClose"},features:[P.zb],decls:12,vars:19,consts:[[3,"title","icon","badge","onclose"],[1,"vitamui-sidepanel-body"],[1,"preview-tab-group"],[3,"label"],[3,"group","readOnly"],["collectionName","groups",3,"id","identifier","filter"]],template:function(e,t){1&e&&(P.Tb(0,"vitamui-common-sidenav-header",0),P.ec("onclose",(function(){return t.emitClose()})),P.Sb(),P.Tb(1,"div",1),P.Tb(2,"mat-tab-group",2),P.Tb(3,"mat-tab",3),P.jc(4,"translate"),P.Ob(5,"app-information-tab",4),P.Sb(),P.Tb(6,"mat-tab",3),P.jc(7,"translate"),P.Ob(8,"app-profiles-tab",4),P.Sb(),P.Tb(9,"mat-tab",3),P.jc(10,"translate"),P.Ob(11,"vitamui-common-operation-history-tab",5),P.Sb(),P.Sb(),P.Sb()),2&e&&(P.oc("title",null==t.group?null:t.group.name)("icon","vitamui-icon-keys")("badge",null!=t.group&&t.group.enabled?"green":"grey"),P.Bb(3),P.oc("label",P.kc(4,13,"GROUP.TAB.INFORMATIONS")),P.Bb(2),P.oc("group",t.group)("readOnly",t.isPopup||(null==t.group?null:t.group.readonly)||t.levelNotAllowed()),P.Bb(1),P.oc("label",P.kc(7,15,"GROUP.TAB.PROFILE")),P.Bb(2),P.oc("group",t.group)("readOnly",t.isPopup||(null==t.group?null:t.group.readonly)||t.levelNotAllowed()),P.Bb(1),P.oc("label",P.kc(10,17,"GROUP.TAB.HISTORY")),P.Bb(2),P.oc("id",null==t.group?null:t.group.id)("identifier",null==t.group?null:t.group.identifier)("filter",t.filterEvents))},directives:[h.mc,w.b,w.a,de,Te,h.Xb],pipes:[Y.d],styles:[""]}),Oe),Ce=((he=function(){function e(t){u(this,e),this.route=t,this.group=this.route.snapshot.data.group}return a(e,[{key:"ngOnInit",value:function(){}},{key:"closePopup",value:function(){window.close()}}]),e}()).\u0275fac=function(e){return new(e||he)(P.Nb(A.a))},he.\u0275cmp=P.Hb({type:he,selectors:[["app-group-popup"]],decls:1,vars:2,consts:[[3,"group","isPopup","previewClose"]],template:function(e,t){1&e&&(P.Tb(0,"app-group-preview",0),P.ec("previewClose",(function(){return t.closePopup()})),P.Sb()),2&e&&P.oc("group",t.group)("isPopup",!0)},directives:[ye],encapsulation:2}),he),Be=((ge=function(){function e(t,n){u(this,e),this.groupService=t,this.router=n}return a(e,[{key:"resolve",value:function(e){var t=this,n=e.paramMap.get("id");return this.groupService.get(n).pipe(Object(z.a)(1),Object(G.a)((function(e){return e||(t.router.navigate(["/"]),null)})))}}]),e}()).\u0275fac=function(e){return new(e||ge)(P.bc(D.a),P.bc(A.d))},ge.\u0275prov=P.Jb({token:ge,factory:ge.\u0275fac,providedIn:"root"}),ge);function Ie(e,t){1&e&&(P.Tb(0,"span"),P.Oc(1),P.jc(2,"translate"),P.Sb()),2&e&&(P.Bb(1),P.Pc(P.kc(2,1,"GROUP.INFORMATIONS.INACTIVE_SWITCH")))}function ke(e,t){1&e&&(P.Tb(0,"span"),P.Oc(1),P.jc(2,"translate"),P.Sb()),2&e&&(P.Bb(1),P.Pc(P.kc(2,1,"GROUP.INFORMATIONS.ACTIVE_SWITCH")))}function Ne(e,t){1&e&&(P.Tb(0,"vitamui-common-input-error"),P.Oc(1),P.jc(2,"translate"),P.Sb()),2&e&&(P.Bb(1),P.Pc(P.kc(2,1,"COMMON.ERROR.REQUIRED")))}function Pe(e,t){1&e&&(P.Tb(0,"vitamui-common-input-error"),P.Oc(1),P.jc(2,"translate"),P.Sb()),2&e&&(P.Bb(1),P.Pc(P.kc(2,1,"GROUP.INFORMATIONS.MODAL.EXISTING_NAME")))}function Re(e,t){if(1&e&&(P.Rb(0),P.Mc(1,Ne,3,3,"vitamui-common-input-error",7),P.Mc(2,Pe,3,3,"vitamui-common-input-error",7),P.Qb()),2&e){var n,i=P.ic(),r=null;P.Bb(1),P.oc("ngIf",!(null==(n=i.form.get("name"))||null==n.errors||!n.errors.required)),P.Bb(1),P.oc("ngIf",!(null==i.form||null==(r=i.form.get("name"))||null==r.errors||!r.errors.nameExists))}}function Me(e,t){1&e&&(P.Tb(0,"vitamui-common-input-error"),P.Oc(1),P.jc(2,"translate"),P.Sb()),2&e&&(P.Bb(1),P.Pc(P.kc(2,1,"COMMON.ERROR.REQUIRED")))}function Ee(e,t){1&e&&(P.Tb(0,"vitamui-common-input-error"),P.Oc(1),P.jc(2,"translate"),P.Sb()),2&e&&(P.Bb(1),P.Pc(P.kc(2,1,"COMMON.ERROR.REQUIRED")))}function je(e,t){1&e&&(P.Tb(0,"vitamui-common-input-error"),P.Oc(1),P.jc(2,"translate"),P.Sb()),2&e&&(P.Bb(1),P.Qc("",P.kc(2,1,"GROUP.INFORMATIONS.MODAL.WRONG_FORMAT")," "))}function Ae(e,t){if(1&e&&(P.Rb(0),P.Mc(1,Ee,3,3,"vitamui-common-input-error",7),P.Mc(2,je,3,3,"vitamui-common-input-error",7),P.Qb()),2&e){var n=P.ic(),i=null,r=null;P.Bb(1),P.oc("ngIf",null==n.form||null==(i=n.form.get("level"))?null:i.hasError("required")),P.Bb(1),P.oc("ngIf",(null==n.form||null==(r=n.form.get("level"))?null:r.touched)&&(null==n.form||null==(r=n.form.get("level"))?null:r.hasError("pattern")))}}function Ue(e,t){if(1&e&&(P.Tb(0,"div",28),P.Oc(1),P.jc(2,"translate"),P.Sb()),2&e){var n=P.ic();P.Bb(1),P.Rc(" ",P.kc(2,2,"GROUP.INFORMATIONS.LEVEL")," : ",n.form.get("level").value," ")}}var we,xe=function(e){return{"mb-0":e}},De=((we=function(){function e(t,n,i,r,o,c,a){u(this,e),this.dialogRef=t,this.data=n,this.authService=i,this.formBuilder=r,this.groupService=o,this.groupValidators=c,this.confirmDialogService=a,this.stepIndex=0,this.stepCount=3}return a(e,[{key:"ngOnInit",value:function(){var e=this;this.form=this.formBuilder.group({name:[null,S.x.required,this.groupValidators.nameExists(this.authService.user.customerId)],enabled:[!0],level:["",Object(h.Gb)(this.authService.user)],description:[null,S.x.required],profileIds:[null,S.x.required],customerId:[this.authService.user.customerId],units:[null]}),this.keyPressSubscription=this.confirmDialogService.listenToEscapeKeyPress(this.dialogRef).subscribe((function(){return e.onCancel()}))}},{key:"ngOnDestroy",value:function(){this.keyPressSubscription.unsubscribe()}},{key:"onCancel",value:function(){this.form.dirty?this.confirmDialogService.confirmBeforeClosing(this.dialogRef):this.dialogRef.close()}},{key:"onSubmit",value:function(){var e=this;this.form.invalid||this.groupService.create(this.form.getRawValue()).subscribe((function(){return e.dialogRef.close(!0)}),(function(e){console.error(e)}))}},{key:"firstStepInvalid",value:function(){return this.form.get("name").invalid||this.form.get("description").invalid||this.form.get("level").invalid}},{key:"secondStepInvalid",value:function(){return this.form.get("profileIds").invalid}},{key:"formValid",value:function(){return this.form.pending||this.form.invalid}}]),e}()).\u0275fac=function(e){return new(e||we)(P.Nb(m.g),P.Nb(m.a),P.Nb(h.k),P.Nb(S.d),P.Nb(D.a),P.Nb(W),P.Nb(h.t))},we.\u0275cmp=P.Hb({type:we,selectors:[["app-group-create"]],decls:76,vars:62,consts:[[1,"header"],[3,"index","count"],[3,"formGroup","ngSubmit","keydown.enter"],[3,"selectionChange"],[1,"content"],[1,"text","large","bold"],["formControlName","enabled"],[4,"ngIf"],[1,"mt-3"],["formControlName","name","minlength","2","maxlength","100","required","",1,"col-5","p-0",3,"placeholder"],["formControlName","description","minlength","4","maxlength","100","required","",1,"col-10","p-0",3,"placeholder"],[1,"d-flex"],[1,"mr-4","p-2"],[1,"text","normal","light"],[1,"text","medium","bold"],[1,"col-3","p-0"],["formControlName","level",3,"prefix"],[1,"actions"],["type","button","cdkStepperNext","",1,"btn","primary",3,"disabled"],["type","button",1,"btn","cancel","link",3,"click"],[1,"text","large","bold",3,"ngClass"],["class","text medium bold mb-4",4,"ngIf"],["formControlName","profileIds",3,"level"],["type","button","cdkStepperPrevious","",1,"btn","link"],[1,"vitamui-icon","vitamui-icon-chevron-left"],[1,"underline"],["formControlName","units",3,"customer"],["type","submit",1,"btn","primary",3,"disabled"],[1,"text","medium","bold","mb-4"]],template:function(e,t){if(1&e&&(P.Tb(0,"div",0),P.Ob(1,"vitamui-common-progress-bar",1),P.Sb(),P.Tb(2,"form",2),P.ec("ngSubmit",(function(){return t.onSubmit()}))("keydown.enter",(function(e){return e.preventDefault()})),P.Tb(3,"vitamui-common-stepper",3),P.ec("selectionChange",(function(e){return t.stepIndex=e.selectedIndex})),P.Tb(4,"cdk-step"),P.Tb(5,"div",4),P.Tb(6,"div",5),P.Oc(7),P.jc(8,"translate"),P.Sb(),P.Tb(9,"vitamui-common-slide-toggle",6),P.Mc(10,Ie,3,3,"span",7),P.Mc(11,ke,3,3,"span",7),P.Sb(),P.Tb(12,"div",8),P.Tb(13,"vitamui-common-input",9),P.jc(14,"translate"),P.Mc(15,Re,3,2,"ng-container",7),P.Sb(),P.Sb(),P.Tb(16,"div"),P.Tb(17,"vitamui-common-input",10),P.jc(18,"translate"),P.Mc(19,Me,3,3,"vitamui-common-input-error",7),P.Sb(),P.Sb(),P.Tb(20,"div",11),P.Tb(21,"div",12),P.Tb(22,"div",13),P.Oc(23),P.jc(24,"translate"),P.Sb(),P.Tb(25,"div",14),P.Oc(26),P.Sb(),P.Sb(),P.Tb(27,"div",15),P.Tb(28,"vitamui-common-level-input",16),P.Mc(29,Ae,3,2,"ng-container",7),P.Sb(),P.Sb(),P.Sb(),P.Tb(30,"div",17),P.Tb(31,"button",18),P.Oc(32),P.jc(33,"translate"),P.Sb(),P.Tb(34,"button",19),P.ec("click",(function(){return t.onCancel()})),P.Oc(35),P.jc(36,"translate"),P.Sb(),P.Sb(),P.Sb(),P.Sb(),P.Tb(37,"cdk-step"),P.Tb(38,"div",4),P.Tb(39,"div",20),P.Oc(40),P.jc(41,"translate"),P.Sb(),P.Mc(42,Ue,3,4,"div",21),P.Ob(43,"app-profiles-form",22),P.Tb(44,"div",17),P.Tb(45,"button",18),P.Oc(46),P.jc(47,"translate"),P.Sb(),P.Tb(48,"button",19),P.ec("click",(function(){return t.onCancel()})),P.Oc(49),P.jc(50,"translate"),P.Sb(),P.Sb(),P.Tb(51,"button",23),P.Ob(52,"i",24),P.Rb(53),P.Tb(54,"span",25),P.Oc(55),P.jc(56,"translate"),P.Sb(),P.Qb(),P.Sb(),P.Sb(),P.Sb(),P.Tb(57,"cdk-step"),P.Tb(58,"div",4),P.Tb(59,"div",5),P.Oc(60),P.jc(61,"translate"),P.Sb(),P.Ob(62,"app-units-form",26),P.Tb(63,"div",17),P.Tb(64,"button",27),P.Oc(65),P.jc(66,"translate"),P.Sb(),P.Tb(67,"button",19),P.ec("click",(function(){return t.onCancel()})),P.Oc(68),P.jc(69,"translate"),P.Sb(),P.Sb(),P.Tb(70,"button",23),P.Ob(71,"i",24),P.Rb(72),P.Tb(73,"span",25),P.Oc(74),P.jc(75,"translate"),P.Sb(),P.Qb(),P.Sb(),P.Sb(),P.Sb(),P.Sb(),P.Sb()),2&e){var n,i,r=null;P.Bb(1),P.oc("index",t.stepIndex)("count",t.stepCount),P.Bb(1),P.oc("formGroup",t.form),P.Bb(5),P.Pc(P.kc(8,32,"GROUP.INFORMATIONS.MODAL.TITLE")),P.Bb(3),P.oc("ngIf",!(null!=t.form&&t.form.get("enabled").value)),P.Bb(1),P.oc("ngIf",null==t.form?null:t.form.get("enabled").value),P.Bb(2),P.oc("placeholder",P.kc(14,34,"GROUP.INFORMATIONS.NAME")),P.Bb(2),P.oc("ngIf",null==(n=t.form.get("name"))?null:n.touched),P.Bb(2),P.oc("placeholder",P.kc(18,36,"GROUP.INFORMATIONS.DESCRIPTION")),P.Bb(2),P.oc("ngIf",(null==(r=t.form.get("description"))?null:r.touched)&&(null==(r=t.form.get("description"))?null:r.hasError("required"))),P.Bb(4),P.Pc(P.kc(24,38,"GROUP.INFORMATIONS.LEVEL")),P.Bb(3),P.Pc(t.authService.user.level),P.Bb(2),P.oc("prefix",t.authService.user.level),P.Bb(1),P.oc("ngIf",null==(i=t.form.get("level"))?null:i.touched),P.Bb(2),P.oc("disabled",t.firstStepInvalid()),P.Bb(1),P.Pc(P.kc(33,40,"COMMON.NEXT")),P.Bb(3),P.Pc(P.kc(36,42,"COMMON.UNDO")),P.Bb(4),P.oc("ngClass",P.tc(60,xe,t.form.get("level").value)),P.Bb(1),P.Rc(" ",P.kc(41,44,"GROUP.INFORMATIONS.MODAL.PROVISIONNING_GROUP")," \u201c",t.form.get("name").value,"\u201d "),P.Bb(2),P.oc("ngIf",t.form.get("level").value),P.Bb(1),P.oc("level",t.form.get("level").value),P.Bb(2),P.oc("disabled",t.secondStepInvalid()),P.Bb(1),P.Pc(P.kc(47,46,"COMMON.NEXT")),P.Bb(3),P.Pc(P.kc(50,48,"COMMON.UNDO")),P.Bb(6),P.Pc(P.kc(56,50,"COMMON.BACK")),P.Bb(5),P.Pc(P.kc(61,52,"GROUP.INFORMATIONS.MODAL.UNITS_INFORMATION")),P.Bb(2),P.oc("customer",t.authService.user.customerId),P.Bb(2),P.oc("disabled",t.formValid()),P.Bb(1),P.Pc(P.kc(66,54,"COMMON.SUBMIT")),P.Bb(3),P.Pc(P.kc(69,56,"COMMON.UNDO")),P.Bb(6),P.Pc(P.kc(75,58,"COMMON.BACK"))}},directives:[h.dc,S.y,S.r,S.i,h.mb,X.a,h.ac,S.q,S.g,p.p,h.Qb,S.m,S.l,S.w,h.R,X.d,p.n,pe.a,X.e,re,h.Rb],pipes:[Y.d],styles:[""],data:{animation:[h.Hb,h.Ob]}}),we),Le=o("ZTXN"),Fe={status:function(e){if(0===e.length)return[];var t=[];return e.forEach((function(e){switch(e){case"ENABLED":t.push(!0);break;case"DISABLED":t.push(!1)}})),[{key:"enabled",value:t,operator:h.W.in}]},level:function(e){return 0===e.length?[]:(e.some((function(e){return null===e}))&&e.push(""),[{key:"level",value:e,operator:h.W.in}])}};function _e(e,t){if(1&e){var n=P.Ub();P.Tb(0,"vitamui-common-table-filter",22),P.ec("filterChange",(function(e){return P.Dc(n),P.ic().filterMap.status=e}))("filterChange",(function(e){return P.Dc(n),P.ic().onFilterChange("status",e)})),P.Tb(1,"vitamui-common-table-filter-option",23),P.Tb(2,"div",24),P.Tb(3,"span",25),P.Oc(4),P.jc(5,"translate"),P.Sb(),P.Sb(),P.Sb(),P.Tb(6,"vitamui-common-table-filter-option",26),P.Tb(7,"div",24),P.Tb(8,"span",25),P.Oc(9),P.jc(10,"translate"),P.Sb(),P.Sb(),P.Sb(),P.Sb()}if(2&e){var i=P.ic();P.oc("filter",i.filterMap.status),P.Bb(4),P.Pc(P.kc(5,3,"GROUP.HOME.RESULTS_TABLE.STATUS_FILTER.ACTIVE")),P.Bb(5),P.Pc(P.kc(10,5,"GROUP.HOME.RESULTS_TABLE.STATUS_FILTER.INACTIVE"))}}function Ge(e,t){if(1&e){var n=P.Ub();P.Tb(0,"vitamui-common-table-filter-search",27),P.ec("filterChange",(function(e){return P.Dc(n),P.ic().filterMap.level=e}))("filterChange",(function(e){return P.Dc(n),P.ic().onFilterChange("level",e)}))("filterClose",(function(){P.Dc(n),P.ic();var e=P.zc(28);return null==e?null:e.close()})),P.jc(1,"translate"),P.Sb()}if(2&e){var i=P.ic();P.oc("filter",i.filterMap.level)("options",i.levelFilterOptions)("emptyValueOption",P.kc(1,3,"GROUP.HOME.RESULTS_TABLE.EMPTY_LEVEL"))}}function Ve(e,t){if(1&e){var n=P.Ub();P.Tb(0,"div",28),P.ec("click",(function(){P.Dc(n);var e=t.$implicit;return P.ic().groupClick.emit(e)})),P.Tb(1,"div",29),P.Tb(2,"div",3),P.Ob(3,"i",30),P.Sb(),P.Tb(4,"div",31),P.Oc(5),P.Sb(),P.Tb(6,"div",32),P.Oc(7),P.Sb(),P.Tb(8,"div",31),P.Oc(9),P.jc(10,"truncate"),P.Sb(),P.Tb(11,"div",32),P.Oc(12),P.Sb(),P.Sb(),P.Sb()}if(2&e){var i=t.$implicit;P.Bb(3),P.oc("ngClass",null!=i&&i.enabled?"status-badge-green":"status-badge-grey"),P.Bb(2),P.Pc(i.name),P.Bb(2),P.Pc(i.identifier),P.Bb(2),P.Pc(P.lc(10,5,i.description,50)),P.Bb(3),P.Pc(i.level)}}function He(e,t){1&e&&P.Ob(0,"div")}function qe(e,t){1&e&&P.Ob(0,"div")}function Ke(e,t){1&e&&P.Ob(0,"div")}function Qe(e,t){1&e&&(P.Tb(0,"div",33),P.Oc(1),P.jc(2,"translate"),P.Sb()),2&e&&(P.Bb(1),P.Pc(P.kc(2,1,"COMMON.NO_RESULT")))}function ze(e,t){if(1&e){var n=P.Ub();P.Tb(0,"div",34),P.ec("click",(function(){return P.Dc(n),P.ic().groupService.loadMore()})),P.Tb(1,"span",35),P.Oc(2),P.jc(3,"translate"),P.Sb(),P.Sb()}2&e&&(P.Bb(2),P.Pc(P.kc(3,1,"COMMON.SHOW_MORE_RESULTS")))}function We(e,t){1&e&&(P.Tb(0,"div",36),P.Ob(1,"mat-spinner",37),P.Sb())}var Xe,Ye=((Xe=function(t){function i(e,t){var r;return u(this,i),(r=n(this,i,[e])).groupService=e,r.locale=t,r.groupClick=new P.n,r.searchKeys=["identifier","name","level","description","units"],r.filterMap={status:["ENABLED"],level:null},r.orderBy="name",r.direction=h.x.ASCENDANT,r.filterChange=new Le.a,r.orderChange=new Le.a,r.searchChange=new Le.a,r.levelFilterOptions=[],r}return r(i,t),a(i,[{key:"searchText",set:function(e){this._search=e,this.searchChange.next(e)}},{key:"ngOnInit",value:function(){var t=this;this.search(),this.refreshLevelOptions(),this.updatedGroupSub=this.groupService.updated.subscribe((function(e){var n=t.dataSource.findIndex((function(t){return e.id===t.id}));n>-1&&(t.dataSource[n]=e)})),Object(L.a)(this.searchChange,this.filterChange,this.orderChange).subscribe((function(){var n,i={criteria:[].concat(e((n=t.filterMap,Object(h.Eb)(n,Fe))),e(Object(h.Fb)(t._search,t.searchKeys)))},r=new h.Z(0,h.w,t.orderBy,t.direction,JSON.stringify(i));t.search(r)}))}},{key:"onFilterChange",value:function(e,t){this.filterMap[e]=t,this.filterChange.next(this.filterMap)}},{key:"emitOrderChange",value:function(){this.orderChange.next()}},{key:"ngOnDestroy",value:function(){this.updatedGroupSub.unsubscribe()}},{key:"refreshLevelOptions",value:function(e){var t=this;this.groupService.getNonEmptyLevels(e).subscribe((function(e){var n;t.levelFilterOptions=e.map((function(e){return{value:e,label:e}})),t.levelFilterOptions.sort((n=t.locale,function(e,t){return e.label.localeCompare(t.label,n)}))}))}}]),i}(h.O)).\u0275fac=function(e){return new(e||Xe)(P.Nb(D.a),P.Nb(P.v))},Xe.\u0275cmp=P.Hb({type:Xe,selectors:[["app-group-list"]],inputs:{searchText:["search","searchText"]},outputs:{groupClick:"groupClick"},features:[P.yb],decls:48,vars:33,consts:[["vitamuiCommonInfiniteScroll","",3,"vitamuiScroll"],[1,"vitamui-table"],[1,"vitamui-table-head"],[1,"col-2","d-flex","align-items-center"],[1,"vitamui-filter-button",3,"vitamuiCommonTableFilter"],[1,"material-icons","vitamui-row-icon"],["statusFilterTemplate",""],[1,"vitamui-icon","vitamui-icon-keys","vitamui-row-icon"],["orderByKey","status",3,"orderBy","direction","orderByChange","directionChange","orderChange"],[1,"col-3","d-flex","align-items-center"],["orderByKey","name",3,"orderBy","direction","orderByChange","directionChange","orderChange"],["orderByKey","identifier",3,"orderBy","direction","orderByChange","directionChange","orderChange"],["orderByKey","description",3,"orderBy","direction","orderByChange","directionChange","orderChange"],["levelFilterTrigger","vitamuiCommonTableFilter"],["levelFilterTemplate",""],["orderByKey","level",3,"orderBy","direction","orderByChange","directionChange","orderChange"],[1,"vitamui-table-body"],["class","vitamui-table-rows",3,"click",4,"ngFor","ngForOf"],[4,"ngIf","ngIfThen"],["noResults",""],["loadMore",""],["loadingSpinner",""],[3,"filter","filterChange"],["value","ENABLED"],[1,"table-filter-icon"],[1,"badge-state"],["value","DISABLED"],[3,"filter","options","emptyValueOption","filterChange","filterClose"],[1,"vitamui-table-rows",3,"click"],[1,"vitamui-row","d-flex","align-items-center","clickable"],[1,"vitamui-icon","vitamui-icon-keys",3,"ngClass"],["vitamuiCommonEllipsis","",1,"col-3"],["vitamuiCommonEllipsis","",1,"col-2"],[1,"vitamui-min-content","vitamui-table-message"],[1,"vitamui-min-content","vitamui-table-message",3,"click"],[1,"clickable"],[1,"vitamui-min-content"],[1,"vitamui-spinner","medium"]],template:function(e,t){if(1&e&&(P.Tb(0,"div",0),P.ec("vitamuiScroll",(function(){return t.onScroll()})),P.Tb(1,"div",1),P.Tb(2,"div",2),P.Tb(3,"div",3),P.Tb(4,"button",4),P.Tb(5,"i",5),P.Oc(6,"filter_list"),P.Sb(),P.Sb(),P.Mc(7,_e,11,7,"ng-template",null,6,P.Nc),P.Ob(9,"i",7),P.Tb(10,"vitamui-common-order-by-button",8),P.ec("orderByChange",(function(e){return t.orderBy=e}))("directionChange",(function(e){return t.direction=e}))("orderChange",(function(){return t.emitOrderChange()})),P.Sb(),P.Sb(),P.Tb(11,"div",9),P.Tb(12,"span"),P.Oc(13),P.jc(14,"translate"),P.Sb(),P.Tb(15,"vitamui-common-order-by-button",10),P.ec("orderByChange",(function(e){return t.orderBy=e}))("directionChange",(function(e){return t.direction=e}))("orderChange",(function(){return t.emitOrderChange()})),P.Sb(),P.Sb(),P.Tb(16,"div",3),P.Tb(17,"span"),P.Oc(18),P.jc(19,"translate"),P.Sb(),P.Tb(20,"vitamui-common-order-by-button",11),P.ec("orderByChange",(function(e){return t.orderBy=e}))("directionChange",(function(e){return t.direction=e}))("orderChange",(function(){return t.emitOrderChange()})),P.Sb(),P.Sb(),P.Tb(21,"div",9),P.Tb(22,"span"),P.Oc(23),P.jc(24,"translate"),P.Sb(),P.Tb(25,"vitamui-common-order-by-button",12),P.ec("orderByChange",(function(e){return t.orderBy=e}))("directionChange",(function(e){return t.direction=e}))("orderChange",(function(){return t.emitOrderChange()})),P.Sb(),P.Sb(),P.Tb(26,"div",3),P.Tb(27,"button",4,13),P.Tb(29,"i",5),P.Oc(30,"filter_list"),P.Sb(),P.Sb(),P.Mc(31,Ge,2,5,"ng-template",null,14,P.Nc),P.Tb(33,"span"),P.Oc(34),P.jc(35,"translate"),P.Sb(),P.Tb(36,"vitamui-common-order-by-button",15),P.ec("orderByChange",(function(e){return t.orderBy=e}))("directionChange",(function(e){return t.direction=e}))("orderChange",(function(){return t.emitOrderChange()})),P.Sb(),P.Sb(),P.Sb(),P.Tb(37,"div",16),P.Mc(38,Ve,13,8,"div",17),P.Sb(),P.Sb(),P.Mc(39,He,1,0,"div",18),P.Mc(40,qe,1,0,"div",18),P.Mc(41,Ke,1,0,"div",18),P.Sb(),P.Mc(42,Qe,3,3,"ng-template",null,19,P.Nc),P.Mc(44,ze,4,3,"ng-template",null,20,P.Nc),P.Mc(46,We,2,0,"ng-template",null,21,P.Nc)),2&e){var n=P.zc(8),i=P.zc(32),r=P.zc(43),o=P.zc(45),c=P.zc(47);P.Bb(4),P.oc("vitamuiCommonTableFilter",n),P.Bb(6),P.oc("orderBy",t.orderBy)("direction",t.direction),P.Bb(3),P.Pc(P.kc(14,25,"GROUP.HOME.RESULTS_TABLE.NAME")),P.Bb(2),P.oc("orderBy",t.orderBy)("direction",t.direction),P.Bb(3),P.Pc(P.kc(19,27,"COMMON.ID")),P.Bb(2),P.oc("orderBy",t.orderBy)("direction",t.direction),P.Bb(3),P.Pc(P.kc(24,29,"GROUP.HOME.RESULTS_TABLE.DESCRIPTION")),P.Bb(2),P.oc("orderBy",t.orderBy)("direction",t.direction),P.Bb(2),P.Fb("active",t.filterMap.level&&t.filterMap.level.length>0),P.oc("vitamuiCommonTableFilter",i),P.Bb(7),P.Pc(P.kc(35,31,"GROUP.HOME.RESULTS_TABLE.LEVEL")),P.Bb(2),P.oc("orderBy",t.orderBy)("direction",t.direction),P.Bb(2),P.oc("ngForOf",t.dataSource),P.Bb(1),P.oc("ngIf",!t.dataSource||t.pending)("ngIfThen",c),P.Bb(1),P.oc("ngIf",!t.pending&&0===(null==t.dataSource?null:t.dataSource.length))("ngIfThen",r),P.Bb(1),P.oc("ngIf",t.infiniteScrollDisabled&&t.groupService.canLoadMore&&!t.pending)("ngIfThen",o)}},directives:[h.N,h.qb,h.X,p.o,p.p,h.pb,h.bc,h.sb,p.n,h.Zb,j.b],pipes:[Y.d,h.qc],styles:[".vitamui-table-body[_ngcontent-%COMP%]   .vitamui-icon-keys[_ngcontent-%COMP%]{padding-left:2rem}"],data:{animation:[h.Hb,h.Ob]}}),Xe),Je=o("+9k3"),Ze=o("wgY5"),$e=o.n(Ze);function et(e,t){if(1&e){var n=P.Ub();P.Tb(0,"app-group-preview",10),P.ec("previewClose",(function(){return P.Dc(n),P.ic().closePanel()})),P.Sb()}if(2&e){var i=P.ic();P.oc("group",i.openedItem)}}var tt,nt,it,rt=[{path:"",component:(tt=function(e){function t(e,i,r,o,c,a){var l;return u(this,t),(l=n(this,t,[e,i])).route=e,l.globalEventService=i,l.dialog=r,l.downloadSnackBarService=o,l.snackBarService=c,l.groupService=a,l.exportButtonDisabled=!1,l}return r(t,e),a(t,[{key:"openCreateGroupDialog",value:function(){var e=this;this.dialog.open(De,{panelClass:"vitamui-modal",disableClose:!0}).afterClosed().subscribe((function(t){t&&e.refreshList()}))}},{key:"onSearchSubmit",value:function(e){this.search=e}},{key:"refreshList",value:function(){this.groupListComponent&&this.groupListComponent.search()}},{key:"exportProfilesAsExcel",value:function(){var e=this;this.exportButtonDisabled=!0,this.downloadSnackBarService.openDownloadBar();var t=this.groupService.export().subscribe((function(t){var n=e.getFileName(t.headers.get("Content-Disposition"));h.z.loadFromBlob(t,t.body.type,n),e.downloadSnackBarService.close(),e.snackBarService.open({message:"SHARED.SNACKBAR.GROUP_EXPORT_SUCCESS"}),e.exportButtonDisabled=!1}),(function(){e.downloadSnackBarService.close(),e.exportButtonDisabled=!1}));this.downloadSnackBarService.cancelDownload.subscribe((function(){e.exportButtonDisabled=!1,t.unsubscribe()}))}},{key:"getFileName",value:function(e){var t=null==e?void 0:e.match(/filename=(.+);?/);return(null==t?void 0:t.length)>1?t[1]:"lexport-groupes-".concat($e()(Object(Ze.now)()).format("YYYY-MM-DDTHH_mm_ss"),".xlsx")}}]),t}(h.kb),tt.\u0275fac=function(e){return new(e||tt)(P.Nb(A.a),P.Nb(h.M),P.Nb(m.b),P.Nb(Je.a),P.Nb(h.Ab),P.Nb(D.a))},tt.\u0275cmp=P.Hb({type:tt,selectors:[["app-group"]],viewQuery:function(e,t){var n;1&e&&P.Ic(Ye,!0),2&e&&P.yc(n=P.fc())&&(t.groupListComponent=n.first)},features:[P.yb],decls:21,vars:18,consts:[[3,"autosize","hasBackdrop"],["mode","side","position","end",3,"fixedInViewport"],["panel",""],[3,"group","previewClose",4,"ngIf"],[1,"vitamui-heading"],[3,"searchbarPlaceholder","search"],[1,"btn","primary","ml-5",3,"click"],[1,"btn","secondary","ml-3",3,"disabled","click"],[1,"vitamui-content"],[3,"search","groupClick"],[3,"group","previewClose"]],template:function(e,t){1&e&&(P.Tb(0,"mat-sidenav-container",0),P.Tb(1,"mat-sidenav",1,2),P.Mc(3,et,1,1,"app-group-preview",3),P.Sb(),P.Tb(4,"mat-sidenav-content"),P.Tb(5,"div",4),P.Tb(6,"vitamui-common-title-breadcrumb"),P.Oc(7),P.jc(8,"translate"),P.Sb(),P.Tb(9,"vitamui-common-banner",5),P.ec("search",(function(e){return t.onSearchSubmit(e)})),P.jc(10,"translate"),P.Tb(11,"button",6),P.ec("click",(function(){return t.openCreateGroupDialog()})),P.Tb(12,"span"),P.Oc(13),P.jc(14,"translate"),P.Sb(),P.Sb(),P.Tb(15,"button",7),P.ec("click",(function(){return t.exportProfilesAsExcel()})),P.Tb(16,"span"),P.Oc(17),P.jc(18,"translate"),P.Sb(),P.Sb(),P.Sb(),P.Sb(),P.Tb(19,"div",8),P.Tb(20,"app-group-list",9),P.ec("groupClick",(function(e){return t.openPanel(e)})),P.Sb(),P.Sb(),P.Sb(),P.Sb()),2&e&&(P.oc("autosize",!0)("hasBackdrop",!1),P.Bb(1),P.oc("fixedInViewport",!0),P.Bb(2),P.oc("ngIf",t.openedItem),P.Bb(4),P.Qc(" ",P.kc(8,10,"APPLICATION.GROUPS_APP.NAME")," "),P.Bb(2),P.oc("searchbarPlaceholder",P.kc(10,12,"GROUP.HOME.TITLE_PLACEHOLDER")),P.Bb(4),P.Pc(P.kc(14,14,"GROUP.HOME.ACTION_BUTTON")),P.Bb(2),P.oc("disabled",t.exportButtonDisabled),P.Bb(2),P.Pc(P.kc(18,16,"GROUP.HOME.EXPORT")),P.Bb(3),P.oc("search",t.search))},directives:[g.b,g.a,p.p,g.c,h.cc,h.jc,Ye,ye],pipes:[Y.d],styles:[""]}),tt),pathMatch:"full"},{path:":id",component:Ce,resolve:{group:Be},data:{isPopup:!0,appId:"GROUPS_APP"}}],ot=((it=a((function e(){u(this,e)}))).\u0275mod=P.Lb({type:it}),it.\u0275inj=P.Kb({factory:function(e){return new(e||it)},imports:[[p.c,A.g.forChild(rt)],A.g]}),it),ct=((nt=a((function e(){u(this,e)}))).\u0275mod=P.Lb({type:nt}),nt.\u0275inj=P.Kb({factory:function(e){return new(e||nt)},imports:[[p.c,h.xb,O.a,M,U,x,m.f,v.b,f.d,g.d,ot]]}),nt)}}])}();