!function(){function e(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,i){if(!e)return;if("string"==typeof e)return t(e,i);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return t(e,i)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function i(e,t,i){return t=o(t),function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}()?Reflect.construct(t,i||[],o(e).constructor):t.apply(e,i))}function n(){return(n="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,i){var n=r(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:i):o.value}}).apply(this,arguments)}function r(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=o(e)););return e}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t)}function a(e,t){return(a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function c(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,s(n.key),n)}}function u(e,t,i){return t&&c(e.prototype,t),i&&c(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function s(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{cRhG:function(t,r,a){"use strict";a.r(r),a.d(r,"ProfileModule",(function(){return Ue}));var c,s,m,f,d=a("2kYt"),p=a("nIj0"),S=a("jdnZ"),v=a("Jb3d"),O=a("66mq"),E=a("lQ7A"),R=a("OWX3"),h=a("PCNd"),T=a("l7x+"),I=a("29Wa"),P=a("Cd2c"),g=a("R7+U"),N=a("W1gw"),y=a("EM62"),_=((c=u((function e(){b(this,e)}))).\u0275mod=y.Lb({type:c}),c.\u0275inj=y.Kb({factory:function(e){return new(e||c)},imports:[[d.c,h.a,S.c,I.d,P.c,O.b,g.b,N.c,p.k,p.v,T.a,R.xb,R.gb]]}),c),F=a("KZIX"),A=a("Y2X+"),U=((s=u((function e(){b(this,e)}))).\u0275mod=y.Lb({type:s}),s.\u0275inj=y.Kb({factory:function(e){return new(e||s)},imports:[[d.c,h.a,v.b,F.c,A.b,p.v,R.xb,R.gb]]}),s),C=a("csyo"),L=((m=u((function e(){b(this,e)}))).\u0275mod=y.Lb({type:m}),m.\u0275inj=y.Kb({factory:function(e){return new(e||m)},imports:[[d.c,h.a,C.a,R.xb]]}),m),k=a("sEIs"),M=a("4Xmu"),B=a("ROBh"),j=a("YtkY"),w=a("xVbo"),D=a("TLy2"),x=a("4e/d"),V=a("6WTZ"),H=a("8lHc"),G=a("J+dc"),W=((f=u((function e(t){var i=this;b(this,e),this.rngProfileService=t,this.debounceTime=400,this.nameExists=function(e,t,n,r){return function(o){return Object(H.a)(i.debounceTime).pipe(Object(D.a)((function(){return o.value!==r?i.rngProfileService.exists(e,t,n,o.value):Object(B.a)(!1)})),Object(G.a)(1),Object(j.a)((function(e){return e?{nameExists:!0}:null})))}}}))).\u0275fac=function(e){return new(e||f)(y.bc(M.a))},f.\u0275prov=y.Jb({token:f,factory:f.\u0275fac,providedIn:"root"}),f),q=a("s2Ay");function Q(e,t){1&e&&(y.Tb(0,"span"),y.Oc(1),y.jc(2,"translate"),y.Sb()),2&e&&(y.Bb(1),y.Pc(y.kc(2,1,"USER_PROFILE.INFORMATIONS.INACTIVE_SWITCH")))}function K(e,t){1&e&&(y.Tb(0,"span"),y.Oc(1),y.jc(2,"translate"),y.Sb()),2&e&&(y.Bb(1),y.Pc(y.kc(2,1,"USER_PROFILE.INFORMATIONS.ACTIVE_SWITCH")))}var X,Y,Z,z,J=((z=function(){function e(t,i,n,r){var o=this;b(this,e),this.formBuilder=t,this.rngProfileService=i,this.profileValidators=n,this.authService=r,this.roleEnum=R.db,this.form=this.formBuilder.group({name:[null,p.x.required],identifier:[{value:null,disabled:!0},p.x.required],description:[null,p.x.required],enabled:!1,level:[null,Object(R.Gb)(this.authService.user)],roles:[]}),this.updateFormSub=this.form.valueChanges.pipe(Object(j.a)((function(){return Object(R.Ib)(o.form.value,o.previousValue)})),Object(w.a)((function(e){return!Object(V.c)(e)})),Object(j.a)((function(e){return o.completeRoles(e)})),Object(j.a)((function(e){return Object(V.a)({id:o.profile.id,customerId:o.profile.customerId,tenantIdentifier:o.profile.tenantIdentifier},e)})),Object(D.a)((function(e){return o.rngProfileService.patch(e).pipe(Object(x.a)((function(){return Object(B.a)(null)})))}))).subscribe((function(e){o.resetForm(o.form,e,o.readOnly)}))}return u(e,[{key:"ngOnInit",value:function(){this.userLevel=this.authService.user.level}},{key:"completeRoles",value:function(e){var t=this.completeUpdateRoles(e);return this.completeCreateRoles(t)}},{key:"completeUpdateRoles",value:function(e){if(e.roles){var t=[R.db.ROLE_MFA_USERS.toString(),R.db.ROLE_UPDATE_STANDARD_USERS.toString()],i=e.roles.some((function(e){return t.includes(e.name)})),n=e.roles.findIndex((function(e){return e.name===R.db.ROLE_UPDATE_USERS})),r=e.roles.findIndex((function(e){return e.name===R.db.ROLE_UPDATE_USER_INFOS}));i?(-1===n&&e.roles.push({name:R.db.ROLE_UPDATE_USERS}),-1===r&&e.roles.push({name:R.db.ROLE_UPDATE_USER_INFOS})):(-1!==n&&e.roles.splice(n,1),-1!==r&&e.roles.splice(r,1))}return e}},{key:"completeCreateRoles",value:function(e){if(e.roles){var t=[R.db.ROLE_CREATE_USERS.toString()],i=e.roles.some((function(e){return t.includes(e.name)})),n=e.roles.findIndex((function(e){return e.name===R.db.ROLE_CREATE_USER_INFOS}));i?-1===n&&e.roles.push({name:R.db.ROLE_CREATE_USER_INFOS}):-1!==n&&e.roles.splice(n,1)}return e}},{key:"ngOnDestroy",value:function(){this.updateFormSub.unsubscribe()}},{key:"ngOnChanges",value:function(e){(e.hasOwnProperty("profile")||e.hasOwnProperty("readOnly"))&&this.profile&&(this.resetForm(this.form,this.profile,this.readOnly),this.previousValue=this.form.value)}},{key:"resetForm",value:function(e,t,i){e.reset(t,{emitEvent:!1}),this.initFormValidators(e,t),this.initCustomFormActivationState(e,t,i),e.updateValueAndValidity({emitEvent:!1})}},{key:"initFormValidators",value:function(e,t){e.get("name").setAsyncValidators(this.profileValidators.nameExists(t.tenantIdentifier,t.level,t.applicationName,t.name))}},{key:"initCustomFormActivationState",value:function(e,t,i){this.initFormActivationState(e,i),e.get("identifier").disable({emitEvent:!1}),t.groupsCount&&t.groupsCount>0&&(this.form.get("enabled").disable({emitEvent:!1}),this.form.get("level").disable({emitEvent:!1}))}},{key:"initFormActivationState",value:function(e,t){t?e.disable({emitEvent:!1}):e.enable({emitEvent:!1})}}]),e}()).\u0275fac=function(e){return new(e||z)(y.Nb(p.d),y.Nb(M.a),y.Nb(W),y.Nb(R.k))},z.\u0275cmp=y.Hb({type:z,selectors:[["app-information-tab"]],inputs:{profile:"profile",readOnly:"readOnly"},features:[y.zb],decls:61,vars:69,consts:[[3,"formGroup"],["formControlName","enabled","matTooltipClass","vitamui-tooltip",3,"matTooltip","matTooltipDisabled"],[4,"ngIf"],[1,"row"],[1,"col-12"],["formControlName","identifier","maxlength","12",3,"label","validator","asyncValidator"],["formControlName","name","maxlength","100",3,"label","validator","asyncValidator"],["errorKey","required"],["errorKey","nameExists"],[1,"col-6"],[1,"read-only-field","disabled-input"],["matTooltipClass","vitamui-tooltip",1,"col-6",3,"matTooltip","matTooltipDisabled"],["formControlName","level","maxlength","250",3,"prefix","label","validator"],["formControlName","description","maxlength","380",3,"label","validator"],[1,"col-6","my-4"],["formControlName","roles"],[3,"name"]],template:function(e,t){if(1&e&&(y.Tb(0,"form",0),y.Tb(1,"vitamui-common-slide-toggle",1),y.jc(2,"translate"),y.Mc(3,Q,3,3,"span",2),y.Mc(4,K,3,3,"span",2),y.Sb(),y.Tb(5,"div",3),y.Tb(6,"div",4),y.Ob(7,"vitamui-common-editable-input",5),y.jc(8,"translate"),y.Sb(),y.Sb(),y.Tb(9,"div",3),y.Tb(10,"div",4),y.Tb(11,"vitamui-common-editable-input",6),y.jc(12,"translate"),y.Tb(13,"vitamui-common-field-error",7),y.Oc(14),y.jc(15,"translate"),y.Sb(),y.Tb(16,"vitamui-common-field-error",8),y.Oc(17),y.jc(18,"translate"),y.Sb(),y.Sb(),y.Sb(),y.Sb(),y.Tb(19,"div",3),y.Tb(20,"div",9),y.Tb(21,"div",10),y.Tb(22,"label"),y.Oc(23),y.jc(24,"translate"),y.Sb(),y.Tb(25,"div"),y.Oc(26),y.Sb(),y.Sb(),y.Sb(),y.Tb(27,"div",11),y.jc(28,"translate"),y.Tb(29,"vitamui-common-editable-level-input",12),y.jc(30,"translate"),y.Tb(31,"vitamui-common-field-error",7),y.Oc(32),y.jc(33,"translate"),y.Sb(),y.Tb(34,"vitamui-common-field-error",8),y.Oc(35),y.jc(36,"translate"),y.Sb(),y.Sb(),y.Sb(),y.Sb(),y.Tb(37,"div",3),y.Tb(38,"div",4),y.Tb(39,"vitamui-common-editable-input",13),y.jc(40,"translate"),y.Tb(41,"vitamui-common-field-error",7),y.Oc(42),y.jc(43,"translate"),y.Sb(),y.Sb(),y.Sb(),y.Tb(44,"div",14),y.Tb(45,"vitamui-common-role-toggle",15),y.Tb(46,"vitamui-common-role",16),y.Oc(47),y.jc(48,"translate"),y.Sb(),y.Tb(49,"vitamui-common-role",16),y.Oc(50),y.jc(51,"translate"),y.Sb(),y.Tb(52,"vitamui-common-role",16),y.Oc(53),y.jc(54,"translate"),y.Sb(),y.Tb(55,"vitamui-common-role",16),y.Oc(56),y.jc(57,"translate"),y.Sb(),y.Tb(58,"vitamui-common-role",16),y.Oc(59),y.jc(60,"translate"),y.Sb(),y.Sb(),y.Sb(),y.Sb(),y.Sb()),2&e){var i=null,n=null,r=null,o=null,l=null,a=null;y.oc("formGroup",t.form),y.Bb(1),y.oc("matTooltip",y.kc(2,35,"USER_PROFILE.INFORMATIONS.ACTIVE_SWITCH_TOOLTIP"))("matTooltipDisabled",0==(null==t.profile?null:t.profile.groupsCount)),y.Bb(2),y.oc("ngIf",!(null!=t.form&&t.form.get("enabled").value)),y.Bb(1),y.oc("ngIf",null==t.form?null:t.form.get("enabled").value),y.Bb(3),y.oc("label",y.kc(8,37,"COMMON.ID"))("validator",null==t.form||null==(i=t.form.get("identifier"))?null:i.validator)("asyncValidator",null==t.form||null==(n=t.form.get("identifier"))?null:n.asyncValidator),y.Bb(4),y.oc("label",y.kc(12,39,"USER_PROFILE.INFORMATIONS.NAME"))("validator",null==t.form||null==(r=t.form.get("name"))?null:r.validator)("asyncValidator",null==t.form||null==(o=t.form.get("name"))?null:o.asyncValidator),y.Bb(3),y.Pc(y.kc(15,41,"COMMON.ERROR.REQUIRED")),y.Bb(3),y.Pc(y.kc(18,43,"USER_PROFILE.INFORMATIONS.EXISTING_NAME")),y.Bb(6),y.Pc(y.kc(24,45,"USER_PROFILE.INFORMATIONS.LEVEL")),y.Bb(3),y.Pc(t.userLevel),y.Bb(1),y.oc("matTooltip",y.kc(28,47,"USER_PROFILE.INFORMATIONS.SUBLEVEL_TOOLTIP"))("matTooltipDisabled",0==(null==t.profile?null:t.profile.groupsCount)),y.Bb(2),y.oc("prefix",t.userLevel)("label",y.kc(30,49,"USER_PROFILE.INFORMATIONS.SUBLEVEL"))("validator",null==t.form||null==(l=t.form.get("level"))?null:l.validator),y.Bb(3),y.Pc(y.kc(33,51,"COMMON.ERROR.REQUIRED")),y.Bb(3),y.Pc(y.kc(36,53,"USER_PROFILE.INFORMATIONS.WRONG_FORMAT")),y.Bb(4),y.oc("label",y.kc(40,55,"USER_PROFILE.INFORMATIONS.DESCRIPTION"))("validator",null==t.form||null==(a=t.form.get("description"))?null:a.validator),y.Bb(3),y.Pc(y.kc(43,57,"COMMON.ERROR.REQUIRED")),y.Bb(4),y.oc("name",t.roleEnum.ROLE_MFA_USERS),y.Bb(1),y.Pc(y.kc(48,59,"USER_PROFILE.INFORMATIONS.STRONG_AUTHENT")),y.Bb(2),y.oc("name",t.roleEnum.ROLE_CREATE_USERS),y.Bb(1),y.Pc(y.kc(51,61,"USER_PROFILE.INFORMATIONS.USERS_CREATION")),y.Bb(2),y.oc("name",t.roleEnum.ROLE_UPDATE_STANDARD_USERS),y.Bb(1),y.Pc(y.kc(54,63,"USER_PROFILE.INFORMATIONS.MODIF_INFORMATIONS")),y.Bb(2),y.oc("name",t.roleEnum.ROLE_ANONYMIZATION_USERS),y.Bb(1),y.Pc(y.kc(57,65,"USER_PROFILE.INFORMATIONS.ANONYMOUS")),y.Bb(2),y.oc("name",t.roleEnum.ROLE_GENERIC_USERS),y.Bb(1),y.Qc(" ",y.kc(60,67,"USER_PROFILE.INFORMATIONS.USERS_MANAGEMENT"),"")}},directives:[p.y,p.r,p.i,R.ac,p.q,p.g,A.a,d.p,R.F,p.l,R.zb,R.G,R.fb,R.eb],pipes:[q.d],styles:[""]}),z),$=((Z=function(){function e(t,i,n){b(this,e),this.rngProfileService=t,this.authService=i,this.startupService=n,this.profileClose=new y.n}return u(e,[{key:"id",set:function(e){var t=this;this.rngProfileService.get(e).subscribe((function(e){return t.profile=e}))}},{key:"ngOnInit",value:function(){var e=this;this.profileUpdateSub=this.rngProfileService.updated.subscribe((function(t){t&&e.rngProfileService.get(t.id).subscribe((function(t){e.profile=t}))}))}},{key:"openPopup",value:function(){window.open(this.startupService.getConfigStringValue("UI_URL")+"/profile/"+this.profile.id,"detailPopup","width=584, height=713, resizable=no, location=no"),this.emitClose()}},{key:"levelNotAllowed",value:function(){if(this.profile)return!Object(R.Kb)(this.authService.user,this.profile.level)}},{key:"emitClose",value:function(){this.profileClose.emit()}},{key:"ngOnDestroy",value:function(){this.profileUpdateSub.unsubscribe()}},{key:"filterEvents",value:function(e){return e.outDetail&&(e.outDetail.includes("EXT_VITAMUI_CREATE_PROFILE")||e.outDetail.includes("EXT_VITAMUI_UPDATE_PROFILE"))}}]),e}()).\u0275fac=function(e){return new(e||Z)(y.Nb(M.a),y.Nb(R.k),y.Nb(R.lb))},Z.\u0275cmp=y.Hb({type:Z,selectors:[["app-profile-detail"]],inputs:{id:"id",profile:"profile",isPopup:"isPopup"},outputs:{profileClose:"profileClose"},decls:9,vars:14,consts:[[3,"title","icon","badge","onclose"],[1,"vitamui-sidepanel-body"],[1,"preview-tab-group"],[3,"label"],[3,"profile","readOnly"],["collectionName","profiles",3,"id","identifier","filter"]],template:function(e,t){1&e&&(y.Tb(0,"vitamui-common-sidenav-header",0),y.ec("onclose",(function(){return t.emitClose()})),y.Sb(),y.Tb(1,"div",1),y.Tb(2,"mat-tab-group",2),y.Tb(3,"mat-tab",3),y.jc(4,"translate"),y.Ob(5,"app-information-tab",4),y.Sb(),y.Tb(6,"mat-tab",3),y.jc(7,"translate"),y.Ob(8,"vitamui-common-operation-history-tab",5),y.Sb(),y.Sb(),y.Sb()),2&e&&(y.oc("title",null==t.profile?null:t.profile.name)("icon","vitamui-icon-gestion-de-profil")("badge",null!=t.profile&&t.profile.enabled?"green":"grey"),y.Bb(3),y.oc("label",y.kc(4,10,"USER_PROFILE.TAB.INFORMATIONS")),y.Bb(2),y.oc("profile",t.profile)("readOnly",t.isPopup||(null==t.profile?null:t.profile.readonly)||t.levelNotAllowed()),y.Bb(1),y.oc("label",y.kc(7,12,"USER_PROFILE.TAB.HISTORY")),y.Bb(2),y.oc("id",null==t.profile?null:t.profile.id)("identifier",null==t.profile?null:t.profile.identifier)("filter",t.filterEvents))},directives:[R.mc,F.b,F.a,J,R.Xb],pipes:[q.d],styles:[""]}),Z),ee=((Y=function(){function e(t){b(this,e),this.route=t,this.profile=this.route.snapshot.data.profile}return u(e,[{key:"ngOnInit",value:function(){}},{key:"closePopup",value:function(){window.close()}}]),e}()).\u0275fac=function(e){return new(e||Y)(y.Nb(k.a))},Y.\u0275cmp=y.Hb({type:Y,selectors:[["app-profile-popup"]],decls:1,vars:2,consts:[[3,"profile","isPopup","profileClose"]],template:function(e,t){1&e&&(y.Tb(0,"app-profile-detail",0),y.ec("profileClose",(function(){return t.closePopup()})),y.Sb()),2&e&&y.oc("profile",t.profile)("isPopup",!0)},directives:[$],encapsulation:2}),Y),te=((X=function(){function e(t,i){b(this,e),this.rngProfileService=t,this.router=i}return u(e,[{key:"resolve",value:function(e){var t=this,i=e.paramMap.get("id");return this.rngProfileService.get(i).pipe(Object(G.a)(1),Object(j.a)((function(e){return e||(t.router.navigate(["/"]),null)})))}}]),e}()).\u0275fac=function(e){return new(e||X)(y.bc(M.a),y.bc(k.d))},X.\u0275prov=y.Jb({token:X,factory:X.\u0275fac,providedIn:"root"}),X),ie=a("OZ4H"),ne=a("O4oY");function re(e,t){1&e&&(y.Tb(0,"span"),y.Oc(1),y.jc(2,"translate"),y.Sb()),2&e&&(y.Bb(1),y.Pc(y.kc(2,1,"USER_PROFILE.INFORMATIONS.INACTIVE_SWITCH")))}function oe(e,t){1&e&&(y.Tb(0,"span"),y.Oc(1),y.jc(2,"translate"),y.Sb()),2&e&&(y.Bb(1),y.Pc(y.kc(2,1,"USER_PROFILE.INFORMATIONS.ACTIVE_SWITCH")))}function le(e,t){1&e&&(y.Tb(0,"vitamui-common-input-error"),y.Oc(1),y.jc(2,"translate"),y.Sb()),2&e&&(y.Bb(1),y.Pc(y.kc(2,1,"COMMON.ERROR.REQUIRED")))}function ae(e,t){1&e&&(y.Tb(0,"vitamui-common-input-error"),y.Oc(1),y.jc(2,"translate"),y.Sb()),2&e&&(y.Bb(1),y.Pc(y.kc(2,1,"USER_PROFILE.INFORMATIONS.MODAL.EXISTING_NAME")))}function ce(e,t){1&e&&(y.Tb(0,"vitamui-common-input-error"),y.Oc(1),y.jc(2,"translate"),y.Sb()),2&e&&(y.Bb(1),y.Pc(y.kc(2,1,"COMMON.ERROR.REQUIRED")))}function ue(e,t){1&e&&(y.Tb(0,"vitamui-common-input-error"),y.Oc(1),y.jc(2,"translate"),y.Sb()),2&e&&(y.Bb(1),y.Pc(y.kc(2,1,"COMMON.ERROR.REQUIRED")))}function se(e,t){1&e&&(y.Tb(0,"vitamui-common-input-error"),y.Oc(1),y.jc(2,"translate"),y.Sb()),2&e&&(y.Bb(1),y.Pc(y.kc(2,1,"USER_PROFILE.INFORMATIONS.MODAL.WRONG_FORMAT")))}var be,me=((be=function(){function e(t,i,n,r,o,l,a,c){b(this,e),this.dialogRef=t,this.data=i,this.rngProfileService=n,this.authService=r,this.customerService=o,this.profileValidators=l,this.formBuilder=a,this.confirmDialogService=c,this.selectedProfileGroups=[],this.selectedProfileGroupsId=[],this.roleEnum=R.db,this.adminProfileForm=this.formBuilder.group({enabled:!0,name:[null,p.x.required],description:[null,p.x.required],level:["",Object(R.Gb)(this.authService.user)],customerId:[this.authService.user.customerId],applicationName:"USERS_APP",tenantIdentifier:this.tenantWithProofId,roles:[[{name:this.roleEnum.ROLE_GET_USERS},{name:this.roleEnum.ROLE_GET_GROUPS},{name:this.roleEnum.ROLE_GET_USER_INFOS}]]})}return u(e,[{key:"ngOnInit",value:function(){var e=this;this.tenantWithProofId=this.authService.user.proofTenantIdentifier,this.adminProfileForm.get("tenantIdentifier").setValue(this.tenantWithProofId),this.adminProfileForm.get("name").setAsyncValidators(this.profileValidators.nameExists(Number(this.tenantWithProofId),"",R.h.USERS_APP)),this.adminProfileForm.get("level").valueChanges.subscribe((function(t){e.adminProfileForm.get("name").setAsyncValidators(e.profileValidators.nameExists(Number(e.tenantWithProofId),t,R.h.USERS_APP)),e.adminProfileForm.get("name").updateValueAndValidity()})),this.keyPressSubscription=this.confirmDialogService.listenToEscapeKeyPress(this.dialogRef).subscribe((function(){return e.onCancel()}))}},{key:"ngOnDestroy",value:function(){this.keyPressSubscription.unsubscribe()}},{key:"onCancel",value:function(){this.adminProfileForm.dirty?this.confirmDialogService.confirmBeforeClosing(this.dialogRef):this.dialogRef.close()}},{key:"firstStepInvalid",value:function(){return this.adminProfileForm.get("name").invalid||this.adminProfileForm.get("name").pending||this.adminProfileForm.get("description").invalid||this.adminProfileForm.get("description").pending||this.adminProfileForm.get("level").invalid}},{key:"completeUpdateRoles",value:function(e){var t=[R.db.ROLE_MFA_USERS.toString(),R.db.ROLE_UPDATE_STANDARD_USERS.toString()],i=e.roles.some((function(e){return t.includes(e.name)})),n=e.roles.findIndex((function(e){return e.name===R.db.ROLE_UPDATE_USERS})),r=e.roles.findIndex((function(e){return e.name===R.db.ROLE_UPDATE_USER_INFOS}));i?(-1===n&&e.roles.push({name:R.db.ROLE_UPDATE_USERS}),-1===r&&e.roles.push({name:R.db.ROLE_UPDATE_USER_INFOS})):(-1!==n&&e.roles.splice(n,1),-1!==r&&e.roles.splice(r,1))}},{key:"completeCreateRoles",value:function(e){var t=[R.db.ROLE_CREATE_USERS.toString()],i=e.roles.some((function(e){return t.includes(e.name)})),n=e.roles.findIndex((function(e){return e.name===R.db.ROLE_CREATE_USER_INFOS}));i?-1===n&&e.roles.push({name:R.db.ROLE_CREATE_USER_INFOS}):-1!==n&&e.roles.splice(n,1)}},{key:"onSubmit",value:function(){var e=this;if(!this.adminProfileForm.invalid){var t=this.adminProfileForm.getRawValue();this.completeUpdateRoles(t),this.completeCreateRoles(t),this.rngProfileService.create(t).subscribe((function(){return e.dialogRef.close(!0)}),(function(e){console.error(e)}))}}}]),e}()).\u0275fac=function(e){return new(e||be)(y.Nb(ie.g),y.Nb(ie.a),y.Nb(M.a),y.Nb(R.k),y.Nb(ne.a),y.Nb(W),y.Nb(p.d),y.Nb(R.t))},be.\u0275cmp=y.Hb({type:be,selectors:[["app-profile-create"]],decls:51,vars:51,consts:[[1,"header"],[3,"index","count"],[3,"formGroup","ngSubmit"],[1,"content","vitamui-form"],[1,"text","large","bold"],[1,"mb-2"],["formControlName","enabled"],[4,"ngIf"],["formControlName","name","minlength","2","maxlength","100","required","",1,"col-9","px-0",3,"placeholder"],["formControlName","description","minlength","2","maxlength","250","required","",1,"col-9","px-0",3,"placeholder"],[1,"d-flex"],[1,"mr-4","p-2"],[1,"text","normal","light"],[1,"text","medium","bold"],["formControlName","level",3,"prefix"],["formControlName","roles",1,"d-flex","flex-column"],[3,"name"],[1,"d-flex","mt-4"],["type","submit",1,"btn","primary","mr-4",3,"disabled"],["type","button",1,"btn","link","cancel",3,"click"]],template:function(e,t){if(1&e&&(y.Tb(0,"div",0),y.Ob(1,"vitamui-common-progress-bar",1),y.Sb(),y.Tb(2,"form",2),y.ec("ngSubmit",(function(){return t.onSubmit()})),y.Tb(3,"div",3),y.Tb(4,"div",4),y.Oc(5),y.jc(6,"translate"),y.Sb(),y.Tb(7,"div",5),y.Tb(8,"vitamui-common-slide-toggle",6),y.Mc(9,re,3,3,"span",7),y.Mc(10,oe,3,3,"span",7),y.Sb(),y.Sb(),y.Tb(11,"vitamui-common-input",8),y.jc(12,"translate"),y.Mc(13,le,3,3,"vitamui-common-input-error",7),y.Mc(14,ae,3,3,"vitamui-common-input-error",7),y.Sb(),y.Tb(15,"vitamui-common-input",9),y.jc(16,"translate"),y.Mc(17,ce,3,3,"vitamui-common-input-error",7),y.Sb(),y.Tb(18,"div",10),y.Tb(19,"div",11),y.Tb(20,"div",12),y.Oc(21),y.jc(22,"translate"),y.Sb(),y.Tb(23,"div",13),y.Oc(24),y.Sb(),y.Sb(),y.Tb(25,"vitamui-common-level-input",14),y.Mc(26,ue,3,3,"vitamui-common-input-error",7),y.Mc(27,se,3,3,"vitamui-common-input-error",7),y.Sb(),y.Sb(),y.Tb(28,"vitamui-common-role-toggle",15),y.Tb(29,"vitamui-common-role",16),y.Oc(30),y.jc(31,"translate"),y.Sb(),y.Tb(32,"vitamui-common-role",16),y.Oc(33),y.jc(34,"translate"),y.Sb(),y.Tb(35,"vitamui-common-role",16),y.Oc(36),y.jc(37,"translate"),y.Sb(),y.Tb(38,"vitamui-common-role",16),y.Oc(39),y.jc(40,"translate"),y.Sb(),y.Tb(41,"vitamui-common-role",16),y.Oc(42),y.jc(43,"translate"),y.Sb(),y.Sb(),y.Tb(44,"div",17),y.Tb(45,"button",18),y.Oc(46),y.jc(47,"translate"),y.Sb(),y.Tb(48,"button",19),y.ec("click",(function(){return t.onCancel()})),y.Oc(49),y.jc(50,"translate"),y.Sb(),y.Sb(),y.Sb(),y.Sb()),2&e){var i=null,n=null,r=null,o=null,l=null;y.Bb(1),y.oc("index",0)("count",1),y.Bb(1),y.oc("formGroup",t.adminProfileForm),y.Bb(3),y.Pc(y.kc(6,29,"USER_PROFILE.INFORMATIONS.MODAL.TITLE")),y.Bb(4),y.oc("ngIf",!(null!=t.adminProfileForm&&t.adminProfileForm.get("enabled").value)),y.Bb(1),y.oc("ngIf",null==t.adminProfileForm?null:t.adminProfileForm.get("enabled").value),y.Bb(1),y.oc("placeholder",y.kc(12,31,"USER_PROFILE.HOME.TITLE_PLACEHOLDER")),y.Bb(2),y.oc("ngIf",(null==t.adminProfileForm||null==(i=t.adminProfileForm.get("name"))?null:i.touched)&&!(null==t.adminProfileForm||null==(i=t.adminProfileForm.get("name"))||null==i.errors||!i.errors.required)),y.Bb(1),y.oc("ngIf",(null==t.adminProfileForm||null==(n=t.adminProfileForm.get("name"))?null:n.touched)&&!(null==t.adminProfileForm||null==(n=t.adminProfileForm.get("name"))||null==n.errors||!n.errors.nameExists)),y.Bb(1),y.oc("placeholder",y.kc(16,33,"USER_PROFILE.INFORMATIONS.DESCRIPTION")),y.Bb(2),y.oc("ngIf",(null==t.adminProfileForm||null==(r=t.adminProfileForm.get("description"))?null:r.touched)&&!(null==t.adminProfileForm||null==(r=t.adminProfileForm.get("description"))||null==r.errors||!r.errors.required)),y.Bb(4),y.Pc(y.kc(22,35,"USER_PROFILE.INFORMATIONS.LEVEL")),y.Bb(3),y.Pc(t.authService.user.level),y.Bb(1),y.oc("prefix",t.authService.user.level),y.Bb(1),y.oc("ngIf",(null==t.adminProfileForm||null==(o=t.adminProfileForm.get("level"))?null:o.touched)&&(null==t.adminProfileForm||null==(o=t.adminProfileForm.get("level"))?null:o.hasError("required"))),y.Bb(1),y.oc("ngIf",(null==t.adminProfileForm||null==(l=t.adminProfileForm.get("level"))?null:l.touched)&&(null==t.adminProfileForm||null==(l=t.adminProfileForm.get("level"))?null:l.hasError("pattern"))),y.Bb(2),y.oc("name",t.roleEnum.ROLE_MFA_USERS),y.Bb(1),y.Pc(y.kc(31,37,"USER_PROFILE.INFORMATIONS.STRONG_AUTHENT")),y.Bb(2),y.oc("name",t.roleEnum.ROLE_CREATE_USERS),y.Bb(1),y.Pc(y.kc(34,39,"USER_PROFILE.INFORMATIONS.USERS_CREATION")),y.Bb(2),y.oc("name",t.roleEnum.ROLE_UPDATE_STANDARD_USERS),y.Bb(1),y.Pc(y.kc(37,41,"USER_PROFILE.INFORMATIONS.MODIF_INFORMATIONS")),y.Bb(2),y.oc("name",t.roleEnum.ROLE_ANONYMIZATION_USERS),y.Bb(1),y.Pc(y.kc(40,43,"USER_PROFILE.INFORMATIONS.ANONYMOUS")),y.Bb(2),y.oc("name",t.roleEnum.ROLE_GENERIC_USERS),y.Bb(1),y.Pc(y.kc(43,45,"USER_PROFILE.INFORMATIONS.USERS_MANAGEMENT")),y.Bb(3),y.oc("disabled",t.firstStepInvalid()),y.Bb(1),y.Qc(" ",y.kc(47,47,"COMMON.SUBMIT")," "),y.Bb(3),y.Qc(" ",y.kc(50,49,"COMMON.UNDO")," ")}},directives:[R.dc,p.y,p.r,p.i,R.ac,p.q,p.g,d.p,R.Qb,p.m,p.l,p.w,R.R,R.fb,R.eb,R.Rb],pipes:[q.d],styles:[""],data:{animation:[R.Hb]}}),be),fe=a("ZTXN"),de=a("g6G6"),pe=a("jIqt"),Se=a("mWib");function ve(e,t){if(1&e){var i=y.Ub();y.Tb(0,"div",13),y.ec("click",(function(){y.Dc(i);var e=t.$implicit;return y.ic().profileClick.emit(e)})),y.Tb(1,"div",14),y.Tb(2,"div",3),y.Ob(3,"i",15),y.Sb(),y.Tb(4,"div",16),y.Oc(5),y.Sb(),y.Tb(6,"div",17),y.Oc(7),y.Sb(),y.Tb(8,"div",17),y.Oc(9),y.jc(10,"truncate"),y.Sb(),y.Tb(11,"div",17),y.Oc(12),y.Sb(),y.Tb(13,"div",17),y.Oc(14),y.Sb(),y.Sb(),y.Sb()}if(2&e){var n=t.$implicit;y.Bb(3),y.oc("ngClass",null!=n&&n.enabled?"status-badge-green":"status-badge-grey"),y.Bb(2),y.Pc(n.name),y.Bb(2),y.Pc(n.identifier),y.Bb(2),y.Pc(y.lc(10,6,n.description,50)),y.Bb(3),y.Pc(n.level),y.Bb(2),y.Pc(n.usersCount)}}function Oe(e,t){1&e&&y.Ob(0,"div")}function Ee(e,t){1&e&&y.Ob(0,"div")}function Re(e,t){1&e&&y.Ob(0,"div")}function he(e,t){1&e&&(y.Tb(0,"div",18),y.Oc(1),y.jc(2,"translate"),y.Sb()),2&e&&(y.Bb(1),y.Pc(y.kc(2,1,"COMMON.NO_RESULT")))}function Te(e,t){if(1&e){var i=y.Ub();y.Tb(0,"div",19),y.ec("click",(function(){return y.Dc(i),y.ic().rngProfileService.loadMore()})),y.Tb(1,"span",20),y.Oc(2),y.jc(3,"translate"),y.Sb(),y.Sb()}2&e&&(y.Bb(2),y.Qc("A",y.kc(3,1,"COMMON.SHOW_MORE_RESULTS"),""))}function Ie(e,t){1&e&&(y.Tb(0,"div",21),y.Ob(1,"mat-spinner",22),y.Sb())}var Pe,ge,Ne,ye,_e=((Pe=function(t){function r(e){var t;return b(this,r),(t=i(this,r,[e])).rngProfileService=e,t.orderBy="name",t.direction=R.x.ASCENDANT,t.filterChange=new fe.a,t.searchChange=new fe.a,t.orderChange=new fe.a,t.searchKeys=["name","description","identifier"],t.profileClick=new y.n,t.updatedProfileSub=t.rngProfileService.updated.subscribe((function(e){var i=t.dataSource.findIndex((function(t){return e.id===t.id}));i>-1&&(t.dataSource[i]={id:t.dataSource[i].id,identifier:e.identifier,enabled:e.enabled,name:e.name,level:e.level,customerId:e.customerId,groupsCount:e.groupsCount,description:e.description,usersCount:t.dataSource[i].usersCount,tenantIdentifier:t.dataSource[i].tenantIdentifier,tenantName:t.dataSource[i].tenantName,applicationName:t.dataSource[i].applicationName,roles:t.dataSource[i].roles,readonly:t.dataSource[i].readonly,externalParamId:t.dataSource[i].externalParamId})})),t}return l(r,t),u(r,[{key:"searchText",set:function(e){this._searchText=e,this.searchChange.next(e)}},{key:"ngOnInit",value:function(){var e=this;Object(de.a)(this.searchChange,this.filterChange,this.orderChange).pipe(Object(pe.a)(null),Object(Se.a)(400)).subscribe((function(){return e.search()}))}},{key:"ngOnDestroy",value:function(){this.updatedProfileSub.unsubscribe()}},{key:"search",value:function(){var t={criteria:[{key:"applicationName",value:R.h.USERS_APP,operator:R.W.equals}].concat(e(Object(R.Fb)(this._searchText,this.searchKeys)))},i=new R.Z(0,R.w,this.orderBy,this.direction,JSON.stringify(t));n(o(r.prototype),"search",this).call(this,i)}}]),r}(R.O)).\u0275fac=function(e){return new(e||Pe)(y.Nb(M.a))},Pe.\u0275cmp=y.Hb({type:Pe,selectors:[["app-profile-list"]],inputs:{searchText:["search","searchText"]},outputs:{profileClick:"profileClick"},features:[y.yb],decls:31,vars:22,consts:[["vitamuiCommonInfiniteScroll","",3,"vitamuiScroll"],[1,"vitamui-table"],[1,"vitamui-table-head"],[1,"col-1"],[1,"vitamui-icon","vitamui-icon-gestion-de-profil"],[1,"col-3"],[1,"col-2"],[1,"vitamui-table-body"],["class","vitamui-table-rows",3,"click",4,"ngFor","ngForOf"],[4,"ngIf","ngIfThen"],["noResults",""],["loadMore",""],["loadingSpinner",""],[1,"vitamui-table-rows",3,"click"],[1,"vitamui-row","d-flex","align-items-center","clickable"],[1,"vitamui-icon","vitamui-icon-gestion-de-profil",3,"ngClass"],["vitamuiCommonEllipsis","",1,"col-3"],["vitamuiCommonEllipsis","",1,"col-2"],[1,"vitamui-min-content","vitamui-table-message"],[1,"vitamui-min-content","vitamui-table-message",3,"click"],[1,"clickable"],[1,"vitamui-min-content"],[1,"vitamui-spinner","medium"]],template:function(e,t){if(1&e&&(y.Tb(0,"div",0),y.ec("vitamuiScroll",(function(){return t.onScroll()})),y.Tb(1,"div",1),y.Tb(2,"div",2),y.Tb(3,"div",3),y.Ob(4,"i",4),y.Sb(),y.Tb(5,"div",5),y.Oc(6),y.jc(7,"translate"),y.Sb(),y.Tb(8,"div",6),y.Oc(9),y.jc(10,"translate"),y.Sb(),y.Tb(11,"div",6),y.Oc(12),y.jc(13,"translate"),y.Sb(),y.Tb(14,"div",6),y.Oc(15),y.jc(16,"translate"),y.Sb(),y.Tb(17,"div",6),y.Oc(18),y.jc(19,"translate"),y.Sb(),y.Sb(),y.Tb(20,"div",7),y.Mc(21,ve,15,9,"div",8),y.Sb(),y.Sb(),y.Mc(22,Oe,1,0,"div",9),y.Mc(23,Ee,1,0,"div",9),y.Mc(24,Re,1,0,"div",9),y.Sb(),y.Mc(25,he,3,3,"ng-template",null,10,y.Nc),y.Mc(27,Te,4,3,"ng-template",null,11,y.Nc),y.Mc(29,Ie,2,0,"ng-template",null,12,y.Nc)),2&e){var i=y.zc(26),n=y.zc(28),r=y.zc(30);y.Bb(6),y.Pc(y.kc(7,12,"USER_PROFILE.HOME.RESULTS_TABLE.NAME")),y.Bb(3),y.Pc(y.kc(10,14,"COMMON.ID")),y.Bb(3),y.Pc(y.kc(13,16,"USER_PROFILE.HOME.RESULTS_TABLE.DESCRIPTION")),y.Bb(3),y.Pc(y.kc(16,18,"USER_PROFILE.HOME.RESULTS_TABLE.LEVEL")),y.Bb(3),y.Pc(y.kc(19,20,"USER_PROFILE.HOME.RESULTS_TABLE.USERS_NUMBER")),y.Bb(3),y.oc("ngForOf",t.dataSource),y.Bb(1),y.oc("ngIf",!t.dataSource||t.pending)("ngIfThen",r),y.Bb(1),y.oc("ngIf",!t.pending&&0===(null==t.dataSource?null:t.dataSource.length))("ngIfThen",i),y.Bb(1),y.oc("ngIf",t.infiniteScrollDisabled&&t.rngProfileService.canLoadMore&&!t.pending)("ngIfThen",n)}},directives:[R.N,d.o,d.p,d.n,R.Zb,C.b],pipes:[q.d,R.qc],styles:[""]}),Pe),Fe=[{path:"",component:(ge=function(e){function t(e,n,r){var o;return b(this,t),(o=i(this,t,[n,r])).dialog=e,o.route=n,o.globalEventService=r,o}return l(t,e),u(t,[{key:"openProfilAdminCreateDialog",value:function(){var e=this;this.dialog.open(me,{panelClass:"vitamui-modal",disableClose:!0}).afterClosed().subscribe((function(t){t&&e.refreshList()}))}},{key:"onSearchSubmit",value:function(e){this.search=e}},{key:"refreshList",value:function(){this.profileListComponent&&this.profileListComponent.search()}}]),t}(R.kb),ge.\u0275fac=function(e){return new(e||ge)(y.Nb(ie.b),y.Nb(k.a),y.Nb(R.M))},ge.\u0275cmp=y.Hb({type:ge,selectors:[["app-profile"]],viewQuery:function(e,t){var i;1&e&&y.Ic(_e,!0),2&e&&y.yc(i=y.fc())&&(t.profileListComponent=i.first)},features:[y.yb],decls:17,vars:14,consts:[[3,"autosize","hasBackdrop"],["mode","side","position","end",3,"fixedInViewport"],["panel",""],[3,"profile","profileClose"],[1,"vitamui-heading"],[3,"searchbarPlaceholder","search"],[1,"btn","primary","ml-5",3,"click"],[1,"vitamui-content"],[3,"search","profileClick"]],template:function(e,t){1&e&&(y.Tb(0,"mat-sidenav-container",0),y.Tb(1,"mat-sidenav",1,2),y.Tb(3,"app-profile-detail",3),y.ec("profileClose",(function(){return t.closePanel()})),y.Sb(),y.Sb(),y.Tb(4,"mat-sidenav-content"),y.Tb(5,"div",4),y.Tb(6,"vitamui-common-title-breadcrumb"),y.Oc(7),y.jc(8,"translate"),y.Sb(),y.Tb(9,"vitamui-common-banner",5),y.ec("search",(function(e){return t.onSearchSubmit(e)})),y.jc(10,"translate"),y.Tb(11,"button",6),y.ec("click",(function(){return t.openProfilAdminCreateDialog()})),y.Tb(12,"span"),y.Oc(13),y.jc(14,"translate"),y.Sb(),y.Sb(),y.Sb(),y.Sb(),y.Tb(15,"div",7),y.Tb(16,"app-profile-list",8),y.ec("profileClick",(function(e){return t.openPanel(e)})),y.Sb(),y.Sb(),y.Sb(),y.Sb()),2&e&&(y.oc("autosize",!0)("hasBackdrop",!1),y.Bb(1),y.oc("fixedInViewport",!0),y.Bb(2),y.oc("profile",t.openedItem),y.Bb(4),y.Qc(" ",y.kc(8,8,"APPLICATION.PROFILES_APP.NAME")," "),y.Bb(2),y.oc("searchbarPlaceholder",y.kc(10,10,"USER_PROFILE.HOME.TITLE_PLACEHOLDER")),y.Bb(4),y.Pc(y.kc(14,12,"USER_PROFILE.HOME.ACTION_BUTTON")),y.Bb(3),y.oc("search",t.search))},directives:[E.b,E.a,$,E.c,R.cc,R.jc,_e],pipes:[q.d],styles:[""]}),ge),pathMatch:"full"},{path:":id",component:ee,resolve:{profile:te},data:{isPopup:!0,appId:"PROFILES_APP"}}],Ae=((ye=u((function e(){b(this,e)}))).\u0275mod=y.Lb({type:ye}),ye.\u0275inj=y.Kb({factory:function(e){return new(e||ye)},imports:[[d.c,k.g.forChild(Fe)],k.g]}),ye),Ue=((Ne=u((function e(){b(this,e)}))).\u0275mod=y.Lb({type:Ne}),Ne.\u0275inj=y.Kb({factory:function(e){return new(e||Ne)},imports:[[d.c,R.xb,h.a,S.c,v.b,L,U,O.b,p.v,_,T.a,R.S,E.d,Ae]]}),Ne)}}])}();