(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{g1uF:function(t,e,i){"use strict";i.r(e),i.d(e,"SubrogationModule",(function(){return F}));var r=i("2kYt"),s=i("nIj0"),c=i("OZ4H"),n=i("66mq"),a=i("csyo"),o=i("R7+U"),u=i("lQ7A"),l=i("OWX3"),b=i("PCNd"),d=i("sEIs"),m=i("ZTXN"),h=i("TLy2"),g=i("kuMc"),p=i("ROBh"),v=i("4e/d"),S=i("YtkY"),O=i("vobO"),f=i("guXd"),T=i("EM62");let y=(()=>{class t{constructor(t){this.customerApi=t}getAll(t){const e={criteria:[{key:"subrogeable",value:t,operator:l.W.equals}]},i=(new O.g).set("criteria",JSON.stringify(e));return this.customerApi.getAllByParams(i).pipe(Object(v.a)(()=>Object(p.a)([])),Object(S.a)(t=>(this.customers=t,(t||[]).map(t=>({value:t.id,label:t.code+" - "+t.name})))))}getCustomers(){return this.customers}}return t.\u0275fac=function(e){return new(e||t)(T.bc(f.a))},t.\u0275prov=T.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var I=i("P4Xx");let B=(()=>{class t extends l.o{constructor(t,e){super(t,e+"/subrogations/users/generic")}getAllPaginated(t,e,i){return super.getAllPaginated(t,e,i)}}return t.\u0275fac=function(e){return new(e||t)(T.bc(O.c),T.bc(l.n))},t.\u0275prov=T.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),C=(()=>{class t extends l.jb{constructor(t,e){super(t),this.subrogationApiService=e}getGroupById(t){return this.subrogationApiService.getGroupById(t)}getAllByCustomerId(t){const e=[];e.push({key:"surrogateCustomerId",value:t,operator:l.W.equals});const i={criteria:e},r=(new O.g).set("criteria",JSON.stringify(i));return this.subrogationApiService.getAllByParams(r)}}return t.\u0275fac=function(e){return new(e||t)(T.bc(B),T.bc(l.nb))},t.\u0275prov=T.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var E=i("s2Ay");function A(t,e){1&t&&(T.Tb(0,"div",23),T.Ob(1,"div",24),T.Ob(2,"div",24),T.Ob(3,"div",25),T.Sb())}function N(t,e){1&t&&(T.Tb(0,"div",23),T.Ob(1,"div",24),T.Ob(2,"div",25),T.Ob(3,"div",25),T.Sb())}function M(t,e){1&t&&(T.Tb(0,"div",23),T.Ob(1,"div",24),T.Ob(2,"div",24),T.Ob(3,"div",24),T.Sb())}function U(t,e){1&t&&(T.Tb(0,"span",26),T.Oc(1),T.jc(2,"translate"),T.Sb()),2&t&&(T.Bb(1),T.Pc(T.kc(2,1,"SUBROGATION.HOME.SUBROGATION_WIP")))}const P=function(t){return{param1:t}};function k(t,e){if(1&t&&(T.Tb(0,"span",26),T.Oc(1),T.jc(2,"translate"),T.Sb()),2&t){const t=T.ic().$implicit;T.Bb(1),T.Pc(T.lc(2,1,"SUBROGATION.HOME.SUBROGATE_BY",T.tc(4,P,t.superUserEmail)))}}function _(t,e){if(1&t){const t=T.Ub();T.Tb(0,"button",27),T.ec("click",(function(){T.Dc(t);const e=T.ic().$implicit;return T.ic().openUserSubrogationDialog(e)})),T.Oc(1),T.jc(2,"translate"),T.Sb()}if(2&t){const t=T.ic().$implicit;T.oc("disabled","ENABLED"!==t.status||!t.subrogeable),T.Bb(1),T.Qc(" ",T.kc(2,2,"SUBROGATION.HOME.RESULTS_TABLE.ACTION_BUTTON")," ")}}function w(t,e){if(1&t&&(T.Tb(0,"div",13),T.Tb(1,"div",14),T.Tb(2,"div",3),T.Ob(3,"i",15),T.Sb(),T.Tb(4,"div",16),T.Oc(5),T.Sb(),T.Tb(6,"div",5),T.Rb(7,17),T.Mc(8,A,4,0,"div",18),T.Mc(9,N,4,0,"div",18),T.Mc(10,M,4,0,"div",18),T.Qb(),T.Sb(),T.Tb(11,"div",16),T.Oc(12),T.Sb(),T.Tb(13,"div",19),T.Oc(14),T.Sb(),T.Tb(15,"div",20),T.Mc(16,U,3,3,"span",21),T.Mc(17,k,3,6,"span",21),T.Sb(),T.Tb(18,"div",20),T.Mc(19,_,3,4,"button",22),T.Sb(),T.Sb(),T.Sb()),2&t){const t=e.$implicit,r=T.ic();var i;T.Bb(3),T.oc("ngClass","ENABLED"===(null==t?null:t.status)?"status-badge-green":"DISABLED"===(null==t?null:t.status)||"ANONYM"===(null==t?null:t.status)?"status-badge-grey":"status-badge-orange"),T.Bb(2),T.Rc("",null==t?null:t.lastname," ",null==t?null:t.firstname,""),T.Bb(2),T.oc("ngSwitch",null==t?null:t.criticality),T.Bb(1),T.oc("ngSwitchCase",0),T.Bb(1),T.oc("ngSwitchCase",1),T.Bb(1),T.oc("ngSwitchCase",2),T.Bb(2),T.Pc(null==(i=r.getGroup(t))?null:i.name),T.Bb(2),T.Pc(null==t?null:t.identifier),T.Bb(2),T.oc("ngIf",t.superUserEmail&&t.superUserEmail===r.currenteUser.email),T.Bb(1),T.oc("ngIf",t.superUserEmail&&t.superUserEmail!==r.currenteUser.email),T.Bb(2),T.oc("ngIf",!t.superUserEmail||t.superUserEmail===r.currenteUser.email)}}function R(t,e){1&t&&T.Ob(0,"div")}function D(t,e){1&t&&T.Ob(0,"div")}function j(t,e){1&t&&T.Ob(0,"div")}function x(t,e){1&t&&(T.Tb(0,"div",28),T.Oc(1),T.jc(2,"translate"),T.Sb()),2&t&&(T.Bb(1),T.Pc(T.kc(2,1,"COMMON.NO_RESULT")))}function L(t,e){if(1&t){const t=T.Ub();T.Tb(0,"div",29),T.ec("click",(function(){return T.Dc(t),T.ic().subrogationService.loadMore()})),T.Tb(1,"span",30),T.Oc(2),T.jc(3,"translate"),T.Sb(),T.Sb()}2&t&&(T.Bb(2),T.Pc(T.kc(3,1,"COMMON.SHOW_MORE_RESULTS")))}function G(t,e){1&t&&(T.Tb(0,"div",31),T.Ob(1,"mat-spinner",32),T.Sb())}let H=(()=>{class t extends l.O{constructor(t,e,i,r,s){super(t),this.subrogationService=t,this.dialog=e,this.activatedRoute=i,this.subrogationModalService=r,this.authService=s,this.groups=[],this.loaded=!1,this.searchChange=new m.a,this.searchKeys=["firstname","lastname","email","mobile","phone","identifier"]}set searchText(t){this._searchText=t,this.searchChange.next(t)}ngOnInit(){this.currenteUser=this.authService.user,this.refreshDataList(),this.activatedRoute.params.subscribe(()=>this.refreshDataList()),this.updatedData.subscribe(()=>{const t=new Set(this.dataSource.map(t=>t.groupId)),e=new Array;t.forEach(t=>{this.groups.find(e=>e.id===t)||e.push(this.subrogationService.getGroupById(t))}),e&&e.length>0?Object(I.a)([Object(I.a)(e),this.subrogationService.getAllByCustomerId(this._getCustomerId())]).subscribe(t=>{t[0].forEach(t=>{this.groups.push({id:t.id,group:t})});const e=t[1];this.dataSource.filter(t=>!t.criticality).forEach(t=>{const i=this.getGroup(t),r=e.find(e=>e.surrogate===t.email);r&&r.superUser&&(t.superUserEmail=r.superUser),i&&(t.criticality=this.computeCriticality(i.profiles))}),this.loaded=!0,this.pending=!1}):(this.loaded=!0,this.pending=!1)}),this._onSearchChange()}openUserSubrogationDialog(t){this.subrogationModalService.open(this.emailDomains,t.customerId,t)}getGroup(t){const e=this.groups.find(e=>e.id===t.groupId);return e?e.group:void 0}refreshDataList(){this._search({criteria:this._getCriterionArrayToCustomer()})}_getCriterionArrayToCustomer(){const t=[];return t.push({key:"customerId",value:this._getCustomerId(),operator:l.W.equals}),t.push({key:"status",value:"ENABLED",operator:l.W.equals}),t}_onSearchChange(){this.searchChange.subscribe(()=>{const t={criteria:[...this._getCriterionArrayToCustomer(),...Object(l.Fb)(this._searchText,this.searchKeys)]};this._search(t)})}_search(t){this.search(new l.Z(0,l.w,"lastname",l.x.ASCENDANT,JSON.stringify(t)))}_getCustomerId(){return this.activatedRoute.snapshot.paramMap.get("customerId")}computeCriticality(t){let e=0;for(const i of t){if(i.applicationName===l.h.CUSTOMERS_APP){e=2;break}e<2&&(i.applicationName===l.h.USERS_APP||i.applicationName===l.h.PROFILES_APP||i.applicationName===l.h.SUBROGATIONS_APP||i.applicationName===l.h.GROUPS_APP)&&(e=1)}return e}ngOnDestroy(){this.updatedData.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(T.Nb(C),T.Nb(c.b),T.Nb(d.a),T.Nb(l.ob),T.Nb(l.k))},t.\u0275cmp=T.Hb({type:t,selectors:[["app-subrogate-user-list"]],inputs:{emailDomains:"emailDomains",searchText:["search","searchText"]},features:[T.yb],decls:28,vars:16,consts:[["vitamuiCommonInfiniteScroll","",3,"vitamuiScroll"],[1,"vitamui-table"],[1,"vitamui-table-head"],[1,"col-1"],[1,"vitamui-icon","vitamui-icon-user"],[1,"col-2"],[1,"col-4"],[1,"vitamui-table-body"],["class","vitamui-table-rows",4,"ngFor","ngForOf"],[4,"ngIf","ngIfThen"],["noResults",""],["loadMore",""],["loadingSpinner",""],[1,"vitamui-table-rows"],[1,"vitamui-row","d-flex","align-items-center"],[1,"vitamui-icon","vitamui-icon-user",3,"ngClass"],["vitamuiCommonEllipsis","",1,"col-2"],[3,"ngSwitch"],["class","d-flex",4,"ngSwitchCase"],["vitamuiCommonEllipsis","",1,"col-1"],[1,"col-2","d-flex","justify-content-end"],["class","text normal bold danger","vitamuiCommonEllipsis","",4,"ngIf"],["class","btn outline-primary",3,"disabled","click",4,"ngIf"],[1,"d-flex"],["id","rectangle-criticity-high"],["id","rectangle-criticity-low"],["vitamuiCommonEllipsis","",1,"text","normal","bold","danger"],[1,"btn","outline-primary",3,"disabled","click"],[1,"vitamui-min-content","vitamui-table-message"],[1,"vitamui-min-content","vitamui-table-message",3,"click"],[1,"clickable"],[1,"vitamui-min-content"],[1,"vitamui-spinner","medium"]],template:function(t,e){if(1&t&&(T.Tb(0,"div",0),T.ec("vitamuiScroll",(function(){return e.onScroll()})),T.Tb(1,"div",1),T.Tb(2,"div",2),T.Tb(3,"div",3),T.Ob(4,"i",4),T.Sb(),T.Tb(5,"div",5),T.Oc(6),T.jc(7,"translate"),T.Sb(),T.Tb(8,"div",5),T.Oc(9),T.jc(10,"translate"),T.Sb(),T.Tb(11,"div",5),T.Oc(12),T.jc(13,"translate"),T.Sb(),T.Tb(14,"div",3),T.Oc(15,"ID"),T.Sb(),T.Ob(16,"div",6),T.Sb(),T.Tb(17,"div",7),T.Mc(18,w,20,12,"div",8),T.Sb(),T.Sb(),T.Mc(19,R,1,0,"div",9),T.Mc(20,D,1,0,"div",9),T.Mc(21,j,1,0,"div",9),T.Sb(),T.Mc(22,x,3,3,"ng-template",null,10,T.Nc),T.Mc(24,L,4,3,"ng-template",null,11,T.Nc),T.Mc(26,G,2,0,"ng-template",null,12,T.Nc)),2&t){const t=T.zc(23),i=T.zc(25),r=T.zc(27);T.Bb(6),T.Pc(T.kc(7,10,"SUBROGATION.HOME.RESULTS_TABLE.NAME")),T.Bb(3),T.Pc(T.kc(10,12,"SUBROGATION.HOME.RESULTS_TABLE.CRITICITY")),T.Bb(3),T.Pc(T.kc(13,14,"SUBROGATION.HOME.RESULTS_TABLE.GROUP")),T.Bb(6),T.oc("ngForOf",e.dataSource),T.Bb(1),T.oc("ngIf",!e.dataSource||e.pending)("ngIfThen",r),T.Bb(1),T.oc("ngIf",!e.pending&&0===(null==e.dataSource?null:e.dataSource.length))("ngIfThen",t),T.Bb(1),T.oc("ngIf",e.infiniteScrollDisabled&&e.subrogationService.canLoadMore&&!e.pending)("ngIfThen",i)}},directives:[l.N,r.o,r.p,r.n,l.Zb,r.r,r.s,a.b],pipes:[E.d],styles:[".criticity-column[_ngcontent-%COMP%]{display:flex;align-items:center}#rectangle-criticity-high[_ngcontent-%COMP%]{background:var(--vitamui-grey)}#rectangle-criticity-high[_ngcontent-%COMP%], #rectangle-criticity-low[_ngcontent-%COMP%]{width:20px;height:10px;border-radius:3px;margin-right:5px}#rectangle-criticity-low[_ngcontent-%COMP%]{background:var(--vitamui-grey-300)}.user-in-subrogation-label[_ngcontent-%COMP%]{color:red}.user-current-in-subrogation-label[_ngcontent-%COMP%]{color:red;margin-left:20px}"]}),t})(),J=(()=>{class t extends l.f{constructor(t,e,i,r,s,c,n){super(r),this.dialog=t,this.globalEventService=e,this.router=i,this.route=r,this.subrogationModalService=s,this.customerSelectService=c,this.customerSelectionService=n,this.destroyer$=new m.a}ngOnInit(){this.customerSelectService.getAll(!0).pipe(Object(h.a)(t=>(this.customers=t,this.customerSelectionService.setCustomers(t),this.route.paramMap))).subscribe(t=>{const e=t.get("customerId"),i=this.customerSelectionService.getSelectedCustomerId();i&&i===e?this.updateCustomer(i):(this.customerSelectionService.setCustomerId(e),this.updateCustomer(e)),this.globalEventService.customerEvent.pipe(Object(g.a)(this.destroyer$)).subscribe(t=>{this.customer&&this.customer.identifier===t||this.changeCustomer(t)})})}ngOnDestroy(){this.destroyer$.next(),this.destroyer$.complete()}openUserSubrogationDialog(){this.subrogationModalService.open(this.customer.emailDomains,this.customer.id)}onSearchSubmit(t){this.search=t}changeCustomer(t){this.router.navigate(["..",t],{relativeTo:this.route})}updateCustomer(t){const e=this.customerSelectService.getCustomers();e&&(this.customer=e.find(e=>e.id===t))}}return t.\u0275fac=function(e){return new(e||t)(T.Nb(c.b),T.Nb(l.M),T.Nb(d.d),T.Nb(d.a),T.Nb(l.ob),T.Nb(y),T.Nb(l.v))},t.\u0275cmp=T.Hb({type:t,selectors:[["app-subrogate-user"]],features:[T.yb],decls:13,vars:13,consts:[[3,"autosize","hasBackdrop"],[1,"vitamui-heading"],[3,"searchbarPlaceholder","search"],[1,"btn","primary","ml-5",3,"click"],[1,"vitamui-content"],[3,"search","emailDomains"]],template:function(t,e){1&t&&(T.Tb(0,"mat-sidenav-container",0),T.Tb(1,"mat-sidenav-content"),T.Tb(2,"div",1),T.Tb(3,"vitamui-common-title-breadcrumb"),T.Oc(4),T.jc(5,"translate"),T.Sb(),T.Tb(6,"vitamui-common-banner",2),T.ec("search",(function(t){return e.onSearchSubmit(t)})),T.jc(7,"translate"),T.Tb(8,"button",3),T.ec("click",(function(){return e.openUserSubrogationDialog()})),T.Oc(9),T.jc(10,"translate"),T.Sb(),T.Sb(),T.Sb(),T.Tb(11,"div",4),T.Ob(12,"app-subrogate-user-list",5),T.Sb(),T.Sb(),T.Sb()),2&t&&(T.oc("autosize",!0)("hasBackdrop",!1),T.Bb(4),T.Qc(" ",T.kc(5,7,"SUBROGATION.HOME.TITLE")," "),T.Bb(2),T.oc("searchbarPlaceholder",T.kc(7,9,"SUBROGATION.HOME.TITLE_PLACEHOLDER")),T.Bb(3),T.Qc(" ",T.kc(10,11,"SUBROGATION.HOME.ACTION_BUTTON")," "),T.Bb(3),T.oc("search",e.search)("emailDomains",null==e.customer?null:e.customer.emailDomains))},directives:[u.b,u.c,l.cc,l.jc,H],pipes:[E.d],styles:[""]}),t})();const $=[{path:"",redirectTo:"customer",pathMatch:"full"},{path:"customer",component:l.yb,resolve:{customers:(()=>{class t{constructor(t,e){this.customerSearchService=t,this.router=e}resolve(){return this.customerSearchService.getAll(!0).pipe(Object(S.a)(t=>t||(this.router.navigate(["/"]),null)))}}return t.\u0275fac=function(e){return new(e||t)(T.bc(y),T.bc(d.d))},t.\u0275prov=T.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()}},{path:"customer/:customerId",component:J}];let W=(()=>{class t{}return t.\u0275mod=T.Lb({type:t}),t.\u0275inj=T.Kb({factory:function(e){return new(e||t)},imports:[[r.c,d.g.forChild($)],d.g]}),t})(),F=(()=>{class t{}return t.\u0275mod=T.Lb({type:t}),t.\u0275inj=T.Kb({factory:function(e){return new(e||t)},imports:[[r.c,l.xb,b.a,c.f,u.d,o.b,a.a,n.b,s.v,W]]}),t})()}}]);