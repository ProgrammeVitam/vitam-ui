(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{Po3Y:function(e,t,i){"use strict";i.r(t),i.d(t,"ArchiveSearchCollectModule",(function(){return wr}));var c=i("2kYt"),a=i("nIj0"),r=i("gcUQ"),n=i("OZ4H"),s=i("29Wa"),l=i("csyo"),o=i("R7+U"),d=i("lQ7A"),u=i("KZIX"),h=i("QcI7"),C=i("OWX3"),E=i("sEIs"),R=i("bwdy"),p=i("ZTXN"),v=i("C05f"),I=i("g6G6"),T=i("8j5Y"),g=i("cJ9h"),L=i("mWib"),b=i("YtkY"),A=i("6WTZ"),S=i("vobO"),_=i("EM62"),m=i("etrl"),f=i("W1gw"),O=i("s2Ay");function N(e,t){1&e&&(_.bc(0),_.Yb(1,"i",5),_.Vc(2," Un ou plusieurs versement(s) sont en cours "),_.Yb(3,"br"),_.dc(4,"span"),_.Vc(5," (Merci de ne pas \xe9teindre votre navigateur pendant le processus)"),_.cc(),_.ac())}function F(e,t){if(1&e&&(_.bc(0),_.Vc(1),_.qc(2,"translate"),_.dc(3,"strong"),_.Vc(4),_.cc(),_.Vc(5,'" '),_.ac()),2&e){const e=_.pc();_.Lb(1),_.Xc(" ",_.rc(2,2,"ARCHIVE_SEARCH.SEARCH_CRITERIA_SAVER.SAVED_WITH_SUCCESS"),' "'),_.Lb(3),_.Wc(null==e.data?null:e.data.name)}}function D(e,t){1&e&&(_.bc(0),_.dc(1,"span"),_.Vc(2),_.qc(3,"translate"),_.cc(),_.ac()),2&e&&(_.Lb(2),_.Xc(" ",_.rc(3,1,"ARCHIVE_SEARCH.EXPORT_CSV.EXPORT_CSV_LIMIT_REACHED")," "))}function U(e,t){if(1&e&&(_.bc(0),_.Vc(1),_.qc(2,"translate"),_.dc(3,"strong"),_.Vc(4),_.cc(),_.Vc(5),_.qc(6,"translate"),_.ac()),2&e){const e=_.pc();_.Lb(1),_.Xc(" ",_.rc(2,3,"ARCHIVE_SEARCH.SEARCH_CRITERIA_SAVER.DELETED_WITH_SUCCESS_1"),' "'),_.Lb(3),_.Wc(null==e.data?null:e.data.name),_.Lb(1),_.Xc(' " ',_.rc(6,5,"ARCHIVE_SEARCH.SEARCH_CRITERIA_SAVER.DELETED_WITH_SUCCESS_2")," ")}}function y(e,t){if(1&e){const e=_.ec();_.bc(0),_.dc(1,"span",6),_.Vc(2),_.cc(),_.dc(3,"button",7),_.lc("click",(function(){_.Kc(e);const t=_.pc();return t.goToLogbook(null==t.data?null:t.data.serviceUrl)})),_.Vc(4),_.qc(5,"translate"),_.cc(),_.ac()}if(2&e){const e=_.pc();_.Lb(2),_.Wc(null==e.data?null:e.data.message),_.Lb(2),_.Xc(" ",_.rc(5,2,"ARCHIVE_SEARCH.DIP.TO_OPERATION_APP")," ")}}function P(e,t){1&e&&(_.bc(0),_.Vc(1),_.qc(2,"translate"),_.ac()),2&e&&(_.Lb(1),_.Xc(" ",_.rc(2,1,"ARCHIVE_SEARCH.DIP.EXPORT_LIMITS")," "))}function x(e,t){1&e&&(_.bc(0),_.Vc(1),_.qc(2,"translate"),_.ac()),2&e&&(_.Lb(1),_.Xc(" ",_.rc(2,1,"ARCHIVE_SEARCH.ELIMINATION.THRESHOLD_EXCEEDED")," "))}let k=(()=>{class e{constructor(e,t){this.data=e,this.matSnackBarRef=t}close(){this.matSnackBarRef.dismiss()}goToLogbook(e){window.location.href=e}}return e.\u0275fac=function(t){return new(t||e)(_.Xb(f.a),_.Xb(f.f))},e.\u0275cmp=_.Rb({type:e,selectors:[["app-vitamui-snack-bar"]],decls:12,vars:8,consts:[[1,"vitamui-snack-bar-container"],[1,"vitamui-snack-bar-content",3,"ngSwitch"],[4,"ngSwitchCase"],[1,"close-btn",3,"click"],[1,"material-icons"],[1,"vitamui-icon","vitamui-icon-archive-ingest"],[1,"space-style"],["type","button",1,"btn","white",3,"click"]],template:function(e,t){1&e&&(_.dc(0,"div",0),_.dc(1,"span",1),_.Tc(2,N,6,0,"ng-container",2),_.Tc(3,F,6,4,"ng-container",2),_.Tc(4,D,4,3,"ng-container",2),_.Tc(5,U,7,7,"ng-container",2),_.Tc(6,y,6,4,"ng-container",2),_.Tc(7,P,3,3,"ng-container",2),_.Tc(8,x,3,3,"ng-container",2),_.cc(),_.dc(9,"button",3),_.lc("click",(function(){return t.close()})),_.dc(10,"i",4),_.Vc(11,"clear"),_.cc(),_.cc(),_.cc()),2&e&&(_.Lb(1),_.vc("ngSwitch",null==t.data?null:t.data.type),_.Lb(1),_.vc("ngSwitchCase","sipUploaded"),_.Lb(1),_.vc("ngSwitchCase","searchCriteriaHistoryCreated"),_.Lb(1),_.vc("ngSwitchCase","exportCsvLimitReached"),_.Lb(1),_.vc("ngSwitchCase","searchCriteriaHistoryDeleted"),_.Lb(1),_.vc("ngSwitchCase","WorkflowSuccessSnackBar"),_.Lb(1),_.vc("ngSwitchCase","exportDIPLimitReached"),_.Lb(1),_.vc("ngSwitchCase","thresholdExceeded"))},directives:[c.r,c.s],pipes:[O.d],styles:["[_nghost-%COMP%]{display:flex;align-items:center;justify-content:space-between;height:100%;width:100%}.btn-link[_ngcontent-%COMP%]{color:#fff;font-weight:700;margin-left:10px}.space-style[_ngcontent-%COMP%]{margin-right:30px}"]}),e})();var M=i("HOZh"),V=i("HYj3"),w=i("Sv/w"),H=i("kuMc"),G=i("J+dc"),q=i("sg/T");new _.w("mat-snack-bar-default-options",{providedIn:"root",factory:function(){return new f.c}});var B=i("cmhy"),W=i("47ST"),j=i("ROBh"),Y=i("4e/d"),X=i("ublV"),K=i("cX0B"),z=i("7zxd");let $=(()=>{class e extends C.ab{constructor(e,t,i,c,a,r,n){super(e,"ALL"),this.projectsApiService=e,this.transactionApiService=t,this.searchUnitApiService=i,this.locale=c,this.snackBar=a,this.accessContractApiService=r,this.securityService=n,this.headers=new S.g}static fetchTitle(e,t){return e||(t&&t.fr?t.fr:t.en)}static fetchAuTitle(e){return Object(C.vb)(e,"Title")}static buildPagedResults(e){const t={results:e.$results,totalResults:e.$hits.total,pageNumbers:0!=+e.$hits.size?Math.floor(+e.$hits.total/+e.$hits.size)+(+e.$hits.total%+e.$hits.size==0?0:1):0};return t.facets=e.$facetResults,t}sortByTitle(e){return e.sort((t=this.locale,(e,i)=>e&&i&&e.title&&i.title?e.title.localeCompare(i.title,t,{numeric:!0}):0));var t}getTransactionById(e){return this.projectsApiService.getTransactionById(e).pipe(Object(b.a)(e=>e))}getLastTransactionByProjectId(e){return this.projectsApiService.getLastTransactionByProjectId(e).pipe(Object(b.a)(e=>e))}searchArchiveUnitsByCriteria(t,i){const c=(new S.g).append("Content-Type","application/json");return i?this.transactionApiService.searchArchiveUnitsByCriteria(t,i,c).pipe(Object(Y.a)(e=>e instanceof B.a?Object(W.a)("Erreur : d\xe9lai d\u2019attente d\xe9pass\xe9 pour votre recherche"):Object(j.a)({$hits:null,$results:[]})),Object(b.a)(t=>e.buildPagedResults(t))):Object(j.a)({pageNumbers:1,results:[],totalResults:0})}getTotalTrackHitsByCriteria(e,t){return this.searchArchiveUnitsByCriteria({criteriaList:e,pageNumber:0,size:1,trackTotalHits:!0},t).pipe(Object(b.a)(e=>e.totalResults),Object(Y.a)(()=>Object(j.a)(-1)))}normalizeTitle(e){return(e=e.replace(/[&\/\\|.'":*?<> ]/g,"")).substring(0,218)}getAccessContractById(e){const t=(new S.g).append("Content-Type","application/json");return this.accessContractApiService.getAccessContractById(e,t)}openSnackBarForWorkflow(e,t){this.snackBar.openFromComponent(k,{panelClass:"vitamui-snack-bar",data:{type:"WorkflowSuccessSnackBar",message:e,serviceUrl:t},duration:1e5})}downloadObjectFromUnit(e,t,i,c){return this.projectsApiService.downloadObjectFromUnit(e,t,i,c).subscribe(e=>{let t=null;const i=e.headers.get("content-disposition");if(null!==i){const e=/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/.exec(i);null!=e&&e[1]&&(t=e[1].replace(/['"]/g,""))}Object(m.saveAs)(e.body,t)})}downloadFile(e){window.addEventListener("focus",(function t(){window.removeEventListener("focus",t,!1),URL.revokeObjectURL(e)}),!1),location.href=e}validateTransaction(e){return this.projectsApiService.validateTransaction(e)}sendTransaction(e){return this.projectsApiService.sendTransaction(e)}getProjectById(e){return this.projectsApiService.getById(e)}exportCsvSearchArchiveUnitsByCriteria(e,t){const i=(new S.g).append("Content-Type","application/json");return this.transactionApiService.exportCsvSearchArchiveUnitsByCriteria(e,t,i).subscribe(e=>{const t=document.createElement("a");t.href=window.URL.createObjectURL(e),t.download="export-archive-units.csv",t.style.visibility="hidden",document.body.appendChild(t),t.click(),document.body.removeChild(t)},e=>{413===e.status&&(console.log("Please update filter to reduce size of response"+e.message),this.snackBar.openFromComponent(k,{panelClass:"vitamui-snack-bar",data:{type:"exportCsvLimitReached"},duration:1e4}))})}loadFilingHoldingSchemeTree(e){const t=new S.g({"X-Tenant-Id":""+e});return this.searchUnitApiService.getFilingPlan(t).pipe(Object(Y.a)(()=>Object(j.a)({$hits:null,$results:[]})),Object(b.a)(e=>this.buildNestedTreeLevels(e.$results)))}getReferentialUnitDetails(e){const t=(new S.g).append("Content-Type","application/json");return this.searchUnitApiService.getById(e,t)}getCollectUnitDetails(e){const t=(new S.g).append("Content-Type","application/json");return this.transactionApiService.getCollectUnitById(e,t)}getObjectGroupDetailsById(e){const t=(new S.g).append("Content-Type","application/json");return this.transactionApiService.getObjectGroupDetailsById(e,t)}buildNestedTreeLevels(e,t){const i=[];return e.forEach(c=>{if(t&&t.vitamId&&c["#unitups"]&&c["#unitups"][0]===t.vitamId||!t&&(!c["#unitups"]||!c["#unitups"].length||(a=c["#unitups"][0],!e.find(e=>e["#id"]===a)))){const t=C.H.convertUnitToNode(c);t.children=this.buildNestedTreeLevels(e,t),i.push(t)}var a}),this.sortByTitle(i)}updateUnitsAMetadata(e,t,i,c){let a=new S.g;return a=a.append("X-Tenant-Id",e),a=a.append("Content-Type","application/octet-stream"),a=a.append("X-Original-Filename",i),this.transactionApiService.updateUnitsAMetadata(c,t,a)}getExternalOntologiesList(){return this.transactionApiService.getExternalOntologiesList()}selectUnitWithInheritedRules(e,t){const i=(new S.g).append("Content-Type","application/json");return this.transactionApiService.selectUnitWithInheritedRules(e,t,i)}hasCollectRole(e,t){return this.securityService.hasRole("COLLECT_APP",t,e)}}return e.\u0275fac=function(t){return new(t||e)(_.ic(X.a),_.ic(K.a),_.ic(z.d),_.ic(_.B),_.ic(f.b),_.ic(C.a),_.ic(C.bb))},e.\u0275prov=_.Tb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function Z(e,t){1&e&&(_.bc(0),_.Yb(1,"i",5),_.Vc(2," Un ou plusieurs versement(s) sont en cours "),_.Yb(3,"br"),_.dc(4,"span"),_.Vc(5," (Merci de ne pas \xe9teindre votre navigateur pendant le processus)"),_.cc(),_.ac())}function Q(e,t){if(1&e&&(_.bc(0),_.Vc(1),_.qc(2,"translate"),_.dc(3,"strong"),_.Vc(4),_.cc(),_.Vc(5,'" '),_.ac()),2&e){const e=_.pc();_.Lb(1),_.Xc(" ",_.rc(2,2,"COLLECT.SEARCH_CRITERIA_SAVER.SAVED_WITH_SUCCESS"),' "'),_.Lb(3),_.Wc(null==e.data?null:e.data.name)}}function J(e,t){1&e&&(_.bc(0),_.dc(1,"span"),_.Vc(2),_.qc(3,"translate"),_.cc(),_.ac()),2&e&&(_.Lb(2),_.Xc(" ",_.rc(3,1,"COLLECT.EXPORT_CSV.EXPORT_CSV_LIMIT_REACHED")," "))}function ee(e,t){if(1&e&&(_.bc(0),_.Vc(1),_.qc(2,"translate"),_.dc(3,"strong"),_.Vc(4),_.cc(),_.Vc(5),_.qc(6,"translate"),_.ac()),2&e){const e=_.pc();_.Lb(1),_.Xc(" ",_.rc(2,3,"COLLECT.SEARCH_CRITERIA_SAVER.DELETED_WITH_SUCCESS_1"),' "'),_.Lb(3),_.Wc(null==e.data?null:e.data.name),_.Lb(1),_.Xc(' " ',_.rc(6,5,"COLLECT.SEARCH_CRITERIA_SAVER.DELETED_WITH_SUCCESS_2")," ")}}function te(e,t){if(1&e){const e=_.ec();_.bc(0),_.dc(1,"span",6),_.Vc(2),_.cc(),_.dc(3,"button",7),_.lc("click",(function(){_.Kc(e);const t=_.pc();return t.goToLogbook(null==t.data?null:t.data.serviceUrl)})),_.Vc(4),_.qc(5,"translate"),_.cc(),_.ac()}if(2&e){const e=_.pc();_.Lb(2),_.Wc(null==e.data?null:e.data.message),_.Lb(2),_.Xc(" ",_.rc(5,2,"COLLECT.DIP.TO_OPERATION_APP")," ")}}function ie(e,t){1&e&&(_.bc(0),_.Vc(1),_.qc(2,"translate"),_.ac()),2&e&&(_.Lb(1),_.Xc(" ",_.rc(2,1,"COLLECT.DIP.EXPORT_LIMITS")," "))}function ce(e,t){1&e&&(_.bc(0),_.Vc(1),_.qc(2,"translate"),_.ac()),2&e&&(_.Lb(1),_.Xc(" ",_.rc(2,1,"COLLECT.ELIMINATION.THRESHOLD_EXCEEDED")," "))}function ae(e,t){1&e&&(_.bc(0),_.Vc(1),_.qc(2,"translate"),_.ac()),2&e&&(_.Lb(1),_.Xc(" ",_.rc(2,1,"COLLECT.UPDATE_UNITS_METADATA.WAIT_MESSAGE")," "))}function re(e,t){1&e&&(_.bc(0),_.Vc(1),_.qc(2,"translate"),_.ac()),2&e&&(_.Lb(1),_.Xc(" ",_.rc(2,1,"COLLECT.UPDATE_UNITS_METADATA.SUCCESS_MESSAGE")," "))}let ne=(()=>{class e{constructor(e,t){this.data=e,this.matSnackBarRef=t}close(){this.matSnackBarRef.dismiss()}goToLogbook(e){window.location.href=e}}return e.\u0275fac=function(t){return new(t||e)(_.Xb(f.a),_.Xb(f.f))},e.\u0275cmp=_.Rb({type:e,selectors:[["app-vitamui-snack-bar"]],decls:14,vars:10,consts:[[1,"vitamui-snack-bar-container"],[1,"vitamui-snack-bar-content",3,"ngSwitch"],[4,"ngSwitchCase"],[1,"close-btn",3,"click"],[1,"material-icons"],[1,"vitamui-icon","vitamui-icon-archive-ingest"],[1,"space-style"],["type","button",1,"btn","white",3,"click"]],template:function(e,t){1&e&&(_.dc(0,"div",0),_.dc(1,"span",1),_.Tc(2,Z,6,0,"ng-container",2),_.Tc(3,Q,6,4,"ng-container",2),_.Tc(4,J,4,3,"ng-container",2),_.Tc(5,ee,7,7,"ng-container",2),_.Tc(6,te,6,4,"ng-container",2),_.Tc(7,ie,3,3,"ng-container",2),_.Tc(8,ce,3,3,"ng-container",2),_.Tc(9,ae,3,3,"ng-container",2),_.Tc(10,re,3,3,"ng-container",2),_.cc(),_.dc(11,"button",3),_.lc("click",(function(){return t.close()})),_.dc(12,"i",4),_.Vc(13,"clear"),_.cc(),_.cc(),_.cc()),2&e&&(_.Lb(1),_.vc("ngSwitch",null==t.data?null:t.data.type),_.Lb(1),_.vc("ngSwitchCase","sipUploaded"),_.Lb(1),_.vc("ngSwitchCase","searchCriteriaHistoryCreated"),_.Lb(1),_.vc("ngSwitchCase","exportCsvLimitReached"),_.Lb(1),_.vc("ngSwitchCase","searchCriteriaHistoryDeleted"),_.Lb(1),_.vc("ngSwitchCase","WorkflowSuccessSnackBar"),_.Lb(1),_.vc("ngSwitchCase","exportDIPLimitReached"),_.Lb(1),_.vc("ngSwitchCase","thresholdExceeded"),_.Lb(1),_.vc("ngSwitchCase","waitMassUpdateUnitsMetadata"),_.Lb(1),_.vc("ngSwitchCase","massUpdateUnitsMetadata"))},directives:[c.r,c.s],pipes:[O.d],styles:["[_nghost-%COMP%]{display:flex;align-items:center;justify-content:space-between;height:100%;width:100%}.btn-link[_ngcontent-%COMP%]{color:#fff;font-weight:700;margin-left:10px}.space-style[_ngcontent-%COMP%]{margin-right:30px}"]}),e})();const se=new _.w("mat-snack-bar-default-options",{providedIn:"root",factory:function(){return new f.c}});let le=(()=>{class e{constructor(e,t,i,c,a,r){this._overlay=e,this._live=t,this._injector=i,this._breakpointObserver=c,this._parentSnackBar=a,this._defaultConfig=r,this._snackBarRefAtThisLevel=null}get _openedSnackBarRef(){const e=this._parentSnackBar;return e?e._openedSnackBarRef:this._snackBarRefAtThisLevel}set _openedSnackBarRef(e){this._parentSnackBar?this._parentSnackBar._openedSnackBarRef=e:this._snackBarRefAtThisLevel=e}openFromComponent(e,t){return this._attach(e,t)}openFromTemplate(e,t){return this._attach(e,t)}open(e,t="",i){const c=Object.assign(Object.assign({},this._defaultConfig),i);return c.data={message:e,action:t},c.announcementMessage=e,this.openFromComponent(f.g,c)}dismiss(){this._openedSnackBarRef&&this._openedSnackBarRef.dismiss()}_attachSnackBarContainer(e,t){const i=new w.g(t&&t.viewContainerRef&&t.viewContainerRef.injector||this._injector,new WeakMap([[f.c,t]])),c=new w.d(f.d,t.viewContainerRef,i),a=e.attach(c);return a.instance.snackBarConfig=t,a.instance}_attach(e,t){const i=Object.assign(Object.assign(Object.assign({},new f.c),this._defaultConfig),t),c=this._createOverlay(i),a=this._attachSnackBarContainer(c,i),r=new f.f(a,c);if(e instanceof _.V){const t=new w.i(e,null,{$implicit:i.data,snackBarRef:r});r.instance=a.attachTemplatePortal(t)}else{const t=this._createInjector(i,r),c=new w.d(e,void 0,t),n=a.attachComponentPortal(c);r.instance=n.instance}return this._breakpointObserver.observe(M.b.Handset).pipe(Object(H.a)(c.detachments().pipe(Object(G.a)(1)))).subscribe(e=>{e.matches?c.overlayElement.classList.add("mat-snack-bar-handset"):c.overlayElement.classList.remove("mat-snack-bar-handset")}),this._animateSnackBar(r,i),this._openedSnackBarRef=r,this._openedSnackBarRef}_animateSnackBar(e,t){e.afterDismissed().subscribe(()=>{this._openedSnackBarRef===e&&(this._openedSnackBarRef=null)}),this._openedSnackBarRef?(this._openedSnackBarRef.afterDismissed().subscribe(()=>{e.containerInstance.enter()}),this._openedSnackBarRef.dismiss()):e.containerInstance.enter(),t.duration&&t.duration>0&&e.afterOpened().subscribe(()=>e._dismissAfter(t.duration)),t.announcementMessage&&this._live.announce(t.announcementMessage,t.politeness)}_createOverlay(e){const t=new V.d;t.direction=e.direction;const i=this._overlay.position().global(),c="rtl"===e.direction,a="left"===e.horizontalPosition||"start"===e.horizontalPosition&&!c||"end"===e.horizontalPosition&&c,r=!a&&"center"!==e.horizontalPosition;return a?i.left("0"):r?i.right("0"):i.centerHorizontally(),"top"===e.verticalPosition?i.top("0"):i.bottom("0"),t.width="100%",t.positionStrategy=i,this._overlay.create(t)}_createInjector(e,t){return new w.g(e&&e.viewContainerRef&&e.viewContainerRef.injector||this._injector,new WeakMap([[f.f,t],[f.a,e.data]]))}}return e.\u0275fac=function(t){return new(t||e)(_.ic(V.c),_.ic(q.k),_.ic(_.x),_.ic(M.a),_.ic(e,12),_.ic(se))},e.\u0275prov=_.Tb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();class oe{}let de=(()=>{class e{constructor(){this.sourceNode=new v.a(new oe),this.filingHoldingNodesSubject=new v.a(null),this.targetNode=new v.a(""),this.facetsSubject=new v.a([]),this.totalResultsSubject=new v.a(null),this.toggleSubject=new v.a(!0),this.toggleReverseSubject=new v.a(!0),this.archiveUnitTpPreviewSubject=new v.a(null),this.toggleArchiveUnitSubject=new v.a(!0),this.lastSearchCriterias=new v.a(null),this.storedSearchCriteriaHistorySubject=new v.a(null),this.allSearchCriteriaHistorySubject=new v.a([]),this.simpleSearchCriteriaAddSubject=new v.a(null),this.appraisalSearchCriteriaAddSubject=new v.a(null),this.storageSearchCriteriaAddSubject=new v.a(null),this.accessSearchCriteriaAddSubject=new v.a(null),this.reuseSearchCriteriaAddSubject=new v.a(null),this.disseminationSearchCriteriaAddSubject=new v.a(null),this.searchAppraisalCriteriaActionFromMainSubject=new v.a(null),this.searchStorageCriteriaActionFromMainSubject=new v.a(null),this.searchAccessCriteriaActionFromMainSubject=new v.a(null),this.searchReuseCriteriaActionFromMainSubject=new v.a(null),this.searchDisseminationCriteriaActionFromMainSubject=new v.a(null),this.searchCriteriaRemoveFromChildSubject=new v.a(null),this.entireNodes=new v.a([]),this.auTitleSubject=new v.a(""),this.actionSubject=new v.a(""),this.ruleCategory=new v.a(""),this.currentNode=this.sourceNode.asObservable(),this.facetsObservable=this.facetsSubject.asObservable(),this.toggleObservable=this.toggleSubject.asObservable(),this.toggleReverseObservable=this.toggleReverseSubject.asObservable(),this.archiveUnitToPreviewObservable=this.archiveUnitTpPreviewSubject.asObservable(),this.toggleArchiveUnitObservable=this.toggleArchiveUnitSubject.asObservable(),this.storedSearchCriteriaHistoryObservable=this.storedSearchCriteriaHistorySubject.asObservable(),this.auTitleObservable=this.auTitleSubject.asObservable(),this.actionObservable=this.actionSubject.asObservable(),this.allSearchCriteriaHistoryObservable=this.allSearchCriteriaHistorySubject.asObservable(),this.simpleSearchCriteriaAddObservable=this.simpleSearchCriteriaAddSubject.asObservable(),this.appraisalFromMainSearchCriteriaObservable=this.searchAppraisalCriteriaActionFromMainSubject.asObservable(),this.storageFromMainSearchCriteriaObservable=this.searchStorageCriteriaActionFromMainSubject.asObservable(),this.accessFromMainSearchCriteriaObservable=this.searchAccessCriteriaActionFromMainSubject.asObservable(),this.reuseFromMainSearchCriteriaObservable=this.searchReuseCriteriaActionFromMainSubject.asObservable(),this.disseminationFromMainSearchCriteriaObservable=this.searchDisseminationCriteriaActionFromMainSubject.asObservable()}emitRuleCategory(e){this.ruleCategory.next(e)}getRuleCategory(){return this.ruleCategory.asObservable()}emitEntireNodes(e){this.entireNodes.next(e)}getEntireNodes(){return this.entireNodes.asObservable()}emitFilingHoldingNodes(e){this.filingHoldingNodesSubject.next(e)}getFilingHoldingNodes(){return this.filingHoldingNodesSubject.asObservable()}emitNode(e){this.sourceNode.next(e)}getNodes(){return this.sourceNode.asObservable()}emitNodeTarget(e){this.targetNode.next(e)}getNodesTarget(){return this.targetNode.asObservable()}emitFacets(e){this.facetsSubject.next(e)}getFacets(){return this.facetsSubject.asObservable()}emitTotalResults(e){this.totalResultsSubject.next(e)}getTotalResults(){return this.totalResultsSubject.asObservable()}emitToggle(e){this.toggleSubject.next(e)}getToggle(){return this.toggleSubject.asObservable()}emitSearchCriteriaHistory(e){this.storedSearchCriteriaHistorySubject.next(e)}emitArchiveUnitTitle(e){this.auTitleSubject.next(e)}emitActionChosen(e){this.auTitleSubject.next(e)}getActionChosen(){return this.auTitleSubject.asObservable()}getArchiveUnitTitle(){return this.auTitleSubject.asObservable()}getSearchCriteriaHistoryShared(){return this.storedSearchCriteriaHistorySubject.asObservable()}emitSearchCriterias(e){this.lastSearchCriterias.next(e)}getSearchCriterias(){return this.lastSearchCriterias.asObservable()}emitAllSearchCriteriaHistory(e){this.allSearchCriteriaHistorySubject.next(e)}getAllSearchCriteriaHistoryShared(){return this.allSearchCriteriaHistorySubject.asObservable()}nbFilters(e){let t=0;return e.searchCriteriaList.length>0&&e.searchCriteriaList.forEach(e=>{t+=e.values.length}),t}sort(e,t){switch(e){case C.z.ASCENDANT:t.sort((e,t)=>new Date(t.savingDate)-new Date(e.savingDate));break;case C.z.DESCENDANT:t.sort((e,t)=>new Date(e.savingDate)-new Date(t.savingDate))}return t}addSimpleSearchCriteriaSubject(e){this.simpleSearchCriteriaAddSubject.next(e)}receiveSimpleSearchCriteriaSubject(){return this.simpleSearchCriteriaAddSubject.asObservable()}addAppraisalSearchCriteriaSubject(e){this.appraisalSearchCriteriaAddSubject.next(e)}receiveAppraisalSearchCriteriaSubject(){return this.appraisalSearchCriteriaAddSubject.asObservable()}addStorageSearchCriteriaSubject(e){this.storageSearchCriteriaAddSubject.next(e)}receiveStorageSearchCriteriaSubject(){return this.storageSearchCriteriaAddSubject.asObservable()}addAccessSearchCriteriaSubject(e){this.accessSearchCriteriaAddSubject.next(e)}receiveAccessSearchCriteriaSubject(){return this.accessSearchCriteriaAddSubject.asObservable()}addDisseminationSearchCriteriaSubject(e){this.disseminationSearchCriteriaAddSubject.next(e)}receiveDisseminationSearchCriteriaSubject(){return this.disseminationSearchCriteriaAddSubject.asObservable()}addReuseSearchCriteriaSubject(e){this.reuseSearchCriteriaAddSubject.next(e)}receiveReuseSearchCriteriaSubject(){return this.reuseSearchCriteriaAddSubject.asObservable()}sendAppraisalFromMainSearchCriteriaAction(e){this.searchAppraisalCriteriaActionFromMainSubject.next(e)}receiveAppraisalFromMainSearchCriteriaSubject(){return this.searchAppraisalCriteriaActionFromMainSubject.asObservable()}sendStorageFromMainSearchCriteriaAction(e){this.searchStorageCriteriaActionFromMainSubject.next(e)}receiveStorageFromMainSearchCriteriaSubject(){return this.searchStorageCriteriaActionFromMainSubject.asObservable()}sendAccessFromMainSearchCriteriaAction(e){this.searchAccessCriteriaActionFromMainSubject.next(e)}receiveAccessFromMainSearchCriteriaSubject(){return this.searchAccessCriteriaActionFromMainSubject.asObservable()}sendReuseFromMainSearchCriteriaAction(e){this.searchReuseCriteriaActionFromMainSubject.next(e)}receiveReuseFromMainSearchCriteriaSubject(){return this.searchReuseCriteriaActionFromMainSubject.asObservable()}sendDisseminationFromMainSearchCriteriaAction(e){this.searchDisseminationCriteriaActionFromMainSubject.next(e)}receiveDisseminationFromMainSearchCriteriaSubject(){return this.searchDisseminationCriteriaActionFromMainSubject.asObservable()}sendRemoveFromChildSearchCriteriaAction(e){this.searchCriteriaRemoveFromChildSubject.next(e)}receiveRemoveFromChildSearchCriteriaSubject(){return this.searchCriteriaRemoveFromChildSubject.asObservable()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=_.Tb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),ue=(()=>{class e extends C.ab{constructor(e){super(e,"ALL"),this.projectsApiService=e}saveSearchCriteriaHistory(e){return this.projectsApiService.saveSearchCriteriaHistory(e)}updateSearchCriteriaHistory(e){return this.projectsApiService.updateSearchCriteriaHistory(e)}getSearchCriteriaHistory(){return this.projectsApiService.getSearchCriteriaHistory()}deleteSearchCriteriaHistory(e){return this.projectsApiService.deleteSearchCriteriaHistory(e)}}return e.\u0275fac=function(t){return new(t||e)(_.ic(X.a))},e.\u0275prov=_.Tb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var he=i("Y2X+"),Ce=i("Jb3d");function Ee(e,t){if(1&e&&(_.dc(0,"div",8),_.dc(1,"div",9),_.dc(2,"button",10),_.Vc(3),_.cc(),_.cc(),_.cc()),2&e){const e=t.$implicit;_.Lb(2),_.vc("matTooltip",e.tooltip),_.Lb(1),_.Yc(" ",e.label,": ",e.value," ")}}function Re(e,t){if(1&e){const e=_.ec();_.dc(0,"div",20),_.dc(1,"button",21),_.lc("click",(function(){return _.Kc(e),_.pc(2).onSubmit()})),_.Vc(2," OK "),_.cc(),_.cc()}if(2&e){const e=_.pc(2);_.Lb(1),_.vc("disabled",""===e.nameControl||e.nameControl.length>e.maxlength)}}function pe(e,t){1&e&&(_.dc(0,"div",22),_.dc(1,"span",23),_.dc(2,"i",24),_.Vc(3,"report_problem"),_.cc(),_.Vc(4),_.qc(5,"translate"),_.cc(),_.Yb(6,"br"),_.dc(7,"span",25),_.Vc(8),_.qc(9,"translate"),_.cc(),_.cc()),2&e&&(_.Lb(4),_.Xc(" ",_.rc(5,2,"COLLECT.SEARCH_CRITERIA_SAVER.SAVE_NOT_POSSIBLE_ALERT_NAME")," "),_.Lb(4),_.Xc(" ",_.rc(9,4,"COLLECT.SEARCH_CRITERIA_SAVER.SAVE_NOT_POSSIBLE_MESSAGE_NAME")," "))}function ve(e,t){if(1&e){const e=_.ec();_.dc(0,"div",11),_.Yb(1,"div",12),_.dc(2,"form",13),_.dc(3,"div",14),_.Vc(4),_.qc(5,"translate"),_.cc(),_.dc(6,"div",15),_.dc(7,"div",16),_.dc(8,"vitamui-common-input",17),_.lc("ngModelChange",(function(t){return _.Kc(e),_.pc().nameControl=t})),_.qc(9,"translate"),_.cc(),_.cc(),_.Tc(10,Re,3,1,"div",18),_.Tc(11,pe,10,6,"div",19),_.cc(),_.cc(),_.cc()}if(2&e){const e=_.pc();_.Lb(2),_.vc("formGroup",e.searchCriteriaForm),_.Lb(2),_.Wc(_.rc(5,6,"COLLECT.SEARCH_CRITERIA_SAVER.NEW_SAVE_IN_POPUP")),_.Lb(4),_.wc("placeholder",_.rc(9,8,"COLLECT.SEARCH_CRITERIA_SAVER.NAME")),_.vc("ngModel",e.nameControl),_.Lb(2),_.vc("ngIf",null!==e.ToUpdate&&!e.ToUpdate),_.Lb(1),_.vc("ngIf",e.nameControl.length>e.maxlength)}}function Ie(e,t){if(1&e){const e=_.ec();_.dc(0,"div",33),_.lc("click",(function(t){_.Kc(e);const i=_.pc().$implicit;return _.pc(2).preUpdate(i,t)})),_.dc(1,"button",34),_.lc("click",(function(t){_.Kc(e);const i=_.pc().$implicit;return _.pc(2).preUpdate(i,t)})),_.dc(2,"i",35),_.Vc(3,"save"),_.cc(),_.bc(4,36),_.lc("click",(function(t){_.Kc(e);const i=_.pc().$implicit;return _.pc(2).preUpdate(i,t)})),_.dc(5,"span",37),_.Vc(6),_.qc(7,"truncate"),_.cc(),_.dc(8,"span",38),_.Vc(9),_.cc(),_.ac(),_.cc(),_.cc()}if(2&e){const e=_.pc().$implicit,t=_.pc(2);_.wc("matTooltip",e.name),_.vc("matTooltipShowDelay",300),_.Lb(6),_.Xc(" ",_.sc(7,4,e.name,30)," "),_.Lb(3),_.Xc(" - (",t.getNbFilters(e)," filtres) ")}}function Te(e,t){if(1&e&&(_.dc(0,"div",31),_.Tc(1,Ie,10,7,"div",32),_.cc()),2&e){const e=t.$implicit,i=_.pc(2);_.Lb(1),_.vc("ngIf",e!==i.searchCriteriaHistory)}}function ge(e,t){1&e&&(_.dc(0,"button",39),_.Vc(1),_.qc(2,"translate"),_.cc()),2&e&&(_.Lb(1),_.Xc(" ",_.rc(2,1,"COLLECT.SEARCH_CRITERIA_SAVER.NO_RESULTS")," "))}function Le(e,t){1&e&&(_.dc(0,"div",22),_.dc(1,"span",23),_.dc(2,"i",24),_.Vc(3,"report_problem"),_.cc(),_.Vc(4),_.qc(5,"translate"),_.cc(),_.Yb(6,"br"),_.dc(7,"span"),_.Vc(8),_.qc(9,"translate"),_.cc(),_.cc()),2&e&&(_.Lb(4),_.Wc(_.rc(5,2,"COLLECT.SEARCH_CRITERIA_SAVER.SAVE_NOT_POSSIBLE_ALERT")),_.Lb(4),_.Wc(_.rc(9,4,"COLLECT.SEARCH_CRITERIA_SAVER.SAVE_NOT_POSSIBLE_MESSAGE")))}function be(e,t){if(1&e){const e=_.ec();_.dc(0,"div",11),_.Yb(1,"div",12),_.dc(2,"div",26),_.Vc(3),_.qc(4,"translate"),_.cc(),_.dc(5,"strong",27),_.Vc(6),_.qc(7,"translate"),_.cc(),_.dc(8,"div",3),_.lc("mouseenter",(function(){return _.Kc(e),_.pc().over("scroll-results")}))("mouseleave",(function(){return _.Kc(e),_.pc().out("scroll-results")})),_.Tc(9,Te,2,1,"div",28),_.Tc(10,ge,3,3,"button",29),_.cc(),_.dc(11,"div",30),_.dc(12,"button",21),_.lc("click",(function(){return _.Kc(e),_.pc().createNewCriteria()})),_.Vc(13),_.qc(14,"translate"),_.cc(),_.cc(),_.Tc(15,Le,10,6,"div",19),_.cc()}if(2&e){const e=_.pc();_.Lb(3),_.Wc(_.rc(4,8,"COLLECT.SEARCH_CRITERIA_SAVER.NEW_SAVE_LABEL")),_.Lb(3),_.Wc(_.rc(7,10,"COLLECT.SEARCH_CRITERIA_SAVER.NEW_SAVE_REPLACE_LABEL")),_.Lb(2),_.vc("ngClass",e.showScroll?"scroll-results":"no-scroll-results"),_.Lb(1),_.vc("ngForOf",e.searchCriteriaHistories),_.Lb(1),_.vc("ngIf",void 0!==e.searchCriteriaHistories&&0===e.searchCriteriaHistories.length),_.Lb(2),_.vc("disabled",""!==e.criteriaId||10==e.searchCriteriaHistories.length),_.Lb(1),_.Xc(" ",_.rc(14,12,"COLLECT.SEARCH_CRITERIA_SAVER.NEW_SAVE_BUTTON")," "),_.Lb(2),_.vc("ngIf",10===e.searchCriteriaHistories.length)}}function Ae(e,t){if(1&e){const e=_.ec();_.dc(0,"div",48),_.lc("click",(function(){return _.Kc(e),_.pc(2).onCancel()})),_.Vc(1),_.qc(2,"translate"),_.cc()}2&e&&(_.Lb(1),_.Xc(" ",_.rc(2,1,"COLLECT.SEARCH_CRITERIA_SAVER.NO_RESULTS")," "))}function Se(e,t){if(1&e){const e=_.ec();_.dc(0,"div",11),_.Yb(1,"div",12),_.dc(2,"div",26),_.Vc(3),_.qc(4,"translate"),_.cc(),_.dc(5,"div",40),_.dc(6,"div",41),_.dc(7,"button",42),_.dc(8,"i",35),_.Vc(9,"save"),_.cc(),_.bc(10),_.dc(11,"span",43),_.Vc(12),_.qc(13,"truncate"),_.cc(),_.dc(14,"span",38),_.Vc(15),_.cc(),_.ac(),_.cc(),_.cc(),_.cc(),_.Tc(16,Ae,3,3,"div",44),_.dc(17,"mat-dialog-actions",45),_.dc(18,"button",46),_.lc("click",(function(){return _.Kc(e),_.pc().update()})),_.bc(19),_.Vc(20),_.qc(21,"translate"),_.ac(),_.cc(),_.dc(22,"button",47),_.lc("click",(function(){return _.Kc(e),_.pc().cancel()})),_.bc(23),_.Vc(24),_.qc(25,"translate"),_.ac(),_.cc(),_.cc(),_.cc()}if(2&e){const e=_.pc();_.Lb(3),_.Wc(_.rc(4,8,"COLLECT.SEARCH_CRITERIA_SAVER.SAVE_REPLACE_CONFIRM_MESSAGE")),_.Lb(8),_.wc("matTooltip",e.criteriaToUpdate.name),_.vc("matTooltipShowDelay",300),_.Lb(1),_.Xc(" ",_.sc(13,10,e.criteriaToUpdate.name,30)," "),_.Lb(3),_.Xc(" - (",e.getNbFilters(e.criteriaToUpdate)," filtres) "),_.Lb(1),_.vc("ngIf",0==e.searchCriteriaHistories.length),_.Lb(4),_.Xc(" ",_.rc(21,13,"COLLECT.SEARCH_CRITERIA_SAVER.SAVE_REPLACE_CONFIRM_BUTTON")," "),_.Lb(4),_.Wc(_.rc(25,15,"COLLECT.SEARCH_CRITERIA_SAVER.SAVE_REPLACE_CANCEL_BUTTON"))}}let _e=(()=>{class e{constructor(e,t,i,c,a,r,n,s,l){this.data=e,this.dialogRef=t,this.formBuilder=i,this.searchCriteriaSaverService=c,this.archiveExchangeDataService=a,this.confirmDialogService=r,this.snackBar=n,this.datePipe=s,this.translatePipe=l,this.nbCriterias=0,this.ToUpdate=!0,this.noScroll=!1,this.showScrollFilter=!1,this.showScroll=!1,this.updateConfirm=!1,this.events=[],this.criteriaId="",this.maxlength=150,this.displaySearchCriterias=[],this.searchCriteriaForm=this.formBuilder.group({searchCriteriaForm:null,name:null}),this.criteria=e.criteria,this.searchCriteriaHistory=e.searchCriteriaHistory,this.nbCriterias=e.nbCriterias,this.searchCriterias=e.originalSearchCriteria,this.displaySearchCriterias=this.computeSearchCriterias(this.searchCriterias),this.subscriptionAllSearchCriteriaHistory=this.archiveExchangeDataService.getAllSearchCriteriaHistoryShared().subscribe(e=>{e&&(this.searchCriteriaHistories=e,this.archiveExchangeDataService.sort(C.z.ASCENDANT,this.searchCriteriaHistories))})}ngOnDestroy(){var e,t;null===(e=this.updateSearchCriteriaHistorySubscription)||void 0===e||e.unsubscribe(),null===(t=this.saveSearchCriteriaHistorySubscription)||void 0===t||t.unsubscribe()}ngOnInit(){this.nameControl=""}onCancel(){this.searchCriteriaForm.dirty?this.confirmDialogService.confirmBeforeClosing(this.dialogRef):this.dialogRef.close()}onSubmit(){this.searchCriteriaHistory.name=this.searchCriteriaForm.value.name,this.saveSearchCriteriaHistorySubscription=this.searchCriteriaSaverService.saveSearchCriteriaHistory(this.searchCriteriaHistory).subscribe(e=>{this.searchCriteriaHistory.id=e.id,this.archiveExchangeDataService.emitSearchCriteriaHistory(this.searchCriteriaHistory),this.dialogRef.close(!0),this.snackBar.openFromComponent(ne,{panelClass:"vitamui-snack-bar",data:{type:"searchCriteriaHistoryCreated",name:e.name},duration:1e4})},e=>{this.dialogRef.close(!1),this.snackBar.open(e.error.message,null,{panelClass:"vitamui-snack-bar",duration:1e4})})}preUpdate(e,t){const i="dynamic-color";this.events.length>0?this.criteriaId===e.id?(t.target.classList.remove(i),this.events.pop(),this.criteriaId="",this.criteriaToUpdate=null):(this.events[0].target.classList.remove(i),this.events.pop(),t.target.classList.contains(i)?t.target.classList.remove(i):t.target.classList.add(i),this.criteriaId=e.id,this.criteriaToUpdate=e):this.criteriaToUpdate=e,this.events.push(t),this.criteriaToUpdate&&(this.ToUpdate=null,this.updateConfirm=!0,this.noScroll=!0,this.criteriaId="")}createNewCriteria(){this.ToUpdate=!1}cancel(){this.updateConfirm=!1,this.criteriaToUpdate=null,this.ToUpdate=!0}update(){this.criteriaToUpdate.searchCriteriaList=this.searchCriteriaHistory.searchCriteriaList,this.criteriaToUpdate.savingDate=(new Date).toISOString(),this.updateSearchCriteriaHistorySubscription=this.searchCriteriaSaverService.updateSearchCriteriaHistory(this.criteriaToUpdate).subscribe(()=>{this.dialogRef.close(!0),this.snackBar.openFromComponent(ne,{panelClass:"vitamui-snack-bar",data:{type:"searchCriteriaHistoryCreated",name:this.criteriaToUpdate.name},duration:1e4})},e=>{this.snackBar.open(e.error.message,null,{panelClass:"vitamui-snack-bar",duration:1e4})})}getNbFilters(e){return this.archiveExchangeDataService.nbFilters(e)}closeSaveCriteriaForm(){this.dialogRef.close(!0)}over(e){switch(e){case"scroll-results":this.showScroll=!0,this.noScroll=!1;break;case"scroll-filters":this.showScrollFilter=!0,this.noScroll=!1}}out(e){switch(e){case"scroll-results":this.showScroll=!1;break;case"scroll-filters":this.showScrollFilter=!1,this.noScroll=!1}}getCategoryName(e){return C.Z[e]}computeSearchCriterias(e){return e?[...e.values()].map(e=>{const{dataType:t,category:i,keyTranslated:c,key:a,values:r}=e,n=this.getCategoryName(i),s=c?this.translatePipe.transform(`COLLECT.SEARCH_CRITERIA_FILTER.${n}.${a}`):a,l=s;return r.map(c=>{let a=null;switch(t){case"STRING":const e=this.getFirstTranslated([`COLLECT.SEARCH_CRITERIA_FILTER.${n}.${c.label}`,`COLLECT.SEARCH_CRITERIA_FILTER.${n}.${c.value.value}`,`COLLECT.SEARCH_CRITERIA_FILTER.${n}.${i}`]),t=!!c.label;a=e||(t?c.label:this.translatePipe.transform("COLLECT.SEARCH_CRITERIA_SAVER.NO_VALUE_FOUND_TO_DISPLAY"));break;case"DATE":a=this.datePipe.transform(c.value.value,"dd/MM/yyyy");break;case"INTERVAL":const r=this.datePipe.transform(c.value.beginInterval,"dd/MM/yyyy"),s=this.datePipe.transform(c.value.endInterval,"dd/MM/yyyy"),l=this.translatePipe.transform("COLLECT.SEARCH_CRITERIA_BETWEEN"),o=this.translatePipe.transform("COLLECT.SEARCH_CRITERIA_AND"),d=this.translatePipe.transform("COLLECT.SEARCH_CRITERIA_GTE"),u=this.translatePipe.transform("COLLECT.SEARCH_CRITERIA_LTE");if(r&&s)a=`${l} ${r} ${o} ${s}`;else if(r&&!s)a=`${d} ${r}`;else{if(r||!s)throw new Error("Interval without beginDate and endDate");a=`${u} ${s}`}break;default:throw new Error("Data type not supported")}return{category:n,label:s,tooltip:l,type:t,value:a,searchCriteria:e}})}).reduce((e,t)=>{if(Array.isArray(t)){const i=t;return[...e,...i]}return[...e,t]},[]):[]}getFirstTranslated(e){for(const t of e){const e=this.translatePipe.transform(t);if(e!==t)return e}return null}}return e.\u0275fac=function(t){return new(t||e)(_.Xb(n.a),_.Xb(n.h),_.Xb(a.e),_.Xb(ue),_.Xb(de),_.Xb(C.t),_.Xb(f.b),_.Xb(c.e),_.Xb(O.d))},e.\u0275cmp=_.Rb({type:e,selectors:[["app-search-criteria-saver"]],features:[_.Kb([O.d])],decls:12,vars:9,consts:[[1,"row","pad"],[1,"col-5","rectangle"],[1,"row","actif-filters"],[3,"ngClass","mouseenter","mouseleave"],["class","separate-div",4,"ngFor","ngForOf"],["class","col-6 form-width",4,"ngIf"],[1,"col-1","btn","link","cancel"],[1,"vitamui-icon","vitamui-icon-close",3,"click"],[1,"separate-div"],[1,"row","pad-bottom"],["type","button","matTooltipClass","vitamui-tooltip","matTooltipShowDelay","300",1,"button-content","right-arround","left-arround","after-search-launched-button",3,"matTooltip"],[1,"col-6","form-width"],[1,"row","triangle"],[3,"formGroup"],[1,"sauvegarde-text"],[1,"row","input-width"],[1,"col-11"],["formControlName","name","maxlength","maxlength","required","",1,"input-text",3,"ngModel","placeholder","ngModelChange"],["class","col-1 btn-ok",4,"ngIf"],["class","warning",4,"ngIf"],[1,"col-1","btn-ok"],["type","submit",1,"btn","primary",3,"disabled","click"],[1,"warning"],[1,"ko-icon"],[1,"material-icons"],[1,"warning-message"],[1,"sauvegarde-text","pad5"],[1,"pad35"],["class","border-results",4,"ngFor","ngForOf"],["mat-menu-item","","class","btn-no-result",4,"ngIf"],[1,"btn-create"],[1,"border-results"],["class","pad-results hover-div","matTooltipClass","vitamui-tooltip",3,"matTooltip","matTooltipShowDelay","click",4,"ngIf"],["matTooltipClass","vitamui-tooltip",1,"pad-results","hover-div",3,"matTooltip","matTooltipShowDelay","click"],["mat-menu-item","",1,"boutton","btn-result-update",3,"click"],[1,"material-icons","save-icon"],[3,"click"],[1,"results-message"],[1,"results-nb-filters"],["mat-menu-item","",1,"btn-no-result"],[1,"div-update","no-scroll-results"],[1,"border-results","pink-color","pad-results","hover-div"],["mat-menu-item","",1,"boutton","btn-result-update"],["matTooltipClass","vitamui-tooltip",1,"results-message",3,"matTooltip","matTooltipShowDelay"],["class","no-results-center search-criterias",3,"click",4,"ngIf"],[1,"pad-actions"],[1,"btn","primary",3,"click"],[1,"btn","link","cancel-update",3,"click"],[1,"no-results-center","search-criterias",3,"click"]],template:function(e,t){1&e&&(_.dc(0,"div",0),_.dc(1,"div",1),_.dc(2,"div",2),_.Vc(3),_.qc(4,"translate"),_.cc(),_.dc(5,"div",3),_.lc("mouseenter",(function(){return t.over("scroll-filters")}))("mouseleave",(function(){return t.out("scroll-filters")})),_.Tc(6,Ee,4,3,"div",4),_.cc(),_.cc(),_.Tc(7,ve,12,10,"div",5),_.Tc(8,be,16,14,"div",5),_.Tc(9,Se,26,17,"div",5),_.dc(10,"button",6),_.dc(11,"i",7),_.lc("click",(function(){return t.closeSaveCriteriaForm()})),_.cc(),_.cc(),_.cc()),2&e&&(_.Lb(3),_.Yc("",_.rc(4,7,"COLLECT.SEARCH_CRITERIA_SAVER.ACTIVE_FILTERS")," (",t.nbCriterias,")"),_.Lb(2),_.vc("ngClass",t.showScrollFilter?"scroll-filters":"scroll-div"),_.Lb(1),_.vc("ngForOf",t.displaySearchCriterias),_.Lb(1),_.vc("ngIf",null!==t.ToUpdate&&!t.ToUpdate),_.Lb(1),_.vc("ngIf",t.ToUpdate),_.Lb(1),_.vc("ngIf",t.criteriaToUpdate&&t.updateConfirm))},directives:[c.n,c.o,c.p,he.a,a.x,a.q,a.i,C.Cb,a.p,a.h,a.k,a.v,Ce.a,n.c],pipes:[O.d,C.Yb],styles:[".button-content[_ngcontent-%COMP%]{border-radius:7px;padding-left:10px;padding-right:10px;max-width:400px;font-weight:700;height:60px}.no-results-center[_ngcontent-%COMP%]{text-align:center}.scroll[_ngcontent-%COMP%]{overflow-y:scroll;height:600px;width:600px}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar{width:12px}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f7ebfa}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:#9c31b5;border-radius:20px;border:3px solid #f7ebfa}.pad[_ngcontent-%COMP%]{padding:0;margin:auto;height:600px}.rectangle[_ngcontent-%COMP%]{background:#eee}.actif-filters[_ngcontent-%COMP%]{padding-top:40px;padding-left:14px;font-size:larger}.actif-filters[_ngcontent-%COMP%], .sauvegarde-text[_ngcontent-%COMP%]{padding-bottom:25px;font-weight:700}.sauvegarde-text[_ngcontent-%COMP%]{padding-left:20px;font-size:21px}.input-text[_ngcontent-%COMP%]{width:95%;padding-left:5%;padding-top:25px}.btn-ok[_ngcontent-%COMP%]{margin-top:30px}.input-width[_ngcontent-%COMP%]{width:475px}.pad5[_ngcontent-%COMP%]{padding-bottom:10px}.pad35[_ngcontent-%COMP%]{padding-left:20px;font-size:15px;font-weight:700}.border-results[_ngcontent-%COMP%]{left:0;right:0;top:0;bottom:0;background:#fff;border:1px solid #bdbdbd;box-sizing:border-box;border-radius:10px;margin-top:17px}.scroll-results[_ngcontent-%COMP%]{height:285px;width:107%;padding-left:25px;overflow-y:scroll;scrollbar-color:var(--vitamui-primary-light) #f7ebfa;scrollbar-width:thin}.scroll-results[_ngcontent-%COMP%]::-webkit-scrollbar{width:12px}.scroll-results[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#fff}.scroll-results[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:var(--vitamui-primary-light);border-radius:20px;border:3px solid #fff}.btn-create[_ngcontent-%COMP%]{padding:5px 0 0 140px}.pink-color[_ngcontent-%COMP%]{background:#f6f3fb}.boutton[_ngcontent-%COMP%]:focus{outline:none}.ko-icon[_ngcontent-%COMP%]{color:red;right:5px}.warning[_ngcontent-%COMP%]{padding-top:5px}.save-icon[_ngcontent-%COMP%]{color:#9d9d9d;font-size:35px}.pad-bottom[_ngcontent-%COMP%]{padding-bottom:10px;padding-left:5%}.triangle[_ngcontent-%COMP%]{position:relative;color:#fff;max-width:10%;top:134px;border:28px solid transparent;border-left-color:#eee}.scroll-filters[_ngcontent-%COMP%]{height:470px;overflow-y:scroll;overflow-x:hidden;scrollbar-color:var(--vitamui-primary-light) #f7ebfa;scrollbar-width:thin}.scroll-filters[_ngcontent-%COMP%]::-webkit-scrollbar{width:12px}.scroll-filters[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f7ebfa}.scroll-filters[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:var(--vitamui-primary-light);border-radius:20px;border:3px solid #f7ebfa}.results-message[_ngcontent-%COMP%]{font-weight:700;padding-left:5px;font-style:normal;font-size:16px;line-height:22px}.results-nb-filters[_ngcontent-%COMP%]{font-style:normal;font-weight:400;font-size:14px;line-height:22px;color:#616161}.div-update[_ngcontent-%COMP%]{padding-left:38px}.confirm-update[_ngcontent-%COMP%]{padding-left:35px;padding-top:10px}.cancel-update[_ngcontent-%COMP%]{padding-left:70px}.pad-actions[_ngcontent-%COMP%]{padding-left:30px}.pad-results[_ngcontent-%COMP%]{padding-top:12px;padding-bottom:12px}.hover-div[_ngcontent-%COMP%]:hover{border-radius:10px}.btn-result-update[_ngcontent-%COMP%]:hover, .hover-div[_ngcontent-%COMP%]:hover{background:#eceaf1}.btn-no-result[_ngcontent-%COMP%]{font-size:20px;padding-top:13px;color:var(--vitamui-grey-700)}.warning-message[_ngcontent-%COMP%]{font-family:Mulish;font-style:normal;font-weight:400;font-size:13px;line-height:16px;letter-spacing:-.2px;color:#000}.no-scroll-results[_ngcontent-%COMP%]{height:283px;width:107%;padding-left:25px;overflow-y:hidden}.scroll-div[_ngcontent-%COMP%]{height:470px;overflow-y:hidden;overflow-x:hidden}.form-width[_ngcontent-%COMP%]{width:730px}"]}),e})();var me=function(e){return e[e.RESULTS_MAX_NUMBER=1e4]="RESULTS_MAX_NUMBER",e[e.UPDATE_DEBOUNCE_TIME=200]="UPDATE_DEBOUNCE_TIME",e.BIG_RESULTS_FACETS_DEFAULT_TEXT="-",e}({});let fe=(()=>{class e{constructor(){this.RULES_COMPUTED_NUMBER_PREFIX="RULES_COMPUTED_NUMBER_",this.FINAL_ACTION_COMPUTED_PREFIX="FINAL_ACTION_COMPUTED_",this.EXPIRED_RULES_COMPUTED_PREFIX="EXPIRED_RULES_COMPUTED_",this.UNEXPIRED_RULES_COMPUTED_PREFIX="UNEXPIRED_RULES_COMPUTED_",this.COUNT_WITHOUT_RULES_PREFIX="COUNT_WITHOUT_RULES_",this.COMPUTE_RULES_AU_NUMBER="COMPUTE_RULES_AU_NUMBER",this.COUNT_BY_NODE="COUNT_BY_NODE"}extractNodesFacetsResults(e){const t=[];if(e&&e.length>0)for(const i of e)if(i.name===this.COUNT_BY_NODE)for(const e of i.buckets)t.push({node:e.value,count:e.count});return t}extractRulesFacetsResults(e){const t=new C.i;return e&&(t.appraisalRuleFacets=this.extractRulesFacetsResultsByCategory(e,C.X.APPRAISAL_RULE),t.accessRuleFacets=this.extractRulesFacetsResultsByCategory(e,C.X.ACCESS_RULE),t.disseminationRuleFacets=this.extractRulesFacetsResultsByCategory(e,C.X.DISSEMINATION_RULE),t.reuseRuleFacets=this.extractRulesFacetsResultsByCategory(e,C.X.REUSE_RULE),t.holdRuleFacets=this.extractRulesFacetsResultsByCategory(e,C.X.HOLD_RULE),t.classificationRuleFacets=this.extractRulesFacetsResultsByCategory(e,C.X.CLASSIFICATION_RULE),t.storageRuleFacets=this.extractRulesFacetsResultsByCategory(e,C.X.STORAGE_RULE)),t}extractRulesFacetsResultsByCategory(e,t){const i=new C.W;if(e&&e.length>0)for(const c of e){if(c.name===this.FINAL_ACTION_COMPUTED_PREFIX+t){const e=c.buckets,t=[];for(const i of e)t.push({node:i.value,count:i.count});i.finalActionsFacets=t}if(c.name===this.RULES_COMPUTED_NUMBER_PREFIX+t){const e=[],t=c.buckets;for(const i of t)e.push({node:i.value,count:i.count});i.rulesListFacets=e}if(c.name===this.EXPIRED_RULES_COMPUTED_PREFIX+t){const e=[],t=c.buckets;for(const i of t)e.push({node:i.value,count:i.count});i.expiredRulesListFacets=e}if(c.name===this.UNEXPIRED_RULES_COMPUTED_PREFIX+t){const e=[],t=c.buckets;for(const i of t)e.push({node:i.value,count:i.count});i.unexpiredRulesListFacets=e}if(c.name===this.COMPUTE_RULES_AU_NUMBER){const e=c.buckets,t=[];for(const i of e)t.push({node:i.value,count:i.count});i.waitingToRecalculateRulesListFacets=t}if(c.name===this.COUNT_WITHOUT_RULES_PREFIX+t){const e=c.buckets,t=[];for(const i of e)t.push({node:i.value,count:i.count});i.noRulesFacets=t}}return i}getFacetTextByExactCountFlag(e,t,i){let c=e.toString();return e<0&&(c=me.BIG_RESULTS_FACETS_DEFAULT_TEXT),!t&&i>=me.RESULTS_MAX_NUMBER&&(c=me.BIG_RESULTS_FACETS_DEFAULT_TEXT),c}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=_.Tb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Oe=(()=>{class e{constructor(e){this.archiveExchangeDataService=e}addCriteria(e,t,i,c,a,r,n,s,l,o,d,u){if(!c)return;if(a&&"ORIGIN_WAITING_RECALCULATE"===a.id)return this.addCriteria(e,t,i,"WAITING_RECALCULATE",{id:"WAITING_RECALCULATE",value:"true"},r,n,s,C.Z.FIELDS,o,d,u),l===C.Z.ACCESS_RULE&&this.archiveExchangeDataService.sendAppraisalFromMainSearchCriteriaAction({keyElt:c,valueElt:a,action:C.d.ADD}),l===C.Z.APPRAISAL_RULE&&this.archiveExchangeDataService.sendAccessFromMainSearchCriteriaAction({keyElt:c,valueElt:a,action:C.d.ADD}),l===C.Z.STORAGE_RULE&&this.archiveExchangeDataService.sendStorageFromMainSearchCriteriaAction({keyElt:c,valueElt:a,action:C.d.ADD}),l===C.Z.REUSE_RULE&&this.archiveExchangeDataService.sendReuseFromMainSearchCriteriaAction({keyElt:c,valueElt:a,action:C.d.ADD}),void(l===C.Z.DISSEMINATION_RULE&&this.archiveExchangeDataService.sendDisseminationFromMainSearchCriteriaAction({keyElt:c,valueElt:a,action:C.d.ADD}));if(!e)return;let h;if(i++,e.has(c)){h=e.get(c);let t=h.values;t&&0!==t.length||(t=[]),a&&(0===t.filter(e=>h.dataType===C.u.STRING||h.dataType===C.u.DATE?e.value.value===(null==a?void 0:a.value):e.value.beginInterval===a.beginInterval&&e.value.endInterval===a.endInterval).length&&t.push({value:a,label:r,valueShown:!0,status:C.Y.NOT_INCLUDED,keyTranslated:n,valueTranslated:o}),h.values=t,e.set(c,h))}else{-1===t.indexOf(c)&&(l===C.Z.NODES?t.unshift(c):t.push(c));const i=[];i.push({value:a,label:r,id:null==a?void 0:a.id,valueShown:!0,status:C.Y.NOT_INCLUDED,keyTranslated:n,valueTranslated:o}),e.set(c,{key:c,values:i,operator:s,category:l,keyTranslated:n,valueTranslated:o,dataType:d})}!0===u&&l===C.Z.APPRAISAL_RULE&&this.archiveExchangeDataService.sendAppraisalFromMainSearchCriteriaAction({keyElt:c,valueElt:a,action:C.d.ADD}),!0===u&&l===C.Z.ACCESS_RULE&&this.archiveExchangeDataService.sendAccessFromMainSearchCriteriaAction({keyElt:c,valueElt:a,action:C.d.ADD}),!0===u&&l===C.Z.STORAGE_RULE&&this.archiveExchangeDataService.sendStorageFromMainSearchCriteriaAction({keyElt:c,valueElt:a,action:C.d.ADD}),!0===u&&l===C.Z.REUSE_RULE&&this.archiveExchangeDataService.sendReuseFromMainSearchCriteriaAction({keyElt:c,valueElt:a,action:C.d.ADD}),!0===u&&l===C.Z.DISSEMINATION_RULE&&this.archiveExchangeDataService.sendDisseminationFromMainSearchCriteriaAction({keyElt:c,valueElt:a,action:C.d.ADD})}prepareUAIdList(e,t,i,c,a){const r=[];return e&&e.length>0&&((c||a)&&e.forEach(e=>{r.push(e)}),t&&t.length>0&&r.push({criteria:"GUID",values:t,operator:C.v.EQ,category:C.Z[C.Z.FIELDS],dataType:C.u.STRING}),i&&i.length>0&&r.push({criteria:"GUID",values:i,operator:C.v.NOT_EQ,category:C.Z[C.Z.FIELDS],dataType:C.u.STRING})),r}removeCriteria(e,t,i,c,a,r){a&&a.size>0&&(t&&"WAITING_RECALCULATE"===t.id&&(t.id="ORIGIN_WAITING_RECALCULATE",t.value="ORIGIN_WAITING_RECALCULATE",!0===i&&(this.archiveExchangeDataService.sendAppraisalFromMainSearchCriteriaAction({keyElt:e,valueElt:t,action:C.d.REMOVE}),this.archiveExchangeDataService.sendAccessFromMainSearchCriteriaAction({keyElt:e,valueElt:t,action:C.d.REMOVE}),this.archiveExchangeDataService.sendStorageFromMainSearchCriteriaAction({keyElt:e,valueElt:t,action:C.d.REMOVE}),this.archiveExchangeDataService.sendReuseFromMainSearchCriteriaAction({keyElt:e,valueElt:t,action:C.d.REMOVE}),this.archiveExchangeDataService.sendDisseminationFromMainSearchCriteriaAction({keyElt:e,valueElt:t,action:C.d.REMOVE})),t.id="WAITING_RECALCULATE"),t&&"ORIGIN_WAITING_RECALCULATE"===t.id&&this.removeCriteria("WAITING_RECALCULATE",{id:"WAITING_RECALCULATE",value:t.value},i,c,a,r),a.forEach((n,s)=>{if(s===e){let l=n.values;t&&(l=l.filter(e=>e.value.id!==t.id)),0===l.length?(c.forEach((t,i)=>{t===e&&c.splice(i,1)}),a.delete(e)):(n.values=l,a.set(e,n)),r--,!0!==i||"NODE"!==s&&s!==C.Q||this.archiveExchangeDataService.emitNodeTarget(t.value),!0===i&&n.category===C.Z.APPRAISAL_RULE&&this.archiveExchangeDataService.sendAppraisalFromMainSearchCriteriaAction({keyElt:e,valueElt:t,action:C.d.REMOVE}),!0===i&&n.category===C.Z.ACCESS_RULE&&this.archiveExchangeDataService.sendAccessFromMainSearchCriteriaAction({keyElt:e,valueElt:t,action:C.d.REMOVE}),!0===i&&n.category===C.Z.STORAGE_RULE&&this.archiveExchangeDataService.sendStorageFromMainSearchCriteriaAction({keyElt:e,valueElt:t,action:C.d.REMOVE}),!0===i&&n.category===C.Z.REUSE_RULE&&this.archiveExchangeDataService.sendReuseFromMainSearchCriteriaAction({keyElt:e,valueElt:t,action:C.d.REMOVE}),!0===i&&n.category===C.Z.DISSEMINATION_RULE&&this.archiveExchangeDataService.sendDisseminationFromMainSearchCriteriaAction({keyElt:e,valueElt:t,action:C.d.REMOVE}),!0===i&&n.category===C.Z.FIELDS&&"ALL_ARCHIVE_UNIT_TYPES"===n.key&&this.archiveExchangeDataService.sendRemoveFromChildSearchCriteriaAction({keyElt:e,valueElt:t,action:C.d.REMOVE})}}))}updateCriteriaStatus(e,t,i){e.forEach(e=>{e.values.forEach(e=>{e.status===t&&(e.status=i)})})}openSnackBarForWorkflow(e,t,i){e.openFromComponent(ne,{panelClass:"vitamui-snack-bar",data:{type:"WorkflowSuccessSnackBar",message:t,serviceUrl:i},duration:1e5})}findDefaultFacetTabIndex(e){let t=100;if(e&&e.size>0)for(const i of e.values())t>0&&this.isStorageRuleCriteria(i)&&(t=0),t>1&&this.isAppraisalRuleCriteria(i)&&(t=1),t>3&&this.isAccessRuleCriteria(i)&&(t=3),t>4&&this.isDisseminationRuleCriteria(i)&&(t=4),t>5&&this.isReuseRuleCriteria(i)&&(t=5),t>6&&this.isClassificationRuleCriteria(i)&&(t=6);return 100===t&&(t=0),t}checkIfRulesFacetsCanBeComputed(e){let t=!1;if(e&&e.size>0)for(const i of e.values())(!t&&(this.isAppraisalRuleCriteria(i)||this.isAccessRuleCriteria(i)||this.isStorageRuleCriteria(i)||this.isReuseRuleCriteria(i)||this.isDisseminationRuleCriteria(i))||this.isWaitingToRecalculateCriteria(i.key)||this.isEliminationTenchnicalIdCriteria(i.key))&&(t=!0);return t}buildFieldsCriteriaListForQUery(e,t){e.forEach(i=>{i.category===C.Z.FIELDS&&(this.updateCriteriaStatus(e,C.Y.NOT_INCLUDED,C.Y.IN_PROGRESS),t.push({criteria:i.key,values:i.values.map(e=>e.value),operator:i.operator,category:C.Z[C.Z.FIELDS],dataType:i.dataType}))})}buildManagementRulesCriteriaListForQuery(e,t,i){t.forEach(c=>{if(c.category.toString()===e){const a=[];c.values.forEach(e=>{a.push(e.value)});const r=c.key.replace("_"+e,"");i.push({criteria:r,values:a,operator:c.operator,category:c.category,dataType:c.dataType}),this.updateCriteriaStatus(t,C.Y.NOT_INCLUDED,C.Y.IN_PROGRESS)}})}buildNodesListForQUery(e,t){e.forEach(i=>{if(i.category===C.Z.NODES){const c=[];i.values.forEach(e=>{c.push(e.value)}),this.updateCriteriaStatus(e,C.Y.NOT_INCLUDED,C.Y.IN_PROGRESS),t.push({criteria:"NODE",values:c,operator:i.operator,category:C.Z[C.Z.NODES],dataType:i.dataType})}})}recursiveCheck(e,t){if(0!==e.length)for(const i of e)i.hidden=!1,i.checked=t,i.count=null,this.recursiveCheck(i.children,t)}fillNodeTitle(e,t,i,c,a){e.forEach(e=>{e.id===t?(e.checked=!0,e.hidden=!1,this.addCriteria(i,c,a,"NODE",{id:t,value:t},e.title,!0,C.v.EQ,C.Z.NODES,!1,C.u.STRING,!1)):e.children.length>0&&this.fillNodeTitle(e.children,t,i,c,a)})}isAppraisalRuleCriteria(e){return C.Z[e.category]===C.Z.APPRAISAL_RULE}isAccessRuleCriteria(e){return C.Z[e.category]===C.Z.ACCESS_RULE}isStorageRuleCriteria(e){return C.Z[e.category]===C.Z.STORAGE_RULE}isClassificationRuleCriteria(e){return C.Z[e.category]===C.Z.CLASSIFICATION_RULE}isDisseminationRuleCriteria(e){return C.Z[e.category]===C.Z.DISSEMINATION_RULE}isReuseRuleCriteria(e){return C.Z[e.category]===C.Z.REUSE_RULE}isWaitingToRecalculateCriteria(e){return"WAITING_RECALCULATE"===e||"ORIGIN_WAITING_RECALCULATE"===e}isEliminationTenchnicalIdCriteria(e){return"ELIMINATION_TECHNICAL_ID_APPRAISAL_RULE"===e}}return e.\u0275fac=function(t){return new(t||e)(_.ic(de))},e.\u0275prov=_.Tb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Ne=i("IrDo");const Fe=["confirmDeleteUpdateUnitsMetadataDialog"],De=["updateMetadataCSVFile"];function Ue(e,t){1&e&&_.Yb(0,"div")}function ye(e,t){1&e&&(_.dc(0,"div",12),_.Yb(1,"mat-spinner",13),_.cc())}function Pe(e,t){1&e&&(_.dc(0,"i",30),_.Vc(1,"check_circle"),_.cc())}function xe(e,t){1&e&&(_.dc(0,"i",31),_.Vc(1,"cancel "),_.cc())}function ke(e,t){if(1&e&&(_.dc(0,"div",24),_.dc(1,"div",25),_.Vc(2),_.dc(3,"span",26),_.Vc(4),_.cc(),_.Tc(5,Pe,2,0,"i",27),_.dc(6,"div"),_.dc(7,"span",28),_.Vc(8),_.cc(),_.Tc(9,xe,2,0,"i",29),_.cc(),_.cc(),_.cc()),2&e){const e=_.pc(2);_.Lb(2),_.Xc(" ",e.fileName," "),_.Lb(2),_.Xc(" | ",e.fileSizeString," "),_.Lb(1),_.vc("ngIf",!e.hasError),_.Lb(3),_.Xc("",e.erroeMessage," "),_.Lb(1),_.vc("ngIf",e.hasError)}}const Me=function(e){return{"on-over":e}};function Ve(e,t){if(1&e){const e=_.ec();_.dc(0,"div",14),_.dc(1,"div",15),_.lc("fileToUploadEmitter",(function(t){return _.Kc(e),_.pc().onDropped(t)}))("fileDragOverEmitter",(function(t){return _.Kc(e),_.pc().onDragOver(t)}))("fileDragLeaveEmitter",(function(t){return _.Kc(e),_.pc().onDragLeave(t)})),_.Tc(2,ke,10,5,"div",16),_.dc(3,"input",17,18),_.lc("change",(function(t){return _.Kc(e),_.pc().handleFileInput(t.target.files)})),_.cc(),_.dc(5,"div",19),_.dc(6,"div",20),_.Vc(7),_.qc(8,"translate"),_.Yb(9,"br"),_.cc(),_.dc(10,"div",20),_.dc(11,"div",21),_.dc(12,"span",22),_.lc("click",(function(){return _.Kc(e),_.pc().addUpdateMetadataCSVFile()})),_.Vc(13),_.qc(14,"translate"),_.cc(),_.cc(),_.cc(),_.dc(15,"div",23),_.dc(16,"span"),_.Vc(17),_.qc(18,"translate"),_.cc(),_.cc(),_.cc(),_.cc(),_.cc()}if(2&e){const e=_.pc();_.Lb(1),_.vc("ngClass",_.Ac(11,Me,e.hasDropZoneOver)),_.Lb(1),_.vc("ngIf",e.fileName&&e.fileSize>0&&e.fileSizeString),_.Lb(5),_.Wc(_.rc(8,5,"COLLECT.UPDATE_UNITS_METADATA.ADD_FILE")),_.Lb(6),_.Xc(" ",_.rc(14,7,"COLLECT.UPDATE_UNITS_METADATA.BROWSE"),""),_.Lb(4),_.Xc(" ",_.rc(18,9,"COLLECT.UPDATE_UNITS_METADATA.ACCEPTED_FORMAT"),"")}}function we(e,t){if(1&e){const e=_.ec();_.dc(0,"mat-dialog-content"),_.dc(1,"div",32),_.Vc(2),_.qc(3,"translate"),_.cc(),_.Yb(4,"br"),_.dc(5,"div",33),_.Vc(6),_.qc(7,"translate"),_.cc(),_.cc(),_.Yb(8,"br"),_.dc(9,"mat-dialog-actions"),_.dc(10,"button",34),_.lc("click",(function(){return _.Kc(e),_.pc().onConfirmAction()})),_.Vc(11),_.qc(12,"translate"),_.cc(),_.dc(13,"button",35),_.lc("click",(function(){return _.Kc(e),_.pc().onCloseAction()})),_.Vc(14),_.qc(15,"translate"),_.cc(),_.cc()}2&e&&(_.Lb(2),_.Wc(_.rc(3,4,"COLLECT.UPDATE_UNITS_METADATA.ACTION_TITLE")),_.Lb(4),_.Wc(_.rc(7,6,"COLLECT.UPDATE_UNITS_METADATA.CANCEL_UPDATE_TO_CONFIRM")),_.Lb(5),_.Xc(" ",_.rc(12,8,"COLLECT.UPDATE_UNITS_METADATA.CONFIRM")," "),_.Lb(3),_.Xc(" ",_.rc(15,10,"COLLECT.UPDATE_UNITS_METADATA.UPDATE_CANCEL")," "))}let He=(()=>{class e{constructor(e,t,i,c,a,r,n,s){this.data=e,this.logger=t,this.dialog=i,this.snackBar=c,this.dialogRef=a,this.dialogRefToClose=r,this.translateService=n,this.archiveCollectService=s,this.stepIndex=0,this.stepCount=1,this.fileSize=0,this.hasDropZoneOver=!1,this.isAtrNotValid=!1,this.isDisabled=!0,this.hasFileSizeError=!1,this.hasError=!1,this.isLoadingData=!1,this.fileToUpload=null,this.transfertDetails={}}ngOnDestroy(){var e;null===(e=this.subscriptions)||void 0===e||e.unsubscribe()}ngOnInit(){}updateUAMetadatas(){this.stepIndex=this.stepIndex+1}addUpdateMetadataCSVFile(){this.updateMetadataCSVFile.nativeElement.click()}updateUnitsMetadata(){this.isLoadingData=!0,this.snackBar.openFromComponent(ne,{panelClass:"vitamui-snack-bar",data:{type:"waitMassUpdateUnitsMetadata"},duration:1e5}),this.subscriptions=this.archiveCollectService.updateUnitsAMetadata(this.data.tenantIdentifier,this.fileToUpload,this.fileName,this.data.selectedTransaction.id).subscribe(e=>{this.isLoadingData=!1,e&&(this.dialogRef.close(!0),this.snackBar.openFromComponent(ne,{panelClass:"vitamui-snack-bar",data:{type:"massUpdateUnitsMetadata"},duration:1e5}))},e=>{this.isLoadingData=!1,this.dialogRef.close(!0),this.logger.error("Error message :",e)})}handleFileInput(e){this.handleFileList(e)}onDragOver(e){this.hasDropZoneOver=e}onDragLeave(e){this.hasDropZoneOver=e}onDropped(e){this.hasDropZoneOver=!1,this.handleFile(e)}checkFileExtension(e){return e.endsWith(".csv")}initializeFileToUpload(e){e&&(this.fileToUpload=e[0],this.fileName=this.fileToUpload.name,this.fileSize=this.fileToUpload.size)}initializeFileListToUpload(e){e&&(this.fileToUpload=e.item(0),this.fileName=this.fileToUpload.name,this.fileSize=this.fileToUpload.size)}onCancel(){this.dialogRefToClose=this.dialog.open(this.confirmDeleteUpdateUnitsMetadataDialog,{panelClass:"vitamui-dialog"})}onCloseAction(){this.dialogRefToClose.close(!0)}onConfirmAction(){this.dialogRefToClose.close(!0),this.dialogRef.close(!0)}initializeParameters(){this.isDisabled=!1,this.hasError=!1,this.hasFileSizeError=!1,this.erroeMessage=null,this.isAtrNotValid=!1}handleFile(e){this.initializeParameters(),this.initializeFileToUpload(e);const t=new C.p(this.logger);if(this.fileSizeString=t.transform(this.fileSize),!this.checkFileExtension(this.fileName))return this.erroeMessage=this.translateService.instant("COLLECT.UPDATE_UNITS_METADATA.FILE_BAD_FORMAT"),void(this.hasError=!0)}handleFileList(e){this.initializeParameters(),this.initializeFileListToUpload(e);const t=new C.p(this.logger);if(this.fileSizeString=t.transform(this.fileSize),!this.checkFileExtension(this.fileName))return this.erroeMessage=this.translateService.instant("COLLECT.UPDATE_UNITS_METADATA.FILE_BAD_FORMAT"),void(this.hasError=!0)}}return e.\u0275fac=function(t){return new(t||e)(_.Xb(n.a),_.Xb(C.O),_.Xb(n.b),_.Xb(f.b),_.Xb(n.h),_.Xb(n.h),_.Xb(O.e),_.Xb($))},e.\u0275cmp=_.Rb({type:e,selectors:[["app-update-units-metadata"]],viewQuery:function(e,t){var i;1&e&&(_.Pc(Fe,!0),_.bd(De,!0)),2&e&&(_.Fc(i=_.mc())&&(t.confirmDeleteUpdateUnitsMetadataDialog=i.first),_.Fc(i=_.mc())&&(t.updateMetadataCSVFile=i.first))},decls:28,vars:23,consts:[[1,"header"],[3,"count","index"],[3,"selectedIndex","selectionChange"],[1,"content"],["matTooltipClass","vitamui-tooltip",1,"vitamui-icon","vitamui-icon-info",3,"matTooltip"],[4,"ngIf","ngIfThen","ngIfElse"],[1,"actions"],["type","button",1,"btn","primary",3,"disabled","click"],["type","button",1,"btn","link",3,"disabled","click"],["loadingMode",""],["dragAndDropArea",""],["confirmDeleteUpdateUnitsMetadataDialog",""],[1,"vitamui-min-content"],[1,"vitamui-spinner","large"],[1,"d-flex"],["vitamuiCommonDragAndDrop","",1,"drag-and-drop-area",3,"ngClass","fileToUploadEmitter","fileDragOverEmitter","fileDragLeaveEmitter"],["class","drag-container",4,"ngIf"],["type","file",1,"input-file",3,"change"],["updateMetadataCSVFile",""],[1,"drop-csv-file-area"],[1,"csv-drop"],[1,"upload"],[1,"url-select",3,"click"],[1,"csv-drop-small"],[1,"drag-container"],[1,"file-info-class"],[1,"text-grey"],["class","material-icons success-icon",4,"ngIf"],[1,"text-red"],["class","material-icons error-icon",4,"ngIf"],[1,"material-icons","success-icon"],[1,"material-icons","error-icon"],[1,"text-title"],[1,"text","large","bold"],[1,"btn","primary","btn-confirm-dialog","margin-btn",3,"click"],["type","button",1,"btn","cancel",3,"click"]],template:function(e,t){if(1&e&&(_.dc(0,"div",0),_.Yb(1,"vitamui-common-progress-bar",1),_.cc(),_.dc(2,"vitamui-common-stepper",2),_.lc("selectionChange",(function(e){return t.stepIndex=e.selectedIndex})),_.dc(3,"cdk-step"),_.dc(4,"div",3),_.dc(5,"h2"),_.Vc(6),_.qc(7,"translate"),_.cc(),_.dc(8,"div"),_.dc(9,"h4"),_.Vc(10),_.qc(11,"translate"),_.Yb(12,"i",4),_.qc(13,"translate"),_.cc(),_.cc(),_.Tc(14,Ue,1,0,"div",5),_.dc(15,"div",6),_.dc(16,"button",7),_.lc("click",(function(){return t.updateUnitsMetadata()})),_.Vc(17),_.qc(18,"translate"),_.cc(),_.dc(19,"button",8),_.lc("click",(function(){return t.onCancel()})),_.Vc(20),_.qc(21,"translate"),_.cc(),_.cc(),_.cc(),_.cc(),_.cc(),_.Tc(22,ye,2,0,"ng-template",null,9,_.Uc),_.Tc(24,Ve,19,13,"ng-template",null,10,_.Uc),_.Tc(26,we,16,12,"ng-template",null,11,_.Uc)),2&e){const e=_.Gc(23),i=_.Gc(25);_.Lb(1),_.vc("count",t.stepCount)("index",t.stepIndex),_.Lb(1),_.vc("selectedIndex",t.stepIndex),_.Lb(4),_.Wc(_.rc(7,13,"COLLECT.UPDATE_UNITS_METADATA.ACTION_TITLE")),_.Lb(4),_.Xc(" ",_.rc(11,15,"COLLECT.UPDATE_UNITS_METADATA.ACTION_SUB_TITLE")," "),_.Lb(2),_.xc("matTooltip"," ",_.rc(13,17,"COLLECT.UPDATE_UNITS_METADATA.ACTION_DESCRIPTION")," "),_.Lb(2),_.vc("ngIf",t.isLoadingData)("ngIfThen",e)("ngIfElse",i),_.Lb(2),_.vc("disabled",t.isDisabled||t.hasError||t.isLoadingData),_.Lb(1),_.Xc(" ",_.rc(18,19,"COLLECT.UPDATE_UNITS_METADATA.UPDATE_CONFIRM")," "),_.Lb(2),_.vc("disabled",t.isLoadingData),_.Lb(1),_.Xc(" ",_.rc(21,21,"COLLECT.UPDATE_UNITS_METADATA.UPDATE_CANCEL")," ")}},directives:[C.Lb,C.eb,Ne.a,he.a,c.p,l.b,C.A,c.n,n.f,n.c],pipes:[O.d],styles:["h2[_ngcontent-%COMP%]{font-size:23px;line-height:46px;margin-top:10px}h4[_ngcontent-%COMP%]{font-size:19px;line-height:26px;margin-top:7px;margin-bottom:7px}button.primary[_ngcontent-%COMP%]{margin-right:20px}.drag-and-drop-area[_ngcontent-%COMP%]{width:100%;height:300px;border:2px dashed var(--vitamui-primary);border-radius:6px;box-shadow:0 0 80px rgba(255,255,249,.3);background:#fff;overflow:hidden}.drag-and-drop-area[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{padding-top:20px}.drag-container[_ngcontent-%COMP%]{width:100%;height:160px;vertical-align:middle;text-align:center}.file-info-class[_ngcontent-%COMP%]{font-size:14px;line-height:20px;text-align:center;margin-top:50px;margin-bottom:10px;color:#000;font-style:normal;font-weight:700;font-size:18px}.file-info-class[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{color:#a5a5a5}.text-red[_ngcontent-%COMP%]{color:#c10000}.text-grey[_ngcontent-%COMP%]{color:#9d9d9d;font-size:13px}.success-icon[_ngcontent-%COMP%]{color:#27740a;font-size:50px}.error-icon[_ngcontent-%COMP%]{color:#ea0101;font-size:50px}.input-file[_ngcontent-%COMP%]{display:none}.drop-csv-file-area[_ngcontent-%COMP%]{text-align:center;height:156px}.on-over[_ngcontent-%COMP%]{border:2px solid var(--vitamui-secondary)}.on-over[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#fff}.on-over[_ngcontent-%COMP%]   .drop-csv-file-area[_ngcontent-%COMP%]{background:#5cbaa9;opacity:.9;color:#fff}.csv-drop[_ngcontent-%COMP%]{font-size:19px;line-height:26px;margin-top:7px;margin-bottom:7px}.csv-drop-small[_ngcontent-%COMP%]{margin-top:190px;margin-bottom:10px;color:var(--vitamui-primary);font-style:normal;font-weight:700;line-height:10px}.csv-drop-small[_ngcontent-%COMP%], .upload-text[_ngcontent-%COMP%]{text-align:center;font-size:15px}.upload-text[_ngcontent-%COMP%]{padding-top:5%;line-height:18px;color:#a5a5a5}.upload-text[_ngcontent-%COMP%]   .upload[_ngcontent-%COMP%]{color:var(--vitamui-secondary)}.url-select[_ngcontent-%COMP%]{cursor:pointer;font-size:30px;color:var(--vitamui-primary);letter-spacing:.1px;white-space:nowrap;transform-origin:left;transition:transform .15s ease-out}"]}),e})();var Ge=i("seVz");class qe{constructor(e,t){this.key=e,this.value=t}}function Be(e,t){1&e&&_.Yb(0,"mat-spinner",7)}function We(e,t){if(1&e&&(_.dc(0,"span",17),_.Vc(1),_.qc(2,"number"),_.cc()),2&e){const e=_.pc(2).$implicit;_.Lb(1),_.Wc(_.sc(2,1,null==e?null:e.count,"1.0"))}}function je(e,t){if(1&e){const e=_.ec();_.dc(0,"div",14),_.dc(1,"div",1),_.dc(2,"vitamui-tree-node",15),_.lc("nodeToggle",(function(){_.Kc(e);const t=_.pc().$implicit;return _.pc(2).nestedTreeControlFull.toggle(t)}))("labelClick",(function(){_.Kc(e);const t=_.pc().$implicit;return _.pc(2).onShowNodeDetails(t.id)})),_.cc(),_.cc(),_.Tc(3,We,3,4,"span",16),_.cc()}if(2&e){const e=_.pc().$implicit,t=_.pc(2);_.Lb(2),_.vc("node",e)("icon",t.getNodeUnitIcon(e)),_.Lb(1),_.vc("ngIf",t.hasMatchesInSearch&&null!=(null==e?null:e.count)&&(null==e?null:e.count)>0)}}function Ye(e,t){if(1&e&&(_.dc(0,"mat-tree-node"),_.Tc(1,je,4,3,"div",13),_.cc()),2&e){const e=t.$implicit,i=_.pc(2);_.Lb(1),_.vc("ngIf",i.nodeHasMatchsOrShowAll(e))}}function Xe(e,t){if(1&e&&(_.dc(0,"span",17),_.Vc(1),_.qc(2,"number"),_.cc()),2&e){const e=_.pc(2).$implicit;_.Lb(1),_.Xc(" ",_.sc(2,1,null==e?null:e.count,"1.0")," ")}}function Ke(e,t){if(1&e){const e=_.ec();_.dc(0,"div",20),_.dc(1,"vitamui-tree-node",21),_.lc("nodeToggle",(function(){_.Kc(e);const t=_.pc().$implicit;return _.pc(2).nestedTreeControlFull.toggle(t)}))("labelClick",(function(){_.Kc(e);const t=_.pc().$implicit;return _.pc(2).onShowNodeDetails(t.id)})),_.cc(),_.Tc(2,Xe,3,4,"span",16),_.cc()}if(2&e){const e=_.pc().$implicit,t=_.pc(2);_.Lb(1),_.vc("node",e)("icon",t.getNodeUnitIcon(e))("expanded",t.nestedTreeControlFull.isExpanded(e)),_.Lb(1),_.vc("ngIf",t.hasMatchesInSearch&&null!=(null==e?null:e.count)&&(null==e?null:e.count)>0)}}function ze(e,t){1&e&&_.Zb(0,24)}function $e(e,t){if(1&e&&(_.dc(0,"div",22),_.Tc(1,ze,1,0,"ng-container",23),_.cc()),2&e){const e=_.pc().$implicit,t=_.pc(2);_.Pb("filing-holding-scheme-tree-invisible",!t.nestedTreeControlFull.isExpanded(e)),_.Lb(1),_.vc("ngIf",t.nestedTreeControlFull.isExpanded(e))}}function Ze(e,t){if(1&e&&(_.dc(0,"mat-nested-tree-node"),_.Tc(1,Ke,3,4,"div",18),_.Tc(2,$e,2,3,"div",19),_.cc()),2&e){const e=t.$implicit,i=_.pc(2);_.Lb(1),_.vc("ngIf",i.nodeHasMatchsOrShowAll(e)),_.Lb(1),_.vc("ngIf",i.nodeHasMatchsOrShowAll(e))}}function Qe(e,t){1&e&&_.Yb(0,"mat-tree-node",25)}function Je(e,t){1&e&&(_.dc(0,"div",26),_.Vc(1),_.qc(2,"translate"),_.cc()),2&e&&(_.Lb(1),_.Xc(" ",_.rc(2,1,"COLLECT.FILING_SCHEMA.NO_TREES_NO_PLANS_FOR_ACCESS_CONTRACT")," "))}function et(e,t){if(1&e&&(_.dc(0,"div"),_.dc(1,"div",8),_.dc(2,"mat-tree",9),_.Tc(3,Ye,2,1,"mat-tree-node",10),_.Tc(4,Ze,3,2,"mat-nested-tree-node",10),_.Tc(5,Qe,1,0,"mat-tree-node",11),_.cc(),_.cc(),_.Tc(6,Je,3,3,"div",12),_.cc()),2&e){const e=_.pc();_.Lb(2),_.vc("dataSource",e.nestedDataSourceFull)("treeControl",e.nestedTreeControlFull),_.Lb(1),_.vc("matTreeNodeDefWhen",e.nodeHasNoChidren),_.Lb(1),_.vc("matTreeNodeDefWhen",e.nodeHasChidren),_.Lb(2),_.vc("ngIf",e.nestedDataSourceFull.data.length<=0)}}function tt(e,t){1&e&&(_.dc(0,"div"),_.Yb(1,"mat-spinner",27),_.cc())}let it=(()=>{class e{constructor(){this.addToSearchCriteria=new _.p,this.showNodeDetail=new _.p,this.switchView=new _.p,this.closePanel=new _.p}addToSearchCriteriaList(e){this.addToSearchCriteria.emit(e)}onShowNodeDetails(e){this.showNodeDetail.emit(new qe(e,!1))}onViewSwitched(){this.switchView.emit()}nodeHasChidren(e,t){return Object(C.wb)(t)}nodeHasNoChidren(e,t){return!Object(C.wb)(t)}nodeHasMatchsOrShowAll(e){return this.showEveryNodes||Object(C.xb)(e)}onClosePanel(){this.closePanel.emit()}getNodeUnitIcon(e){return Object(C.yb)(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=_.Rb({type:e,selectors:[["app-classification-tree"]],inputs:{loadingHolding:"loadingHolding",nestedDataSourceFull:"nestedDataSourceFull",nestedTreeControlFull:"nestedTreeControlFull",hasMatchesInSearch:"hasMatchesInSearch",showEveryNodes:"showEveryNodes",loadingNodeUnit:"loadingNodeUnit"},outputs:{addToSearchCriteria:"addToSearchCriteria",showNodeDetail:"showNodeDetail",switchView:"switchView",closePanel:"closePanel"},decls:11,vars:6,consts:[[1,"flex-row"],[1,"tree-text"],[1,"tree-title"],["diameter","20","color","accent",4,"ngIf"],[1,"btn","link","cancel"],[1,"vitamui-icon","vitamui-icon-close",3,"click"],[4,"ngIf"],["diameter","20","color","accent"],[1,"tree-filing-scheme"],[1,"filing-holding-scheme-tree",3,"dataSource","treeControl"],[4,"matTreeNodeDef","matTreeNodeDefWhen"],["class","hide",4,"matTreeNodeDef"],["class","area-show-tree",4,"ngIf"],["class","mat-tree-node filing-holding-scheme-tree-node flex-row",4,"ngIf"],[1,"mat-tree-node","filing-holding-scheme-tree-node","flex-row"],["disabled","",3,"node","icon","nodeToggle","labelClick"],["class","badge badge-secondary pad",4,"ngIf"],[1,"badge","badge-secondary","pad"],["class","mat-tree-node filing-holding-scheme-tree-node",4,"ngIf"],["class","flex-column childs",3,"filing-holding-scheme-tree-invisible",4,"ngIf"],[1,"mat-tree-node","filing-holding-scheme-tree-node"],[3,"node","icon","expanded","nodeToggle","labelClick"],[1,"flex-column","childs"],["matTreeNodeOutlet","",4,"ngIf"],["matTreeNodeOutlet",""],[1,"hide"],[1,"area-show-tree"],["diameter","50","color","accent"]],template:function(e,t){1&e&&(_.dc(0,"div",0),_.dc(1,"div",1),_.dc(2,"div",2),_.dc(3,"span"),_.Vc(4),_.qc(5,"translate"),_.cc(),_.Tc(6,Be,1,0,"mat-spinner",3),_.cc(),_.cc(),_.dc(7,"button",4),_.dc(8,"i",5),_.lc("click",(function(){return t.onClosePanel()})),_.cc(),_.cc(),_.cc(),_.Tc(9,et,7,5,"div",6),_.Tc(10,tt,2,0,"div",6)),2&e&&(_.Lb(4),_.Wc(_.rc(5,4,"COLLECT.FILING_SCHEMA.TREE_TITLE")),_.Lb(2),_.vc("ngIf",t.loadingNodeUnit),_.Lb(3),_.vc("ngIf",!t.loadingHolding),_.Lb(1),_.vc("ngIf",t.loadingHolding))},directives:[c.p,l.b,h.b,h.f,h.e,C.pb,h.a,h.g],pipes:[O.d,c.f],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%;background:#fff;margin:0;width:100%}[_nghost-%COMP%]   div[_ngcontent-%COMP%], [_nghost-%COMP%]   mat-nested-tree-node[_ngcontent-%COMP%], [_nghost-%COMP%]   mat-tree[_ngcontent-%COMP%], [_nghost-%COMP%]   mat-tree-node[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start;align-items:flex-start;width:100%}[_nghost-%COMP%]   .tree-text[_ngcontent-%COMP%]{flex:1;min-width:0}[_nghost-%COMP%]   .tree-text[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], [_nghost-%COMP%]   .tree-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}[_nghost-%COMP%]   .mat-tree-node[_ngcontent-%COMP%]{flex:1 1 auto;min-height:0}[_nghost-%COMP%]   mat-nested-tree-node[_ngcontent-%COMP%]   .childs[_ngcontent-%COMP%]{padding-left:27px}[_nghost-%COMP%]   .vitamui-sidepanel-resize-sidebar[_ngcontent-%COMP%]{border-top:4px solid #702382;height:0;padding:0;margin:0;cursor:ns-resize;flex:0 0 auto}[_nghost-%COMP%]   .vitamui-sidepanel-header[_ngcontent-%COMP%]{flex-grow:1;overflow:auto}[_nghost-%COMP%]   .tree-filing-scheme[_ngcontent-%COMP%]{flex:1;flex-direction:column;background-color:#fafafa}[_nghost-%COMP%]   .tree-filing-scheme[_ngcontent-%COMP%]   mat-nested-tree-node[_ngcontent-%COMP%], [_nghost-%COMP%]   .tree-filing-scheme[_ngcontent-%COMP%]   mat-tree-node[_ngcontent-%COMP%]{flex-direction:column}[_nghost-%COMP%]   .load-more-ua[_ngcontent-%COMP%]{cursor:pointer;color:#979797;text-decoration:underline}[_nghost-%COMP%]   .tree-title[_ngcontent-%COMP%]{flex-direction:row;justify-content:space-between;margin-top:15px;margin-bottom:15px}.filing-holding-scheme-tree-invisible[_ngcontent-%COMP%], .hide[_ngcontent-%COMP%]{display:none}.filing-holding-scheme-tree-node[_ngcontent-%COMP%]{position:relative;border-bottom:1px solid hsla(0,0%,59.2%,.3);color:var(--vitamui-secondary-dark-5);cursor:pointer}.filing-holding-scheme-tree-node[_ngcontent-%COMP%]:hover{background-color:#fafafa}.loader[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;top:0;left:0;right:0;bottom:0;background:hsla(0,0%,100%,.8)}.icon-greeny-blue[_ngcontent-%COMP%]{color:var(--vitamui-secondary)}.tree-show-link[_ngcontent-%COMP%]{cursor:pointer;color:#979797;text-decoration:underline}.badge[_ngcontent-%COMP%]{display:inline-block;padding:.25em 1.5em;font-size:100%;font-weight:700;line-height:1;position:absolute;top:14px;white-space:nowrap;vertical-align:baseline;border-radius:1.25rem;right:2px;width:54px;text-align:right}.badge-secondary[_ngcontent-%COMP%]{color:#2c76c9;background-color:#abcaed}.area-show-tree[_ngcontent-%COMP%]{padding-top:20px}.badge-parent[_ngcontent-%COMP%]{position:relative}"]}),e})();function ct(e,t){1&e&&_.Yb(0,"mat-spinner",8)}function at(e,t){if(1&e&&(_.dc(0,"span",14),_.Vc(1),_.qc(2,"number"),_.cc()),2&e){const e=_.pc(2).$implicit;_.Lb(1),_.Xc(" ",_.sc(2,1,e.count,"1.0")," ")}}function rt(e,t){if(1&e){const e=_.ec();_.dc(0,"div",11),_.dc(1,"vitamui-tree-node",12),_.lc("labelClick",(function(){_.Kc(e);const t=_.pc().$implicit;return _.pc().onLabelClick(t)}))("checkboxClick",(function(){_.Kc(e);const t=_.pc().$implicit;return _.pc().addToSearchCriteriaList(t)}))("nodeToggle",(function(){_.Kc(e);const t=_.pc().$implicit;return _.pc().toggleLeave(t)})),_.cc(),_.Tc(2,at,3,4,"span",13),_.cc()}if(2&e){const e=_.pc().$implicit,t=_.pc();_.Lb(1),_.vc("node",e)("icon",t.getNodeUnitIcon(e))("expanded",t.nestedTreeControlLeaves.isExpanded(e)),_.Lb(1),_.vc("ngIf",t.nodeHasPositiveCount(e))}}function nt(e,t){1&e&&_.Zb(0,18)}function st(e,t){1&e&&(_.dc(0,"div"),_.Yb(1,"mat-spinner",8),_.cc())}function lt(e,t){if(1&e){const e=_.ec();_.dc(0,"div"),_.dc(1,"a",19),_.lc("click",(function(){_.Kc(e);const t=_.pc(2).$implicit;return _.pc().toggleLoadMore(t)})),_.Vc(2),_.qc(3,"translate"),_.cc(),_.cc()}2&e&&(_.Lb(2),_.Xc(" ",_.rc(3,1,"COLLECT.FILING_SCHEMA.LOAD_MORE_UNITS")," "))}function ot(e,t){if(1&e&&(_.dc(0,"div",15),_.Tc(1,nt,1,0,"ng-container",16),_.Tc(2,st,2,0,"div",17),_.Tc(3,lt,4,3,"div",17),_.cc()),2&e){const e=_.pc().$implicit,t=_.pc();_.Pb("filing-holding-scheme-tree-invisible",!t.nestedTreeControlLeaves.isExpanded(e)),_.Lb(1),_.vc("ngIf",t.nestedTreeControlLeaves.isExpanded(e)),_.Lb(1),_.vc("ngIf",e.isLoadingChildren),_.Lb(1),_.vc("ngIf",t.canLoadMoreUAForNode(e)&&t.nestedTreeControlLeaves.isExpanded(e))}}function dt(e,t){if(1&e&&(_.dc(0,"mat-nested-tree-node"),_.Tc(1,rt,3,4,"div",9),_.Tc(2,ot,4,5,"div",10),_.cc()),2&e){const e=t.$implicit,i=_.pc();_.Lb(1),_.vc("ngIf",i.nodeHasResultOrShowAll(e)),_.Lb(1),_.vc("ngIf",i.nodeHasResultOrShowAll(e))}}function ut(e,t){if(1&e&&(_.dc(0,"span",14),_.Vc(1),_.qc(2,"number"),_.cc()),2&e){const e=_.pc(2).$implicit;_.Lb(1),_.Xc(" ",_.sc(2,1,e.count,"1.0")," ")}}function ht(e,t){if(1&e){const e=_.ec();_.dc(0,"div",11),_.dc(1,"div",1),_.dc(2,"vitamui-tree-node",20),_.lc("labelClick",(function(){_.Kc(e);const t=_.pc().$implicit;return _.pc().onLabelClick(t)}))("checkboxClick",(function(){_.Kc(e);const t=_.pc().$implicit;return _.pc().addToSearchCriteriaList(t)}))("nodeToggle",(function(){_.Kc(e);const t=_.pc().$implicit;return _.pc().nestedTreeControlLeaves.toggle(t)})),_.cc(),_.cc(),_.Tc(3,ut,3,4,"span",13),_.cc()}if(2&e){const e=_.pc().$implicit,t=_.pc();_.Lb(2),_.vc("node",e)("icon",t.getNodeUnitIcon(e)),_.Lb(1),_.vc("ngIf",t.nodeHasPositiveCount(e))}}function Ct(e,t){if(1&e&&(_.dc(0,"mat-tree-node"),_.Tc(1,ht,4,3,"div",9),_.cc()),2&e){const e=t.$implicit,i=_.pc();_.Lb(1),_.vc("ngIf",i.nodeHasResultOrShowAll(e))}}function Et(e,t){if(1&e&&(_.dc(0,"span",23),_.Vc(1),_.qc(2,"number"),_.cc()),2&e){const e=_.pc(2).$implicit;_.Lb(1),_.Xc(" ",_.sc(2,1,e.count,"1.0")," ")}}function Rt(e,t){if(1&e){const e=_.ec();_.dc(0,"div",11),_.dc(1,"vitamui-tree-node",21),_.lc("checkboxClick",(function(){_.Kc(e);const t=_.pc().$implicit;return _.pc().addToSearchCriteriaList(t)}))("nodeToggle",(function(){_.Kc(e);const t=_.pc().$implicit;return _.pc().toggleOrphansNode(t)})),_.cc(),_.Tc(2,Et,3,4,"span",22),_.cc()}if(2&e){const e=_.pc().$implicit,t=_.pc();_.Lb(1),_.vc("node",e)("expanded",t.nestedTreeControlLeaves.isExpanded(e)),_.Lb(1),_.vc("ngIf",t.nodeHasPositiveCount(e))}}function pt(e,t){1&e&&_.Zb(0,18)}function vt(e,t){1&e&&(_.dc(0,"div"),_.Yb(1,"mat-spinner",8),_.cc())}function It(e,t){if(1&e){const e=_.ec();_.dc(0,"div"),_.dc(1,"a",19),_.lc("click",(function(){_.Kc(e);const t=_.pc(2).$implicit;return _.pc().toggleLoadMoreOrphans(t)})),_.Vc(2),_.qc(3,"translate"),_.cc(),_.cc()}2&e&&(_.Lb(2),_.Xc(" ",_.rc(3,1,"ARCHIVE_SEARCH.FILING_SCHEMA.LOAD_MORE_UNITS")," "))}function Tt(e,t){if(1&e&&(_.dc(0,"div",15),_.Tc(1,pt,1,0,"ng-container",16),_.Tc(2,vt,2,0,"div",17),_.Tc(3,It,4,3,"div",17),_.cc()),2&e){const e=_.pc().$implicit,t=_.pc();_.Pb("filing-holding-scheme-tree-invisible",!t.nestedTreeControlLeaves.isExpanded(e)),_.Lb(1),_.vc("ngIf",t.nestedTreeControlLeaves.isExpanded(e)),_.Lb(1),_.vc("ngIf",e.isLoadingChildren),_.Lb(1),_.vc("ngIf",t.canLoadMoreUAForNode(e)&&t.nestedTreeControlLeaves.isExpanded(e))}}function gt(e,t){if(1&e&&(_.dc(0,"mat-nested-tree-node"),_.Tc(1,Rt,3,3,"div",9),_.Tc(2,Tt,4,5,"div",10),_.cc()),2&e){const e=t.$implicit,i=_.pc();_.Lb(1),_.vc("ngIf",i.nodeHasResultOrShowAll(e)),_.Lb(1),_.vc("ngIf",i.nodeHasResultOrShowAll(e))}}function Lt(e,t){if(1&e&&(_.dc(0,"span",14),_.Vc(1),_.qc(2,"number"),_.cc()),2&e){const e=_.pc(2).$implicit;_.Lb(1),_.Xc(" ",_.sc(2,1,e.count,"1.0")," ")}}function bt(e,t){if(1&e){const e=_.ec();_.dc(0,"div",25),_.dc(1,"vitamui-tree-node",12),_.lc("labelClick",(function(){_.Kc(e);const t=_.pc().$implicit;return _.pc().onLabelClick(t)}))("checkboxClick",(function(){_.Kc(e);const t=_.pc().$implicit;return _.pc().addToSearchCriteriaList(t)}))("nodeToggle",(function(){_.Kc(e);const t=_.pc().$implicit;return _.pc().toggleLeave(t)})),_.cc(),_.Tc(2,Lt,3,4,"span",13),_.cc()}if(2&e){const e=_.pc().$implicit,t=_.pc();_.Lb(1),_.vc("node",e)("icon",t.getNodeUnitIcon(e))("expanded",t.nestedTreeControlLeaves.isExpanded(e)),_.Lb(1),_.vc("ngIf",t.nodeHasPositiveCount(e))}}function At(e,t){1&e&&_.Zb(0,18)}function St(e,t){1&e&&(_.dc(0,"div"),_.Yb(1,"mat-spinner",8),_.cc())}function _t(e,t){if(1&e){const e=_.ec();_.dc(0,"div"),_.dc(1,"a",19),_.lc("click",(function(){_.Kc(e);const t=_.pc(2).$implicit;return _.pc().toggleLoadMore(t)})),_.Vc(2),_.qc(3,"translate"),_.cc(),_.cc()}2&e&&(_.Lb(2),_.Xc(" ",_.rc(3,1,"COLLECT.FILING_SCHEMA.LOAD_MORE_UNITS")," "))}function mt(e,t){if(1&e&&(_.dc(0,"div",15),_.Tc(1,At,1,0,"ng-container",16),_.Tc(2,St,2,0,"div",17),_.Tc(3,_t,4,3,"div",17),_.cc()),2&e){const e=_.pc().$implicit,t=_.pc();_.Pb("filing-holding-scheme-tree-invisible",!t.nestedTreeControlLeaves.isExpanded(e)),_.Lb(1),_.vc("ngIf",!e.isLoadingChilds&&t.nestedTreeControlLeaves.isExpanded(e)),_.Lb(1),_.vc("ngIf",e.isLoadingChildren),_.Lb(1),_.vc("ngIf",t.canLoadMoreUAForNode(e)&&t.nestedTreeControlLeaves.isExpanded(e))}}function ft(e,t){if(1&e&&(_.dc(0,"mat-nested-tree-node"),_.Tc(1,bt,3,4,"div",24),_.Tc(2,mt,4,5,"div",10),_.cc()),2&e){const e=t.$implicit,i=_.pc();_.Lb(1),_.vc("ngIf",i.nodeHasResultOrShowAll(e)),_.Lb(1),_.vc("ngIf",i.nodeHasResultOrShowAll(e))}}let Ot=(()=>{class e{constructor(e,t){this.archiveSharedDataService=e,this.archiveCollectService=t,this.DEFAULT_UNIT_PAGE_SIZE=10,this.addToSearchCriteria=new _.p,this.showNodeDetail=new _.p,this.switchView=new _.p,this.nestedTreeControlLeaves=new Ge.j(e=>e.children),this.showEveryNodes=!0,this.showFacetsCount=!0,this.subscriptions=new R.a,this.leavesTreeService=new C.N(this.archiveCollectService)}ngOnInit(){this.subscribeOnSearchCriteriasUpdate()}ngOnChanges(e){(e.nestedDataSourceLeaves||e.searchRequestResultFacets)&&(this.nestedTreeControlLeaves.dataNodes=this.nestedDataSourceLeaves.data,this.searchCriterias&&this.loadNodesDetailsFromFacetsIdsAndAddThem(this.nestedDataSourceLeaves.data,this.searchRequestResultFacets),e.searchRequestResultFacets&&e.searchRequestResultFacets.currentValue.length>0&&this.leavesTreeService.setSearchRequestResultFacets(e.searchRequestResultFacets.currentValue),this.refreshTreeNodes()),e.transactionId&&this.leavesTreeService.setTransactionId(this.transactionId)}ngOnDestroy(){this.subscriptions.unsubscribe()}addToSearchCriteriaList(e){this.addToSearchCriteria.emit(e)}searchUnderNode(e){this.leavesTreeService.searchUnderNode(e).subscribe(e=>{this.refreshTreeNodes()})}searchUnderNodeWithSearchCriterias(e){this.leavesTreeService.searchUnderNodeWithSearchCriterias(e).subscribe(e=>{this.refreshTreeNodes()})}searchAtNodeWithSearchCriterias(e){this.leavesTreeService.searchAtNodeWithSearchCriterias(e).subscribe(e=>{this.refreshTreeNodes()})}searchOrphans(e){this.leavesTreeService.searchOrphans(e).subscribe(e=>{this.refreshTreeNodes()})}searchOrphansWithSearchCriterias(e){this.leavesTreeService.searchOrphansWithSearchCriterias(e).subscribe(e=>{this.refreshTreeNodes()})}loadNodesDetailsFromFacetsIdsAndAddThem(e,t){this.leavesTreeService.loadNodesDetailsFromFacetsIdsAndAddThem(e,t).subscribe(e=>{this.refreshTreeNodes()})}refreshTreeNodes(){const e=this.nestedDataSourceLeaves.data;this.nestedDataSourceLeaves.data=null,this.nestedDataSourceLeaves.data=e}firstToggle(e){return this.leavesTreeService.firstToggle(e)}toggleOrphansNode(e){const t=this.nestedTreeControlLeaves.isExpanded(e);this.nestedTreeControlLeaves.toggle(e),t||this.firstToggle(e)&&(this.searchOrphans(e),this.searchOrphansWithSearchCriterias(e))}toggleLeave(e){const t=this.nestedTreeControlLeaves.isExpanded(e);this.nestedTreeControlLeaves.toggle(e),t||this.firstToggle(e)&&(this.searchUnderNodeWithSearchCriterias(e),this.searchUnderNode(e),this.searchAtNodeWithSearchCriterias(e))}toggleLoadMoreOrphans(e){this.nestedTreeControlLeaves.isExpanded(e)&&(this.searchOrphans(e),this.searchOrphansWithSearchCriterias(e))}toggleLoadMore(e){this.nestedTreeControlLeaves.isExpanded(e)&&(this.searchUnderNodeWithSearchCriterias(e),this.searchUnderNode(e))}canLoadMoreUAForNode(e){return!e.isLoadingChildren&&(this.showEveryNodes&&e.canLoadMoreChildren||!this.showEveryNodes&&e.canLoadMoreMatchingChildren)}nodeIsUAWithChildren(e,t){return t.unitType===C.kb.INGEST&&t.descriptionLevel!==C.y.ITEM}nodeIsUAWithoutChildren(e,t){return t.unitType===C.kb.INGEST&&t.descriptionLevel===C.y.ITEM}nodeIsOrphansNode(e,t){return C.H.isOrphansNode(t)}nodeHasPositiveCount(e){return e.count&&e.count>0}nodeHasResultOrShowAll(e){return this.nodeHasPositiveCount(e)||this.showEveryNodes}onLabelClick(e){this.showNodeDetail.emit(new qe(e.vitamId,e.id===e.vitamId))}switchViewAllNodes(){this.showEveryNodes=!this.showEveryNodes}getNodeUnitIcon(e){return Object(C.yb)(e)}subscribeOnSearchCriteriasUpdate(){this.subscriptions.add(this.archiveSharedDataService.getSearchCriterias().subscribe(e=>{this.leavesTreeService.setSearchCriterias(e),this.searchCriterias=e}))}}return e.\u0275fac=function(t){return new(t||e)(_.Xb(de),_.Xb($))},e.\u0275cmp=_.Rb({type:e,selectors:[["app-leaves-tree"]],inputs:{loadingNodeUnit:"loadingNodeUnit",transactionId:"transactionId",nestedDataSourceLeaves:"nestedDataSourceLeaves",searchRequestResultFacets:"searchRequestResultFacets",searchRequestTotalResults:"searchRequestTotalResults"},outputs:{addToSearchCriteria:"addToSearchCriteria",showNodeDetail:"showNodeDetail",switchView:"switchView"},features:[_.Jb],decls:13,vars:9,consts:[[1,"flex-row"],[1,"tree-text"],[1,"tree-title"],["diameter","20","color","accent",4,"ngIf"],[1,"tree-filing-scheme"],[1,"filing-holding-scheme-tree",3,"dataSource","treeControl"],[4,"matTreeNodeDef","matTreeNodeDefWhen"],[4,"matTreeNodeDef"],["diameter","20","color","accent"],["class","mat-tree-node filing-holding-scheme-tree-node flex-row",4,"ngIf"],["class","flex-column childs",3,"filing-holding-scheme-tree-invisible",4,"ngIf"],[1,"mat-tree-node","filing-holding-scheme-tree-node","flex-row"],[3,"node","icon","expanded","labelClick","checkboxClick","nodeToggle"],["class","badge badge-secondary pad",4,"ngIf"],[1,"badge","badge-secondary","pad"],[1,"flex-column","childs"],["matTreeNodeOutlet","",4,"ngIf"],[4,"ngIf"],["matTreeNodeOutlet",""],[1,"load-more-ua",3,"click"],["disabled","",3,"node","icon","labelClick","checkboxClick","nodeToggle"],[3,"node","expanded","checkboxClick","nodeToggle"],["class","badge badge-primary pad",4,"ngIf"],[1,"badge","badge-primary","pad"],["class","mat-tree-node filing-holding-scheme-tree-node",4,"ngIf"],[1,"mat-tree-node","filing-holding-scheme-tree-node"]],template:function(e,t){1&e&&(_.dc(0,"div",0),_.dc(1,"div",1),_.dc(2,"div",2),_.dc(3,"span"),_.Vc(4),_.qc(5,"translate"),_.cc(),_.Tc(6,ct,1,0,"mat-spinner",3),_.cc(),_.cc(),_.cc(),_.dc(7,"div",4),_.dc(8,"mat-tree",5),_.Tc(9,dt,3,2,"mat-nested-tree-node",6),_.Tc(10,Ct,2,1,"mat-tree-node",6),_.Tc(11,gt,3,2,"mat-nested-tree-node",6),_.Tc(12,ft,3,2,"mat-nested-tree-node",7),_.cc(),_.cc()),2&e&&(_.Lb(4),_.Wc(_.rc(5,7,"COLLECT.FILING_SCHEMA.TREE_LEAVES_TITLE")),_.Lb(2),_.vc("ngIf",0==t.nestedDataSourceLeaves.data.length),_.Lb(2),_.vc("dataSource",t.nestedDataSourceLeaves)("treeControl",t.nestedTreeControlLeaves),_.Lb(1),_.vc("matTreeNodeDefWhen",t.nodeIsUAWithChildren),_.Lb(1),_.vc("matTreeNodeDefWhen",t.nodeIsUAWithoutChildren),_.Lb(1),_.vc("matTreeNodeDefWhen",t.nodeIsOrphansNode))},directives:[c.p,h.b,h.f,l.b,h.a,C.pb,h.g,h.e],pipes:[O.d,c.f],styles:["[_nghost-%COMP%], [_nghost-%COMP%]   div[_ngcontent-%COMP%], [_nghost-%COMP%]   mat-nested-tree-node[_ngcontent-%COMP%], [_nghost-%COMP%]   mat-tree[_ngcontent-%COMP%], [_nghost-%COMP%]   mat-tree-node[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start;align-items:flex-start;width:100%}[_nghost-%COMP%]   .tree-text[_ngcontent-%COMP%]{flex:1;min-width:0}[_nghost-%COMP%]   .tree-text[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], [_nghost-%COMP%]   .tree-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}[_nghost-%COMP%]   .mat-tree-node[_ngcontent-%COMP%]{flex:1 1 auto;min-height:0}[_nghost-%COMP%]   mat-nested-tree-node[_ngcontent-%COMP%]   .childs[_ngcontent-%COMP%]{padding-left:27px}[_nghost-%COMP%]   .vitamui-sidepanel-resize-sidebar[_ngcontent-%COMP%]{border-top:4px solid #702382;height:0;padding:0;margin:0;cursor:ns-resize;flex:0 0 auto}[_nghost-%COMP%]   .vitamui-sidepanel-header[_ngcontent-%COMP%]{flex-grow:1;overflow:auto;position:relative}[_nghost-%COMP%]   .tree-filing-scheme[_ngcontent-%COMP%]{flex:1;flex-direction:column}[_nghost-%COMP%]   .tree-filing-scheme[_ngcontent-%COMP%]   mat-nested-tree-node[_ngcontent-%COMP%], [_nghost-%COMP%]   .tree-filing-scheme[_ngcontent-%COMP%]   mat-tree-node[_ngcontent-%COMP%]{flex-direction:column}[_nghost-%COMP%]   .load-more-ua[_ngcontent-%COMP%]{cursor:pointer;color:#205692;text-decoration:underline}[_nghost-%COMP%]   .tree-title[_ngcontent-%COMP%]{flex-direction:row;justify-content:space-between;margin-top:15px;margin-bottom:15px}.filing-holding-scheme-tree-invisible[_ngcontent-%COMP%]{display:none}.filing-holding-scheme-tree-node[_ngcontent-%COMP%]{position:relative;border-bottom:1px solid hsla(0,0%,59.2%,.3);color:var(--vitamui-secondary-dark-5);cursor:pointer}.filing-holding-scheme-tree-node[_ngcontent-%COMP%]:hover{background-color:#fafafa}.loader[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;top:0;left:0;right:0;bottom:0;background:hsla(0,0%,100%,.8)}.icon-greeny-blue[_ngcontent-%COMP%]{color:var(--vitamui-secondary)}.tree-show-link[_ngcontent-%COMP%]{cursor:pointer;color:#979797;text-decoration:underline}.badge[_ngcontent-%COMP%]{display:inline-block;padding:.25em 0;font-size:100%;font-weight:700;line-height:1;position:absolute;top:11px;right:2px;white-space:nowrap;vertical-align:baseline;border-radius:1.25rem;width:54px;text-align:center}.badge-primary[_ngcontent-%COMP%]{color:#9c31b5;background-color:#e6c3ef}.badge-secondary[_ngcontent-%COMP%]{color:#2c76c9;background-color:#abcaed}.area-show-tree[_ngcontent-%COMP%]{padding-top:20px}.badge-parent[_ngcontent-%COMP%]{position:relative}"]}),e})();function Nt(e,t){1&e&&_.Yb(0,"div",4)}function Ft(e,t){if(1&e){const e=_.ec();_.dc(0,"div",5),_.dc(1,"app-leaves-tree",6),_.lc("addToSearchCriteria",(function(t){return _.Kc(e),_.pc().addToSearchCriteria(t)}))("showNodeDetail",(function(t){return _.Kc(e),_.pc().fetchUaFromNodeAndShowDetails(t,"LEAVE")})),_.cc(),_.cc()}if(2&e){const e=_.pc();_.Lb(1),_.vc("transactionId",e.transactionId)("nestedDataSourceLeaves",e.nestedDataSourceLeaves)("searchRequestResultFacets",e.requestResultFacets)("searchRequestTotalResults",e.searchRequestTotalResults)}}let Dt=(()=>{class e{constructor(e,t,i,c){this.translateService=e,this.archiveService=t,this.startupService=i,this.archiveSharedDataService=c,this.searchHasMatches=!1,this.showArchiveUnitDetails=new _.p,this.switchView=new _.p,this.subscriptions=new R.a,this.nestedTreeControlFull=new Ge.j(e=>e.children),this.nestedDataSourceFull=new h.d,this.nestedDataSourceLeaves=new h.d,this.attachmentNodes=[],this.loadingHolding=!0,this.fullNodes=[],this.showEveryNodes=!0,this.loadingArchiveUnit={TREE:!1,LEAVE:!1},this.filingPlanLoaded=!1,this.attachmentUnitsLoaded=!1,this.tenantIdentifier=this.startupService.getTenantIdentifier()}ngOnInit(){this.nestedDataSourceLeaves.data=[],this.subscribeOnTotalResultsChange(),this.subscribeOnNodeSelectionToSetCheck(),this.subscribeOnFacetsChanges(),this.loadFilingHoldingSchemeTree(),this.loadAttachementUnits()}ngOnChanges(e){}ngOnDestroy(){this.subscriptions.unsubscribe()}subscribeOnNodeSelectionToSetCheck(){this.subscriptions.add(this.archiveSharedDataService.getNodesTarget().subscribe(e=>{null==e?this.switchViewAllNodes():(C.H.foundNodeAndSetCheck(this.nestedDataSourceFull.data,!1,e),C.H.foundNodeAndSetCheck(this.nestedDataSourceLeaves.data,!1,e))}))}subscribeOnFacetsChanges(){this.subscriptions.add(this.archiveSharedDataService.getFacets().subscribe(e=>{this.requestResultFacets=e,this.filingPlanLoaded&&this.attachmentUnitsLoaded&&(this.nestedDataSourceLeaves.data=[...this.attachmentNodes],this.searchRequestTotalResults>0&&Object(A.b)(this.attachmentNodes)&&C.H.addOrphansNodeFromTree(this.nestedDataSourceLeaves.data,this.translateService.instant("ARCHIVE_SEARCH.FILING_SCHEMA.ORPHANS_NODE"),this.searchRequestTotalResults))}))}addToSearchCriteria(e){this.nodeData={id:e.id,title:e.title,checked:e.checked,count:e.count},C.H.foundNodeAndSetCheck(this.nestedDataSourceFull.data,e.checked,e.id),C.H.foundNodeAndSetCheck(this.nestedDataSourceLeaves.data,e.checked,e.id),this.archiveSharedDataService.emitNode(this.nodeData)}loadAttachementUnits(){const e={criteria:"Title",sorting:C.z.ASCENDANT},t={criteriaList:Array.of({criteria:"#management.UpdateOperation.SystemId",values:[{id:"true",value:"true"}],category:C.Z.FIELDS,operator:C.v.EXISTS,dataType:C.u.STRING}),pageNumber:0,size:100,sortingCriteria:e,trackTotalHits:!1,computeFacets:!1};this.archiveService.searchArchiveUnitsByCriteria(t,this.transactionId).subscribe(e=>{this.attachmentUnits=e.results,this.attachmentUnitsLoaded=!0,this.setAttachmentNodes()})}setAttachmentNodes(){if(!Object(A.b)(this.fullNodes)&&!Object(A.b)(this.attachmentUnits)){this.attachmentNodes=[];for(const e of this.attachmentUnits){const t=C.H.foundNode(this.fullNodes,e["#management"].UpdateOperation.SystemId),i=C.H.convertUnitToNode(e);i.vitamId=t.id,i.title=t.title,i.unitType=t.unitType,i.hasObject=t.hasObject,this.attachmentNodes.push(i)}}}loadFilingHoldingSchemeTree(){this.loadingHolding=!0,this.archiveService.loadFilingHoldingSchemeTree(this.tenantIdentifier).subscribe(e=>{this.disableNodesRecursive(e),this.fullNodes=e,this.filingPlanLoaded=!0,this.nestedDataSourceFull.data=e,this.nestedTreeControlFull.dataNodes=e,this.archiveSharedDataService.emitFilingHoldingNodes(e),this.switchViewAllNodes(),this.setAttachmentNodes(),this.loadingHolding=!1})}disableNodesRecursive(e){e.forEach(e=>{e.disabled=!0,e.children&&this.disableNodesRecursive(e.children)})}switchViewAllNodes(){this.showEveryNodes=!this.showEveryNodes}emitClose(){this.archiveSharedDataService.emitToggle(!1)}fetchUaFromNodeAndShowDetails(e,t){this.loadingArchiveUnit[t]=!0,this.subscriptions.add(Boolean(e.value)?this.archiveService.getCollectUnitDetails(e.key.toString()).subscribe(e=>{this.showArchiveUnitDetails.emit(e),this.loadingArchiveUnit[""+t]=!1}):this.archiveService.getReferentialUnitDetails(e.key.toString()).subscribe(e=>{this.showArchiveUnitDetails.emit(e.$results[0]),this.loadingArchiveUnit[""+t]=!1}))}subscribeOnTotalResultsChange(){this.subscriptions.add(this.archiveSharedDataService.getTotalResults().subscribe(e=>{this.searchRequestTotalResults=e,1===this.nestedDataSourceLeaves.data.length&&this.nestedDataSourceLeaves.data[0].count+1!==e&&(this.nestedDataSourceLeaves.data[0].count=e)}))}}return e.\u0275fac=function(t){return new(t||e)(_.Xb(O.e),_.Xb($),_.Xb(C.db),_.Xb(de))},e.\u0275cmp=_.Rb({type:e,selectors:[["app-filing-holding-scheme"]],inputs:{transactionId:"transactionId",searchHasMatches:"searchHasMatches",searchRequestTotalResults:"searchRequestTotalResults"},outputs:{showArchiveUnitDetails:"showArchiveUnitDetails",switchView:"switchView"},features:[_.Jb],decls:4,vars:8,consts:[[1,"vitamui-sidepanel-header"],[3,"hasMatchesInSearch","loadingHolding","nestedDataSourceFull","nestedTreeControlFull","showEveryNodes","loadingNodeUnit","closePanel","showNodeDetail","switchView"],["vitamuiVerticalResizeSidebar","top",4,"ngIf"],["class","vitamui-sidepanel-header flex-column",4,"ngIf"],["vitamuiVerticalResizeSidebar","top"],[1,"vitamui-sidepanel-header","flex-column"],[3,"transactionId","nestedDataSourceLeaves","searchRequestResultFacets","searchRequestTotalResults","addToSearchCriteria","showNodeDetail"]],template:function(e,t){1&e&&(_.dc(0,"div",0),_.dc(1,"app-classification-tree",1),_.lc("closePanel",(function(){return t.emitClose()}))("showNodeDetail",(function(e){return t.fetchUaFromNodeAndShowDetails(e,"TREE")}))("switchView",(function(){return t.switchViewAllNodes()})),_.cc(),_.cc(),_.Tc(2,Nt,1,0,"div",2),_.Tc(3,Ft,2,4,"div",3)),2&e&&(_.Lb(1),_.vc("hasMatchesInSearch",!0)("loadingHolding",t.loadingHolding)("nestedDataSourceFull",t.nestedDataSourceFull)("nestedTreeControlFull",t.nestedTreeControlFull)("showEveryNodes",!0)("loadingNodeUnit",t.loadingArchiveUnit.TREE),_.Lb(1),_.vc("ngIf",t.searchHasMatches),_.Lb(1),_.vc("ngIf",t.searchHasMatches))},directives:[it,c.p,C.Pb,Ot],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%;background:#fff;margin:0;padding:72px 0 0}[_nghost-%COMP%]   div[_ngcontent-%COMP%], [_nghost-%COMP%]   mat-nested-tree-node[_ngcontent-%COMP%], [_nghost-%COMP%]   mat-tree[_ngcontent-%COMP%], [_nghost-%COMP%]   mat-tree-node[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start;align-items:flex-start;width:100%}[_nghost-%COMP%]   .tree-text[_ngcontent-%COMP%]{flex:1;min-width:0}[_nghost-%COMP%]   .tree-text[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], [_nghost-%COMP%]   .tree-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}[_nghost-%COMP%]   .mat-tree-node[_ngcontent-%COMP%]{flex:1 1 auto;min-height:0}[_nghost-%COMP%]   mat-nested-tree-node[_ngcontent-%COMP%]   .childs[_ngcontent-%COMP%]{padding-left:27px}[_nghost-%COMP%]   .vitamui-sidepanel-resize-sidebar[_ngcontent-%COMP%]{border-top:4px solid #702382;height:0;padding:0;margin:0;cursor:ns-resize;flex:0 0 auto}[_nghost-%COMP%]   .vitamui-sidepanel-header[_ngcontent-%COMP%]{flex-grow:1;overflow:auto}[_nghost-%COMP%]   .tree-filing-scheme[_ngcontent-%COMP%]{flex:1;flex-direction:column;background-color:#fafafa}[_nghost-%COMP%]   .tree-filing-scheme[_ngcontent-%COMP%]   mat-nested-tree-node[_ngcontent-%COMP%], [_nghost-%COMP%]   .tree-filing-scheme[_ngcontent-%COMP%]   mat-tree-node[_ngcontent-%COMP%]{flex-direction:column}[_nghost-%COMP%]   .load-more-ua[_ngcontent-%COMP%]{cursor:pointer;color:#979797;text-decoration:underline}.filing-holding-scheme-tree-invisible[_ngcontent-%COMP%], .hide[_ngcontent-%COMP%]{display:none}.filing-holding-scheme-tree-node[_ngcontent-%COMP%]{position:relative;border-bottom:1px solid hsla(0,0%,59.2%,.3);color:var(--vitamui-secondary-dark-5);cursor:pointer}.filing-holding-scheme-tree-node[_ngcontent-%COMP%]:hover{background-color:#fafafa}.loader[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;top:0;left:0;right:0;bottom:0;background:hsla(0,0%,100%,.8)}.icon-greeny-blue[_ngcontent-%COMP%]{color:var(--vitamui-secondary)}.tree-show-link[_ngcontent-%COMP%]{cursor:pointer;color:#979797;text-decoration:underline}.badge[_ngcontent-%COMP%]{display:inline-block;padding:.25em 1.5em;font-size:100%;font-weight:700;line-height:1;position:absolute;top:14px;white-space:nowrap;vertical-align:baseline;border-radius:1.25rem;right:2px;width:54px;text-align:right}.badge-secondary[_ngcontent-%COMP%]{color:#2c76c9;background-color:#abcaed}.area-show-tree[_ngcontent-%COMP%]{padding-top:20px}.badge-parent[_ngcontent-%COMP%]{position:relative}"]}),e})();var Ut=i("D57K"),yt=i("TLy2"),Pt=i("xVbo");let xt=(()=>{class e extends C.o{constructor(e,t){super(e,t)}asyncPartialUpdateArchiveUnits(e,t,i){return this.http.patch(`${this.apiUrl}/archive-units/${e}`,t,{headers:i})}asyncPartialUpdateArchiveUnitByCommands(e,t,i){return this.http.patch(`${this.apiUrl}/archive-units/${e}/update/single`,t,{headers:i})}asyncPartialUpdateArchiveUnitsByCommands(e,t,i){return this.http.patch(`${this.apiUrl}/archive-units/${e}/update/multiple`,t,{headers:i})}}return e.\u0275fac=function(t){return new(t||e)(_.ic(S.c),_.ic(C.n))},e.\u0275prov=_.Tb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),kt=(()=>{class e{constructor(e){this.archiveUnitApiService=e}asyncPartialUpdateArchiveUnits(e,t,i){return this.archiveUnitApiService.asyncPartialUpdateArchiveUnits(e,t,i)}asyncPartialUpdateArchiveUnitByCommands(e,t,i){return this.archiveUnitApiService.asyncPartialUpdateArchiveUnitByCommands(e,t,i)}asyncPartialUpdateArchiveUnitsByCommands(e,t,i){return this.archiveUnitApiService.asyncPartialUpdateArchiveUnitsByCommands(e,t,i)}}return e.\u0275fac=function(t){return new(t||e)(_.ic(xt))},e.\u0275prov=_.Tb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const Mt=["savingOK"],Vt=["updateDialog"],wt=["cancelDialog"];function Ht(e,t){if(1&e&&_.Yb(0,"vitamui-common-archive-unit-viewer",5),2&e){const e=_.pc();_.vc("data",e.archiveUnit)}}const Gt=function(){return{sedaVersion:"2.2"}};function qt(e,t){if(1&e){const e=_.ec();_.dc(0,"div"),_.dc(1,"vitamui-common-editor-banner",6),_.qc(2,"translate"),_.dc(3,"button",7),_.lc("click",(function(){return _.Kc(e),_.pc().onSave()})),_.Vc(4),_.qc(5,"translate"),_.cc(),_.dc(6,"button",8),_.lc("click",(function(){return _.Kc(e),_.pc().onCancel()})),_.Vc(7),_.qc(8,"translate"),_.cc(),_.cc(),_.Yb(9,"vitamui-common-archive-unit-editor",5),_.cc()}if(2&e){const e=_.pc();_.Lb(1),_.vc("title",_.sc(2,5,"ARCHIVE_UNIT.EDITOR_BANNER.TITLE",_.zc(12,Gt))),_.Lb(2),_.vc("disabled",!e.isModified()),_.Lb(1),_.Xc(" ",_.rc(5,8,"COMMON.SAVE")," "),_.Lb(3),_.Xc(" ",_.rc(8,10,"COMMON.UNDO")," "),_.Lb(2),_.vc("data",e.archiveUnit)}}function Bt(e,t){if(1&e){const e=_.ec();_.dc(0,"div",9),_.dc(1,"span",10),_.Vc(2),_.qc(3,"translate"),_.cc(),_.dc(4,"button",11),_.lc("click",(function(){return _.Kc(e),_.pc().snackBarRef.dismiss()})),_.dc(5,"i",12),_.Vc(6,"clear"),_.cc(),_.cc(),_.cc()}2&e&&(_.Lb(2),_.Wc(_.rc(3,1,"ARCHIVE_UNIT.DIALOGS.SAVE.MESSAGES.SUCCESS")))}function Wt(e,t){if(1&e&&(_.dc(0,"mat-dialog-content"),_.dc(1,"div",13),_.Vc(2),_.qc(3,"translate"),_.cc(),_.dc(4,"div",14),_.Vc(5),_.qc(6,"translate"),_.cc(),_.cc(),_.Yb(7,"br"),_.dc(8,"mat-dialog-actions"),_.dc(9,"button",15),_.Vc(10),_.qc(11,"translate"),_.cc(),_.dc(12,"button",16),_.Vc(13),_.qc(14,"translate"),_.cc(),_.cc()),2&e){const e=_.pc();_.Lb(2),_.Xc(" ",_.rc(3,6,"ARCHIVE_UNIT.DIALOGS.SAVE.TITLE")," "),_.Lb(3),_.Xc(" ",_.rc(6,8,"ARCHIVE_UNIT.DIALOGS.SAVE.CONTENT")," "),_.Lb(4),_.vc("matDialogClose",!0)("disabled",!e.isModified()),_.Lb(1),_.Xc(" ",_.rc(11,10,"ARCHIVE_UNIT.DIALOGS.SAVE.BUTTONS.CONFIRM")," "),_.Lb(3),_.Wc(_.rc(14,12,"ARCHIVE_UNIT.DIALOGS.SAVE.BUTTONS.CANCEL"))}}function jt(e,t){if(1&e&&(_.dc(0,"mat-dialog-content"),_.dc(1,"div",13),_.Vc(2),_.qc(3,"translate"),_.cc(),_.dc(4,"div",14),_.Vc(5),_.qc(6,"translate"),_.cc(),_.cc(),_.Yb(7,"br"),_.dc(8,"mat-dialog-actions"),_.dc(9,"button",15),_.Vc(10),_.qc(11,"translate"),_.cc(),_.dc(12,"button",16),_.Vc(13),_.qc(14,"translate"),_.cc(),_.cc()),2&e){const e=_.pc();_.Lb(2),_.Xc(" ",_.rc(3,6,"ARCHIVE_UNIT.DIALOGS.CANCEL.TITLE")," "),_.Lb(3),_.Xc(" ",_.rc(6,8,"ARCHIVE_UNIT.DIALOGS.CANCEL.CONTENT")," "),_.Lb(4),_.vc("matDialogClose",!0)("disabled",!e.isModified()),_.Lb(1),_.Xc(" ",_.rc(11,10,"ARCHIVE_UNIT.DIALOGS.CANCEL.BUTTONS.CONFIRM")," "),_.Lb(3),_.Wc(_.rc(14,12,"ARCHIVE_UNIT.DIALOGS.CANCEL.BUTTONS.CANCEL"))}}let Yt=(()=>{class e{constructor(e,t,i,c){this.dialog=e,this.archiveUnitService=t,this.snackBar=i,this.spinnerOverlayService=c,this.editMode=!1,this.editModeChange=new _.p,this.subscriptions=new R.a,this.dialogConfig={panelClass:"vitamui-dialog"},this.snackBarConfig={panelClass:"vitamui-snack-bar",duration:1e4}}ngOnDestroy(){this.subscriptions.unsubscribe()}set editor(e){var t;if(e){this.archiveUnitEditor=e;const i=null===(t=this.archiveUnitEditor)||void 0===t?void 0:t.editObject$.subscribe(e=>{this.editObject=e});i&&this.subscriptions.add(i)}}isModified(){var e,t;return this.editMode&&!(null===(t=null===(e=this.editObject)||void 0===e?void 0:e.control)||void 0===t?void 0:t.pristine)}onCancel(){return Object(Ut.a)(this,void 0,void 0,(function*(){this.isModified()?yield this.dialog.open(this.cancelDialog,this.dialogConfig).afterClosed().pipe(Object(b.a)(e=>{if(e)return this.archiveUnitEditor.getJsonPatch();throw new Error(e)}),Object(T.a)(()=>this.spinnerOverlayService.open()),Object(yt.a)(e=>this.archiveUnitService.asyncPartialUpdateArchiveUnitByCommands(this.transactionId,e))).toPromise().then(()=>this.handleUpdateSuccess()).catch(()=>this.backToDisplayMode()):this.backToDisplayMode()}))}onSave(){this.subscriptions.add(this.dialog.open(this.updateDialog,this.dialogConfig).afterClosed().pipe(Object(Pt.a)(e=>!!e),Object(b.a)(()=>this.archiveUnitEditor.getJsonPatch()),Object(T.a)(()=>this.spinnerOverlayService.open()),Object(yt.a)(e=>this.archiveUnitService.asyncPartialUpdateArchiveUnitByCommands(this.transactionId,e))).subscribe(()=>this.handleUpdateSuccess(),()=>this.spinnerOverlayService.close()))}handleUpdateSuccess(){this.snackBarRef=this.snackBar.openFromTemplate(this.savingOK,this.snackBarConfig),this.patchUnit(this.archiveUnit,this.archiveUnitEditor.getJsonPatch().jsonPatch),this.backToDisplayMode()}patchUnit(e,t){t.forEach(t=>{const i=t.path;switch(t.op){case"add":case"replace":e[i]=t.value;break;case"remove":delete e[i]}})}backToDisplayMode(){this.spinnerOverlayService.close(),this.editMode=!1,this.editModeChange.emit(this.editMode)}}return e.\u0275fac=function(t){return new(t||e)(_.Xb(n.b),_.Xb(kt),_.Xb(f.b),_.Xb(z.e))},e.\u0275cmp=_.Rb({type:e,selectors:[["app-archive-unit-description-tab"]],viewQuery:function(e,t){var i;1&e&&(_.bd(Mt,!0),_.bd(Vt,!0),_.bd(wt,!0),_.bd(C.j,!0)),2&e&&(_.Fc(i=_.mc())&&(t.savingOK=i.first),_.Fc(i=_.mc())&&(t.updateDialog=i.first),_.Fc(i=_.mc())&&(t.cancelDialog=i.first),_.Fc(i=_.mc())&&(t.editor=i.first))},inputs:{archiveUnit:"archiveUnit",editMode:"editMode",transactionId:"transactionId"},outputs:{editModeChange:"editModeChange"},decls:8,vars:2,consts:[[3,"data",4,"ngIf"],[4,"ngIf"],["savingOK",""],["updateDialog",""],["cancelDialog",""],[3,"data"],[1,"editor-banner",3,"title"],[1,"btn","primary","save",3,"disabled","click"],[1,"btn","primary","cancel",3,"click"],[1,"vitamui-snack-bar-container"],[1,"vitamui-snack-bar-content"],[1,"close-btn",3,"click"],[1,"material-icons"],[1,"text-title"],[1,"text","large","bold"],[1,"btn","primary","btn-confirm-dialog","margin-btn",3,"matDialogClose","disabled"],["matDialogClose","",1,"btn","link","cancel","cancel-popup"]],template:function(e,t){1&e&&(_.Tc(0,Ht,1,1,"vitamui-common-archive-unit-viewer",0),_.Tc(1,qt,10,13,"div",1),_.Tc(2,Bt,7,3,"ng-template",null,2,_.Uc),_.Tc(4,Wt,15,14,"ng-template",null,3,_.Uc),_.Tc(6,jt,15,14,"ng-template",null,4,_.Uc)),2&e&&(_.vc("ngIf",!t.editMode),_.Lb(1),_.vc("ngIf",t.editMode))},directives:[c.p,C.Hb,C.D,C.j,n.f,n.c,n.d],pipes:[O.d],styles:["button.save[_ngcontent-%COMP%]{background-color:#fff;color:var(--vitamui-primary)}button.cancel[_ngcontent-%COMP%]{background-color:transparent;color:#fff;box-shadow:none;border:none}.editor-banner[_ngcontent-%COMP%]{margin-left:-40px;margin-right:-40px;position:sticky;z-index:10;top:-20px}.margin-btn[_ngcontent-%COMP%]{margin-right:1rem}"]}),e})();function Xt(e,t){if(1&e&&(_.dc(0,"span"),_.Vc(1),_.qc(2,"async"),_.cc()),2&e){const e=_.pc();var i;_.Lb(1),_.Wc(null==(i=_.rc(2,1,e.uaPath$))?null:i.resumePath)}}function Kt(e,t){if(1&e&&(_.dc(0,"span"),_.Vc(1),_.qc(2,"async"),_.cc()),2&e){const e=_.pc();var i;_.Lb(1),_.Wc(null==(i=_.rc(2,1,e.uaPath$))?null:i.fullPath)}}let zt=(()=>{class e{constructor(e){this.archiveService=e,this.showNormalPanel=new _.p,this.fullPath=!1}ngOnInit(){}ngOnChanges(e){this.fullPath=!1}onDownloadObjectFromUnit(e){return this.archiveService.downloadObjectFromUnit(e["#id"],this.archiveUnit["#object"])}showArchiveUniteFullPath(){this.fullPath=!0}}return e.\u0275fac=function(t){return new(t||e)(_.Xb($))},e.\u0275cmp=_.Rb({type:e,selectors:[["app-archive-unit-information-tab"]],inputs:{archiveUnit:"archiveUnit"},outputs:{showNormalPanel:"showNormalPanel"},features:[_.Jb],decls:99,vars:65,consts:[[1,"row"],[1,"col-12"],[1,"read-only-field"],[1,"read-only-field","text-justify"],[1,"col-6"],["type","button",1,"ml-2","btn-show-full-path",3,"click"],[4,"ngIf"],[1,"row","content","vitamui-form","margin_right"],[1,"btn","primary","download-btn",3,"disabled","click"],[1,"vitamui-icon","vitamui-icon-deposit"]],template:function(e,t){1&e&&(_.dc(0,"div",0),_.dc(1,"div",1),_.dc(2,"div",2),_.dc(3,"label"),_.Vc(4),_.qc(5,"translate"),_.cc(),_.dc(6,"div"),_.Vc(7),_.qc(8,"unitI18n"),_.cc(),_.cc(),_.cc(),_.cc(),_.dc(9,"div",0),_.dc(10,"div",1),_.dc(11,"div",2),_.dc(12,"label"),_.Vc(13),_.qc(14,"translate"),_.cc(),_.dc(15,"div"),_.Vc(16),_.cc(),_.cc(),_.cc(),_.cc(),_.dc(17,"div",0),_.dc(18,"div",1),_.dc(19,"div",2),_.dc(20,"label"),_.Vc(21),_.qc(22,"translate"),_.cc(),_.dc(23,"div"),_.Vc(24),_.cc(),_.cc(),_.cc(),_.cc(),_.dc(25,"div",0),_.dc(26,"div",1),_.dc(27,"div",3),_.dc(28,"label"),_.Vc(29),_.qc(30,"translate"),_.cc(),_.dc(31,"div"),_.Vc(32),_.qc(33,"unitI18n"),_.cc(),_.cc(),_.cc(),_.cc(),_.dc(34,"div",0),_.dc(35,"div",4),_.dc(36,"div",2),_.dc(37,"label"),_.Vc(38),_.qc(39,"translate"),_.cc(),_.Yb(40,"br"),_.dc(41,"label"),_.Vc(42),_.qc(43,"translate"),_.cc(),_.dc(44,"div"),_.Vc(45),_.cc(),_.cc(),_.cc(),_.dc(46,"div",4),_.dc(47,"div",2),_.Yb(48,"label"),_.Yb(49,"br"),_.dc(50,"label"),_.Vc(51),_.qc(52,"translate"),_.cc(),_.dc(53,"div"),_.Vc(54),_.cc(),_.cc(),_.cc(),_.cc(),_.dc(55,"div",0),_.dc(56,"div",4),_.dc(57,"div",2),_.dc(58,"label"),_.Vc(59),_.qc(60,"translate"),_.dc(61,"button",5),_.lc("click",(function(){return t.showArchiveUniteFullPath()})),_.Vc(62),_.qc(63,"translate"),_.cc(),_.cc(),_.dc(64,"div"),_.Tc(65,Xt,3,3,"span",6),_.Tc(66,Kt,3,3,"span",6),_.cc(),_.cc(),_.cc(),_.dc(67,"div",4),_.dc(68,"div",2),_.dc(69,"label"),_.Vc(70),_.qc(71,"translate"),_.cc(),_.dc(72,"div"),_.Vc(73),_.qc(74,"translate"),_.cc(),_.cc(),_.cc(),_.cc(),_.dc(75,"div",7),_.dc(76,"div",4),_.dc(77,"div",2),_.dc(78,"label"),_.Vc(79),_.qc(80,"translate"),_.cc(),_.dc(81,"div"),_.Vc(82),_.qc(83,"dateTime"),_.cc(),_.cc(),_.cc(),_.dc(84,"div",4),_.dc(85,"div",2),_.dc(86,"label"),_.Vc(87),_.qc(88,"translate"),_.cc(),_.dc(89,"div"),_.Vc(90),_.qc(91,"dateTime"),_.cc(),_.cc(),_.cc(),_.cc(),_.dc(92,"div",0),_.dc(93,"div",1),_.dc(94,"button",8),_.lc("click",(function(){return t.onDownloadObjectFromUnit(t.archiveUnit)})),_.dc(95,"span"),_.Vc(96),_.qc(97,"translate"),_.cc(),_.Yb(98,"i",9),_.cc(),_.cc(),_.cc()),2&e&&(_.Lb(4),_.Xc("",_.rc(5,25,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.NAME")," :"),_.Lb(3),_.Xc(" ",_.sc(8,27,t.archiveUnit,"Title")," "),_.Lb(6),_.Xc("",_.rc(14,30,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.GUID")," :"),_.Lb(3),_.Xc(" ",t.archiveUnit["#opi"]," "),_.Lb(5),_.Xc("",_.rc(22,32,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.UAID")," :"),_.Lb(3),_.Xc(" ",t.archiveUnit["#id"]," "),_.Lb(5),_.Xc("",_.rc(30,34,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.DESCRIPTION")," :"),_.Lb(3),_.Xc(" ",_.sc(33,36,t.archiveUnit,"Description")," "),_.Lb(6),_.Xc("",_.rc(39,39,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.SP")," :"),_.Lb(4),_.Xc("",_.rc(43,41,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.SP_CODE")," :"),_.Lb(3),_.Xc(" ",t.archiveUnit["#originating_agency"]," "),_.Lb(6),_.Xc("",_.rc(52,43,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.SP_LABEL")," :"),_.Lb(3),_.Xc(" ",null==t.archiveUnit?null:t.archiveUnit.originating_agencyName," "),_.Lb(5),_.Xc("",_.rc(60,45,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.PATH")," : "),_.Lb(3),_.Xc(" ",_.rc(63,47,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.BTN_SHOW_COMPLETE_PATH")," "),_.Lb(3),_.vc("ngIf",!t.fullPath),_.Lb(1),_.vc("ngIf",t.fullPath),_.Lb(4),_.Xc("",_.rc(71,49,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.DESCRIPTION_LEVEL")," :"),_.Lb(3),_.Xc(" ",_.rc(74,51,"UNIT_UPDATE."+t.archiveUnit.DescriptionLevel.toUpperCase())," "),_.Lb(6),_.Xc("",_.rc(80,53,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.START_DATE")," :"),_.Lb(3),_.Xc(" ",_.sc(83,55,null==t.archiveUnit?null:t.archiveUnit.StartDate,"dd/MM/yyyy")," "),_.Lb(5),_.Xc("",_.rc(88,58,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.END_DATE")," :"),_.Lb(3),_.Xc(" ",_.sc(91,60,null==t.archiveUnit?null:t.archiveUnit.EndDate,"dd/MM/yyyy")," "),_.Lb(4),_.vc("disabled",null==t.archiveUnit["#object"]),_.Lb(2),_.Wc(_.rc(97,63,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.DOWNLOAD_DOC")))},directives:[c.p],pipes:[O.d,C.jb,C.Vb,c.b],styles:[".download-btn[_ngcontent-%COMP%]{border-radius:100px;color:#fff;font-size:14px;font-weight:700;margin:20px 20px 20px 120px}.btn-show-full-path[_ngcontent-%COMP%]{border:1px solid var(--vitamui-grey);border-radius:10px;font-size:10px}.btn-show-full-path[_ngcontent-%COMP%]:hover{background-color:var(--vitamui-grey-400);cursor:pointer}.padding-style[_ngcontent-%COMP%]{padding-top:20px}.text-title[_ngcontent-%COMP%]{font-family:Mulish;font-style:normal;font-weight:400;font-size:16px;line-height:24px;display:flex;align-items:center;color:#757575}.cancel-popup[_ngcontent-%COMP%]{padding-left:40px}.margin_right[_ngcontent-%COMP%]{margin-right:0}.btn-size[_ngcontent-%COMP%]{background-color:#e24242;position:absolute;right:16px;bottom:16px;width:30px;height:30px;border:none}.close-color[_ngcontent-%COMP%]{color:#fff}"]}),e})();var $t=i("f7+R");function Zt(e,t){if(1&e&&(_.dc(0,"div",10),_.Vc(1),_.qc(2,"dateTime"),_.cc()),2&e){const e=_.pc();_.Lb(1),_.Wc(_.sc(2,1,e.getMaxEndDate(e.unitRuleDTO),"dd/MM/yyyy"))}}function Qt(e,t){if(1&e&&(_.dc(0,"div",10),_.Vc(1),_.cc()),2&e){const e=_.pc();_.Lb(1),_.Wc(e.getFinalActionValue(e.propertiesList))}}function Jt(e,t){1&e&&_.Yb(0,"div",11)}function ei(e,t){if(1&e){const e=_.ec();_.dc(0,"div",12),_.dc(1,"i",2),_.lc("click",(function(){return _.Kc(e),_.pc().showListOfPropertiesBloc()})),_.Vc(2),_.cc(),_.Vc(3),_.qc(4,"translate"),_.cc()}if(2&e){const e=_.pc();_.Lb(1),_.Qc("font-size",20,"px"),_.Lb(1),_.Xc(" ",e.listOfPropertiesCollapsed?"expand_less":"expand_more"," "),_.Lb(1),_.Xc(" ",_.rc(4,4,"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.PROPERTIES"),"\n")}}function ti(e,t){1&e&&(_.dc(0,"div",12),_.dc(1,"div",15),_.Vc(2),_.qc(3,"translate"),_.cc(),_.dc(4,"div",15),_.Vc(5),_.qc(6,"translate"),_.cc(),_.dc(7,"div",15),_.Vc(8),_.qc(9,"translate"),_.cc(),_.cc()),2&e&&(_.Lb(2),_.Wc(_.rc(3,3,"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.FINAL_ACTION.PROPERTY")),_.Lb(3),_.Wc(_.rc(6,5,"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.FINAL_ACTION.VALUE")),_.Lb(3),_.Wc(_.rc(9,7,"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.FINAL_ACTION.STATUS")))}function ii(e,t){if(1&e&&(_.dc(0,"div",18),_.dc(1,"div",19),_.dc(2,"div",20),_.Vc(3),_.cc(),_.dc(4,"div",20),_.Vc(5),_.cc(),_.dc(6,"div",20),_.Vc(7),_.cc(),_.cc(),_.cc()),2&e){const e=t.$implicit,i=_.pc(3);_.Lb(3),_.Wc(i.getPropertyName(e.PropertyName)),_.Lb(2),_.Wc(i.getPropertyValue(e.PropertyValue)),_.Lb(2),_.Wc(i.getFinalActionStatus(e))}}function ci(e,t){if(1&e&&(_.dc(0,"div",16),_.Tc(1,ii,8,3,"div",17),_.cc()),2&e){const e=_.pc(2);_.Lb(1),_.vc("ngForOf",e.propertiesList)}}function ai(e,t){if(1&e&&(_.dc(0,"div",13),_.Tc(1,ti,10,9,"div",6),_.Tc(2,ci,2,1,"div",14),_.cc()),2&e){const e=_.pc();_.vc("@collapse",e.listOfPropertiesCollapsed),_.Lb(1),_.vc("ngIf",e.categoryHasPropertiesList),_.Lb(1),_.vc("ngIf",e.categoryHasPropertiesList)}}function ri(e,t){if(1&e){const e=_.ec();_.dc(0,"div",12),_.dc(1,"i",2),_.lc("click",(function(){return _.Kc(e),_.pc().showListOfPropertiesBloc()})),_.Vc(2),_.cc(),_.Vc(3),_.qc(4,"translate"),_.cc()}if(2&e){const e=_.pc();_.Lb(1),_.Qc("font-size",20,"px"),_.Lb(1),_.Xc(" ",e.listOfPropertiesCollapsed?"expand_less":"expand_more"," "),_.Lb(1),_.Xc(" ",_.rc(4,4,"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.PROPERTIES"),"\n")}}function ni(e,t){1&e&&(_.dc(0,"div",12),_.dc(1,"div",21),_.Vc(2),_.qc(3,"translate"),_.cc(),_.dc(4,"div",15),_.Vc(5),_.qc(6,"translate"),_.cc(),_.dc(7,"div",22),_.Vc(8),_.qc(9,"translate"),_.cc(),_.cc()),2&e&&(_.Lb(2),_.Wc(_.rc(3,3,"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.FINAL_ACTION.PROPERTY")),_.Lb(3),_.Wc(_.rc(6,5,"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.FINAL_ACTION.VALUE")),_.Lb(3),_.Wc(_.rc(9,7,"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.FINAL_ACTION.STATUS")))}function si(e,t){if(1&e&&(_.dc(0,"div",18),_.dc(1,"div",19),_.dc(2,"div",24),_.Vc(3),_.cc(),_.dc(4,"div",20),_.Vc(5),_.cc(),_.dc(6,"div",25),_.Vc(7),_.cc(),_.cc(),_.dc(8,"div",19),_.dc(9,"div",24),_.Vc(10),_.cc(),_.dc(11,"div",20),_.Vc(12),_.cc(),_.dc(13,"div",25),_.Vc(14),_.cc(),_.cc(),_.dc(15,"div",19),_.dc(16,"div",24),_.Vc(17),_.cc(),_.dc(18,"div",20),_.Vc(19),_.qc(20,"yesNo"),_.cc(),_.dc(21,"div",25),_.Vc(22),_.cc(),_.cc(),_.dc(23,"div",19),_.dc(24,"div",24),_.Vc(25),_.cc(),_.dc(26,"div",20),_.Vc(27),_.cc(),_.dc(28,"div",25),_.Vc(29),_.cc(),_.cc(),_.dc(30,"div",19),_.dc(31,"div",24),_.Vc(32),_.cc(),_.dc(33,"div",20),_.Vc(34),_.cc(),_.dc(35,"div",25),_.Vc(36),_.cc(),_.cc(),_.cc()),2&e){const e=_.pc(3);_.Lb(3),_.Wc(e.getHoldAndClassificationRulePropertyName("HoldReason")),_.Lb(2),_.Wc(null==e.holdRuleDetails?null:e.holdRuleDetails.HoldReason),_.Lb(2),_.Wc(e.holdRuleStatus),_.Lb(3),_.Wc(e.getHoldAndClassificationRulePropertyName("HoldOwner")),_.Lb(2),_.Wc(null==e.holdRuleDetails?null:e.holdRuleDetails.HoldOwner),_.Lb(2),_.Wc(e.holdRuleStatus),_.Lb(3),_.Wc(e.getHoldAndClassificationRulePropertyName("PreventRearrangement")),_.Lb(2),_.Wc(_.rc(20,15,null==e.holdRuleDetails?null:e.holdRuleDetails.PreventRearrangement)),_.Lb(3),_.Wc(e.holdRuleStatus),_.Lb(3),_.Wc(e.getHoldAndClassificationRulePropertyName("HoldReassessingDate")),_.Lb(2),_.Wc(null==e.holdRuleDetails?null:e.holdRuleDetails.HoldReassessingDate),_.Lb(2),_.Wc(e.holdRuleStatus),_.Lb(3),_.Wc(e.getHoldAndClassificationRulePropertyName("HoldEndDate")),_.Lb(2),_.Wc(null==e.holdRuleDetails?null:e.holdRuleDetails.HoldEndDate),_.Lb(2),_.Wc(e.holdRuleStatus)}}function li(e,t){if(1&e&&(_.dc(0,"div",16),_.Tc(1,si,37,17,"div",23),_.cc()),2&e){const e=_.pc(2);_.Lb(1),_.vc("ngIf",e.isShowHoldRuleDetails)}}function oi(e,t){if(1&e&&(_.dc(0,"div",13),_.Tc(1,ni,10,9,"div",6),_.Tc(2,li,2,1,"div",14),_.cc()),2&e){const e=_.pc();_.vc("@collapse",e.listOfPropertiesCollapsed),_.Lb(1),_.vc("ngIf",e.categoryHasPropertiesList),_.Lb(1),_.vc("ngIf",e.categoryHasPropertiesList)}}function di(e,t){if(1&e){const e=_.ec();_.dc(0,"div",12),_.dc(1,"i",2),_.lc("click",(function(){return _.Kc(e),_.pc().showListOfPropertiesBloc()})),_.Vc(2),_.cc(),_.Vc(3),_.qc(4,"translate"),_.cc()}if(2&e){const e=_.pc();_.Lb(1),_.Qc("font-size",20,"px"),_.Lb(1),_.Xc(" ",e.listOfPropertiesCollapsed?"expand_less":"expand_more"," "),_.Lb(1),_.Xc(" ",_.rc(4,4,"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.PROPERTIES"),"\n")}}function ui(e,t){1&e&&(_.dc(0,"div",12),_.dc(1,"div",15),_.Vc(2),_.qc(3,"translate"),_.cc(),_.dc(4,"div",15),_.Vc(5),_.qc(6,"translate"),_.cc(),_.dc(7,"div",15),_.Vc(8),_.qc(9,"translate"),_.cc(),_.cc()),2&e&&(_.Lb(2),_.Wc(_.rc(3,3,"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.FINAL_ACTION.PROPERTY")),_.Lb(3),_.Wc(_.rc(6,5,"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.FINAL_ACTION.VALUE")),_.Lb(3),_.Wc(_.rc(9,7,"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.FINAL_ACTION.STATUS")))}function hi(e,t){if(1&e&&(_.dc(0,"div",18),_.dc(1,"div",19),_.dc(2,"div",20),_.Vc(3),_.cc(),_.dc(4,"div",20),_.Vc(5),_.qc(6,"yesNo"),_.cc(),_.dc(7,"div",20),_.Vc(8),_.cc(),_.cc(),_.cc()),2&e){const e=t.$implicit,i=_.pc(3);_.Lb(3),_.Wc(i.getHoldAndClassificationRulePropertyName(e.PropertyName)),_.Lb(2),_.Wc(_.rc(6,3,e.PropertyValue)),_.Lb(3),_.Wc(i.getClassificationRulePropertyStatus(e.PropertyName))}}function Ci(e,t){if(1&e&&(_.dc(0,"div",16),_.Tc(1,hi,9,5,"div",17),_.cc()),2&e){const e=_.pc(2);_.Lb(1),_.vc("ngForOf",e.propertiesList)}}function Ei(e,t){if(1&e&&(_.dc(0,"div",13),_.Tc(1,ui,10,9,"div",6),_.Tc(2,Ci,2,1,"div",14),_.cc()),2&e){const e=_.pc();_.vc("@collapse",e.listOfPropertiesCollapsed),_.Lb(1),_.vc("ngIf",e.categoryHasPropertiesList),_.Lb(1),_.vc("ngIf",e.categoryHasPropertiesList)}}function Ri(e,t){1&e&&(_.dc(0,"div",12),_.dc(1,"div",15),_.Vc(2),_.qc(3,"translate"),_.cc(),_.dc(4,"div",26),_.Vc(5),_.qc(6,"translate"),_.cc(),_.dc(7,"div",26),_.Vc(8),_.qc(9,"translate"),_.cc(),_.dc(10,"div",22),_.Vc(11),_.qc(12,"translate"),_.cc(),_.cc()),2&e&&(_.Lb(2),_.Wc(_.rc(3,4,"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.RULE.IDENTIFIER")),_.Lb(3),_.Wc(_.rc(6,6,"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.RULE.START_DATE")),_.Lb(3),_.Wc(_.rc(9,8,"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.RULE.END_DATE")),_.Lb(3),_.Wc(_.rc(12,10,"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.RULE.STATUS")))}function pi(e,t){if(1&e){const e=_.ec();_.dc(0,"div",18),_.dc(1,"div",27),_.lc("click",(function(){_.Kc(e);const i=t.$implicit;return _.pc(3).getHoldRuleInformations(i)})),_.dc(2,"div",20),_.Vc(3),_.cc(),_.dc(4,"div",28),_.Vc(5),_.qc(6,"dateTime"),_.cc(),_.dc(7,"div",28),_.Vc(8),_.qc(9,"dateTime"),_.cc(),_.dc(10,"div",25),_.Vc(11),_.cc(),_.cc(),_.cc()}if(2&e){const e=t.$implicit,i=_.pc(3);_.Lb(1),_.vc("ngClass","HoldRule"===i.ruleCategory?"enabled-div clickable":"disabled-div"),_.Lb(2),_.Wc(e.Rule),_.Lb(2),_.Wc(_.sc(6,5,e.StartDate,"dd/MM/yyyy")),_.Lb(3),_.Wc(_.sc(9,8,e.EndDate,"dd/MM/yyyy")),_.Lb(3),_.Wc(i.getRuleStatus(e))}}function vi(e,t){if(1&e&&(_.dc(0,"div",16),_.Tc(1,pi,12,11,"div",17),_.cc()),2&e){const e=_.pc(2);_.Lb(1),_.vc("ngForOf",e.unitRuleDTO)}}function Ii(e,t){if(1&e&&(_.Tc(0,Ri,13,12,"div",6),_.Tc(1,vi,2,1,"div",14)),2&e){const e=_.pc();_.vc("ngIf",e.isToShowRulesList||e.isToShowBlockedRulesList),_.Lb(1),_.vc("ngIf",e.isToShowRulesList)}}function Ti(e,t){1&e&&(_.dc(0,"div",0),_.Vc(1),_.qc(2,"translate"),_.cc()),2&e&&(_.Lb(1),_.Wc(_.rc(2,1,"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.INHERITANCE_BLOCKED")))}let gi=(()=>{class e{constructor(e,t){this.translateService=e,this.logger=t,this.isShowHoldRuleDetails=!1,this.listOfPropertiesCollapsed=!0,this.listOfRulesCollapsed=!1,this.isPreventInheritance=!1}ngOnChanges(e){this.initializeParameters(),e.archiveUnitRules&&(this.getInheritedRulesDetails(e.archiveUnitRules.currentValue),this.showListOfPropertiesBloc())}getRuleCategoryName(e){if(e)return this.translateService.instant("COLLECT.ARCHIVE_UNIT_RULES_DETAILS.CATEGORY_NAME."+e.toUpperCase())}ngOnInit(){}getRuleStatus(e){return e&&e.status&&"BLOCKED"===e.status?this.translateService.instant("COLLECT.ARCHIVE_UNIT_RULES_DETAILS.RULE_STATUS.BLOCKED"):e&&e.Paths?this.translateService.instant(e.Paths[0].length>1?"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.RULE_STATUS.INHERITED":"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.RULE_STATUS.CARRIED"):void 0}getMaxEndDate(e){var t;if(e){const i=e.filter(e=>null!=e.EndDate).sort((e,t)=>new Date(e.EndDate)<new Date(t.EndDate)?1:-1);return i?null===(t=i[0])||void 0===t?void 0:t.EndDate:null}}getFinalActionValue(e){if(e)return 0===e.filter(e=>"FinalAction"===e.PropertyName).length?null:e.filter(e=>"FinalAction"===e.PropertyName).length>1?this.translateService.instant("COLLECT.ARCHIVE_UNIT_RULES_DETAILS.RULES_FINAL_ACTION.CONFLICT"):this.translateService.instant("COLLECT.ARCHIVE_UNIT_RULES_DETAILS.RULES_FINAL_ACTION."+String(e.find(e=>"FinalAction"===e.PropertyName).PropertyValue).toUpperCase())}getPropertyName(e){if(e&&"FinalAction"===e)return this.translateService.instant("COLLECT.ARCHIVE_UNIT_RULES_DETAILS.FINAL_ACTION_VALUE")}getPropertyValue(e){if(e)return this.translateService.instant("COLLECT.ARCHIVE_UNIT_RULES_DETAILS.RULES_FINAL_ACTION."+e.toUpperCase())}getFinalActionStatus(e){if(e&&e.Paths){const t=[];return e.Paths.forEach(e=>{e.forEach(e=>{t.push(e)})}),this.translateService.instant(t.length>1?"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.RULES_FINAL_ACTION.INHERITED":"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.RULES_FINAL_ACTION.CARRIED")}}showlistOfRulesBloc(){this.listOfRulesCollapsed=!this.listOfRulesCollapsed}showListOfPropertiesBloc(){this.listOfPropertiesCollapsed=!this.listOfPropertiesCollapsed}getInheritedRulesDetails(e){if(e&&e.InheritedRules)switch(this.ruleCategory){case"AppraisalRule":e.InheritedRules.AppraisalRule&&e.InheritedRules.AppraisalRule.Rules&&(this.unitRuleDTO=e.InheritedRules.AppraisalRule.Rules,this.isToShowRulesList=0!==e.InheritedRules.AppraisalRule.Rules.length),e.InheritedRules.AppraisalRule&&e.InheritedRules.AppraisalRule.Properties&&(this.propertiesList=e.InheritedRules.AppraisalRule.Properties,this.isToShowPropertiesList=!0,this.categoryHasPropertiesList=0!==e.InheritedRules.AppraisalRule.Properties.length);break;case"StorageRule":e.InheritedRules.StorageRule&&e.InheritedRules.StorageRule.Rules&&(this.unitRuleDTO=e.InheritedRules.StorageRule.Rules,this.isToShowRulesList=0!==e.InheritedRules.StorageRule.Rules.length),e.InheritedRules.StorageRule&&e.InheritedRules.StorageRule.Properties&&(this.propertiesList=e.InheritedRules.StorageRule.Properties,this.isToShowPropertiesList=!0,this.categoryHasPropertiesList=0!==e.InheritedRules.StorageRule.Properties.length);break;case"AccessRule":e.InheritedRules.AccessRule&&e.InheritedRules.AccessRule.Rules&&(this.unitRuleDTO=e.InheritedRules.AccessRule.Rules,this.isToShowRulesList=0!==e.InheritedRules.AccessRule.Rules.length),this.isToShowPropertiesList=!1;break;case"ReuseRule":e.InheritedRules.ReuseRule&&e.InheritedRules.ReuseRule.Rules&&(this.unitRuleDTO=e.InheritedRules.ReuseRule.Rules,this.isToShowRulesList=0!==e.InheritedRules.ReuseRule.Rules.length),this.isToShowPropertiesList=!1;break;case"DisseminationRule":e.InheritedRules.DisseminationRule&&e.InheritedRules.DisseminationRule.Rules&&(this.unitRuleDTO=e.InheritedRules.DisseminationRule.Rules,this.isToShowRulesList=0!==e.InheritedRules.DisseminationRule.Rules.length),this.isToShowPropertiesList=!1;break;case"HoldRule":e.InheritedRules.HoldRule&&e.InheritedRules.HoldRule.Rules&&(this.unitRuleDTO=e.InheritedRules.HoldRule.Rules,this.isToShowRulesList=0!==e.InheritedRules.HoldRule.Rules.length),this.categoryHasPropertiesList=!0,this.isToShowPropertiesList=!0;break;case"ClassificationRule":e.InheritedRules.ClassificationRule&&e.InheritedRules.ClassificationRule.Rules&&(this.unitRuleDTO=e.InheritedRules.ClassificationRule.Rules,this.isToShowRulesList=0!==e.InheritedRules.ClassificationRule.Rules.length),e.InheritedRules.ClassificationRule&&e.InheritedRules.ClassificationRule.Properties&&(this.propertiesList=e.InheritedRules.ClassificationRule.Properties,this.isToShowPropertiesList=!0,this.categoryHasPropertiesList=0!==e.InheritedRules.ClassificationRule.Properties.length);break;default:this.logger.warn("No Category with name ",this.ruleCategory,"found")}if(e&&e["#management"])switch(this.ruleCategory){case"AppraisalRule":if(e["#management"].AppraisalRule&&e["#management"].AppraisalRule.Inheritance&&(this.isPreventInheritance=e["#management"].AppraisalRule.Inheritance.PreventInheritance,e["#management"].AppraisalRule.Inheritance.PreventRulesId)){this.isToShowBlockedRulesList=0!==e["#management"].AppraisalRule.Inheritance.PreventRulesId.length;const t=e["#management"].AppraisalRule.Inheritance.PreventRulesId;t&&t.forEach(e=>{this.unitRuleDTO.push({Rule:e,status:"BLOCKED"})})}break;case"StorageRule":if(e["#management"].StorageRule&&e["#management"].StorageRule.Inheritance&&(this.isPreventInheritance=e["#management"].StorageRule.Inheritance.PreventInheritance,e["#management"].StorageRule.Inheritance.PreventRulesId)){const t=e["#management"].StorageRule.Inheritance.PreventRulesId;this.isToShowBlockedRulesList=0!==e["#management"].StorageRule.Inheritance.PreventRulesId.length,t&&t.forEach(e=>{this.unitRuleDTO.push({Rule:e,status:"BLOCKED"})})}break;case"AccessRule":if(e["#management"].AccessRule&&e["#management"].AccessRule.Inheritance&&(this.isPreventInheritance=e["#management"].AccessRule.Inheritance.PreventInheritance,e["#management"].AccessRule.Inheritance.PreventRulesId)){this.isToShowBlockedRulesList=0!==e["#management"].AccessRule.Inheritance.PreventRulesId.length;const t=e["#management"].AccessRule.Inheritance.PreventRulesId;t&&t.forEach(e=>{this.unitRuleDTO.push({Rule:e,status:"BLOCKED"})})}break;case"ReuseRule":if(e["#management"].ReuseRule&&e["#management"].ReuseRule.Inheritance&&(this.isPreventInheritance=e["#management"].ReuseRule.Inheritance.PreventInheritance,e["#management"].ReuseRule.Inheritance.PreventRulesId)){this.isToShowBlockedRulesList=0!==e["#management"].ReuseRule.Inheritance.PreventRulesId.length;const t=e["#management"].ReuseRule.Inheritance.PreventRulesId;t&&t.forEach(e=>{this.unitRuleDTO.push({Rule:e,status:"BLOCKED"})})}break;case"DisseminationRule":if(e["#management"].DisseminationRule&&e["#management"].DisseminationRule.Inheritance&&(this.isPreventInheritance=e["#management"].DisseminationRule.Inheritance.PreventInheritance,e["#management"].DisseminationRule.Inheritance.PreventRulesId)){this.isToShowBlockedRulesList=0!==e["#management"].DisseminationRule.Inheritance.PreventRulesId.length;const t=e["#management"].DisseminationRule.Inheritance.PreventRulesId;t&&t.forEach(e=>{this.unitRuleDTO.push({Rule:e,status:"BLOCKED"})})}break;case"HoldRule":if(e["#management"].HoldRule&&e["#management"].HoldRule.Inheritance&&(this.isPreventInheritance=e["#management"].HoldRule.Inheritance.PreventInheritance,e["#management"].HoldRule.Inheritance.PreventRulesId)){this.isToShowBlockedRulesList=0!==e["#management"].HoldRule.Inheritance.PreventRulesId.length;const t=e["#management"].HoldRule.Inheritance.PreventRulesId;t&&t.forEach(e=>{this.unitRuleDTO.push({Rule:e,status:"BLOCKED"})})}break;case"ClassificationRule":if(e["#management"].ClassificationRule&&e["#management"].ClassificationRule.Inheritance&&(this.isPreventInheritance=e["#management"].ClassificationRule.Inheritance.PreventInheritance,e["#management"].ClassificationRule.Inheritance.PreventRulesId)){this.isToShowBlockedRulesList=0!==e["#management"].ClassificationRule.Inheritance.PreventRulesId.length;const t=e["#management"].ClassificationRule.Inheritance.PreventRulesId;t&&t.forEach(e=>{this.unitRuleDTO.push({Rule:e,status:"BLOCKED"})})}}}getClassificationRulePropertyName(e){if(e)return this.translateService.instant("COLLECT.ARCHIVE_UNIT_RULES_DETAILS.CLASSIFICATION_RULE_PROPERTIES."+e.toUpperCase())}getHoldRulePropertyName(e){if(e)return this.translateService.instant("COLLECT.ARCHIVE_UNIT_RULES_DETAILS.HOLD_RULE_PROPERTIES."+e.toUpperCase())}getHoldAndClassificationRulePropertyName(e){switch(this.ruleCategory){case"ClassificationRule":if(e)return this.translateService.instant("COLLECT.ARCHIVE_UNIT_RULES_DETAILS.CLASSIFICATION_RULE_PROPERTIES."+e.toUpperCase());break;case"HoldRule":if(e)return this.translateService.instant("COLLECT.ARCHIVE_UNIT_RULES_DETAILS.HOLD_RULE_PROPERTIES."+e.toUpperCase());break;default:this.logger.warn("No property found")}}getClassificationRulePropertyStatus(e){if(this.archiveUnitRules["#management"]&&this.archiveUnitRules["#management"].ClassificationRule)switch(e){case"ClassificationAudience":return this.translateService.instant(this.archiveUnitRules["#management"].ClassificationRule.ClassificationAudience?"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.RULE_STATUS.CARRIED":"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.RULE_STATUS.INHERITED");case"ClassificationLevel":return this.translateService.instant(this.archiveUnitRules["#management"].ClassificationRule.ClassificationLevel?"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.RULE_STATUS.CARRIED":"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.RULE_STATUS.INHERITED");case"NeedReassessingAuthorization":return this.translateService.instant(this.archiveUnitRules["#management"].ClassificationRule.NeedReassessingAuthorization?"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.RULE_STATUS.CARRIED":"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.RULE_STATUS.INHERITED");case"ClassificationReassessingDate":return this.translateService.instant(this.archiveUnitRules["#management"].ClassificationRule.ClassificationReassessingDate?"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.RULE_STATUS.CARRIED":"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.RULE_STATUS.INHERITED");case"ClassificationOwner":return this.translateService.instant(this.archiveUnitRules["#management"].ClassificationRule.ClassificationOwner?"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.RULE_STATUS.CARRIED":"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.RULE_STATUS.INHERITED");default:this.logger.warn("No property found")}}getHoldRuleInformations(e){this.listOfPropertiesCollapsed=!1,this.archiveUnitRules&&this.archiveUnitRules.InheritedRules&&this.archiveUnitRules.InheritedRules.HoldRule&&(this.holdRuleDetails=this.archiveUnitRules.InheritedRules.HoldRule.Rules.find(t=>t.Rule===e.Rule),this.holdRuleStatus=this.getRuleStatus(e),this.isShowHoldRuleDetails=!(this.holdRuleDetails&&null===this.holdRuleDetails.PreventRearrangement&&null===this.holdRuleDetails.HoldReassessingDate&&null===this.holdRuleDetails.HoldReason&&null===this.holdRuleDetails.HoldOwner&&null===this.holdRuleDetails.HoldEndDate))}initializeParameters(){this.unitRuleDTO=null,this.propertiesList=null,this.isPreventInheritance=!1,this.holdRuleDetails=null,this.isShowHoldRuleDetails=!1,this.listOfPropertiesCollapsed=!1}}return e.\u0275fac=function(t){return new(t||e)(_.Xb(O.e),_.Xb(C.O))},e.\u0275cmp=_.Rb({type:e,selectors:[["app-archive-unit-rules-informations-tab"]],inputs:{archiveUnitRules:"archiveUnitRules",ruleCategory:"ruleCategory"},features:[_.Jb],decls:19,vars:16,consts:[[1,"vitamui-table-head","text-color"],[1,"col-5"],[1,"clickable","material-icons","mat-icon-rtl-mirror","arrow-icon",3,"click"],["class","col",4,"ngIf"],[1,"collapsible"],["class","vitamui-table",4,"ngIf","ngIfThen","ngIfElse"],["class","vitamui-table-head",4,"ngIf"],["class","vitamui-table collapsible",4,"ngIf"],["resultsFound",""],["noResults",""],[1,"col"],[1,"vitamui-table"],[1,"vitamui-table-head"],[1,"vitamui-table","collapsible"],["class","vitamui-table-body",4,"ngIf"],[1,"col-4"],[1,"vitamui-table-body"],["class","vitamui-table-rows",4,"ngFor","ngForOf"],[1,"vitamui-table-rows"],[1,"vitamui-row","d-flex","align-items-center"],[1,"col-4","text"],[1,"col-6"],[1,"col-2"],["class","vitamui-table-rows",4,"ngIf"],[1,"col-6","text"],[1,"col-2","text"],[1,"col-3"],[1,"vitamui-row","d-flex","align-items-center",3,"ngClass","click"],[1,"col-3","text"]],template:function(e,t){if(1&e&&(_.dc(0,"div",0),_.dc(1,"div",1),_.dc(2,"i",2),_.lc("click",(function(){return t.showlistOfRulesBloc()})),_.Vc(3),_.cc(),_.Vc(4),_.cc(),_.Tc(5,Zt,3,4,"div",3),_.Tc(6,Qt,2,1,"div",3),_.cc(),_.dc(7,"div",4),_.Tc(8,Jt,1,0,"div",5),_.cc(),_.Tc(9,ei,5,6,"div",6),_.Tc(10,ai,3,3,"div",7),_.Tc(11,ri,5,6,"div",6),_.Tc(12,oi,3,3,"div",7),_.Tc(13,di,5,6,"div",6),_.Tc(14,Ei,3,3,"div",7),_.Tc(15,Ii,2,2,"ng-template",null,8,_.Uc),_.Tc(17,Ti,3,3,"ng-template",null,9,_.Uc)),2&e){const e=_.Gc(16),i=_.Gc(18);_.Lb(2),_.Qc("font-size",20,"px"),_.Lb(1),_.Xc(" ",t.listOfRulesCollapsed?"expand_less":"expand_more"," "),_.Lb(1),_.Xc(" ",t.getRuleCategoryName(t.ruleCategory)," "),_.Lb(1),_.vc("ngIf",!t.isPreventInheritance),_.Lb(1),_.vc("ngIf",!t.isPreventInheritance),_.Lb(1),_.vc("@collapse",t.listOfRulesCollapsed),_.Lb(1),_.vc("ngIf",t.isPreventInheritance)("ngIfThen",i)("ngIfElse",e),_.Lb(1),_.vc("ngIf",t.isToShowPropertiesList&&"ClassificationRule"!==t.ruleCategory&&"HoldRule"!==t.ruleCategory),_.Lb(1),_.vc("ngIf",t.isToShowPropertiesList&&"ClassificationRule"!==t.ruleCategory&&"HoldRule"!==t.ruleCategory),_.Lb(1),_.vc("ngIf",t.isToShowPropertiesList&&"HoldRule"===t.ruleCategory),_.Lb(1),_.vc("ngIf",t.isToShowPropertiesList&&"HoldRule"===t.ruleCategory),_.Lb(1),_.vc("ngIf",t.isToShowPropertiesList&&"ClassificationRule"===t.ruleCategory),_.Lb(1),_.vc("ngIf",t.isToShowPropertiesList&&"ClassificationRule"===t.ruleCategory)}},directives:[c.p,c.o,c.n],pipes:[C.Vb,O.d,C.Zb],styles:[".text-color[_ngcontent-%COMP%]{color:var(--vitamui-primary)}.disabled-div[_ngcontent-%COMP%]{pointer-events:none}.enabled-div[_ngcontent-%COMP%]{pointer-events:painted}"],data:{animation:[Object($t.o)("collapse",[Object($t.l)("false",Object($t.m)({height:$t.a,visibility:$t.a})),Object($t.l)("true",Object($t.m)({height:"0",visibility:"hidden"})),Object($t.n)("false => true",Object($t.e)("300ms ease-in")),Object($t.n)("true => false",Object($t.e)("300ms ease-out"))])]}}),e})(),Li=(()=>{class e{constructor(e,t){this.collectService=e,this.translateService=t,this.listOfCriteriaSearch=[]}ngOnChanges(e){e.archiveUnit&&this.archiveUnit["#opi"]&&this.selectUnitWithInheritedRules(e.archiveUnit.currentValue)}ngOnInit(){}ngOnDestroy(){var e;null===(e=this.selectUnitWithInheritedRulesSubscription)||void 0===e||e.unsubscribe()}selectUnitWithInheritedRules(e){this.listOfCriteriaSearch.push({criteria:"GUID",values:[{value:e["#id"],id:e["#id"]}],operator:C.v.EQ,category:C.Z.FIELDS,dataType:C.u.STRING}),e["#opi"]&&(this.selectUnitWithInheritedRulesSubscription=this.collectService.selectUnitWithInheritedRules(e["#opi"],{criteriaList:this.listOfCriteriaSearch,pageNumber:0,size:10,language:this.translateService.currentLang}).subscribe(e=>{this.archiveUnitRules=e,this.listOfCriteriaSearch=[]}))}}return e.\u0275fac=function(t){return new(t||e)(_.Xb($),_.Xb(O.e))},e.\u0275cmp=_.Rb({type:e,selectors:[["app-archive-unit-rules-details-tab"]],inputs:{archiveUnit:"archiveUnit"},features:[_.Jb],decls:24,vars:14,consts:[[1,"row"],[1,"col-6"],[1,"col"],[3,"ruleCategory","archiveUnitRules"]],template:function(e,t){1&e&&(_.dc(0,"div",0),_.dc(1,"div",1),_.dc(2,"div",0),_.dc(3,"div",2),_.Yb(4,"app-archive-unit-rules-informations-tab",3),_.cc(),_.cc(),_.dc(5,"div",0),_.dc(6,"div",2),_.Yb(7,"app-archive-unit-rules-informations-tab",3),_.cc(),_.cc(),_.dc(8,"div",0),_.dc(9,"div",2),_.Yb(10,"app-archive-unit-rules-informations-tab",3),_.cc(),_.cc(),_.dc(11,"div",0),_.dc(12,"div",2),_.Yb(13,"app-archive-unit-rules-informations-tab",3),_.cc(),_.cc(),_.cc(),_.dc(14,"div",1),_.dc(15,"div",0),_.dc(16,"div",2),_.Yb(17,"app-archive-unit-rules-informations-tab",3),_.cc(),_.cc(),_.dc(18,"div",0),_.dc(19,"div",2),_.Yb(20,"app-archive-unit-rules-informations-tab",3),_.cc(),_.cc(),_.dc(21,"div",0),_.dc(22,"div",2),_.Yb(23,"app-archive-unit-rules-informations-tab",3),_.cc(),_.cc(),_.cc(),_.cc()),2&e&&(_.Lb(4),_.vc("ruleCategory","AppraisalRule")("archiveUnitRules",t.archiveUnitRules),_.Lb(3),_.vc("ruleCategory","HoldRule")("archiveUnitRules",t.archiveUnitRules),_.Lb(3),_.vc("ruleCategory","DisseminationRule")("archiveUnitRules",t.archiveUnitRules),_.Lb(3),_.vc("ruleCategory","ClassificationRule")("archiveUnitRules",t.archiveUnitRules),_.Lb(4),_.vc("ruleCategory","StorageRule")("archiveUnitRules",t.archiveUnitRules),_.Lb(3),_.vc("ruleCategory","AccessRule")("archiveUnitRules",t.archiveUnitRules),_.Lb(3),_.vc("ruleCategory","ReuseRule")("archiveUnitRules",t.archiveUnitRules))},directives:[gi],encapsulation:2,data:{animation:[Object($t.o)("collapse",[Object($t.l)("false",Object($t.m)({height:$t.a,visibility:$t.a})),Object($t.l)("true",Object($t.m)({height:"0",visibility:"hidden"})),Object($t.n)("false => true",Object($t.e)("300ms ease-in")),Object($t.n)("true => false",Object($t.e)("300ms ease-out"))])]}}),e})();class bi{constructor(e,t){this._document=t;const i=this._textarea=this._document.createElement("textarea"),c=i.style;c.position="fixed",c.top=c.opacity="0",c.left="-999em",i.setAttribute("aria-hidden","true"),i.value=e,this._document.body.appendChild(i)}copy(){const e=this._textarea;let t=!1;try{if(e){const i=this._document.activeElement;e.select(),e.setSelectionRange(0,e.value.length),t=this._document.execCommand("copy"),i&&i.focus()}}catch(i){}return t}destroy(){const e=this._textarea;e&&(e.parentNode&&e.parentNode.removeChild(e),this._textarea=void 0)}}let Ai=(()=>{class e{constructor(e){this._document=e}copy(e){const t=this.beginCopy(e),i=t.copy();return t.destroy(),i}beginCopy(e){return new bi(e,this._document)}}return e.\u0275fac=function(t){return new(t||e)(_.ic(c.d))},e.\u0275prov=Object(_.Tb)({factory:function(){return new e(Object(_.ic)(c.d))},token:e,providedIn:"root"}),e})();function Si(e,t){if(1&e&&(_.dc(0,"div",2),_.dc(1,"div",3),_.dc(2,"div",4),_.Vc(3),_.qc(4,"translate"),_.cc(),_.cc(),_.dc(5,"div",3),_.dc(6,"div",5),_.dc(7,"div",6),_.dc(8,"label"),_.Vc(9),_.qc(10,"translate"),_.cc(),_.dc(11,"div"),_.Vc(12),_.cc(),_.cc(),_.cc(),_.cc(),_.dc(13,"div",3),_.dc(14,"div",5),_.dc(15,"div",6),_.dc(16,"label"),_.Vc(17),_.qc(18,"translate"),_.cc(),_.dc(19,"div"),_.Vc(20),_.cc(),_.cc(),_.dc(21,"div",6),_.dc(22,"label"),_.Vc(23),_.qc(24,"translate"),_.cc(),_.dc(25,"div"),_.Vc(26),_.cc(),_.cc(),_.cc(),_.cc(),_.cc()),2&e){const e=_.pc();_.Lb(3),_.Xc(" ",_.rc(4,7,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.TECHNICAL_OBJECT_GROUP")," "),_.Lb(6),_.Wc(_.rc(10,9,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.OBJECT_GROUP_ID")),_.Lb(3),_.Wc(e.unitObject["#id"]),_.Lb(5),_.Wc(_.rc(18,11,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.CREATION_DATE")),_.Lb(3),_.Wc(e.unitObject["#approximate_creation_date"]),_.Lb(3),_.Wc(_.rc(24,13,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.LAST_MODIFIED_DATE")),_.Lb(3),_.Wc(e.unitObject["#approximate_update_date"])}}function _i(e,t){if(1&e&&_.Yb(0,"vitamui-common-physical-archive-viewer",11),2&e){const e=_.pc().$implicit;_.vc("archive",e)}}const mi=function(e){return{opened:e}};function fi(e,t){if(1&e){const e=_.ec();_.dc(0,"div",12),_.lc("click",(function(){_.Kc(e);const t=_.pc().$implicit;return _.pc().openClose(t)})),_.dc(1,"div",13),_.dc(2,"div",14),_.Yb(3,"i"),_.cc(),_.dc(4,"div",15),_.Vc(5),_.qc(6,"translate"),_.cc(),_.dc(7,"div",16),_.Vc(8),_.qc(9,"bytes"),_.cc(),_.cc(),_.dc(10,"div",13),_.dc(11,"div",17),_.Vc(12),_.cc(),_.dc(13,"button",18),_.lc("click",(function(t){_.Kc(e);const i=_.pc().$implicit;return _.pc().onClickDownloadObject(t,i)})),_.Yb(14,"i",19),_.cc(),_.cc(),_.cc()}if(2&e){const e=_.pc().$implicit,t=_.pc();_.vc("ngClass",_.Ac(12,mi,e.opened)),_.Lb(3),_.Ob("vitamui-icon ",e.opened?"vitamui-icon-chevron-down":"vitamui-icon-chevron-right",""),_.Lb(2),_.Xc(" ",_.rc(6,8,"COLLECT.UNIT_OBJECT_QUALIFIER_TYPE."+(null==e?null:e.qualifier))+" ("+(null==e?null:e.version)+")"," "),_.Lb(3),_.Wc(_.rc(9,10,e.Size)),_.Lb(4),_.Xc(" ",t.getFormatLitteral(null==e?null:e.FormatIdentification)," "),_.Lb(1),_.vc("disabled",0===(null==e?null:e.Size))}}function Oi(e,t){if(1&e&&(_.dc(0,"div",3),_.dc(1,"div",5),_.dc(2,"div",6),_.dc(3,"label"),_.Vc(4),_.qc(5,"translate"),_.cc(),_.dc(6,"div"),_.Vc(7),_.cc(),_.cc(),_.cc(),_.cc()),2&e){const e=t.$implicit;_.Lb(4),_.Wc(_.rc(5,2,"ARCHIVE_SEARCH.ARCHIVE_UNIT_PREVIEW.FIELDS.PERSISTENT_IDENTIFIER_CONTENT")),_.Lb(3),_.Wc(e.PersistentIdentifierContent)}}function Ni(e,t){if(1&e&&(_.dc(0,"div",36),_.dc(1,"div",37),_.Vc(2),_.qc(3,"translate"),_.cc(),_.Tc(4,Oi,8,4,"div",38),_.Yb(5,"div",22),_.cc()),2&e){const e=_.pc(2).$implicit;_.Lb(2),_.Wc(_.rc(3,2,"ARCHIVE_SEARCH.ARCHIVE_UNIT_PREVIEW.FIELDS.PERSISTENT_IDENTIFIER")),_.Lb(2),_.vc("ngForOf",e.PersistentIdentifier)}}function Fi(e,t){1&e&&(_.dc(0,"label"),_.Vc(1),_.qc(2,"translate"),_.cc()),2&e&&(_.Lb(1),_.Xc(" ",_.rc(2,1,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.FILE_ENCODING")," "))}function Di(e,t){1&e&&(_.dc(0,"label"),_.Vc(1),_.qc(2,"translate"),_.cc()),2&e&&(_.Lb(1),_.Xc(" ",_.rc(2,1,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.CREATING_APPLICATION_NAME")," "))}function Ui(e,t){1&e&&(_.dc(0,"label"),_.Vc(1),_.qc(2,"translate"),_.cc()),2&e&&(_.Lb(1),_.Xc(" ",_.rc(2,1,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.CREATING_OS")," "))}function yi(e,t){1&e&&(_.dc(0,"label"),_.Vc(1),_.qc(2,"translate"),_.cc()),2&e&&(_.Lb(1),_.Xc(" ",_.rc(2,1,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.CREATING_APPLICATION_VERSION")," "))}function Pi(e,t){if(1&e&&(_.dc(0,"div",3),_.dc(1,"div",5),_.dc(2,"div",6),_.Tc(3,Ui,3,3,"label",26),_.dc(4,"div"),_.Vc(5),_.cc(),_.cc(),_.cc(),_.dc(6,"div",5),_.dc(7,"div",6),_.Tc(8,yi,3,3,"label",26),_.dc(9,"div"),_.Vc(10),_.cc(),_.cc(),_.cc(),_.cc()),2&e){const e=_.pc(2).$implicit,t=_.pc();_.Lb(3),_.vc("ngIf",t.getCreatingOs(null==e?null:e.FileInfo)),_.Lb(2),_.Wc(t.getCreatingOs(null==e?null:e.FileInfo)),_.Lb(3),_.vc("ngIf",t.getCreatingApplicationVersion(null==e?null:e.FileInfo)),_.Lb(2),_.Wc(t.getCreatingApplicationVersion(null==e?null:e.FileInfo))}}function xi(e,t){1&e&&(_.dc(0,"label"),_.Vc(1),_.qc(2,"translate"),_.cc()),2&e&&(_.Lb(1),_.Xc(" ",_.rc(2,1,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.CREATING_OS_VERSION")," "))}function ki(e,t){1&e&&(_.dc(0,"label"),_.Vc(1),_.qc(2,"translate"),_.cc()),2&e&&(_.Lb(1),_.Xc(" ",_.rc(2,1,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.CREATED_APPLICATION_DATE")," "))}function Mi(e,t){if(1&e&&(_.dc(0,"div",3),_.dc(1,"div",5),_.dc(2,"div",6),_.Tc(3,xi,3,3,"label",26),_.dc(4,"div"),_.Vc(5),_.cc(),_.cc(),_.cc(),_.dc(6,"div",5),_.dc(7,"div",6),_.Tc(8,ki,3,3,"label",26),_.dc(9,"div"),_.Vc(10),_.cc(),_.cc(),_.cc(),_.cc()),2&e){const e=_.pc(2).$implicit,t=_.pc();_.Lb(3),_.vc("ngIf",t.getCreatingOsVersion(null==e?null:e.FileInfo)),_.Lb(2),_.Wc(t.getCreatingOsVersion(null==e?null:e.FileInfo)),_.Lb(3),_.vc("ngIf",t.getDateCreatedByApplication(null==e?null:e.FileInfo)),_.Lb(2),_.Wc(t.getDateCreatedByApplication(null==e?null:e.FileInfo))}}function Vi(e,t){if(1&e){const e=_.ec();_.dc(0,"div",20),_.dc(1,"div",2),_.Yb(2,"div",21),_.dc(3,"div",3),_.dc(4,"div",5),_.dc(5,"div",6),_.dc(6,"label"),_.Vc(7),_.qc(8,"translate"),_.cc(),_.dc(9,"div"),_.Vc(10),_.cc(),_.cc(),_.cc(),_.dc(11,"div",5),_.dc(12,"div",6),_.dc(13,"label"),_.Vc(14),_.qc(15,"translate"),_.cc(),_.dc(16,"div"),_.Vc(17),_.cc(),_.cc(),_.cc(),_.cc(),_.dc(18,"div",3),_.dc(19,"div",5),_.dc(20,"div",6),_.dc(21,"label"),_.Vc(22),_.qc(23,"translate"),_.cc(),_.dc(24,"div"),_.Vc(25),_.cc(),_.cc(),_.cc(),_.dc(26,"div",5),_.dc(27,"div",6),_.dc(28,"label"),_.Vc(29),_.qc(30,"translate"),_.cc(),_.dc(31,"div"),_.Vc(32),_.cc(),_.cc(),_.cc(),_.cc(),_.Yb(33,"div",22),_.cc(),_.Tc(34,Ni,6,4,"div",23),_.dc(35,"div",24),_.dc(36,"div",25),_.Vc(37),_.qc(38,"translate"),_.cc(),_.dc(39,"div",3),_.dc(40,"div",5),_.dc(41,"div",6),_.dc(42,"label"),_.Vc(43),_.qc(44,"translate"),_.cc(),_.dc(45,"div"),_.Vc(46),_.cc(),_.cc(),_.cc(),_.dc(47,"div",5),_.dc(48,"div",6),_.dc(49,"label"),_.Vc(50),_.qc(51,"translate"),_.cc(),_.dc(52,"div"),_.Vc(53),_.cc(),_.cc(),_.cc(),_.cc(),_.dc(54,"div",3),_.dc(55,"div",5),_.dc(56,"div",6),_.dc(57,"label"),_.Vc(58),_.qc(59,"translate"),_.cc(),_.dc(60,"div"),_.Vc(61),_.cc(),_.cc(),_.cc(),_.dc(62,"div",5),_.dc(63,"div",6),_.Tc(64,Fi,3,3,"label",26),_.dc(65,"div"),_.Vc(66),_.cc(),_.cc(),_.cc(),_.cc(),_.Yb(67,"div",22),_.cc(),_.dc(68,"div",27),_.dc(69,"div",25),_.Vc(70),_.qc(71,"translate"),_.cc(),_.dc(72,"div",3),_.dc(73,"div",5),_.dc(74,"div",6),_.dc(75,"label"),_.Vc(76),_.qc(77,"translate"),_.cc(),_.dc(78,"div"),_.Vc(79),_.cc(),_.cc(),_.cc(),_.dc(80,"div",5),_.dc(81,"div",6),_.dc(82,"label"),_.Vc(83),_.qc(84,"translate"),_.cc(),_.dc(85,"div"),_.Vc(86),_.cc(),_.cc(),_.cc(),_.cc(),_.dc(87,"div",3),_.dc(88,"div",5),_.dc(89,"div",6),_.dc(90,"label"),_.Vc(91),_.qc(92,"translate"),_.cc(),_.dc(93,"div"),_.Vc(94),_.cc(),_.cc(),_.cc(),_.dc(95,"div",5),_.dc(96,"div",6),_.dc(97,"label"),_.Vc(98),_.qc(99,"translate"),_.cc(),_.dc(100,"div",28),_.dc(101,"div",29),_.Vc(102),_.cc(),_.dc(103,"div",30),_.lc("click",(function(){_.Kc(e);const t=_.pc().$implicit;return _.pc().copyToClipboard(null==t?null:t.MessageDigest)})),_.qc(104,"translate"),_.Yb(105,"i",31),_.cc(),_.cc(),_.cc(),_.cc(),_.cc(),_.dc(106,"div",3),_.dc(107,"div",5),_.dc(108,"div",6),_.dc(109,"label"),_.Vc(110),_.qc(111,"translate"),_.cc(),_.dc(112,"div"),_.Vc(113),_.cc(),_.cc(),_.cc(),_.dc(114,"div",5),_.dc(115,"div",6),_.Tc(116,Di,3,3,"label",26),_.dc(117,"div"),_.Vc(118),_.cc(),_.cc(),_.cc(),_.cc(),_.Tc(119,Pi,11,4,"div",32),_.Tc(120,Mi,11,4,"div",32),_.Yb(121,"div",22),_.cc(),_.dc(122,"div",33),_.dc(123,"div",25),_.Vc(124),_.qc(125,"translate"),_.cc(),_.dc(126,"div",3),_.dc(127,"div",5),_.dc(128,"div",6),_.dc(129,"label"),_.Vc(130),_.qc(131,"translate"),_.cc(),_.dc(132,"div"),_.Vc(133),_.cc(),_.cc(),_.cc(),_.cc(),_.Yb(134,"div",22),_.cc(),_.dc(135,"div",34),_.dc(136,"button",35),_.lc("click",(function(t){_.Kc(e);const i=_.pc().$implicit;return _.pc().onClickDownloadObject(t,i)})),_.Yb(137,"i",19),_.dc(138,"span"),_.Vc(139),_.qc(140,"translate"),_.cc(),_.cc(),_.cc(),_.cc()}if(2&e){const e=_.pc().$implicit,t=_.pc();_.Lb(7),_.Wc(_.rc(8,40,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.OBJECT_ID")),_.Lb(3),_.Wc(e["#id"]),_.Lb(4),_.Wc(_.rc(15,42,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.OPERATION_ID")),_.Lb(3),_.Wc(e["#opi"]),_.Lb(5),_.Wc(_.rc(23,44,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.USAGE")),_.Lb(3),_.Wc(null==e?null:e.qualifier),_.Lb(4),_.Wc(_.rc(30,46,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.USAGE_VERSION")),_.Lb(3),_.Wc(e.version),_.Lb(2),_.vc("ngIf",e.PersistentIdentifier),_.Lb(3),_.Wc(_.rc(38,48,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.FORMAT")),_.Lb(6),_.Wc(_.rc(44,50,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.FORMAT_PUID")),_.Lb(3),_.Wc(t.getFormatId(null==e?null:e.FormatIdentification)),_.Lb(4),_.Wc(_.rc(51,52,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.FORMAT_NAME")),_.Lb(3),_.Wc(t.getFormatLitteral(null==e?null:e.FormatIdentification)),_.Lb(5),_.Wc(_.rc(59,54,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.MIME_TYPE")),_.Lb(3),_.Wc(t.getMimeType(null==e?null:e.FormatIdentification)),_.Lb(3),_.vc("ngIf",t.getEncoding(null==e?null:e.FormatIdentification)),_.Lb(2),_.Wc(t.getEncoding(null==e?null:e.FormatIdentification)),_.Lb(4),_.Wc(_.rc(71,56,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.FILE")),_.Lb(6),_.Wc(_.rc(77,58,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.FILE_NAME")),_.Lb(3),_.Wc(t.getFileName(null==e?null:e.FileInfo)),_.Lb(4),_.Wc(_.rc(84,60,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.URI")),_.Lb(3),_.Wc(null==e?null:e.Uri),_.Lb(5),_.Wc(_.rc(92,62,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.OCTET_SIZE")),_.Lb(3),_.Wc(null==e?null:e.Size),_.Lb(4),_.Xc(" ",_.rc(99,64,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.ALGORITHM")+e.Algorithm," "),_.Lb(4),_.Wc(null==e?null:e.MessageDigest),_.Lb(1),_.wc("matTooltip",_.rc(104,66,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.COPY")),_.vc("matTooltipShowDelay",300),_.Lb(7),_.Wc(_.rc(111,68,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.LAST_MODIFIED_DATE")),_.Lb(3),_.Wc(t.getLastModified(null==e?null:e.FileInfo)),_.Lb(3),_.vc("ngIf",t.getCreatingApplicationName(null==e?null:e.FileInfo)),_.Lb(2),_.Wc(t.getCreatingApplicationName(null==e?null:e.FileInfo)),_.Lb(1),_.vc("ngIf",t.getCreatingOs(null==e?null:e.FileInfo)&&t.getCreatingApplicationVersion(null==e?null:e.FileInfo)),_.Lb(1),_.vc("ngIf",t.getCreatingOsVersion(null==e?null:e.FileInfo)&&t.getDateCreatedByApplication(null==e?null:e.FileInfo)),_.Lb(4),_.Wc(_.rc(125,70,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.STOCKAGE")),_.Lb(6),_.Wc(_.rc(131,72,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.STOCKAGE_STRATEGY_ID")),_.Lb(3),_.Wc(null==e["#storage"]?null:e["#storage"].strategyId),_.Lb(3),_.vc("disabled",0===(null==e?null:e.Size)),_.Lb(3),_.Wc(_.rc(140,74,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.DOWNLOAD_DOC"))}}function wi(e,t){if(1&e&&(_.dc(0,"div",7),_.Tc(1,_i,1,1,"vitamui-common-physical-archive-viewer",8),_.Tc(2,fi,15,14,"div",9),_.Tc(3,Vi,141,76,"div",10),_.cc()),2&e){const e=t.$implicit;_.Lb(1),_.vc("ngIf","PhysicalMaster"===e.qualifier),_.Lb(1),_.vc("ngIf","PhysicalMaster"!==e.qualifier),_.Lb(1),_.vc("ngIf","PhysicalMaster"!==e.qualifier&&e.opened)}}let Hi=(()=>{class e{constructor(e,t){this.archiveCollectService=e,this.clipboard=t}ngOnInit(){}ngOnChanges(e){e.archiveUnit&&(this.unitObject=null,this.versionsWithQualifiersOrdered=null,this.unitHasObject()&&this.getObjectGroupDetailsById(this.archiveUnit))}unitHasObject(){return this.archiveUnit.DescriptionLevel===C.y.ITEM&&!!this.archiveUnit["#object"]}onClickDownloadObject(e,t){return e.stopPropagation(),this.archiveCollectService.downloadObjectFromUnit(this.archiveUnit["#id"],this.archiveUnit["#object"],t.qualifier,t.version)}copyToClipboard(e){this.clipboard.copy(e)}getObjectGroupDetailsById(e){this.archiveCollectService.getObjectGroupDetailsById(e["#object"]).subscribe(e=>{this.unitObject=e,this.versionsWithQualifiersOrdered=Object(C.zb)(this.unitObject["#qualifiers"]),this.setFirstVersionWithQualifierOpen()})}setFirstVersionWithQualifierOpen(){this.versionsWithQualifiersOrdered&&this.versionsWithQualifiersOrdered.length>0&&(this.versionsWithQualifiersOrdered[0].opened=!0)}openClose(e){e.opened=!e.opened}getFormatLitteral(e){return e?e.FormatLitteral:null}getMimeType(e){return e?e.MimeType:null}getFormatId(e){return e?e.FormatId:null}getEncoding(e){return e?e.Encoding:null}getFileName(e){return e?e.Filename:null}getLastModified(e){return e?e.LastModified:null}getDateCreatedByApplication(e){return e?e.DateCreatedByApplication:null}getCreatingOsVersion(e){return e?e.CreatingOsVersion:null}getCreatingOs(e){return e?e.CreatingOs:null}getCreatingApplicationVersion(e){return e?e.CreatingApplicationVersion:null}getCreatingApplicationName(e){return e?e.CreatingApplicationName:null}}return e.\u0275fac=function(t){return new(t||e)(_.Xb($),_.Xb(Ai))},e.\u0275cmp=_.Rb({type:e,selectors:[["app-collect-object-group-details-tab"]],inputs:{archiveUnit:"archiveUnit"},features:[_.Jb],decls:2,vars:2,consts:[["class","object-details-group IDS",4,"ngIf"],["class","object-container",4,"ngFor","ngForOf"],[1,"object-details-group","IDS"],[1,"row"],[1,"col","title"],[1,"col"],[1,"read-only-field"],[1,"object-container"],[3,"archive",4,"ngIf"],["class","object-menu",3,"ngClass","click",4,"ngIf"],["class","object-details",4,"ngIf"],[3,"archive"],[1,"object-menu",3,"ngClass","click"],[1,"line","split"],[1,"line","open-close-icon"],[1,"line","shrink","object-name"],[1,"line","object-size"],[1,"line","shrink","object-type"],[1,"download-button",3,"disabled","click"],[1,"vitamui-icon","vitamui-icon-telecharger"],[1,"object-details"],[1,"row","no-title"],[1,"row-separator"],["class","object-details-group",4,"ngIf"],[1,"object-details-group","FORMAT"],[1,"row","title"],[4,"ngIf"],[1,"object-details-group","FILE"],[1,"line"],[1,"shrink"],["matTooltipClass","vitamui-tooltip",1,"button-copy",3,"matTooltip","matTooltipShowDelay","click"],[1,"vitamui-icon","vitamui-icon-content-copy"],["class","row",4,"ngIf"],[1,"object-details-group","STOCKAGE"],[1,"object-details-group","download-object"],[1,"btn","primary","download-btn",3,"disabled","click"],[1,"object-details-group"],[1,"row","title","text","uppercase"],["class","row",4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(_.Tc(0,Si,27,15,"div",0),_.Tc(1,wi,4,3,"div",1)),2&e&&(_.vc("ngIf",t.unitObject),_.Lb(1),_.vc("ngForOf",t.versionsWithQualifiersOrdered))},directives:[c.p,c.o,C.Fb,c.n,he.a],pipes:[O.d,C.p],styles:["[_nghost-%COMP%]{flex-direction:column}.col[_ngcontent-%COMP%], [_nghost-%COMP%]{display:flex}.col[_ngcontent-%COMP%]{flex-shrink:1;overflow:hidden}.line[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}.shrink[_ngcontent-%COMP%]{display:flex;flex-grow:1;flex-shrink:1;overflow:hidden;text-overflow:ellipsis}.object-details-group[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{padding:5px 14px;font-size:12px;font-weight:700;color:var(--vitamui-primary)}.object-details-group[_ngcontent-%COMP%]   .no-title[_ngcontent-%COMP%]{height:10px}.object-details-group[_ngcontent-%COMP%]   .read-only-field[_ngcontent-%COMP%]{min-height:51px;margin-bottom:0}.object-details-group[_ngcontent-%COMP%]   .read-only-field[_ngcontent-%COMP%]   .button-copy[_ngcontent-%COMP%]{padding:0 10px;cursor:pointer}.object-details-group[_ngcontent-%COMP%]   .read-only-field[_ngcontent-%COMP%]   .button-copy[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:hover{color:var(--vitamui-secondary)}.object-details-group[_ngcontent-%COMP%]   .read-only-field[_ngcontent-%COMP%]   .button-copy[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:active{color:var(--vitamui-primary-100)}.object-details-group[_ngcontent-%COMP%]   .read-only-field[_ngcontent-%COMP%]   .button-copy[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:focus{color:var(--vitamui-primary)}.object-details-group[_ngcontent-%COMP%]   .read-only-field[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;flex-direction:row}.object-details-group[_ngcontent-%COMP%]   .row-separator[_ngcontent-%COMP%]{border-bottom:1px solid #e0e0e0;margin-bottom:5px;margin-top:5px}.object-details-group.download-object[_ngcontent-%COMP%]{padding:15px 0 15px 20px}.object-container[_ngcontent-%COMP%]   .object-menu[_ngcontent-%COMP%]{height:50px;margin-top:20px;padding:0 5px;border-radius:5px;display:flex;background-color:#fff;flex-direction:row;font-size:16px;font-weight:700;line-height:22px;cursor:pointer}.object-container[_ngcontent-%COMP%]   .object-menu.opened[_ngcontent-%COMP%]{border-left:5px solid var(--vitamui-primary);padding-left:0;color:var(--vitamui-primary)}.object-container[_ngcontent-%COMP%]   .object-menu[_ngcontent-%COMP%]   .split[_ngcontent-%COMP%]{padding:0 10px;width:50%}.object-container[_ngcontent-%COMP%]   .object-menu[_ngcontent-%COMP%]   .open-close-icon[_ngcontent-%COMP%]{padding-right:5px}.object-container[_ngcontent-%COMP%]   .object-menu[_ngcontent-%COMP%]   .download-button[_ngcontent-%COMP%]{border:none;border-radius:50%;background-color:var(--vitamui-primary);width:30px;height:30px;font-size:medium;color:var(--vitamui-primary-font);cursor:pointer}.object-container[_ngcontent-%COMP%]   .object-menu[_ngcontent-%COMP%]   .download-button[_ngcontent-%COMP%]:hover{background-color:var(--vitamui-primary-800)}.object-container[_ngcontent-%COMP%]   .object-details[_ngcontent-%COMP%]{padding:0 15px;margin-top:5px;background-color:#fff}"],data:{animation:[Object($t.o)("collapse",[Object($t.l)("false",Object($t.m)({height:$t.a,visibility:$t.a})),Object($t.l)("true",Object($t.m)({height:"0",visibility:"hidden"})),Object($t.n)("false => true",Object($t.e)("300ms ease-in")),Object($t.n)("true => false",Object($t.e)("300ms ease-out"))])]}}),e})();const Gi=["tabs"],qi=["descriptionTab"];let Bi=(()=>{class e{constructor(e){this.translateService=e,this.backToNormalLateralPanel=new _.p,this.previewClose=new _.p,this.showExtendedLateralPanel=new _.p,this.isPanelextended=!1,this.selectedIndex=0,this.updateStarted=!1,this.hasAccessContractManagementPermissionsMessage=this.translateService.instant("UNIT_UPDATE.NO_PERMISSION")}ngAfterViewInit(){this.tabs._handleClick=this.interceptTabChange.bind(this)}emitClose(){return Object(Ut.a)(this,void 0,void 0,(function*(){this.descriptionTab.isModified()&&(yield this.checkBeforeExit()),this.previewClose.emit(),this.isPanelextended=!1,this.backToNormalLateralPanel.emit(),this.selectedIndex=0}))}checkBeforeExit(){return Object(Ut.a)(this,void 0,void 0,(function*(){yield this.descriptionTab.onCancel()}))}selectedTabChangeEvent(e){switch(e.index){case 0:this.isPanelextended=!1,this.backToNormalLateralPanel.emit();break;case 1:case 2:this.isPanelextended=!0,this.showExtendedLateralPanel.emit()}this.selectedIndex=e.index}beforeunloadHandler(e){return Object(Ut.a)(this,void 0,void 0,(function*(){this.descriptionTab.isModified()&&(e.preventDefault(),yield this.checkBeforeExit())}))}interceptTabChange(e,t,i){return Object(Ut.a)(this,void 0,void 0,(function*(){return this.descriptionTab.isModified()&&(yield this.checkBeforeExit()),this.updateStarted=!1,u.b.prototype._handleClick.apply(this.tabs,[e,t,i])}))}showNormalPanel(){this.updateStarted=!1,this.selectedTabChangeEvent({index:this.selectedIndex,tab:null})}updateMetadataDesc(){this.selectedIndex=1,this.isPanelextended=!0,this.showExtendedLateralPanel.emit(),this.updateStarted=!0}ngOnChanges(e){var t;return Object(Ut.a)(this,void 0,void 0,(function*(){e.archiveUnit&&((null===(t=this.descriptionTab)||void 0===t?void 0:t.isModified())&&(this.archiveUnit=e.archiveUnit.previousValue,yield this.checkBeforeExit().then(()=>{this.archiveUnit=e.archiveUnit.currentValue})),this.showNormalPanel())}))}getArchiveUnitIcon(e){return Object(C.Bb)(e)}}return e.\u0275fac=function(t){return new(t||e)(_.Xb(O.e))},e.\u0275cmp=_.Rb({type:e,selectors:[["app-archive-preview"]],viewQuery:function(e,t){var i;1&e&&(_.bd(Gi,!0),_.bd(qi,!0)),2&e&&(_.Fc(i=_.mc())&&(t.tabs=i.first),_.Fc(i=_.mc())&&(t.descriptionTab=i.first))},hostBindings:function(e,t){1&e&&_.lc("beforeunload",(function(e){return t.beforeunloadHandler(e)}),!1,_.Jc)},inputs:{archiveUnit:"archiveUnit",isPopup:"isPopup",accessContractAllowUpdating:"accessContractAllowUpdating",hasUpdateDescriptiveUnitMetadataRole:"hasUpdateDescriptiveUnitMetadataRole",transactionId:"transactionId"},outputs:{backToNormalLateralPanel:"backToNormalLateralPanel",previewClose:"previewClose",showExtendedLateralPanel:"showExtendedLateralPanel"},features:[_.Jb],decls:24,vars:43,consts:[[3,"extended","title","icon","hasToolTipOnTitle","toolTipTitleText","toolTipTitleDuration","onclose"],[3,"overlayPos","icon"],["mat-menu-item","","matTooltipClass","vitamui-tooltip",3,"matTooltip","matTooltipShowDelay","disabled","click"],[1,"vitamui-sidepanel-body"],[3,"selectedIndex","ngClass","selectedTabChange"],["tabs",""],[3,"label"],[3,"archiveUnit","showNormalPanel"],[3,"archiveUnit","editMode","transactionId","editModeChange"],["descriptionTab",""],[3,"archiveUnit"]],template:function(e,t){1&e&&(_.dc(0,"vitamui-common-sidenav-header",0),_.lc("onclose",(function(){return t.emitClose()})),_.qc(1,"truncate"),_.qc(2,"unitI18n"),_.qc(3,"unitI18n"),_.dc(4,"vitamui-common-menu-button",1),_.dc(5,"button",2),_.lc("click",(function(){return t.updateMetadataDesc()})),_.Vc(6),_.qc(7,"translate"),_.cc(),_.cc(),_.cc(),_.dc(8,"div",3),_.dc(9,"mat-tab-group",4,5),_.lc("selectedTabChange",(function(e){return t.selectedTabChangeEvent(e)})),_.dc(11,"mat-tab",6),_.qc(12,"translate"),_.dc(13,"app-archive-unit-information-tab",7),_.lc("showNormalPanel",(function(){return t.showNormalPanel()})),_.cc(),_.cc(),_.dc(14,"mat-tab",6),_.qc(15,"translate"),_.dc(16,"app-archive-unit-description-tab",8,9),_.lc("editModeChange",(function(e){return t.updateStarted=e})),_.cc(),_.cc(),_.dc(18,"mat-tab",6),_.qc(19,"translate"),_.Yb(20,"app-archive-unit-rules-details-tab",10),_.cc(),_.dc(21,"mat-tab",6),_.qc(22,"translate"),_.Yb(23,"app-collect-object-group-details-tab",10),_.cc(),_.cc(),_.cc()),2&e&&(_.vc("extended",t.isPanelextended)("title",_.sc(1,24,_.sc(2,27,t.archiveUnit,"Title"),29))("icon",t.getArchiveUnitIcon(t.archiveUnit))("hasToolTipOnTitle",!0)("toolTipTitleText",_.sc(3,30,t.archiveUnit,"Title"))("toolTipTitleDuration",300),_.Lb(4),_.vc("overlayPos","end")("icon","vitamui-icon-more-horiz"),_.Lb(1),_.wc("matTooltip",t.accessContractAllowUpdating?"":t.hasAccessContractManagementPermissionsMessage),_.vc("matTooltipShowDelay",300)("disabled",t.updateStarted||!t.accessContractAllowUpdating||!t.hasUpdateDescriptiveUnitMetadataRole),_.Lb(1),_.Xc(" ",_.rc(7,33,"UNIT_UPDATE.UPDATE_DESC_METADATA")," "),_.Lb(3),_.vc("selectedIndex",t.selectedIndex)("ngClass",t.isPanelextended?"extended-preview-tab-group":"preview-tab-group"),_.Lb(2),_.wc("label",_.rc(12,35,"COLLECT.ARCHIVE_UNIT_PREVIEW.TABS.INFORMATIONS")),_.Lb(2),_.vc("archiveUnit",t.archiveUnit),_.Lb(1),_.wc("label",_.rc(15,37,"TAB.DESCRIPTION")),_.Lb(2),_.vc("archiveUnit",t.archiveUnit)("editMode",t.updateStarted)("transactionId",t.transactionId),_.Lb(2),_.wc("label",_.rc(19,39,"COLLECT.ARCHIVE_UNIT_PREVIEW.TABS.RULES")),_.Lb(2),_.vc("archiveUnit",t.archiveUnit),_.Lb(1),_.wc("label",_.rc(22,41,"COLLECT.ARCHIVE_UNIT_PREVIEW.TABS.OBJECTS")),_.Lb(2),_.vc("archiveUnit",t.archiveUnit))},directives:[C.Ub,C.Eb,Ce.a,he.a,u.b,c.n,u.a,zt,Yt,Li,Hi],pipes:[C.Yb,C.jb,O.d],styles:[".download-btn[_ngcontent-%COMP%]{border-radius:100px;color:#fff;font-size:14px;font-weight:700;margin:20px 20px 20px 120px}.btn-show-full-path[_ngcontent-%COMP%]{border:1px solid var(--vitamui-grey);border-radius:10px;font-size:10px}.btn-show-full-path[_ngcontent-%COMP%]:hover{background-color:var(--vitamui-grey-400);cursor:pointer}.margin-btn[_ngcontent-%COMP%]{margin-right:300px}"]}),e})(),Wi=(()=>{class e{constructor(e,t,i){this.formBuilder=e,this.archiveExchangeDataService=t,this.dialog=i,this.emptyTitleDescriptionCriteriaForm={archiveCriteria:""},this.previousTitleDescriptionCriteriaValue={archiveCriteria:""},this.quickSearchCriteriaForm=this.formBuilder.group({archiveCriteria:["",[]]}),Object(I.a)(this.quickSearchCriteriaForm.statusChanges,this.quickSearchCriteriaForm.valueChanges).pipe(Object(L.a)(me.UPDATE_DEBOUNCE_TIME),Object(Pt.a)(()=>this.quickSearchCriteriaForm.valid),Object(b.a)(()=>this.quickSearchCriteriaForm.value),Object(b.a)(()=>Object(C.sb)(this.quickSearchCriteriaForm.value,this.previousTitleDescriptionCriteriaValue)),Object(Pt.a)(e=>this.isEmpty(e))).subscribe(()=>{this.resetSimpleCriteriaForm()})}isEmpty(e){return!!e&&!!e.archiveCriteria&&(this.addCriteria("TITLE_OR_DESCRIPTION",{value:e.archiveCriteria.trim(),id:e.archiveCriteria.trim()},e.archiveCriteria.trim(),!0,C.v.EQ,!1),!0)}resetSimpleCriteriaForm(){this.quickSearchCriteriaForm.reset(this.emptyTitleDescriptionCriteriaForm)}ngOnInit(){}addCriteria(e,t,i,c,a,r){e&&t&&this.archiveExchangeDataService.addSimpleSearchCriteriaSubject({keyElt:e,valueElt:t,labelElt:i,keyTranslated:c,operator:a,category:C.Z.FIELDS,valueTranslated:r,dataType:C.u.STRING})}get archiveCriteria(){return this.quickSearchCriteriaForm.controls.archiveCriteria}}return e.\u0275fac=function(t){return new(t||e)(_.Xb(a.e),_.Xb(de),_.Xb(n.b))},e.\u0275cmp=_.Rb({type:e,selectors:[["app-title-and-description-criteria-search-collect"]],decls:3,vars:5,consts:[[3,"formGroup"],["formControlName","archiveCriteria",3,"validator","label"]],template:function(e,t){if(1&e&&(_.dc(0,"form",0),_.Yb(1,"vitamui-common-editable-input",1),_.qc(2,"translate"),_.cc()),2&e){var i=null;_.vc("formGroup",t.quickSearchCriteriaForm),_.Lb(1),_.wc("label",_.rc(2,3,"COLLECT.TITLE_SEARCH_AREA")),_.vc("validator",null==t.quickSearchCriteriaForm||null==(i=t.quickSearchCriteriaForm.get("archiveCriteria"))?null:i.validator)}},directives:[a.x,a.q,a.i,C.C,a.p,a.h],pipes:[O.d],encapsulation:2}),e})();function ji(e,t){if(1&e&&(_.dc(0,"vitamui-common-confirm-dialog",1),_.qc(1,"translate"),_.dc(2,"h5"),_.Vc(3),_.qc(4,"translate"),_.cc(),_.dc(5,"strong"),_.Vc(6),_.qc(7,"date"),_.cc(),_.cc()),2&e){const e=_.pc();_.yc("dialogTitle","",_.rc(1,5,"COLLECT.SEARCH_CRITERIA_SAVER.SAVE_DELETE_CRITERIA_LABEL")," ",e.objectType,""),_.Lb(3),_.Wc(_.rc(4,7,"COLLECT.SEARCH_CRITERIA_SAVER.SAVE_DELETE_CRITERIA_MESSGE")),_.Lb(3),_.Yc(" ",e.objectName," - ",_.sc(7,9,e.objectDate,"dd/MM/yyyy"),"")}}let Yi=(()=>{class e{constructor(){this.dialogType="delete"}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=_.Rb({type:e,selectors:[["vitamui-confirm-action"]],inputs:{dialogType:"dialogType",objectName:"objectName",objectType:"objectType",objectDate:"objectDate"},decls:3,vars:5,consts:[["confirmLabel","CONFIRMER","cancelLabel","ANNULER",3,"dialogTitle",4,"ngIf"],["confirmLabel","CONFIRMER","cancelLabel","ANNULER",3,"dialogTitle"]],template:function(e,t){1&e&&(_.Vc(0),_.qc(1,"date"),_.Tc(2,ji,8,12,"vitamui-common-confirm-dialog",0)),2&e&&(_.Xc("",_.sc(1,2,t.objectDate,"dd/MM/yyyy"),"\n"),_.Lb(2),_.vc("ngIf","delete"===t.dialogType))},directives:[c.p,C.r],pipes:[c.e,O.d],encapsulation:2}),e})();function Xi(e,t){if(1&e){const e=_.ec();_.bc(0),_.dc(1,"button",4),_.lc("click",(function(){_.Kc(e);const i=t.$implicit;return _.pc().storedSearchCriteriaHistory.emit(i)})),_.dc(2,"div",5),_.dc(3,"div",6),_.dc(4,"span",7),_.Vc(5),_.qc(6,"truncate"),_.cc(),_.Vc(7," - "),_.dc(8,"span",8),_.Vc(9),_.qc(10,"dateTime"),_.cc(),_.cc(),_.dc(11,"div"),_.dc(12,"i",9),_.lc("click",(function(){_.Kc(e);const i=t.$implicit;return _.pc().deleteSearchCriteriaHistory(i)})),_.Vc(13,"delete"),_.cc(),_.cc(),_.cc(),_.cc(),_.ac()}if(2&e){const e=t.$implicit;_.Lb(1),_.wc("matTooltip",e.name),_.vc("matTooltipShowDelay",300),_.Lb(4),_.Wc(_.sc(6,4,e.name,30)),_.Lb(4),_.Wc(_.sc(10,7,e.savingDate,"dd/MM/yyyy"))}}function Ki(e,t){1&e&&(_.dc(0,"button",10),_.Vc(1),_.qc(2,"translate"),_.cc()),2&e&&(_.Lb(1),_.Xc(" ",_.rc(2,1,"COLLECT.SEARCH_CRITERIA_SAVER.NO_RESULTS")," "))}function zi(e,t){1&e&&(_.dc(0,"div",11),_.Yb(1,"mat-spinner",12),_.cc())}let $i=(()=>{class e{constructor(e,t,i,c,a){this.searchCriteriaSaverService=e,this.archiveSharedDataService=t,this.dialog=i,this.snackBar=c,this.translateService=a,this.storedSearchCriteriaHistory=new _.p,this.orderChange=new p.a,this.direction=C.z.ASCENDANT,this.pending=!1}ngOnInit(){this.subscriptionSearchCriteriaHistory=this.archiveSharedDataService.getSearchCriteriaHistoryShared().subscribe(e=>{e&&(this.searchCriteriaHistory.push(e),this.archiveSharedDataService.sort(C.z.ASCENDANT,this.searchCriteriaHistory))}),this.getSearchCriteriaHistory(),this.direction=C.z.ASCENDANT}emitOrderChange(){this.orderChange.next()}getSearchCriteriaHistory(){this.pending=!0,this.searchCriteriaSaverService.getSearchCriteriaHistory().subscribe(e=>{this.searchCriteriaHistory=e,this.archiveSharedDataService.sort(C.z.ASCENDANT,this.searchCriteriaHistory),this.archiveSharedDataService.emitAllSearchCriteriaHistory(e),this.pending=!1})}deleteSearchCriteriaHistory(e){const t=this.dialog.open(Yi,{panelClass:"vitamui-confirm-dialog"});t.componentInstance.objectType=this.translateService.instant("COLLECT.SEARCH_CRITERIA_SAVER.OBJECT_TYPE"),t.componentInstance.objectName=e.name,t.componentInstance.objectDate=e.savingDate,t.afterClosed().pipe(Object(Pt.a)(e=>!!e)).subscribe(()=>{this.searchCriteriaSaverService.deleteSearchCriteriaHistory(e.id).subscribe(()=>{this.clearElement(e.id),this.snackBar.openFromComponent(ne,{panelClass:"vitamui-snack-bar",data:{type:"searchCriteriaHistoryDeleted",name:e.name},duration:1e4})})})}clearElement(e){for(let t=0;t<this.searchCriteriaHistory.length;t++)this.searchCriteriaHistory[t].id===e&&this.searchCriteriaHistory.splice(t,1)}}return e.\u0275fac=function(t){return new(t||e)(_.Xb(ue),_.Xb(de),_.Xb(n.b),_.Xb(le),_.Xb(O.e))},e.\u0275cmp=_.Rb({type:e,selectors:[["app-search-criteria-list"]],outputs:{storedSearchCriteriaHistory:"storedSearchCriteriaHistory"},decls:4,vars:3,consts:[[1,"list-div"],[4,"ngFor","ngForOf"],["mat-menu-item","",4,"ngIf"],["class","center-spinner",4,"ngIf"],["mat-menu-item","","matTooltipClass","vitamui-tooltip",3,"matTooltip","matTooltipShowDelay","click"],[1,"grid-container"],[1,"criteria-name-date"],[1,"criteria-name"],[1,"criteria-date"],[1,"material-icons","btn-delete",3,"click"],["mat-menu-item",""],[1,"center-spinner"],["diameter","50","color","accent"]],template:function(e,t){1&e&&(_.dc(0,"div",0),_.Tc(1,Xi,14,10,"ng-container",1),_.Tc(2,Ki,3,3,"button",2),_.Tc(3,zi,2,0,"div",3),_.cc()),2&e&&(_.Lb(1),_.vc("ngForOf",t.searchCriteriaHistory),_.Lb(1),_.vc("ngIf",void 0!==t.searchCriteriaHistory&&0===t.searchCriteriaHistory.length),_.Lb(1),_.vc("ngIf",t.pending))},directives:[c.o,c.p,Ce.a,he.a,l.b],pipes:[C.Yb,C.Vb,O.d],styles:[".center-spinner[_ngcontent-%COMP%]{text-align:-webkit-center}.btn-delete[_ngcontent-%COMP%]{color:#bdbdbd;float:right;padding-top:9px;font-size:30px}.btn-delete[_ngcontent-%COMP%]:hover{color:#9c31b5}.list-div[_ngcontent-%COMP%]{max-width:380px}.grid-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;grid-gap:1px}.criteria-name-date[_ngcontent-%COMP%]{width:320px}.criteria-date[_ngcontent-%COMP%]{font-size:13px;line-height:16px;align-items:center;letter-spacing:-.2px;color:#757575}.criteria-name[_ngcontent-%COMP%]{font-family:Mulish;font-style:normal;font-weight:400;font-size:15px;line-height:22px;align-items:center;letter-spacing:.1px;color:#212121}"]}),e})(),Zi=(()=>{class e{constructor(e){this.ruleApiService=e,this.accessContract=new v.a(""),this.selectedItems=new v.a(0),this.criteriaSearchListToSave=new v.a([]),this.criteriaSearchDSLQuery=new v.a(null),this.ruleActions=new v.a([]),this.ruleCategory=new v.a(""),this.managementRules=new v.a([]),this.hasExactCount=new v.a(!1),this.selectedItem=this.selectedItems.asObservable(),this.allCriteriaSearchListToSave=this.criteriaSearchListToSave.asObservable(),this.allCriteriaSearchDSLQuery=this.criteriaSearchDSLQuery.asObservable(),this.allRuleActions=this.ruleActions.asObservable(),this.allManagementRules=this.managementRules.asObservable(),this.hasExactCounts=this.hasExactCount.asObservable()}emitRuleCategory(e){this.ruleCategory.next(e)}getRuleCategory(){return this.ruleCategory.asObservable()}emitAccessContract(e){this.accessContract.next(e)}getAccessContract(){return this.accessContract.asObservable()}emitselectedItems(e){this.selectedItems.next(e)}getselectedItems(){return this.selectedItems.asObservable()}emitCriteriaSearchListToSave(e){this.criteriaSearchListToSave.next(e)}getCriteriaSearchListToSave(){return this.criteriaSearchListToSave.asObservable()}emitCriteriaSearchDSLQuery(e){this.criteriaSearchDSLQuery.next(e)}getCriteriaSearchDSLQuery(){return this.criteriaSearchDSLQuery.asObservable()}emitRuleActions(e){this.ruleActions.next(e)}getRuleActions(){return this.ruleActions.asObservable()}emitManagementRules(e){this.managementRules.next(e)}getManagementRules(){return this.managementRules.asObservable()}emitHasExactCount(e){this.hasExactCount.next(e)}getHasExactCount(){return this.hasExactCount.asObservable()}existsProperties(e){const t=new S.g,i={};return e.ruleId&&(i.ruleId=e.ruleId),e.ruleType&&(i.ruleType=e.ruleType),this.ruleApiService.check(i,t)}}return e.\u0275fac=function(t){return new(t||e)(_.ic(C.V))},e.\u0275prov=_.Tb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Qi=i("mFH5");function Ji(e,t){if(1&e){const e=_.ec();_.dc(0,"span",35),_.lc("click",(function(){return _.Kc(e),_.pc(),_.Gc(32).open()})),_.Vc(1),_.qc(2,"translate"),_.cc()}2&e&&(_.Lb(1),_.Wc(_.rc(2,1,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.START_DATE_SEARCH")))}function ec(e,t){if(1&e){const e=_.ec();_.dc(0,"span",36),_.lc("click",(function(){return _.Kc(e),_.pc(),_.Gc(32).open()})),_.Vc(1),_.qc(2,"dateTime"),_.cc()}if(2&e){const e=_.pc();_.Lb(1),_.Xc("",_.sc(2,1,e.simpleCriteriaForm.get("beginDt").value,"dd/MM/yyyy")," ")}}function tc(e,t){if(1&e){const e=_.ec();_.dc(0,"span",35),_.lc("click",(function(){return _.Kc(e),_.pc(),_.Gc(40).open()})),_.Vc(1),_.qc(2,"translate"),_.cc()}2&e&&(_.Lb(1),_.Wc(_.rc(2,1,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.END_DATE_SEARCH")))}function ic(e,t){if(1&e){const e=_.ec();_.dc(0,"span",36),_.lc("click",(function(){return _.Kc(e),_.pc(),_.Gc(40).open()})),_.Vc(1),_.qc(2,"dateTime"),_.cc()}if(2&e){const e=_.pc();_.Lb(1),_.Xc("",_.sc(2,1,e.simpleCriteriaForm.get("endDt").value,"dd/MM/yyyy")," ")}}function cc(e,t){if(1&e&&(_.bc(0),_.dc(1,"mat-option",37),_.Vc(2),_.cc(),_.ac()),2&e){const e=t.$implicit;_.Lb(1),_.wc("value",e.ApiField),_.wc("matTooltip",e.ShortName),_.vc("matTooltipShowDelay",300),_.Lb(1),_.Xc("",e.Identifier," ")}}function ac(e,t){if(1&e&&_.Yb(0,"vitamui-common-editable-input",38),2&e){const e=_.pc();var i=null;_.wc("label",e.selectedValueOntolonogy),_.vc("validator",null==e.simpleCriteriaForm||null==(i=e.simpleCriteriaForm.get("otherCriteriaValue"))?null:i.validator)}}function rc(e,t){if(1&e){const e=_.ec();_.dc(0,"span",35),_.lc("click",(function(){return _.Kc(e),_.pc(),_.Gc(6).open()})),_.Vc(1),_.cc()}if(2&e){const e=_.pc(2);_.Lb(1),_.Wc(e.selectedValueOntolonogy)}}function nc(e,t){if(1&e){const e=_.ec();_.dc(0,"span",36),_.lc("click",(function(){return _.Kc(e),_.pc(),_.Gc(6).open()})),_.Vc(1),_.qc(2,"dateTime"),_.cc()}if(2&e){const e=_.pc(2);_.Lb(1),_.Xc("",_.sc(2,1,e.simpleCriteriaForm.get("otherCriteriaValue").value,"dd/MM/yyyy")," ")}}function sc(e,t){if(1&e){const e=_.ec();_.dc(0,"div",13),_.lc("click",(function(){return _.Kc(e),_.Gc(6).open()})),_.Tc(1,rc,2,1,"span",14),_.Tc(2,nc,3,4,"ng-template",null,39,_.Uc),_.Yb(4,"input",40),_.Yb(5,"mat-datepicker",null,41),_.cc()}if(2&e){const e=_.Gc(3),t=_.Gc(6),i=_.pc();_.Lb(1),_.vc("ngIf",!i.simpleCriteriaForm.get("otherCriteriaValue").value)("ngIfElse",e),_.Lb(3),_.vc("matDatepicker",t)("min",i.simpleCriteriaForm.get("otherCriteriaValue").value)}}const lc=function(){return{"margin-right":"50%"}},oc=function(){return{"margin-top":"10px"}};let dc=(()=>{class e{constructor(e,t,i,c,r,n,s){this.formBuilder=e,this.archiveCollectService=t,this.archiveExchangeDataService=i,this.dialog=c,this.managementRulesSharedDataService=r,this.translateService=n,this.ontologyService=s,this.otherCriteriaValueEnabled=!1,this.otherCriteriaValueType="DATE",this.ontologies=[],this.criteriaSearchListToSave=[],this.emptySimpleCriteriaForm={title:"",identifier:"",description:"",guid:"",beginDt:"",endDt:"",serviceProdLabel:"",serviceProdCode:"",otherCriteria:"",otherCriteriaValue:""},this.archiveUnitTypesCriteria=new Map([["ARCHIVE_UNIT_WITH_OBJECTS",!0],["ARCHIVE_UNIT_WITHOUT_OBJECTS",!0]]),this.ontologyService.getInternalOntologyFieldsList().subscribe(e=>{this.ontologies.push(...e),this.ontologies.sort((e,t)=>{const i=e.Identifier,c=t.Identifier;return i<c?-1:i>c?1:0})}),this.archiveCollectService.getExternalOntologiesList().subscribe(e=>{this.ontologies.push(...e)}),this.translateService.onLangChange.subscribe(()=>{this.archiveUnitTypesCriteria.get("ARCHIVE_UNIT_WITH_OBJECTS")&&this.manageUnitObjectUnitCriteria("ARCHIVE_UNIT_WITH_OBJECTS"),this.archiveUnitTypesCriteria.get("ARCHIVE_UNIT_WITHOUT_OBJECTS")&&this.manageUnitObjectUnitCriteria("ARCHIVE_UNIT_WITHOUT_OBJECTS")}),this.previousSimpleCriteriaValue={title:"",identifier:"",description:"",guid:"",beginDt:"",endDt:"",serviceProdLabel:"",serviceProdCode:"",otherCriteria:"",otherCriteriaValue:""},this.simpleCriteriaForm=this.formBuilder.group({title:["",[]],description:["",[]],guid:["",[a.w.pattern("^[a-z0-9_, ]+")]],beginDt:["",[]],endDt:["",[]],serviceProdLabel:["",[]],serviceProdCode:["",[]],otherCriteria:["",[]],otherCriteriaValue:["",[]]}),Object(I.a)(this.simpleCriteriaForm.statusChanges,this.simpleCriteriaForm.valueChanges).pipe(Object(L.a)(me.UPDATE_DEBOUNCE_TIME),Object(Pt.a)(()=>this.simpleCriteriaForm.valid),Object(b.a)(()=>this.simpleCriteriaForm.value),Object(b.a)(()=>Object(C.sb)(this.simpleCriteriaForm.value,this.previousSimpleCriteriaValue)),Object(Pt.a)(e=>this.isEmpty(e))).subscribe(()=>{this.resetSimpleCriteriaForm()}),this.archiveExchangeDataService.receiveRemoveFromChildSearchCriteriaSubject().subscribe(e=>{e&&(e.action===C.d.ADD?this.archiveUnitTypesCriteria.set(e.valueElt.id,!0):e.action===C.d.REMOVE&&this.archiveUnitTypesCriteria.set(e.valueElt.id,!1))})}isEmpty(e){if(e){if(e.title)return this.addCriteria("TITLE",{value:e.title.trim(),id:e.title.trim()},e.title.trim(),!0,C.v.EQ,!1,C.u.STRING),!0;if(e.description)return this.addCriteria("DESCRIPTION",{value:e.description.trim(),id:e.description.trim()},e.description.trim(),!0,C.v.EQ,!1,C.u.STRING),!0;if(e.beginDt)return this.addCriteria("START_DATE",{value:this.simpleCriteriaForm.value.beginDt,id:this.simpleCriteriaForm.value.beginDt},this.simpleCriteriaForm.value.beginDt,!0,C.v.GTE,!1,C.u.DATE),!0;if(e.endDt)return this.addCriteria("END_DATE",{value:this.simpleCriteriaForm.value.endDt,id:this.simpleCriteriaForm.value.endDt},this.simpleCriteriaForm.value.endDt,!0,C.v.LTE,!1,C.u.DATE),!0;if(e.serviceProdCode)return this.addCriteria("SP_CODE",{value:e.serviceProdCode.trim(),id:e.serviceProdCode.trim()},e.serviceProdCode.trim(),!0,C.v.EQ,!1,C.u.STRING),!0;if(e.serviceProdLabel)return this.addCriteria("SP_LABEL",{value:e.serviceProdLabel.trim(),id:e.serviceProdLabel.trim()},e.serviceProdLabel.trim(),!0,C.v.EQ,!1,C.u.STRING),!0;if(e.guid)return e.guid.split(",").forEach(e=>{e&&""!==e.trim()&&this.addCriteria("GUID",{value:e.trim(),id:e.trim()},e.trim(),!0,C.v.EQ,!1,C.u.STRING)}),!0;if(e.otherCriteriaValue){const t=this.ontologies.find(t=>t.ApiField===e.otherCriteria);return this.otherCriteriaValueType===C.u.DATE?this.addCriteria(t.ApiField,{value:this.simpleCriteriaForm.value.otherCriteriaValue,id:this.simpleCriteriaForm.value.otherCriteriaValue},this.simpleCriteriaForm.value.otherCriteriaValue,!1,C.v.EQ,!1,C.u.DATE):this.addCriteria(t.ApiField,{value:e.otherCriteriaValue.trim(),id:e.otherCriteriaValue.trim()},e.otherCriteriaValue.trim(),!1,C.v.EQ,!1,C.u.STRING),!0}return!1}return!1}resetSimpleCriteriaForm(){this.simpleCriteriaForm.reset(this.emptySimpleCriteriaForm)}isValueTranslated(e){return"FINAL_ACTION_TYPE"===e||"ALL_ARCHIVE_UNIT_TYPES"===e}ngOnInit(){this.managementRulesSharedDataService.getCriteriaSearchListToSave().subscribe(e=>{this.criteriaSearchListToSave=e}),this.criteriaSearchListToSave.forEach(e=>{"ALL_ARCHIVE_UNIT_TYPES"===e.criteria&&e.values.forEach(e=>{this.archiveUnitTypesCriteria.set(e.id,!0)}),e.values.forEach(t=>{this.addCriteria(e.criteria,t,t.id,!0,e.operator,this.isValueTranslated(e.criteria),e.dataType,e.category)})}),0===this.criteriaSearchListToSave.length&&(this.addCriteria("ALL_ARCHIVE_UNIT_TYPES",{value:"ARCHIVE_UNIT_WITH_OBJECTS",id:"ARCHIVE_UNIT_WITH_OBJECTS"},this.translateService.instant("COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.UNIT_TYPE.ARCHIVE_UNIT_WITH_OBJECTS"),!0,C.v.EQ,!1,C.u.STRING,C.Z.FIELDS),this.addCriteria("ALL_ARCHIVE_UNIT_TYPES",{value:"ARCHIVE_UNIT_WITHOUT_OBJECTS",id:"ARCHIVE_UNIT_WITHOUT_OBJECTS"},this.translateService.instant("COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.UNIT_TYPE.ARCHIVE_UNIT_WITHOUT_OBJECTS"),!0,C.v.EQ,!1,C.u.STRING,C.Z.FIELDS))}onSelectOtherCriteria(){this.simpleCriteriaForm.get("otherCriteria").valueChanges.subscribe(e=>{if(""===e)this.otherCriteriaValueEnabled=!1,this.selectedValueOntolonogy=null;else{this.simpleCriteriaForm.controls.otherCriteriaValue.setValue(""),this.otherCriteriaValueEnabled=!0;const e=this.simpleCriteriaForm.get("otherCriteria").value,t=this.ontologies.find(t=>t.ApiField===e);t&&(this.selectedValueOntolonogy=t.Identifier,this.otherCriteriaValueType=t.Type)}})}addCriteria(e,t,i,c,a,r,n,s){e&&t&&this.archiveExchangeDataService.addSimpleSearchCriteriaSubject({keyElt:e,valueElt:t,labelElt:i,keyTranslated:c,operator:a,category:s||C.Z.FIELDS,valueTranslated:r,dataType:n})}addArchiveUnitTypeCriteria(e,t){const i=t.target.checked;switch(this.archiveUnitTypesCriteria.set(e,i),e){case"ARCHIVE_UNIT_WITH_OBJECTS":i?this.addCriteria("ALL_ARCHIVE_UNIT_TYPES",{value:"ARCHIVE_UNIT_WITH_OBJECTS",id:"ARCHIVE_UNIT_WITH_OBJECTS"},this.translateService.instant("COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.UNIT_TYPE.ARCHIVE_UNIT_WITH_OBJECTS"),!0,C.v.EQ,!1,C.u.STRING,C.Z.FIELDS):this.emitRemoveCriteriaEvent("ALL_ARCHIVE_UNIT_TYPES",{value:"ARCHIVE_UNIT_WITH_OBJECTS",id:"ARCHIVE_UNIT_WITH_OBJECTS"});break;case"ARCHIVE_UNIT_WITHOUT_OBJECTS":i?this.addCriteria("ALL_ARCHIVE_UNIT_TYPES",{value:"ARCHIVE_UNIT_WITHOUT_OBJECTS",id:"ARCHIVE_UNIT_WITHOUT_OBJECTS"},this.translateService.instant("COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.UNIT_TYPE.ARCHIVE_UNIT_WITHOUT_OBJECTS"),!0,C.v.EQ,!1,C.u.STRING,C.Z.FIELDS):this.emitRemoveCriteriaEvent("ALL_ARCHIVE_UNIT_TYPES",{value:"ARCHIVE_UNIT_WITHOUT_OBJECTS",id:"ARCHIVE_UNIT_WITHOUT_OBJECTS"})}}emitRemoveCriteriaEvent(e,t){this.archiveExchangeDataService.sendRemoveFromChildSearchCriteriaAction({keyElt:e,valueElt:t,action:C.d.REMOVE})}manageUnitObjectUnitCriteria(e){this.emitRemoveCriteriaEvent("ALL_ARCHIVE_UNIT_TYPES",{value:e,id:e}),this.addCriteria("ALL_ARCHIVE_UNIT_TYPES",{value:e,id:e},this.translateService.instant("COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.UNIT_TYPE."+e),!0,C.v.EQ,!1,C.u.STRING,C.Z.FIELDS),this.archiveUnitTypesCriteria.set(e,!0)}get guid(){return this.simpleCriteriaForm.controls.guid}get archiveCriteria(){return this.simpleCriteriaForm.controls.archiveCriteria}get title(){return this.simpleCriteriaForm.controls.title}get description(){return this.simpleCriteriaForm.controls.description}get beginDt(){return this.simpleCriteriaForm.controls.beginDt}get endDt(){return this.simpleCriteriaForm.controls.endDt}get serviceProdLabel(){return this.simpleCriteriaForm.controls.serviceProdLabel}get serviceProdCode(){return this.simpleCriteriaForm.controls.serviceProdCode}get otherCriteria(){return this.simpleCriteriaForm.controls.otherCriteria}get otherCriteriaValue(){return this.simpleCriteriaForm.controls.otherCriteriaValue}}return e.\u0275fac=function(t){return new(t||e)(_.Xb(a.e),_.Xb($),_.Xb(de),_.Xb(n.b),_.Xb(Zi),_.Xb(O.e),_.Xb(C.R))},e.\u0275cmp=_.Rb({type:e,selectors:[["app-simple-criteria-search"]],decls:87,vars:55,consts:[[1,"container"],[3,"formGroup"],[1,"row"],[1,"col-11"],[1,"row","justify-content-around","margin-row"],[1,"col-6","form-control"],["formControlName","title",3,"validator","label"],["formControlName","description",3,"validator","label"],[1,"col-6","form-control",3,"ngStyle"],["formControlName","guid",3,"validator","label"],["matTooltipClass","vitamui-tooltip",1,"vitamui-icon","vitamui-icon-info-circle","vitamui-row-icon","icon-information",3,"matTooltip","matTooltipShowDelay"],[1,"title-text"],[1,"row","justify-content-around","margin-row","margin-bottom"],[1,"vitamui-input",3,"click"],["class","search-date-label",3,"click",4,"ngIf","ngIfElse"],["showBeginDt",""],["size","0","formControlName","beginDt",1,"hidden",3,"matDatepicker","min"],["pickerBegin",""],["showEndDt",""],["size","0","formControlName","endDt",1,"hidden",3,"matDatepicker","min"],["pickerEnd",""],[1,"row","padding-row"],[1,"criteria-checkbox-choice"],["type","checkbox",3,"checked","click"],[1,"vitamui-icon","vitamui-icon-file","vitamui-row-icon","status-badge","icon-large"],[1,"vitamui-icon","vitamui-icon-folder","vitamui-row-icon","status-badge","icon-large"],[1,"vitamui-mat-select","search-input-criteria"],["formControlName","otherCriteria",2,"font-size","14px","font-weight","700","color","var(--vitamui-primary)",3,"placeholder","valueChange"],["value","",2,"font-size","14px","font-weight","700","color","var(--vitamui-primary)"],[4,"ngFor","ngForOf"],[1,"select-arrow"],[1,"vitamui-icon","vitamui-icon-search","vitamui-row-icon"],[1,"material-icons"],["formControlName","otherCriteriaValue",3,"validator","label",4,"ngIf"],["class","vitamui-input",3,"click",4,"ngIf"],[1,"search-date-label",3,"click"],[3,"click"],["matTooltipClass","vitamui-tooltip",2,"font-size","14px","font-weight","700","color","var(--vitamui-primary)",3,"value","matTooltip","matTooltipShowDelay"],["formControlName","otherCriteriaValue",3,"validator","label"],["showOtherCriteria",""],["size","0","formControlName","otherCriteriaValue",1,"hidden",3,"matDatepicker","min"],["pickerOtherCriteria",""]],template:function(e,t){if(1&e){const e=_.ec();_.dc(0,"div",0),_.dc(1,"form",1),_.dc(2,"div",2),_.dc(3,"div",3),_.dc(4,"div",4),_.dc(5,"div",5),_.Yb(6,"vitamui-common-editable-input",6),_.qc(7,"translate"),_.cc(),_.dc(8,"div",5),_.Yb(9,"vitamui-common-editable-input",7),_.qc(10,"translate"),_.cc(),_.cc(),_.dc(11,"div",4),_.dc(12,"div",8),_.Yb(13,"vitamui-common-editable-input",9),_.qc(14,"translate"),_.Yb(15,"i",10),_.qc(16,"translate"),_.cc(),_.Yb(17,"div",5),_.cc(),_.dc(18,"div",4),_.dc(19,"div",5),_.dc(20,"p",11),_.Vc(21),_.qc(22,"translate"),_.cc(),_.cc(),_.Yb(23,"div",5),_.cc(),_.dc(24,"div",12),_.dc(25,"div",5),_.dc(26,"div",13),_.lc("click",(function(){return _.Kc(e),_.Gc(32).open()})),_.Tc(27,Ji,3,3,"span",14),_.Tc(28,ec,3,4,"ng-template",null,15,_.Uc),_.Yb(30,"input",16),_.Yb(31,"mat-datepicker",null,17),_.cc(),_.cc(),_.dc(33,"div",5),_.dc(34,"div",13),_.lc("click",(function(){return _.Kc(e),_.Gc(40).open()})),_.Tc(35,tc,3,3,"span",14),_.Tc(36,ic,3,4,"ng-template",null,18,_.Uc),_.Yb(38,"input",19),_.Yb(39,"mat-datepicker",null,20),_.cc(),_.cc(),_.cc(),_.dc(41,"div",4),_.dc(42,"div",5),_.dc(43,"p",11),_.Vc(44),_.qc(45,"translate"),_.cc(),_.cc(),_.dc(46,"div",5),_.dc(47,"p",11),_.Vc(48),_.qc(49,"translate"),_.cc(),_.cc(),_.cc(),_.dc(50,"div",4),_.dc(51,"div",5),_.dc(52,"div",21),_.dc(53,"label",22),_.dc(54,"input",23),_.lc("click",(function(e){return t.addArchiveUnitTypeCriteria("ARCHIVE_UNIT_WITH_OBJECTS",e)})),_.cc(),_.dc(55,"span"),_.Vc(56),_.qc(57,"translate"),_.cc(),_.cc(),_.Yb(58,"i",24),_.cc(),_.dc(59,"div",21),_.dc(60,"label",22),_.dc(61,"input",23),_.lc("click",(function(e){return t.addArchiveUnitTypeCriteria("ARCHIVE_UNIT_WITHOUT_OBJECTS",e)})),_.cc(),_.dc(62,"span"),_.Vc(63),_.qc(64,"translate"),_.cc(),_.cc(),_.Yb(65,"i",25),_.cc(),_.cc(),_.dc(66,"div",5),_.dc(67,"mat-form-field",26),_.dc(68,"mat-select",27),_.lc("valueChange",(function(){return t.onSelectOtherCriteria()})),_.qc(69,"translate"),_.dc(70,"mat-option",28),_.Vc(71),_.qc(72,"translate"),_.cc(),_.Tc(73,cc,3,4,"ng-container",29),_.cc(),_.dc(74,"div",30),_.Yb(75,"i",31),_.cc(),_.dc(76,"div",30),_.dc(77,"i",32),_.Vc(78,"keyboard_arrow_up"),_.cc(),_.dc(79,"i",32),_.Vc(80,"keyboard_arrow_down"),_.cc(),_.cc(),_.cc(),_.Yb(81,"br"),_.cc(),_.cc(),_.dc(82,"div",4),_.dc(83,"div",8),_.Tc(84,ac,1,2,"vitamui-common-editable-input",33),_.Tc(85,sc,7,4,"div",34),_.cc(),_.cc(),_.Yb(86,"br"),_.cc(),_.cc(),_.cc(),_.cc()}if(2&e){const e=_.Gc(29),r=_.Gc(32),n=_.Gc(37),s=_.Gc(40);var i=null,c=null,a=null;_.Lb(1),_.vc("formGroup",t.simpleCriteriaForm),_.Lb(5),_.wc("label",_.rc(7,31,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.TITLE")),_.vc("validator",null==t.simpleCriteriaForm||null==(i=t.simpleCriteriaForm.get("title"))?null:i.validator),_.Lb(3),_.wc("label",_.rc(10,33,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.DESCRIPTION")),_.vc("validator",null==t.simpleCriteriaForm||null==(c=t.simpleCriteriaForm.get("description"))?null:c.validator),_.Lb(3),_.vc("ngStyle",_.zc(53,lc)),_.Lb(1),_.wc("label",_.rc(14,35,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.UAID")),_.vc("validator",null==t.simpleCriteriaForm||null==(a=t.simpleCriteriaForm.get("guid"))?null:a.validator),_.Lb(2),_.vc("matTooltip",_.rc(16,37,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.GUIDS_SEPARATED"))("matTooltipShowDelay",300),_.Lb(6),_.Wc(_.rc(22,39,"COLLECT.SEARCH_CRITERIA_FILTER.DATES")),_.Lb(6),_.vc("ngIf",!t.simpleCriteriaForm.get("beginDt").value)("ngIfElse",e),_.Lb(3),_.vc("matDatepicker",r)("min",t.simpleCriteriaForm.get("beginDt").value),_.Lb(5),_.vc("ngIf",!t.simpleCriteriaForm.get("endDt").value)("ngIfElse",n),_.Lb(3),_.vc("matDatepicker",s)("min",t.simpleCriteriaForm.get("endDt").value),_.Lb(6),_.Wc(_.rc(45,41,"COLLECT.SEARCH_CRITERIA_FILTER.UA_TYPE")),_.Lb(4),_.Wc(_.rc(49,43,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.OTHER_FIELD")),_.Lb(6),_.vc("checked",t.archiveUnitTypesCriteria.get("ARCHIVE_UNIT_WITH_OBJECTS")),_.Lb(2),_.Wc(_.rc(57,45,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.UNIT_TYPE.ARCHIVE_UNIT_WITH_OBJECTS")),_.Lb(5),_.vc("checked",t.archiveUnitTypesCriteria.get("ARCHIVE_UNIT_WITHOUT_OBJECTS")),_.Lb(2),_.Wc(_.rc(64,47,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.UNIT_TYPE.ARCHIVE_UNIT_WITHOUT_OBJECTS")),_.Lb(5),_.wc("placeholder",_.rc(69,49,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.OTHER_FIELD")),_.Lb(3),_.Xc(" ",_.rc(72,51,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.SELECT_OTHER_FIELD")," "),_.Lb(2),_.vc("ngForOf",t.ontologies),_.Lb(10),_.vc("ngStyle",_.zc(54,oc)),_.Lb(1),_.vc("ngIf",t.otherCriteriaValueEnabled&&("KEYWORD"===t.otherCriteriaValueType||"TEXT"===t.otherCriteriaValueType||"LONG"===t.otherCriteriaValueType||"DOUBLE"===t.otherCriteriaValueType||"BOOLEAN"===t.otherCriteriaValueType)),_.Lb(1),_.vc("ngIf",t.otherCriteriaValueEnabled&&"DATE"===t.otherCriteriaValueType)}},directives:[a.x,a.q,a.i,C.C,a.p,a.h,c.q,he.a,c.p,a.c,r.b,r.a,s.b,o.a,Qi.n,c.o],pipes:[O.d,C.Vb],styles:[".icon-information[_ngcontent-%COMP%]{position:absolute;float:right;top:15px;right:-45px;width:30px;height:31px;font-size:26px;font-weight:700}.title-text[_ngcontent-%COMP%]{font-style:normal;font-weight:700;font-size:16px;color:var(--vitamui-primary)!important}.margin-row[_ngcontent-%COMP%]{margin-left:10px}.margin-bottom[_ngcontent-%COMP%]{margin-bottom:15px}.padding-row[_ngcontent-%COMP%]{padding-left:13px}.icon-large[_ngcontent-%COMP%]{font-size:larger}"]}),e})();function uc(e,t){if(1&e&&(_.bc(0),_.Vc(1),_.qc(2,"translate"),_.ac()),2&e){const e=_.pc().$implicit,t=_.pc(3);_.Lb(1),_.Xc(" ",(e.keyTranslated?_.rc(2,1,"COLLECT.SEARCH_CRITERIA_FILTER."+t.getCategoryName(t.criteriaVal.category)+"."+t.criteriaVal.key):t.criteriaVal.key)+" : "," ")}}const hc=function(e,t){return[e,t]};function Cc(e,t){if(1&e){const e=_.ec();_.dc(0,"div",8),_.lc("click",(function(){_.Kc(e);const t=_.pc().$implicit,i=_.pc(3);return i.removeCriteria(i.criteriaKey,t.value)})),_.Yb(1,"i",9),_.cc()}if(2&e){const e=_.pc();_.vc("ngClass",_.Bc(1,hc,e.last?"right-arround":"right-button","INCLUDED"===e.$implicit.status?"after-search-launched-button":"before-search-launched-button"))}}function Ec(e,t){if(1&e&&(_.dc(0,"div",10),_.Yb(1,"i",11),_.cc()),2&e){const e=_.pc();_.vc("ngClass",_.Bc(1,hc,e.last?"right-arround":"right-button","INCLUDED"===e.$implicit.status?"after-search-launched-button":"before-search-launched-button"))}}const Rc=function(e){return[e]};function pc(e,t){if(1&e&&(_.bc(0),_.dc(1,"div",12),_.Vc(2),_.qc(3,"translate"),_.cc(),_.ac()),2&e){const e=_.pc().$implicit;_.Lb(1),_.vc("ngClass",_.Ac(4,Rc,"INCLUDED"===e.status?"after-search-launched-button":"before-search-launched-button")),_.Lb(1),_.Xc(" ",_.rc(3,2,"COLLECT.SEARCH_CRITERIA_OR")," ")}}function vc(e,t){if(1&e&&(_.bc(0),_.dc(1,"div",5),_.qc(2,"translate"),_.qc(3,"date"),_.qc(4,"translate"),_.Tc(5,uc,3,3,"ng-container",0),_.Vc(6),_.qc(7,"date"),_.cc(),_.Tc(8,Cc,2,4,"div",6),_.Tc(9,Ec,2,4,"div",7),_.Tc(10,pc,4,6,"ng-container",0),_.ac()),2&e){const e=t.$implicit,i=t.first,c=t.last,a=_.pc(3);_.Lb(1),_.yc("matTooltip","",e.keyTranslated?_.rc(2,9,"COLLECT.SEARCH_CRITERIA_FILTER."+a.getCategoryName(a.criteriaVal.category)+"."+a.criteriaVal.key):a.criteriaVal.key,":","DATE"===a.criteriaVal.dataType?_.sc(3,11,e.value.value,"dd/MM/yyyy"):e.valueTranslated?_.rc(4,14,"COLLECT.SEARCH_CRITERIA_FILTER."+a.getCategoryName(a.criteriaVal.category)+"."+e.label):e.label,""),_.vc("matTooltipShowDelay",300)("ngClass",_.Bc(19,hc,i?"left-arround":"left-not-arround","INCLUDED"===e.status?"after-search-launched-button":"before-search-launched-button")),_.Lb(4),_.vc("ngIf",i),_.Lb(1),_.Xc(" ",_.sc(7,16,e.value.value,"dd/MM/yyyy")," "),_.Lb(2),_.vc("ngIf","IN_PROGRESS"!==e.status),_.Lb(1),_.vc("ngIf","IN_PROGRESS"===e.status),_.Lb(1),_.vc("ngIf",!c)}}function Ic(e,t){if(1&e&&(_.bc(0),_.Tc(1,vc,11,22,"ng-container",4),_.ac()),2&e){const e=_.pc(2);_.Lb(1),_.vc("ngForOf",e.criteriaVal.values)}}function Tc(e,t){if(1&e&&(_.bc(0),_.Vc(1),_.qc(2,"translate"),_.ac()),2&e){const e=_.pc().$implicit,t=_.pc(3);_.Lb(1),_.Xc(" ",(e.keyTranslated?_.rc(2,1,"COLLECT.SEARCH_CRITERIA_FILTER."+t.getCategoryName(t.criteriaVal.category)+"."+t.criteriaVal.key):t.criteriaVal.key)+" : "," ")}}function gc(e,t){if(1&e&&(_.bc(0),_.Vc(1),_.qc(2,"translate"),_.qc(3,"date"),_.qc(4,"translate"),_.qc(5,"date"),_.ac()),2&e){const e=_.pc().$implicit;_.Lb(1),_.ad(" ",_.rc(2,4,"COLLECT.SEARCH_CRITERIA_BETWEEN")," ",_.sc(3,6,e.value.beginInterval,"dd/MM/yyyy")," ",_.rc(4,9,"COLLECT.SEARCH_CRITERIA_AND")," ",_.sc(5,11,e.value.endInterval,"dd/MM/yyyy")," ")}}function Lc(e,t){if(1&e&&(_.bc(0),_.Vc(1),_.qc(2,"translate"),_.qc(3,"date"),_.ac()),2&e){const e=_.pc().$implicit;_.Lb(1),_.Yc(" ",_.rc(2,2,"COLLECT.SEARCH_CRITERIA_GTE")," ",_.sc(3,4,e.value.beginInterval,"dd/MM/yyyy")," ")}}function bc(e,t){if(1&e&&(_.bc(0),_.Vc(1),_.qc(2,"translate"),_.qc(3,"date"),_.ac()),2&e){const e=_.pc().$implicit;_.Lb(1),_.Yc(" ",_.rc(2,2,"COLLECT.SEARCH_CRITERIA_LTE")," ",_.sc(3,4,e.value.endInterval,"dd/MM/yyyy")," ")}}function Ac(e,t){if(1&e){const e=_.ec();_.dc(0,"div",8),_.lc("click",(function(){_.Kc(e);const t=_.pc().$implicit,i=_.pc(3);return i.removeCriteria(i.criteriaKey,t.value)})),_.Yb(1,"i",9),_.cc()}if(2&e){const e=_.pc();_.vc("ngClass",_.Bc(1,hc,e.last?"right-arround":"right-button","INCLUDED"===e.$implicit.status?"after-search-launched-button":"before-search-launched-button"))}}function Sc(e,t){if(1&e&&(_.dc(0,"div",10),_.Yb(1,"i",11),_.cc()),2&e){const e=_.pc();_.vc("ngClass",_.Bc(1,hc,e.last?"right-arround":"right-button","INCLUDED"===e.$implicit.status?"after-search-launched-button":"before-search-launched-button"))}}function _c(e,t){if(1&e&&(_.bc(0),_.dc(1,"div",12),_.Vc(2),_.qc(3,"translate"),_.cc(),_.ac()),2&e){const e=_.pc().$implicit;_.Lb(1),_.vc("ngClass",_.Ac(4,Rc,"INCLUDED"===e.status?"after-search-launched-button":"before-search-launched-button")),_.Lb(1),_.Xc(" ",_.rc(3,2,"COLLECT.SEARCH_CRITERIA_OR")," ")}}function mc(e,t){if(1&e&&(_.bc(0),_.dc(1,"div",5),_.qc(2,"translate"),_.Tc(3,Tc,3,3,"ng-container",0),_.Tc(4,gc,6,14,"ng-container",0),_.Tc(5,Lc,4,7,"ng-container",0),_.Tc(6,bc,4,7,"ng-container",0),_.cc(),_.Tc(7,Ac,2,4,"div",6),_.Tc(8,Sc,2,4,"div",7),_.Tc(9,_c,4,6,"ng-container",0),_.ac()),2&e){const e=t.$implicit,i=t.first,c=t.last,a=_.pc(3);_.Lb(1),_.wc("matTooltip",e.keyTranslated?_.rc(2,10,"COLLECT.SEARCH_CRITERIA_FILTER."+a.getCategoryName(a.criteriaVal.category)+"."+a.criteriaVal.key):a.criteriaVal.key),_.vc("matTooltipShowDelay",300)("ngClass",_.Bc(12,hc,i?"left-arround":"left-not-arround","INCLUDED"===e.status?"after-search-launched-button":"before-search-launched-button")),_.Lb(2),_.vc("ngIf",i),_.Lb(1),_.vc("ngIf",e.value.beginInterval&&e.value.endInterval),_.Lb(1),_.vc("ngIf",e.value.beginInterval&&!e.value.endInterval),_.Lb(1),_.vc("ngIf",!e.value.beginInterval&&e.value.endInterval),_.Lb(1),_.vc("ngIf","IN_PROGRESS"!==e.status),_.Lb(1),_.vc("ngIf","IN_PROGRESS"===e.status),_.Lb(1),_.vc("ngIf",!c)}}function fc(e,t){if(1&e&&(_.bc(0),_.Tc(1,mc,10,15,"ng-container",4),_.ac()),2&e){const e=_.pc(2);_.Lb(1),_.vc("ngForOf",e.criteriaVal.values)}}function Oc(e,t){if(1&e&&(_.bc(0),_.dc(1,"div",5),_.qc(2,"translate"),_.qc(3,"translate"),_.Vc(4),_.qc(5,"translate"),_.qc(6,"translate"),_.cc(),_.ac()),2&e){const e=_.pc(4);_.Lb(1),_.vc("matTooltip",("EQ"===e.criteriaVal.operator?_.rc(2,4,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.GUID_TO_INCLUDE"):_.rc(3,6,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.GUID_TO_EXCLUDE"))+" : "+e.criteriaVal.values[0].label)("matTooltipShowDelay",300)("ngClass",_.Bc(12,hc,e.isFirst?"left-arround":"left-not-arround","INCLUDED"===e.criteriaVal.values[e.criteriaVal.values.length-1].status?"after-search-launched-button":"before-search-launched-button")),_.Lb(3),_.Xc(" ",("EQ"===e.criteriaVal.operator?_.rc(5,8,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.GUID_TO_INCLUDE"):_.rc(6,10,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.GUID_TO_EXCLUDE"))+" : "+e.criteriaVal.values[e.criteriaVal.values.length-1].label," ")}}function Nc(e,t){if(1&e&&(_.bc(0),_.dc(1,"div",5),_.qc(2,"translate"),_.qc(3,"translate"),_.Vc(4),_.qc(5,"translate"),_.qc(6,"translate"),_.cc(),_.ac()),2&e){const e=_.pc(4);_.Lb(1),_.vc("matTooltip",("EQ"===e.criteriaVal.operator?_.rc(2,4,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.GUIDS_TO_INCLUDE"):_.rc(3,6,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.GUIDS_TO_EXCLUDE"))+" : "+e.criteriaVal.values.length)("matTooltipShowDelay",300)("ngClass",_.Bc(12,hc,e.isFirst?"left-arround":"left-not-arround","INCLUDED"===e.criteriaVal.values[e.criteriaVal.values.length-1].status?"after-search-launched-button":"before-search-launched-button")),_.Lb(3),_.Xc(" ",("EQ"===e.criteriaVal.operator?_.rc(5,8,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.GUIDS_TO_INCLUDE"):_.rc(6,10,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.GUIDS_TO_EXCLUDE"))+" : "+e.criteriaVal.values.length," ")}}function Fc(e,t){if(1&e){const e=_.ec();_.dc(0,"div",8),_.lc("click",(function(){_.Kc(e);const t=_.pc(4);return t.removeCriteriaAllValues(t.criteriaKey)})),_.Yb(1,"i",9),_.cc()}if(2&e){const e=_.pc(4);_.vc("ngClass",_.Bc(1,hc,e.isLast?"right-arround":"right-button","INCLUDED"===e.criteriaVal.values[e.criteriaVal.values.length-1].status?"after-search-launched-button":"before-search-launched-button"))}}function Dc(e,t){if(1&e&&(_.dc(0,"div",10),_.Yb(1,"i",11),_.cc()),2&e){const e=_.pc(4);_.vc("ngClass",_.Bc(1,hc,e.isLast?"right-arround":"right-button","INCLUDED"===e.criteriaVal.values[e.criteriaVal.values.length-1].status?"after-search-launched-button":"before-search-launched-button"))}}function Uc(e,t){if(1&e&&(_.bc(0),_.Tc(1,Oc,7,15,"ng-container",0),_.Tc(2,Nc,7,15,"ng-container",0),_.Tc(3,Fc,2,4,"div",6),_.Tc(4,Dc,2,4,"div",7),_.ac()),2&e){const e=_.pc(3);_.Lb(1),_.vc("ngIf",1===e.criteriaVal.values.length),_.Lb(1),_.vc("ngIf",e.criteriaVal.values.length>1),_.Lb(1),_.vc("ngIf","IN_PROGRESS"!==e.criteriaVal.values[e.criteriaVal.values.length-1].status),_.Lb(1),_.vc("ngIf","IN_PROGRESS"===e.criteriaVal.values[e.criteriaVal.values.length-1].status)}}function yc(e,t){1&e&&_.Yb(0,"i",15)}function Pc(e,t){if(1&e&&(_.bc(0),_.Tc(1,yc,1,0,"i",14),_.Vc(2),_.qc(3,"translate"),_.ac()),2&e){const e=_.pc().$implicit,t=_.pc(4);_.Lb(1),_.vc("ngIf","NODE"===t.criteriaKey),_.Lb(1),_.Xc(" ",(e.keyTranslated?_.rc(3,2,"COLLECT.SEARCH_CRITERIA_FILTER."+t.getCategoryName(t.criteriaVal.category)+"."+t.criteriaVal.key):t.criteriaVal.key)+" : "," ")}}function xc(e,t){if(1&e){const e=_.ec();_.dc(0,"div",8),_.lc("click",(function(){_.Kc(e);const t=_.pc().$implicit,i=_.pc(4);return i.removeCriteria(i.criteriaKey,t.value)})),_.Yb(1,"i",9),_.cc()}if(2&e){const e=_.pc();_.vc("ngClass",_.Bc(1,hc,e.last?"right-arround":"right-button","INCLUDED"===e.$implicit.status?"after-search-launched-button":"before-search-launched-button"))}}function kc(e,t){if(1&e&&(_.dc(0,"div",10),_.Yb(1,"i",11),_.cc()),2&e){const e=_.pc();_.vc("ngClass",_.Bc(1,hc,e.last?"right-arround":"right-button","INCLUDED"===e.$implicit.status?"after-search-launched-button":"before-search-launched-button"))}}function Mc(e,t){if(1&e&&(_.dc(0,"div",12),_.Vc(1),_.qc(2,"translate"),_.cc()),2&e){const e=_.pc().$implicit;_.vc("ngClass",_.Ac(4,Rc,"INCLUDED"===e.status?"after-search-launched-button":"before-search-launched-button")),_.Lb(1),_.Xc(" ",_.rc(2,2,"COLLECT.SEARCH_CRITERIA_OR")," ")}}function Vc(e,t){if(1&e&&(_.bc(0),_.dc(1,"div",5),_.qc(2,"translate"),_.qc(3,"translate"),_.Tc(4,Pc,4,4,"ng-container",0),_.Vc(5),_.qc(6,"translate"),_.qc(7,"truncate"),_.cc(),_.Tc(8,xc,2,4,"div",6),_.Tc(9,kc,2,4,"div",7),_.Tc(10,Mc,3,6,"div",13),_.ac()),2&e){const e=t.$implicit,i=t.first,c=t.last,a=_.pc(4);_.Lb(1),_.yc("matTooltip","",e.keyTranslated?_.rc(2,9,"COLLECT.SEARCH_CRITERIA_FILTER."+a.getCategoryName(a.criteriaVal.category)+"."+a.criteriaVal.key):a.criteriaVal.key,":",e.valueTranslated?_.rc(3,11,"COLLECT.SEARCH_CRITERIA_FILTER."+a.getCategoryName(a.criteriaVal.category)+"."+e.label):e.label,""),_.vc("matTooltipShowDelay",300)("ngClass",_.Bc(18,hc,i?"left-arround":"left-not-arround","INCLUDED"===e.status?"after-search-launched-button":"before-search-launched-button")),_.Lb(3),_.vc("ngIf",i),_.Lb(1),_.Xc(" ",e.valueTranslated?_.rc(6,13,"COLLECT.SEARCH_CRITERIA_FILTER."+a.getCategoryName(a.criteriaVal.category)+"."+e.label):_.sc(7,15,e.label,50)," "),_.Lb(3),_.vc("ngIf","IN_PROGRESS"!==e.status),_.Lb(1),_.vc("ngIf","IN_PROGRESS"===e.status),_.Lb(1),_.vc("ngIf",!c)}}function wc(e,t){if(1&e&&(_.bc(0),_.Tc(1,Vc,11,21,"ng-container",4),_.ac()),2&e){const e=_.pc(3);_.Lb(1),_.vc("ngForOf",e.criteriaVal.values)}}function Hc(e,t){if(1&e&&(_.bc(0),_.Tc(1,Uc,5,4,"ng-container",0),_.Tc(2,wc,2,1,"ng-container",0),_.ac()),2&e){const e=_.pc(2);_.Lb(1),_.vc("ngIf","GUID"===e.criteriaVal.key),_.Lb(1),_.vc("ngIf","GUID"!==e.criteriaVal.key)}}function Gc(e,t){if(1&e&&(_.bc(0),_.dc(1,"div",1),_.dc(2,"ul",2),_.dc(3,"li",3),_.Tc(4,Ic,2,1,"ng-container",0),_.Tc(5,fc,2,1,"ng-container",0),_.Tc(6,Hc,3,2,"ng-container",0),_.cc(),_.cc(),_.cc(),_.ac()),2&e){const e=_.pc();_.Lb(4),_.vc("ngIf","DATE"===e.criteriaVal.dataType),_.Lb(1),_.vc("ngIf","INTERVAL"===e.criteriaVal.dataType),_.Lb(1),_.vc("ngIf","STRING"===e.criteriaVal.dataType)}}let qc=(()=>{class e{constructor(){this.criteriaRemoveEvent=new _.p}ngOnInit(){}removeCriteria(e,t){this.criteriaRemoveEvent.emit({keyElt:e,valueElt:t})}getCategoryName(e){return C.Z[e]}removeCriteriaAllValues(e){this.criteriaVal.values.forEach(t=>{this.removeCriteria(e,t.value)})}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=_.Rb({type:e,selectors:[["app-criteria-search"]],inputs:{criteriaKey:"criteriaKey",criteriaVal:"criteriaVal"},outputs:{criteriaRemoveEvent:"criteriaRemoveEvent"},decls:1,vars:1,consts:[[4,"ngIf"],["id","chip"],[1,"vitamui-search-criteria-list"],[1,"vitamui-search-criteria"],[4,"ngFor","ngForOf"],["matTooltipClass","vitamui-tooltip",1,"button-content","right-button",3,"matTooltip","matTooltipShowDelay","ngClass"],["class","vitamui-remove-search-criteria",3,"ngClass","click",4,"ngIf"],["class","vitamui-remove-search-criteria",3,"ngClass",4,"ngIf"],[1,"vitamui-remove-search-criteria",3,"ngClass","click"],[1,"vitamui-icon","vitamui-icon-cross","vitamui-row-icon"],[1,"vitamui-remove-search-criteria",3,"ngClass"],[1,"vitamui-icon","vitamui-icon-loop2","vitamui-row-icon"],[1,"button-or","left-not-arround","right-button",3,"ngClass"],["class","button-or left-not-arround right-button",3,"ngClass",4,"ngIf"],["class","vitamui-icon vitamui-icon-radio-checked vitamui-row-icon",4,"ngIf"],[1,"vitamui-icon","vitamui-icon-radio-checked","vitamui-row-icon"]],template:function(e,t){1&e&&_.Tc(0,Gc,7,3,"ng-container",0),2&e&&_.vc("ngIf",t.criteriaKey&&t.criteriaVal)},directives:[c.p,c.o,he.a,c.n],pipes:[O.d,c.e,C.Yb],styles:[".after-search-launched-button[_ngcontent-%COMP%]{color:#fff;background-color:#2c76c9;border:1px solid #9d9d9d;box-sizing:border-box;border-top-left-radius:0;border-bottom-left-radius:0}.before-search-launched-button[_ngcontent-%COMP%]{box-sizing:border-box;border:1px solid #9d9d9d;border-left:0}.criteria-group[_ngcontent-%COMP%]{padding:10px}.left-arround[_ngcontent-%COMP%]{border-top-left-radius:5px;border-bottom-left-radius:5px;border:1px solid #9d9d9d}.left-not-arround[_ngcontent-%COMP%]{border:1px solid #9d9d9d}.left-not-arround[_ngcontent-%COMP%], .right-arround[_ngcontent-%COMP%]{border-top-left-radius:0;border-bottom-left-radius:0}.right-arround[_ngcontent-%COMP%]{border-top-right-radius:5px;border-bottom-right-radius:5px;border:1px solid #9d9d9d;border-left:0}.right-button[_ngcontent-%COMP%]{border-top-right-radius:0;border-bottom-right-radius:0;border:1px solid #9d9d9d;border-left:0}.button-or[_ngcontent-%COMP%]{border-right-width:0;border-left-width:0}.button-content[_ngcontent-%COMP%], .button-or[_ngcontent-%COMP%]{padding-left:10px;padding-right:10px;height:60px;font-weight:700;padding-top:18px}.button-content[_ngcontent-%COMP%]{max-width:680px;border:1px solid #9d9d9d}.vitamui-chip-list[_ngcontent-%COMP%]   .button-criteria[_ngcontent-%COMP%]{background:#fff!important;border:solid #bdbdbd!important}.button-remove[_ngcontent-%COMP%]{padding-left:4px;padding-right:0;border:1px solid #9d9d9d}.hide-ink[_ngcontent-%COMP%]{cursor:pointer;color:#702382;text-decoration:underline;font-weight:700;margin-top:10px;margin-bottom:10px;padding-left:30px}.launch-search-btn[_ngcontent-%COMP%]{width:218px;height:50px;background:#702382;border-radius:100px;color:#fff;font-size:14px;font-weight:700;letter-spacing:.1px;-webkit-text-decoration-line:underline;text-decoration-line:underline}.button-remove[_ngcontent-%COMP%]{border-left-width:0;padding-left:10px;padding-right:10px;max-width:400px;font-weight:700;height:60px}.hide-area-search[_ngcontent-%COMP%]{margin-bottom:10px}.area-criteria[_ngcontent-%COMP%]{padding-top:20px;display:flex;flex-direction:row;justify-content:flex-start;flex-wrap:wrap}.area-download[_ngcontent-%COMP%]{text-align:right;right:5px}.icon-download[_ngcontent-%COMP%]{color:var(--vitamui-primary);padding-right:10px;padding-left:10px;font-size:22px}.search-criterias[_ngcontent-%COMP%]{font-size:large;font-weight:700;margin-top:50px}.left-margin[_ngcontent-%COMP%]{margin-left:30%}.show-panel[_ngcontent-%COMP%]{display:none}.hide-panel[_ngcontent-%COMP%]{display:block}  .my-menu{max-width:380px}.circle[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;align-items:center;padding:13px;position:static;width:50px;height:50px;left:0;top:0;background:var(--vitamui-secondary);border-radius:50px;flex:none;order:0;flex-grow:0;border:none}.circle[_ngcontent-%COMP%]:focus{border:none;outline:0 auto -webkit-focus-ring-color;outline-color:-webkit-focus-ring-color;outline-style:auto;outline-width:0}.primary-save-icon[_ngcontent-%COMP%]{color:#fff}.mat-boutton[_ngcontent-%COMP%], .mat-boutton[_ngcontent-%COMP%]:focus, .mat-boutton[_ngcontent-%COMP%]:hover   .mat-boutton[_ngcontent-%COMP%]:focus{border:none;background:#f5f7fc}.mat-boutton[_ngcontent-%COMP%]:focus{outline:0 auto -webkit-focus-ring-color;outline-color:-webkit-focus-ring-color;outline-style:auto;outline-width:0}.mat-boutton[_ngcontent-%COMP%]:active{background:#f5f7fc;border:none}.div-btn-delete[_ngcontent-%COMP%]{width:78px}.btn-add[_ngcontent-%COMP%]{color:#757575;font-size:37x}.btn-new-save[_ngcontent-%COMP%]{font-size:16px}.button-space[_ngcontent-%COMP%]{margin-left:-20px;padding-left:30px}.vitamui-search-criteria-list[_ngcontent-%COMP%]{display:initial;flex-wrap:wrap;align-items:flex-start;height:60px}.vitamui-search-criteria-list[_ngcontent-%COMP%]   .vitamui-search-criteria[_ngcontent-%COMP%]{display:flex;align-items:stretch;font-size:13px;cursor:pointer;min-width:100px}.vitamui-search-criteria-list[_ngcontent-%COMP%]   .vitamui-search-criteria[_ngcontent-%COMP%]:not(:last-child){margin-right:10px;margin-bottom:10px}.vitamui-search-criteria-list[_ngcontent-%COMP%]   .vitamui-search-criteria[_ngcontent-%COMP%]   .vitamui-search-criteria-content[_ngcontent-%COMP%]{padding:6px 10px;flex-grow:1}.vitamui-search-criteria-list[_ngcontent-%COMP%]   .vitamui-search-criteria[_ngcontent-%COMP%]   .vitamui-remove-search-criteria[_ngcontent-%COMP%]{display:flex;align-items:center;border-top:1px solid #9d9d9d;border-right:solid #9d9d9d;border-bottom:1px solid #9d9d9d;padding:6px}.vitamui-search-criteria-list[_ngcontent-%COMP%]   .vitamui-search-criteria[_ngcontent-%COMP%]   .vitamui-remove-search-criteria[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:14px}.vitamui-search-criteria-list[_ngcontent-%COMP%]   .vitamui-search-criteria[_ngcontent-%COMP%]   .vitamui-or-search-criteria[_ngcontent-%COMP%]{display:flex;align-items:center;border-top:1px solid #9d9d9d;border-right:1px solid #9d9d9d;border-bottom:1px solid #9d9d9d;padding:6px}.vitamui-search-criteria-list[_ngcontent-%COMP%]   .vitamui-search-criteria[_ngcontent-%COMP%]   .vitamui-or-search-criteria[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:14px}.vitamui-search-criteria[_ngcontent-%COMP%]{background-color:#fff;border:1px solid #f0f0f0;border-radius:5px;color:var(--vitamui-grey-900);font-size:12px;font-weight:700}"]}),e})(),Bc=(()=>{class e{constructor(e,t,i){this.facetsService=e,this.translateService=t,this.datePipe=i,this.rulesFacetDetails=[],this.expiredRulesFacetDetails=[],this.finalActionFacetDetails=[],this.archiveUnitsCountFacetDetails=[]}ngOnInit(){}ngOnChanges(){this.finalActionsFacetsValues=new Map,this.rulesFacetDetails=[],this.expiredRulesFacetDetails=[],this.finalActionFacetDetails=[],this.archiveUnitsCountFacetDetails=[];let e=0;this.storageRuleFacets&&(e=this.handleWaitingToRecalculateRulesFacets(),this.handleFinalActionsRulesFacets(),this.handleRulesDisctinctsFacets(),this.handleRulesExpirationFacets(e))}handleRulesExpirationFacets(e){let t=0;this.dateFilterValue=this.datePipe.transform(new Date,"dd-MM-yyyy"),this.storageRuleFacets.expiredRulesListFacets&&this.storageRuleFacets.expiredRulesListFacets.length>0&&this.storageRuleFacets.expiredRulesListFacets.forEach(e=>{e&&e.node&&e.node.length>10&&(this.dateFilterValue=" "+e.node.substring(e.node.length-10,e.node.length),t=e.count?e.count:0)}),this.expiredRulesFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.STORAGE_RULE.EXPIRED"),totalResults:this.facetsService.getFacetTextByExactCountFlag(t,this.exactCount,this.totalResults),clickable:!1,color:C.q.GRAY,filter:">"+this.dateFilterValue,backgroundColor:C.q.DISABLED}),this.expiredRulesFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.STORAGE_RULE.NOT_EXPIRED"),totalResults:this.facetsService.getFacetTextByExactCountFlag(e-t,this.exactCount,this.totalResults),clickable:!1,color:C.q.GRAY,filter:"<"+this.dateFilterValue,backgroundColor:C.q.DISABLED})}handleRulesDisctinctsFacets(){this.rulesFacetDetails.push(this.storageRuleFacets.rulesListFacets&&this.storageRuleFacets.rulesListFacets.length>0?{title:this.translateService.instant("COLLECT.FACETS.STORAGE_RULE.DISTINCT_RULES"),totalResults:this.facetsService.getFacetTextByExactCountFlag(this.storageRuleFacets.rulesListFacets.length,this.exactCount,this.totalResults),clickable:!1,color:C.q.GRAY,backgroundColor:C.q.DISABLED}:{title:this.translateService.instant("COLLECT.FACETS.STORAGE_RULE.DISTINCT_RULES"),totalResults:this.facetsService.getFacetTextByExactCountFlag(0,this.exactCount,this.totalResults),clickable:!1,color:C.q.GRAY,backgroundColor:C.q.DISABLED})}handleFinalActionsRulesFacets(){this.finalActionsFacetsValues.set("COPY",0),this.finalActionsFacetsValues.set("TRANSFER",0),this.finalActionsFacetsValues.set("RESTRICTACCESS",0),this.storageRuleFacets.finalActionsFacets&&this.storageRuleFacets.finalActionsFacets.forEach(e=>{this.finalActionsFacetsValues.set(e.node.toUpperCase(),e.count?e.count:0)}),this.finalActionFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.STORAGE_RULE.COPY"),totalResults:this.facetsService.getFacetTextByExactCountFlag(this.finalActionsFacetsValues.get("COPY"),this.exactCount,this.totalResults),clickable:!1,color:C.q.GRAY,backgroundColor:C.q.DISABLED}),this.finalActionFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.STORAGE_RULE.TRANSFER"),totalResults:this.facetsService.getFacetTextByExactCountFlag(this.finalActionsFacetsValues.get("TRANSFER"),this.exactCount,this.totalResults),clickable:!1,color:C.q.GRAY,backgroundColor:C.q.DISABLED}),this.finalActionFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.STORAGE_RULE.RESTRICT_ACCESS"),totalResults:this.facetsService.getFacetTextByExactCountFlag(this.finalActionsFacetsValues.get("RESTRICTACCESS"),this.exactCount,this.totalResults),clickable:!1,color:C.q.GRAY,backgroundColor:C.q.DISABLED})}handleWaitingToRecalculateRulesFacets(){let e=0;if(this.storageRuleFacets.waitingToRecalculateRulesListFacets&&this.storageRuleFacets.waitingToRecalculateRulesListFacets.length>0){const t=this.storageRuleFacets.waitingToRecalculateRulesListFacets.filter(e=>"true"===e.node);let i=0;i=t.length>0&&t[0].count?t[0].count:0;let c="";c=!this.exactCount&&(this.totalResults>=me.RESULTS_MAX_NUMBER||i>=me.RESULTS_MAX_NUMBER)?me.BIG_RESULTS_FACETS_DEFAULT_TEXT:(this.totalResults-i).toString(),this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.STORAGE_RULE.WAITING_TO_RECALCULATE"),totalResults:c,clickable:!1,color:"0"===c?C.q.GRAY:C.q.ORANGE,backgroundColor:C.q.DISABLED}),this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.STORAGE_RULE.CALCULATED"),totalResults:this.facetsService.getFacetTextByExactCountFlag(i,this.exactCount,this.totalResults),clickable:!1,color:C.q.GRAY,backgroundColor:C.q.DISABLED}),e=i}else this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.STORAGE_RULE.WAITING_TO_RECALCULATE"),totalResults:this.facetsService.getFacetTextByExactCountFlag(this.totalResults,this.exactCount,this.totalResults),clickable:!1,color:0===this.totalResults?C.q.GRAY:C.q.ORANGE,backgroundColor:C.q.DISABLED}),this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.STORAGE_RULE.CALCULATED"),totalResults:this.facetsService.getFacetTextByExactCountFlag(0,this.exactCount,this.totalResults),clickable:!1,color:C.q.GRAY,backgroundColor:C.q.DISABLED});return this.storageRuleFacets.noRulesFacets&&this.storageRuleFacets.noRulesFacets.length>0?this.storageRuleFacets.noRulesFacets.forEach(t=>{this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.STORAGE_RULE.WITHOUT_RULES"),totalResults:this.facetsService.getFacetTextByExactCountFlag(t.count,this.exactCount,this.totalResults),clickable:!1,color:C.q.GRAY,backgroundColor:C.q.DISABLED}),e-=t.count?t.count:0}):this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.STORAGE_RULE.WITHOUT_RULES"),totalResults:this.facetsService.getFacetTextByExactCountFlag(0,this.exactCount,this.totalResults),clickable:!1,color:C.q.GRAY,backgroundColor:C.q.DISABLED}),e}}return e.\u0275fac=function(t){return new(t||e)(_.Xb(fe),_.Xb(O.e),_.Xb(c.e))},e.\u0275cmp=_.Rb({type:e,selectors:[["app-search-storage-rules-facets"]],inputs:{storageRuleFacets:"storageRuleFacets",totalResults:"totalResults",exactCount:"exactCount"},features:[_.Jb],decls:14,vars:19,consts:[["id","facet-row"],["id","count-facet-details"],[3,"facetDetails","facetTitle"],["id","rules-facet-details"],["id","expired-rules-facet-details"],[3,"facetDetails","facetSubTitle","facetTitle"],["id","final-action-facetDetails"]],template:function(e,t){1&e&&(_.dc(0,"div",0),_.dc(1,"div",1),_.Yb(2,"app-vitamui-facet",2),_.qc(3,"translate"),_.cc(),_.dc(4,"div",3),_.Yb(5,"app-vitamui-facet",2),_.qc(6,"translate"),_.cc(),_.dc(7,"div",4),_.Yb(8,"app-vitamui-facet",5),_.qc(9,"translate"),_.qc(10,"translate"),_.cc(),_.dc(11,"div",6),_.Yb(12,"app-vitamui-facet",2),_.qc(13,"translate"),_.cc(),_.cc()),2&e&&(_.Lb(2),_.vc("facetDetails",t.archiveUnitsCountFacetDetails)("facetTitle",_.rc(3,9,"COLLECT.FACETS.STORAGE_RULE.ARCHIVE_UNITS_COUNT")),_.Lb(3),_.vc("facetDetails",t.rulesFacetDetails)("facetTitle",_.rc(6,11,"COLLECT.FACETS.STORAGE_RULE.RULES_COUNT")),_.Lb(3),_.vc("facetDetails",t.expiredRulesFacetDetails)("facetSubTitle",_.rc(9,13,"COLLECT.FACETS.STORAGE_RULE.FROM_DATE")+" "+t.dateFilterValue)("facetTitle",_.rc(10,15,"COLLECT.FACETS.STORAGE_RULE.EXPIRED_RULES")),_.Lb(4),_.vc("facetDetails",t.finalActionFacetDetails)("facetTitle",_.rc(13,17,"COLLECT.FACETS.STORAGE_RULE.FINAL_ACTIONS")))},directives:[C.Tb],pipes:[O.d],styles:["#facet-row[_ngcontent-%COMP%]{display:flex;width:100%;align-items:flex-start;justify-content:space-between}#count-facet-details[_ngcontent-%COMP%]{width:35%}#rules-facet-details[_ngcontent-%COMP%]{width:13%}#expired-rules-facet-details[_ngcontent-%COMP%]{width:21%}#final-action-facetDetails[_ngcontent-%COMP%]{width:27%}"]}),e})(),Wc=(()=>{class e{constructor(e,t,i){this.facetsService=e,this.translateService=t,this.datePipe=i,this.rulesFacetDetails=[],this.expiredRulesFacetDetails=[],this.finalActionFacetDetails=[],this.archiveUnitsCountFacetDetails=[]}ngOnInit(){}ngOnChanges(){this.finalActionsFacetsValues=new Map,this.rulesFacetDetails=[],this.expiredRulesFacetDetails=[],this.finalActionFacetDetails=[],this.archiveUnitsCountFacetDetails=[];let e=0;this.appraisalRuleFacets&&(e=this.handleWaitingToRecalculateRulesFacets(),this.handleFinalActionsRulesFacets(),this.handleRulesDisctinctsFacets(),this.handleRulesExpirationFacets(e))}getFacetTextByExactCountFlag(e,t){let i=e.toString();return!t&&this.totalResults>=me.RESULTS_MAX_NUMBER&&(i=me.BIG_RESULTS_FACETS_DEFAULT_TEXT),i}handleRulesExpirationFacets(e){let t=0;this.dateFilterValue=this.datePipe.transform(new Date,"dd-MM-yyyy"),this.appraisalRuleFacets.expiredRulesListFacets&&this.appraisalRuleFacets.expiredRulesListFacets.length>0&&this.appraisalRuleFacets.expiredRulesListFacets.forEach(e=>{e&&e.node&&e.node.length>10&&(this.dateFilterValue=" "+e.node.substring(e.node.length-10,e.node.length),t=e.count?e.count:0)}),this.expiredRulesFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.APPRAISAL_RULE.EXPIRED"),totalResults:this.facetsService.getFacetTextByExactCountFlag(t,this.exactCount,this.totalResults),clickable:!1,color:C.q.GRAY,filter:">"+this.dateFilterValue,backgroundColor:C.q.DISABLED}),this.expiredRulesFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.APPRAISAL_RULE.NOT_EXPIRED"),totalResults:this.facetsService.getFacetTextByExactCountFlag(e-t,this.exactCount,this.totalResults),clickable:!1,color:C.q.GRAY,filter:"<"+this.dateFilterValue,backgroundColor:C.q.DISABLED})}handleRulesDisctinctsFacets(){this.rulesFacetDetails.push(this.appraisalRuleFacets.rulesListFacets&&this.appraisalRuleFacets.rulesListFacets.length>0?{title:this.translateService.instant("COLLECT.FACETS.APPRAISAL_RULE.DISTINCT_RULES"),totalResults:this.facetsService.getFacetTextByExactCountFlag(this.appraisalRuleFacets.rulesListFacets.length,this.exactCount,this.totalResults),clickable:!1,color:C.q.GRAY,backgroundColor:C.q.DISABLED}:{title:this.translateService.instant("COLLECT.FACETS.APPRAISAL_RULE.DISTINCT_RULES"),totalResults:this.facetsService.getFacetTextByExactCountFlag(0,this.exactCount,this.totalResults),clickable:!1,color:C.q.GRAY,backgroundColor:C.q.DISABLED})}handleFinalActionsRulesFacets(){this.finalActionsFacetsValues.set("KEEP",0),this.finalActionsFacetsValues.set("DESTROY",0),this.finalActionsFacetsValues.set("CONFLICT",0),this.appraisalRuleFacets.finalActionsFacets&&this.appraisalRuleFacets.finalActionsFacets.forEach(e=>{this.finalActionsFacetsValues.set(e.node.toUpperCase(),e.count?e.count:0)}),this.finalActionFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.APPRAISAL_RULE.KEEP"),totalResults:this.facetsService.getFacetTextByExactCountFlag(this.finalActionsFacetsValues.get("KEEP"),this.exactCount,this.totalResults),clickable:!1,color:C.q.GREEN,filter:"KEEP",backgroundColor:C.q.DISABLED}),this.finalActionFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.APPRAISAL_RULE.DESTROY"),totalResults:this.facetsService.getFacetTextByExactCountFlag(this.finalActionsFacetsValues.get("DESTROY"),this.exactCount,this.totalResults),clickable:!1,color:C.q.ORANGE,filter:"DESTROY",backgroundColor:C.q.DISABLED}),this.finalActionFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.APPRAISAL_RULE.CONFLICT"),totalResults:this.facetsService.getFacetTextByExactCountFlag(this.finalActionsFacetsValues.get("CONFLICT"),this.exactCount,this.totalResults),clickable:!1,color:C.q.RED,filter:"CONFLICT",backgroundColor:C.q.DISABLED})}handleWaitingToRecalculateRulesFacets(){let e=0;if(this.appraisalRuleFacets.waitingToRecalculateRulesListFacets&&this.appraisalRuleFacets.waitingToRecalculateRulesListFacets.length>0){const t=this.appraisalRuleFacets.waitingToRecalculateRulesListFacets.filter(e=>"true"===e.node);let i=0;i=t.length>0&&t[0].count?t[0].count:0;let c="";c=!this.exactCount&&(this.totalResults>=me.RESULTS_MAX_NUMBER||i>=me.RESULTS_MAX_NUMBER)?me.BIG_RESULTS_FACETS_DEFAULT_TEXT:(this.totalResults-i).toString(),this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.APPRAISAL_RULE.WAITING_TO_RECALCULATE"),totalResults:c,clickable:!1,color:"0"===c?C.q.GRAY:C.q.ORANGE,backgroundColor:C.q.DISABLED}),this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.APPRAISAL_RULE.CALCULATED"),totalResults:this.facetsService.getFacetTextByExactCountFlag(i,this.exactCount,this.totalResults),clickable:!1,color:C.q.GRAY,backgroundColor:C.q.DISABLED}),e=i}else this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.APPRAISAL_RULE.WAITING_TO_RECALCULATE"),totalResults:this.facetsService.getFacetTextByExactCountFlag(this.totalResults,this.exactCount,this.totalResults),clickable:!1,color:0===this.totalResults?C.q.GRAY:C.q.ORANGE,backgroundColor:C.q.DISABLED}),this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.APPRAISAL_RULE.CALCULATED"),totalResults:this.facetsService.getFacetTextByExactCountFlag(0,this.exactCount,this.totalResults),clickable:!1,color:C.q.GRAY,backgroundColor:C.q.DISABLED});return this.appraisalRuleFacets.noRulesFacets&&this.appraisalRuleFacets.noRulesFacets.length>0?this.appraisalRuleFacets.noRulesFacets.forEach(t=>{this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.APPRAISAL_RULE.WITHOUT_RULES"),totalResults:this.facetsService.getFacetTextByExactCountFlag(t.count,this.exactCount,this.totalResults),clickable:!1,color:C.q.GRAY,backgroundColor:C.q.DISABLED}),e-=t.count?t.count:0}):this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.APPRAISAL_RULE.WITHOUT_RULES"),totalResults:this.facetsService.getFacetTextByExactCountFlag(0,this.exactCount,this.totalResults),clickable:!1,color:C.q.GRAY,backgroundColor:C.q.DISABLED}),e}}return e.\u0275fac=function(t){return new(t||e)(_.Xb(fe),_.Xb(O.e),_.Xb(c.e))},e.\u0275cmp=_.Rb({type:e,selectors:[["app-search-appraisal-rules-facets"]],inputs:{appraisalRuleFacets:"appraisalRuleFacets",totalResults:"totalResults",exactCount:"exactCount"},features:[_.Jb],decls:14,vars:19,consts:[["id","facet-row"],["id","count-facet-details"],[3,"facetDetails","facetTitle"],["id","rules-facet-details"],["id","expired-rules-facet-details"],[3,"facetDetails","facetSubTitle","facetTitle"],["id","final-action-facetDetails"]],template:function(e,t){1&e&&(_.dc(0,"div",0),_.dc(1,"div",1),_.Yb(2,"app-vitamui-facet",2),_.qc(3,"translate"),_.cc(),_.dc(4,"div",3),_.Yb(5,"app-vitamui-facet",2),_.qc(6,"translate"),_.cc(),_.dc(7,"div",4),_.Yb(8,"app-vitamui-facet",5),_.qc(9,"translate"),_.qc(10,"translate"),_.cc(),_.dc(11,"div",6),_.Yb(12,"app-vitamui-facet",2),_.qc(13,"translate"),_.cc(),_.cc()),2&e&&(_.Lb(2),_.vc("facetDetails",t.archiveUnitsCountFacetDetails)("facetTitle",_.rc(3,9,"COLLECT.FACETS.APPRAISAL_RULE.ARCHIVE_UNITS_COUNT")),_.Lb(3),_.vc("facetDetails",t.rulesFacetDetails)("facetTitle",_.rc(6,11,"COLLECT.FACETS.APPRAISAL_RULE.RULES_COUNT")),_.Lb(3),_.vc("facetDetails",t.expiredRulesFacetDetails)("facetSubTitle",_.rc(9,13,"COLLECT.FACETS.APPRAISAL_RULE.FROM_DATE")+" "+t.dateFilterValue)("facetTitle",_.rc(10,15,"COLLECT.FACETS.APPRAISAL_RULE.EXPIRED_RULES")),_.Lb(4),_.vc("facetDetails",t.finalActionFacetDetails)("facetTitle",_.rc(13,17,"COLLECT.FACETS.APPRAISAL_RULE.FINAL_ACTIONS")))},directives:[C.Tb],pipes:[O.d],styles:["#facet-row[_ngcontent-%COMP%]{display:flex;width:100%;align-items:flex-start;justify-content:space-between}#count-facet-details[_ngcontent-%COMP%]{width:35%}#rules-facet-details[_ngcontent-%COMP%]{width:13%}#expired-rules-facet-details[_ngcontent-%COMP%]{width:21%}#final-action-facetDetails[_ngcontent-%COMP%]{width:27%}"]}),e})(),jc=(()=>{class e{constructor(e,t,i){this.facetsService=e,this.translateService=t,this.datePipe=i,this.rulesFacetDetails=[],this.expiredRulesFacetDetails=[],this.finalActionFacetDetails=[],this.archiveUnitsCountFacetDetails=[]}ngOnInit(){}ngOnChanges(){this.finalActionsFacetsValues=new Map,this.rulesFacetDetails=[],this.expiredRulesFacetDetails=[],this.finalActionFacetDetails=[],this.archiveUnitsCountFacetDetails=[];let e=0;this.accessRuleFacets&&(e=this.handleWaitingToRecalculateRulesFacets(),this.handleRulesDisctinctsFacets(),this.handleRulesExpirationFacets(e))}handleRulesExpirationFacets(e){let t=0;this.dateFilterValue=this.datePipe.transform(new Date,"dd-MM-yyyy"),this.accessRuleFacets.expiredRulesListFacets&&this.accessRuleFacets.expiredRulesListFacets.length>0&&this.accessRuleFacets.expiredRulesListFacets.forEach(e=>{e&&e.node&&e.node.length>10&&(this.dateFilterValue=" "+e.node.substring(e.node.length-10,e.node.length),t=e.count?e.count:0)}),this.expiredRulesFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.ACCESS_RULE.EXPIRED"),totalResults:this.facetsService.getFacetTextByExactCountFlag(t,this.exactCount,this.totalResults),clickable:!1,color:C.q.GRAY,filter:">"+this.dateFilterValue,backgroundColor:C.q.DISABLED}),this.expiredRulesFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.ACCESS_RULE.NOT_EXPIRED"),totalResults:this.facetsService.getFacetTextByExactCountFlag(e-t,this.exactCount,this.totalResults),clickable:!1,color:C.q.GRAY,filter:"<"+this.dateFilterValue,backgroundColor:C.q.DISABLED})}handleRulesDisctinctsFacets(){this.rulesFacetDetails.push(this.accessRuleFacets.rulesListFacets&&this.accessRuleFacets.rulesListFacets.length>0?{title:this.translateService.instant("COLLECT.FACETS.ACCESS_RULE.DISTINCT_RULES"),totalResults:this.facetsService.getFacetTextByExactCountFlag(this.accessRuleFacets.rulesListFacets.length,this.exactCount,this.totalResults),clickable:!1,color:C.q.GRAY,backgroundColor:C.q.DISABLED}:{title:this.translateService.instant("COLLECT.FACETS.ACCESS_RULE.DISTINCT_RULES"),totalResults:this.facetsService.getFacetTextByExactCountFlag(0,this.exactCount,this.totalResults),clickable:!1,color:C.q.GRAY,backgroundColor:C.q.DISABLED})}handleWaitingToRecalculateRulesFacets(){let e=0;if(this.accessRuleFacets.waitingToRecalculateRulesListFacets&&this.accessRuleFacets.waitingToRecalculateRulesListFacets.length>0){const t=this.accessRuleFacets.waitingToRecalculateRulesListFacets.filter(e=>"true"===e.node);let i=0;i=t.length>0&&t[0].count?t[0].count:0;let c="";c=!this.exactCount&&(this.totalResults>=me.RESULTS_MAX_NUMBER||i>=me.RESULTS_MAX_NUMBER)?me.BIG_RESULTS_FACETS_DEFAULT_TEXT:(this.totalResults-i).toString(),this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.ACCESS_RULE.WAITING_TO_RECALCULATE"),totalResults:c,clickable:!1,color:"0"===c?C.q.GRAY:C.q.ORANGE,backgroundColor:C.q.DISABLED}),this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.ACCESS_RULE.CALCULATED"),totalResults:this.facetsService.getFacetTextByExactCountFlag(i,this.exactCount,this.totalResults),clickable:!1,color:C.q.GRAY,backgroundColor:C.q.DISABLED}),e=i}else this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.APPRAISAL_RULE.WAITING_TO_RECALCULATE"),totalResults:this.facetsService.getFacetTextByExactCountFlag(this.totalResults,this.exactCount,this.totalResults),clickable:!1,color:0===this.totalResults?C.q.GRAY:C.q.ORANGE,backgroundColor:C.q.DISABLED}),this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.APPRAISAL_RULE.CALCULATED"),totalResults:this.facetsService.getFacetTextByExactCountFlag(0,this.exactCount,this.totalResults),clickable:!1,color:C.q.GRAY,backgroundColor:C.q.DISABLED});return this.accessRuleFacets.noRulesFacets&&this.accessRuleFacets.noRulesFacets.length>0?this.accessRuleFacets.noRulesFacets.forEach(t=>{this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.APPRAISAL_RULE.WITHOUT_RULES"),totalResults:this.facetsService.getFacetTextByExactCountFlag(t.count,this.exactCount,this.totalResults),clickable:!1,color:C.q.GRAY,backgroundColor:C.q.DISABLED}),e-=t.count?t.count:0}):this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.APPRAISAL_RULE.WITHOUT_RULES"),totalResults:this.facetsService.getFacetTextByExactCountFlag(0,this.exactCount,this.totalResults),clickable:!1,color:C.q.GRAY,backgroundColor:C.q.DISABLED}),e}}return e.\u0275fac=function(t){return new(t||e)(_.Xb(fe),_.Xb(O.e),_.Xb(c.e))},e.\u0275cmp=_.Rb({type:e,selectors:[["app-search-access-rules-facets"]],inputs:{accessRuleFacets:"accessRuleFacets",totalResults:"totalResults",exactCount:"exactCount"},features:[_.Jb],decls:11,vars:15,consts:[["id","facet-row"],["id","count-facet-details"],[3,"facetDetails","facetTitle"],["id","rules-facet-details"],["id","expired-rules-facet-details"],[3,"facetDetails","facetSubTitle","facetTitle"]],template:function(e,t){1&e&&(_.dc(0,"div",0),_.dc(1,"div",1),_.Yb(2,"app-vitamui-facet",2),_.qc(3,"translate"),_.cc(),_.dc(4,"div",3),_.Yb(5,"app-vitamui-facet",2),_.qc(6,"translate"),_.cc(),_.dc(7,"div",4),_.Yb(8,"app-vitamui-facet",5),_.qc(9,"translate"),_.qc(10,"translate"),_.cc(),_.cc()),2&e&&(_.Lb(2),_.vc("facetDetails",t.archiveUnitsCountFacetDetails)("facetTitle",_.rc(3,7,"COLLECT.FACETS.ACCESS_RULE.ARCHIVE_UNITS_COUNT")),_.Lb(3),_.vc("facetDetails",t.rulesFacetDetails)("facetTitle",_.rc(6,9,"COLLECT.FACETS.ACCESS_RULE.RULES_COUNT")),_.Lb(3),_.vc("facetDetails",t.expiredRulesFacetDetails)("facetSubTitle",_.rc(9,11,"COLLECT.FACETS.ACCESS_RULE.FROM_DATE")+" "+t.dateFilterValue)("facetTitle",_.rc(10,13,"COLLECT.FACETS.ACCESS_RULE.EXPIRED_RULES")))},directives:[C.Tb],pipes:[O.d],styles:["#facet-row[_ngcontent-%COMP%]{display:flex;width:100%;align-items:flex-start;justify-content:first baseline}#count-facet-details[_ngcontent-%COMP%]{width:35%}#rules-facet-details[_ngcontent-%COMP%]{width:13%}#expired-rules-facet-details[_ngcontent-%COMP%]{width:21%}"]}),e})(),Yc=(()=>{class e{constructor(e,t,i){this.facetsService=e,this.translateService=t,this.datePipe=i,this.rulesFacetDetails=[],this.expiredRulesFacetDetails=[],this.finalActionFacetDetails=[],this.archiveUnitsCountFacetDetails=[]}ngOnInit(){}ngOnChanges(){this.finalActionsFacetsValues=new Map,this.rulesFacetDetails=[],this.expiredRulesFacetDetails=[],this.finalActionFacetDetails=[],this.archiveUnitsCountFacetDetails=[];let e=0;this.disseminationRuleFacets&&(e=this.handleWaitingToRecalculateRulesFacets(),this.handleRulesDisctinctsFacets(),this.handleRulesExpirationFacets(e))}getFacetTextByExactCountFlag(e,t){let i=e.toString();return!t&&this.totalResults>=me.RESULTS_MAX_NUMBER&&(i=me.BIG_RESULTS_FACETS_DEFAULT_TEXT),i}handleRulesExpirationFacets(e){let t=0;this.dateFilterValue=this.datePipe.transform(new Date,"dd-MM-yyyy"),this.disseminationRuleFacets.expiredRulesListFacets&&this.disseminationRuleFacets.expiredRulesListFacets.length>0&&this.disseminationRuleFacets.expiredRulesListFacets.forEach(e=>{e&&e.node&&e.node.length>10&&(this.dateFilterValue=" "+e.node.substring(e.node.length-10,e.node.length),t=e.count?e.count:0)}),this.expiredRulesFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.DISSEMINATION_RULE.EXPIRED"),totalResults:this.facetsService.getFacetTextByExactCountFlag(t,this.exactCount,this.totalResults),clickable:!1,color:C.q.GRAY,filter:">"+this.dateFilterValue,backgroundColor:C.q.DISABLED}),this.expiredRulesFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.DISSEMINATION_RULE.NOT_EXPIRED"),totalResults:this.facetsService.getFacetTextByExactCountFlag(e-t,this.exactCount,this.totalResults),clickable:!1,color:C.q.GRAY,filter:"<"+this.dateFilterValue,backgroundColor:C.q.DISABLED})}handleRulesDisctinctsFacets(){this.rulesFacetDetails.push(this.disseminationRuleFacets.rulesListFacets&&this.disseminationRuleFacets.rulesListFacets.length>0?{title:this.translateService.instant("COLLECT.FACETS.DISSEMINATION_RULE.DISTINCT_RULES"),totalResults:this.facetsService.getFacetTextByExactCountFlag(this.disseminationRuleFacets.rulesListFacets.length,this.exactCount,this.totalResults),clickable:!1,color:C.q.GRAY,backgroundColor:C.q.DISABLED}:{title:this.translateService.instant("COLLECT.FACETS.DISSEMINATION_RULE.DISTINCT_RULES"),totalResults:this.facetsService.getFacetTextByExactCountFlag(0,this.exactCount,this.totalResults),clickable:!1,color:C.q.GRAY,backgroundColor:C.q.DISABLED})}handleWaitingToRecalculateRulesFacets(){let e=0;if(this.disseminationRuleFacets.waitingToRecalculateRulesListFacets&&this.disseminationRuleFacets.waitingToRecalculateRulesListFacets.length>0){const t=this.disseminationRuleFacets.waitingToRecalculateRulesListFacets.filter(e=>"true"===e.node);let i=0;i=t.length>0&&t[0].count?t[0].count:0;let c="";c=!this.exactCount&&(this.totalResults>=me.RESULTS_MAX_NUMBER||i>=me.RESULTS_MAX_NUMBER)?me.BIG_RESULTS_FACETS_DEFAULT_TEXT:(this.totalResults-i).toString(),this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.DISSEMINATION_RULE.WAITING_TO_RECALCULATE"),totalResults:c,clickable:!1,color:"0"===c?C.q.GRAY:C.q.ORANGE,backgroundColor:C.q.DISABLED}),this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.DISSEMINATION_RULE.CALCULATED"),totalResults:this.facetsService.getFacetTextByExactCountFlag(i,this.exactCount,this.totalResults),clickable:!1,color:C.q.GRAY,backgroundColor:C.q.DISABLED}),e=i}else this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.DISSEMINATION_RULE.WAITING_TO_RECALCULATE"),totalResults:this.facetsService.getFacetTextByExactCountFlag(this.totalResults,this.exactCount,this.totalResults),clickable:!1,color:0===this.totalResults?C.q.GRAY:C.q.ORANGE,backgroundColor:C.q.DISABLED}),this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.DISSEMINATION_RULE.CALCULATED"),totalResults:this.facetsService.getFacetTextByExactCountFlag(0,this.exactCount,this.totalResults),clickable:!1,color:C.q.GRAY,backgroundColor:C.q.DISABLED});return this.disseminationRuleFacets.noRulesFacets&&this.disseminationRuleFacets.noRulesFacets.length>0?this.disseminationRuleFacets.noRulesFacets.forEach(t=>{this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.DISSEMINATION_RULE.WITHOUT_RULES"),totalResults:this.facetsService.getFacetTextByExactCountFlag(t.count,this.exactCount,this.totalResults),clickable:!1,color:C.q.GRAY,backgroundColor:C.q.DISABLED}),e-=t.count?t.count:0}):this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.DISSEMINATION_RULE.WITHOUT_RULES"),totalResults:this.facetsService.getFacetTextByExactCountFlag(0,this.exactCount,this.totalResults),clickable:!1,color:C.q.GRAY,backgroundColor:C.q.DISABLED}),e}}return e.\u0275fac=function(t){return new(t||e)(_.Xb(fe),_.Xb(O.e),_.Xb(c.e))},e.\u0275cmp=_.Rb({type:e,selectors:[["app-search-dissemination-rules-facets"]],inputs:{disseminationRuleFacets:"disseminationRuleFacets",totalResults:"totalResults",exactCount:"exactCount"},features:[_.Jb],decls:11,vars:15,consts:[["id","facet-row"],["id","count-facet-details"],[3,"facetDetails","facetTitle"],["id","rules-facet-details"],["id","expired-rules-facet-details"],[3,"facetDetails","facetSubTitle","facetTitle"]],template:function(e,t){1&e&&(_.dc(0,"div",0),_.dc(1,"div",1),_.Yb(2,"app-vitamui-facet",2),_.qc(3,"translate"),_.cc(),_.dc(4,"div",3),_.Yb(5,"app-vitamui-facet",2),_.qc(6,"translate"),_.cc(),_.dc(7,"div",4),_.Yb(8,"app-vitamui-facet",5),_.qc(9,"translate"),_.qc(10,"translate"),_.cc(),_.cc()),2&e&&(_.Lb(2),_.vc("facetDetails",t.archiveUnitsCountFacetDetails)("facetTitle",_.rc(3,7,"COLLECT.FACETS.DISSEMINATION_RULE.ARCHIVE_UNITS_COUNT")),_.Lb(3),_.vc("facetDetails",t.rulesFacetDetails)("facetTitle",_.rc(6,9,"COLLECT.FACETS.DISSEMINATION_RULE.RULES_COUNT")),_.Lb(3),_.vc("facetDetails",t.expiredRulesFacetDetails)("facetSubTitle",_.rc(9,11,"COLLECT.FACETS.DISSEMINATION_RULE.FROM_DATE")+" "+t.dateFilterValue)("facetTitle",_.rc(10,13,"COLLECT.FACETS.DISSEMINATION_RULE.EXPIRED_RULES")))},directives:[C.Tb],pipes:[O.d],styles:["#facet-row[_ngcontent-%COMP%]{display:flex;width:100%;align-items:flex-start;justify-content:first baseline}#count-facet-details[_ngcontent-%COMP%]{width:35%}#rules-facet-details[_ngcontent-%COMP%]{width:13%}#expired-rules-facet-details[_ngcontent-%COMP%]{width:21%}"]}),e})(),Xc=(()=>{class e{constructor(e,t,i){this.facetsService=e,this.translateService=t,this.datePipe=i,this.rulesFacetDetails=[],this.expiredRulesFacetDetails=[],this.finalActionFacetDetails=[],this.archiveUnitsCountFacetDetails=[]}ngOnInit(){}ngOnChanges(){this.finalActionsFacetsValues=new Map,this.rulesFacetDetails=[],this.expiredRulesFacetDetails=[],this.finalActionFacetDetails=[],this.archiveUnitsCountFacetDetails=[];let e=0;this.reuseRuleFacets&&(e=this.handleWaitingToRecalculateRulesFacets(),this.handleRulesDisctinctsFacets(),this.handleRulesExpirationFacets(e))}getFacetTextByExactCountFlag(e,t){let i=e.toString();return!t&&this.totalResults>=me.RESULTS_MAX_NUMBER&&(i=me.BIG_RESULTS_FACETS_DEFAULT_TEXT),i}handleRulesExpirationFacets(e){let t=0;this.dateFilterValue=this.datePipe.transform(new Date,"dd-MM-yyyy"),this.reuseRuleFacets.expiredRulesListFacets&&this.reuseRuleFacets.expiredRulesListFacets.length>0&&this.reuseRuleFacets.expiredRulesListFacets.forEach(e=>{e&&e.node&&e.node.length>10&&(this.dateFilterValue=" "+e.node.substring(e.node.length-10,e.node.length),t=e.count?e.count:0)}),this.expiredRulesFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.REUSE_RULE.EXPIRED"),totalResults:this.facetsService.getFacetTextByExactCountFlag(t,this.exactCount,this.totalResults),clickable:!1,color:C.q.GRAY,filter:">"+this.dateFilterValue,backgroundColor:C.q.DISABLED}),this.expiredRulesFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.REUSE_RULE.NOT_EXPIRED"),totalResults:this.facetsService.getFacetTextByExactCountFlag(e-t,this.exactCount,this.totalResults),clickable:!1,color:C.q.GRAY,filter:"<"+this.dateFilterValue,backgroundColor:C.q.DISABLED})}handleRulesDisctinctsFacets(){this.rulesFacetDetails.push(this.reuseRuleFacets.rulesListFacets&&this.reuseRuleFacets.rulesListFacets.length>0?{title:this.translateService.instant("COLLECT.FACETS.REUSE_RULE.DISTINCT_RULES"),totalResults:this.facetsService.getFacetTextByExactCountFlag(this.reuseRuleFacets.rulesListFacets.length,this.exactCount,this.totalResults),clickable:!1,color:C.q.GRAY,backgroundColor:C.q.DISABLED}:{title:this.translateService.instant("COLLECT.FACETS.REUSE_RULE.DISTINCT_RULES"),totalResults:this.facetsService.getFacetTextByExactCountFlag(0,this.exactCount,this.totalResults),clickable:!1,color:C.q.GRAY,backgroundColor:C.q.DISABLED})}handleWaitingToRecalculateRulesFacets(){let e=0;if(this.reuseRuleFacets.waitingToRecalculateRulesListFacets&&this.reuseRuleFacets.waitingToRecalculateRulesListFacets.length>0){const t=this.reuseRuleFacets.waitingToRecalculateRulesListFacets.filter(e=>"true"===e.node);let i=0;i=t.length>0&&t[0].count?t[0].count:0;let c="";c=!this.exactCount&&(this.totalResults>=me.RESULTS_MAX_NUMBER||i>=me.RESULTS_MAX_NUMBER)?me.BIG_RESULTS_FACETS_DEFAULT_TEXT:(this.totalResults-i).toString(),this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.REUSE_RULE.WAITING_TO_RECALCULATE"),totalResults:c,clickable:!1,color:"0"===c?C.q.GRAY:C.q.ORANGE,backgroundColor:C.q.DISABLED}),this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.REUSE_RULE.CALCULATED"),totalResults:this.facetsService.getFacetTextByExactCountFlag(i,this.exactCount,this.totalResults),clickable:!1,color:C.q.GRAY,backgroundColor:C.q.DISABLED}),e=i}else this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.REUSE_RULE.WAITING_TO_RECALCULATE"),totalResults:this.facetsService.getFacetTextByExactCountFlag(this.totalResults,this.exactCount,this.totalResults),clickable:!1,color:0===this.totalResults?C.q.GRAY:C.q.ORANGE,backgroundColor:C.q.DISABLED}),this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.REUSE_RULE.CALCULATED"),totalResults:this.facetsService.getFacetTextByExactCountFlag(0,this.exactCount,this.totalResults),clickable:!1,color:C.q.GRAY,backgroundColor:C.q.DISABLED});return this.reuseRuleFacets.noRulesFacets&&this.reuseRuleFacets.noRulesFacets.length>0?this.reuseRuleFacets.noRulesFacets.forEach(t=>{this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.REUSE_RULE.WITHOUT_RULES"),totalResults:this.facetsService.getFacetTextByExactCountFlag(t.count,this.exactCount,this.totalResults),clickable:!1,color:C.q.GRAY,backgroundColor:C.q.DISABLED}),e-=t.count?t.count:0}):this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.REUSE_RULE.WITHOUT_RULES"),totalResults:this.facetsService.getFacetTextByExactCountFlag(0,this.exactCount,this.totalResults),clickable:!1,color:C.q.GRAY,backgroundColor:C.q.DISABLED}),e}}return e.\u0275fac=function(t){return new(t||e)(_.Xb(fe),_.Xb(O.e),_.Xb(c.e))},e.\u0275cmp=_.Rb({type:e,selectors:[["app-search-reuse-rules-facets"]],inputs:{reuseRuleFacets:"reuseRuleFacets",totalResults:"totalResults",exactCount:"exactCount"},features:[_.Jb],decls:11,vars:15,consts:[["id","facet-row"],["id","count-facet-details"],[3,"facetDetails","facetTitle"],["id","rules-facet-details"],["id","expired-rules-facet-details"],[3,"facetDetails","facetSubTitle","facetTitle"]],template:function(e,t){1&e&&(_.dc(0,"div",0),_.dc(1,"div",1),_.Yb(2,"app-vitamui-facet",2),_.qc(3,"translate"),_.cc(),_.dc(4,"div",3),_.Yb(5,"app-vitamui-facet",2),_.qc(6,"translate"),_.cc(),_.dc(7,"div",4),_.Yb(8,"app-vitamui-facet",5),_.qc(9,"translate"),_.qc(10,"translate"),_.cc(),_.cc()),2&e&&(_.Lb(2),_.vc("facetDetails",t.archiveUnitsCountFacetDetails)("facetTitle",_.rc(3,7,"COLLECT.FACETS.REUSE_RULE.ARCHIVE_UNITS_COUNT")),_.Lb(3),_.vc("facetDetails",t.rulesFacetDetails)("facetTitle",_.rc(6,9,"COLLECT.FACETS.REUSE_RULE.RULES_COUNT")),_.Lb(3),_.vc("facetDetails",t.expiredRulesFacetDetails)("facetSubTitle",_.rc(9,11,"COLLECT.FACETS.REUSE_RULE.FROM_DATE")+" "+t.dateFilterValue)("facetTitle",_.rc(10,13,"COLLECT.FACETS.REUSE_RULE.EXPIRED_RULES")))},directives:[C.Tb],pipes:[O.d],styles:["#facet-row[_ngcontent-%COMP%]{display:flex;width:100%;align-items:flex-start;justify-content:first baseline}#count-facet-details[_ngcontent-%COMP%]{width:35%}#rules-facet-details[_ngcontent-%COMP%]{width:13%}#expired-rules-facet-details[_ngcontent-%COMP%]{width:21%}"]}),e})();function Kc(e,t){if(1&e){const e=_.ec();_.dc(0,"span",3),_.lc("click",(function(){return _.Kc(e),_.pc().showHideFacets(!0)})),_.Vc(1),_.qc(2,"translate"),_.cc()}2&e&&(_.Lb(1),_.Xc(" ",_.rc(2,1,"COLLECT.CRITERIA_CATEGORY.STORAGE_RULE")," "))}function zc(e,t){if(1&e&&(_.dc(0,"div",4),_.Yb(1,"app-search-storage-rules-facets",5),_.cc()),2&e){const e=_.pc();_.Lb(1),_.vc("totalResults",e.totalResults)("exactCount",e.exactCount)("storageRuleFacets",e.storageRuleFacets)}}function $c(e,t){if(1&e){const e=_.ec();_.dc(0,"span",3),_.lc("click",(function(){return _.Kc(e),_.pc().showHideFacets(!0)})),_.Vc(1),_.qc(2,"translate"),_.cc()}2&e&&(_.Lb(1),_.Xc(" ",_.rc(2,1,"COLLECT.CRITERIA_CATEGORY.APPRAISAL_RULE")," "))}function Zc(e,t){if(1&e&&(_.dc(0,"div",4),_.Yb(1,"app-search-appraisal-rules-facets",6),_.cc()),2&e){const e=_.pc();_.Lb(1),_.vc("totalResults",e.totalResults)("exactCount",e.exactCount)("appraisalRuleFacets",e.appraisalRuleFacets)}}function Qc(e,t){if(1&e){const e=_.ec();_.dc(0,"span",3),_.lc("click",(function(){return _.Kc(e),_.pc().showHideFacets(!0)})),_.Vc(1),_.qc(2,"translate"),_.cc()}2&e&&(_.Lb(1),_.Xc(" ",_.rc(2,1,"COLLECT.CRITERIA_CATEGORY.ACCESS_RULE")," "))}function Jc(e,t){if(1&e&&(_.dc(0,"div",4),_.Yb(1,"app-search-access-rules-facets",7),_.cc()),2&e){const e=_.pc();_.Lb(1),_.vc("exactCount",e.exactCount)("totalResults",e.totalResults)("accessRuleFacets",e.accessRuleFacets)}}function ea(e,t){if(1&e){const e=_.ec();_.dc(0,"span",3),_.lc("click",(function(){return _.Kc(e),_.pc().showHideFacets(!0)})),_.Vc(1),_.qc(2,"translate"),_.cc()}2&e&&(_.Lb(1),_.Xc(" ",_.rc(2,1,"COLLECT.CRITERIA_CATEGORY.DISSEMINATION")," "))}function ta(e,t){if(1&e&&(_.dc(0,"div",4),_.Yb(1,"app-search-dissemination-rules-facets",8),_.cc()),2&e){const e=_.pc();_.Lb(1),_.vc("totalResults",e.totalResults)("exactCount",e.exactCount)("disseminationRuleFacets",e.disseminationRuleFacets)}}function ia(e,t){if(1&e){const e=_.ec();_.dc(0,"span",3),_.lc("click",(function(){return _.Kc(e),_.pc().showHideFacets(!0)})),_.Vc(1),_.qc(2,"translate"),_.cc()}2&e&&(_.Lb(1),_.Xc(" ",_.rc(2,1,"COLLECT.CRITERIA_CATEGORY.REUSE")," "))}function ca(e,t){if(1&e&&(_.dc(0,"div",4),_.Yb(1,"app-search-reuse-rules-facets",9),_.cc()),2&e){const e=_.pc();_.Lb(1),_.vc("exactCount",e.exactCount)("totalResults",e.totalResults)("reuseRuleFacets",e.reuseRuleFacets)}}let aa=(()=>{class e{constructor(){this.facetsVisibles=!0}showHideFacets(e){this.facetsVisibles=e}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=_.Rb({type:e,selectors:[["app-archive-search-rules-facets"]],inputs:{totalResults:"totalResults",appraisalRuleFacets:"appraisalRuleFacets",accessRuleFacets:"accessRuleFacets",storageRuleFacets:"storageRuleFacets",disseminationRuleFacets:"disseminationRuleFacets",reuseRuleFacets:"reuseRuleFacets",classificationRuleFacets:"classificationRuleFacets",holdRuleFacets:"holdRuleFacets",tenantIdentifier:"tenantIdentifier",exactCount:"exactCount",defaultFacetTabIndex:"defaultFacetTabIndex"},decls:16,vars:6,consts:[[3,"selectedIndex"],["mat-tab-label",""],["id","facet-content",4,"ngIf"],[3,"click"],["id","facet-content"],[3,"totalResults","exactCount","storageRuleFacets"],[3,"totalResults","exactCount","appraisalRuleFacets"],[3,"exactCount","totalResults","accessRuleFacets"],[3,"totalResults","exactCount","disseminationRuleFacets"],[3,"exactCount","totalResults","reuseRuleFacets"]],template:function(e,t){1&e&&(_.dc(0,"mat-tab-group",0),_.dc(1,"mat-tab"),_.Tc(2,Kc,3,3,"ng-template",1),_.Tc(3,zc,2,3,"div",2),_.cc(),_.dc(4,"mat-tab"),_.Tc(5,$c,3,3,"ng-template",1),_.Tc(6,Zc,2,3,"div",2),_.cc(),_.dc(7,"mat-tab"),_.Tc(8,Qc,3,3,"ng-template",1),_.Tc(9,Jc,2,3,"div",2),_.cc(),_.dc(10,"mat-tab"),_.Tc(11,ea,3,3,"ng-template",1),_.Tc(12,ta,2,3,"div",2),_.cc(),_.dc(13,"mat-tab"),_.Tc(14,ia,3,3,"ng-template",1),_.Tc(15,ca,2,3,"div",2),_.cc(),_.cc()),2&e&&(_.vc("selectedIndex",t.defaultFacetTabIndex),_.Lb(3),_.vc("ngIf",t.facetsVisibles),_.Lb(3),_.vc("ngIf",t.facetsVisibles),_.Lb(3),_.vc("ngIf",t.facetsVisibles),_.Lb(3),_.vc("ngIf",t.facetsVisibles),_.Lb(3),_.vc("ngIf",t.facetsVisibles))},directives:[u.b,u.a,u.c,c.p,Bc,Wc,jc,Yc,Xc],pipes:[O.d],styles:["#show-hide-facet-button[_ngcontent-%COMP%]{position:relative;float:right;cursor:pointer;width:40px;border:1px solid #bdbdbd;box-sizing:border-box;border-radius:20px;padding:10px;font-size:large;font-weight:700}#facet-content[_ngcontent-%COMP%]{margin:0 5px;padding:0 5px}"]}),e})();var ra=i("8lHc");let na=(()=>{class e{constructor(e,t){this.managementRulesSharedDataService=e,this.archiveSharedDataService=t,this.debounceTime=400}uniqueRuleId(e){return this.uniqueFields("ruleId","ruleIdExists",e)}getRuleType(e){switch(e){case"APPRAISAL_RULE":return"AppraisalRule";case"STORAGE_RULE":return"StorageRule";case"ACCESS_RULE":return"AccessRule";case"REUSE_RULE":return"ReuseRule";case"CLASSIFICATION_RULE":return"ClassificationRule";case"HOLD_RULE":return"HoldRule";case"DISSEMINATION_RULE":return"DisseminationRule";default:return null}}uniqueFields(e,t,i){return this.archiveSharedDataService.getRuleCategory().subscribe(e=>{this.ruleCategorySelected=e}),c=>{const a={};if(c.value){a[e]=c.value,a.ruleType=this.getRuleType(this.ruleCategorySelected);const r={};return r[t]=!0,Object(ra.a)(this.debounceTime).pipe(Object(yt.a)(()=>c.value!==i?this.managementRulesSharedDataService.existsProperties(a):Object(j.a)(!1)),Object(G.a)(1),Object(b.a)(e=>e?null:r))}return Object(j.a)(!1)}}}return e.\u0275fac=function(t){return new(t||e)(_.ic(Zi),_.ic(de))},e.\u0275prov=_.Tb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var sa=i("PBFl");function la(e,t){if(1&e){const e=_.ec();_.dc(0,"span",35),_.lc("click",(function(){return _.Kc(e),_.pc(),_.Gc(38).open()})),_.Vc(1),_.qc(2,"translate"),_.cc()}if(2&e){const e=_.pc();_.Lb(1),_.Wc(_.rc(2,1,e.endDateInterval?"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.END_DATE_DUA_BEGIN":"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.END_DATE_DUA_EQUAL"))}}function oa(e,t){if(1&e){const e=_.ec();_.dc(0,"span",36),_.lc("click",(function(){return _.Kc(e),_.pc(),_.Gc(38).open()})),_.Vc(1),_.qc(2,"date"),_.cc()}if(2&e){const e=_.pc();_.Lb(1),_.Xc("",_.sc(2,1,e.storageRuleCriteriaForm.get("storageRuleStartDate").value,"dd/MM/yyyy")," ")}}function da(e,t){if(1&e){const e=_.ec();_.dc(0,"button",37),_.lc("click",(function(){return _.Kc(e),_.pc().addBeginDtDucCriteria()})),_.dc(1,"i",38),_.Vc(2,"check"),_.cc(),_.cc()}}function ua(e,t){if(1&e){const e=_.ec();_.dc(0,"p",39),_.lc("click",(function(){return _.Kc(e),_.pc().updateEndDateInterval(!0)})),_.Vc(1),_.qc(2,"translate"),_.cc()}2&e&&(_.Lb(1),_.Xc(" ",_.rc(2,1,"COLLECT.SEARCH_CRITERIA_FILTER.STORAGE_RULE.CREATE_INTERVAL")," "))}function ha(e,t){if(1&e){const e=_.ec();_.dc(0,"span",35),_.lc("click",(function(){return _.Kc(e),_.pc(),_.Gc(6).open()})),_.Vc(1),_.qc(2,"translate"),_.cc()}2&e&&(_.Lb(1),_.Wc(_.rc(2,1,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.END_DATE_DUA_END")))}function Ca(e,t){if(1&e){const e=_.ec();_.dc(0,"span",36),_.lc("click",(function(){return _.Kc(e),_.pc(),_.Gc(6).open()})),_.Vc(1),_.qc(2,"date"),_.cc()}if(2&e){const e=_.pc(2);_.Lb(1),_.Xc("",_.sc(2,1,e.storageRuleCriteriaForm.get("storageRuleEndDate").value,"dd/MM/yyyy")," ")}}function Ea(e,t){if(1&e){const e=_.ec();_.dc(0,"div",13),_.lc("click",(function(){return _.Kc(e),_.Gc(6).open()})),_.Tc(1,ha,3,3,"span",14),_.Tc(2,Ca,3,4,"ng-template",null,40,_.Uc),_.Yb(4,"input",41),_.Yb(5,"mat-datepicker",null,42),_.cc()}if(2&e){const e=_.Gc(3),t=_.Gc(6),i=_.pc();_.Lb(1),_.vc("ngIf",!i.storageRuleCriteriaForm.get("storageRuleEndDate").value)("ngIfElse",e),_.Lb(3),_.vc("matDatepicker",t)("min",i.storageRuleCriteriaForm.get("storageRuleStartDate").value)}}function Ra(e,t){if(1&e){const e=_.ec();_.dc(0,"button",43),_.lc("click",(function(){return _.Kc(e),_.pc().addIntervalDtDucCriteria()})),_.dc(1,"i",38),_.Vc(2,"check"),_.cc(),_.cc()}}function pa(e,t){if(1&e){const e=_.ec();_.dc(0,"p",39),_.lc("click",(function(){return _.Kc(e),_.pc().updateEndDateInterval(!1)})),_.Vc(1),_.qc(2,"translate"),_.cc()}2&e&&(_.Lb(1),_.Xc(" ",_.rc(2,1,"COLLECT.SEARCH_CRITERIA_FILTER.STORAGE_RULE.DELETE_INTERVAL")," "))}let va=(()=>{class e{constructor(e,t,i,c){this.formBuilder=e,this.dialog=t,this.archiveExchangeDataService=i,this.ruleValidator=c,this.storageCriteriaList=[],this.storageAdditionalCriteria=new Map,this.endDateInterval=!1,this.emptyStorageCriteriaForm={storageRuleIdentifier:"",storageRuleTitle:"",storageRuleStartDate:"",storageRuleEndDate:"",storageRuleOriginInheriteAtLeastOne:!0,storageRuleOriginHasAtLeastOne:!0,storageRuleOriginHasNoOne:!1,storageRuleOriginWaitingRecalculate:!1,copyFinalActionType:!1,transferFinalActionType:!1,storageRuleFinalActionHasFinalAction:!1,storageRuleFinalActionInheriteFinalAction:!1,restrictAccessFinalActionType:!1},this.showUnitPreviewBlock=!1,this.storageRuleCriteriaForm=this.formBuilder.group({storageRuleIdentifier:[null,[z.c.ruleIdPattern],this.ruleValidator.uniqueRuleId()],storageRuleTitle:["",[]],storageRuleStartDate:["",[]],storageRuleEndDate:["",[]],storageRuleEliminationIdentifier:["",[]]}),Object(I.a)(this.storageRuleCriteriaForm.statusChanges,this.storageRuleCriteriaForm.valueChanges).pipe(Object(L.a)(me.UPDATE_DEBOUNCE_TIME),Object(b.a)(()=>this.storageRuleCriteriaForm.value),Object(b.a)(()=>Object(C.sb)(this.storageRuleCriteriaForm.value,this.previousStorageCriteriaValue)),Object(Pt.a)(e=>this.isEmpty(e))).subscribe(()=>{this.resetStorageRuleCriteriaForm()}),this.storageRuleCriteriaForm.get("storageRuleTitle").valueChanges.subscribe(e=>{null!==this.storageRuleCriteriaForm.get("storageRuleTitle").value&&""!==this.storageRuleCriteriaForm.get("storageRuleTitle").value&&(this.addCriteria("RULE_TITLE_STORAGE_RULE",{id:e,value:e},e,!0,C.v.EQ,!1,C.u.STRING,C.Z.STORAGE_RULE),this.resetStorageRuleCriteriaForm())}),this.subscriptionStorageFromMainSearchCriteria=this.archiveExchangeDataService.storageFromMainSearchCriteriaObservable.subscribe(e=>{e&&(e.action===C.d.ADD?this.storageAdditionalCriteria.set(e.valueElt.value,!0):e.action===C.d.REMOVE&&this.storageAdditionalCriteria&&this.storageAdditionalCriteria.has(e.valueElt.value)&&this.storageAdditionalCriteria.set(e.valueElt.value,!1))})}ngOnInit(){this.storageAdditionalCriteria=new Map,this.storageAdditionalCriteria.set("ORIGIN_WAITING_RECALCULATE",!0===this.hasWaitingToRecalculateCriteria),this.storageAdditionalCriteria.set("FINAL_ACTION_TYPE_COPY",!1),this.storageAdditionalCriteria.set("FINAL_ACTION_TYPE_TRANSFER",!1),this.storageAdditionalCriteria.set("ORIGIN_HAS_NO_ONE",!1),this.storageAdditionalCriteria.set("ORIGIN_HAS_AT_LEAST_ONE",!1),this.storageAdditionalCriteria.set("FINAL_ACTION_HAS_FINAL_ACTION",!1),this.previousStorageCriteriaValue={storageRuleIdentifier:"",storageRuleTitle:"",storageRuleStartDate:"",storageRuleEndDate:"",storageRuleOriginInheriteAtLeastOne:!0,storageRuleOriginHasAtLeastOne:!0,storageRuleOriginHasNoOne:!1,storageRuleOriginWaitingRecalculate:this.hasWaitingToRecalculateCriteria,copyFinalActionType:!1,transferFinalActionType:!1,storageRuleFinalActionHasFinalAction:!1,storageRuleFinalActionInheriteFinalAction:!1,restrictAccessFinalActionType:!1},this.addCriteria("RULE_ORIGIN_STORAGE_RULE",{value:"ORIGIN_HAS_AT_LEAST_ONE",id:"ORIGIN_HAS_AT_LEAST_ONE"},"ORIGIN_HAS_AT_LEAST_ONE",!0,C.v.EXISTS,!0,C.u.STRING,C.Z.STORAGE_RULE),this.storageAdditionalCriteria.set("ORIGIN_HAS_AT_LEAST_ONE",!0)}checkBoxChange(e,t){const i=t.target.checked;switch(this.storageAdditionalCriteria.set(e,i),e){case"ORIGIN_HAS_NO_ONE":i?this.addCriteria("RULE_ORIGIN_STORAGE_RULE",{id:"ORIGIN_HAS_NO_ONE",value:"ORIGIN_HAS_NO_ONE"},"ORIGIN_HAS_NO_ONE",!0,C.v.MISSING,!0,C.u.STRING,C.Z.STORAGE_RULE):this.emitRemoveCriteriaEvent("RULE_ORIGIN_STORAGE_RULE",{id:"ORIGIN_HAS_NO_ONE",value:"ORIGIN_HAS_NO_ONE"}),this.previousStorageCriteriaValue.storageRuleOriginHasNoOne=i;break;case"ORIGIN_WAITING_RECALCULATE":i?this.addCriteria("RULE_ORIGIN_STORAGE_RULE",{id:"ORIGIN_WAITING_RECALCULATE",value:"ORIGIN_WAITING_RECALCULATE"},"ORIGIN_WAITING_RECALCULATE",!0,C.v.EQ,!0,C.u.STRING,C.Z.STORAGE_RULE):this.emitRemoveCriteriaEvent("RULE_ORIGIN_STORAGE_RULE",{id:"ORIGIN_WAITING_RECALCULATE",value:"ORIGIN_WAITING_RECALCULATE"}),this.previousStorageCriteriaValue.storageRuleOriginWaitingRecalculate=i;break;case"ORIGIN_HAS_AT_LEAST_ONE":i?this.addCriteria("RULE_ORIGIN_STORAGE_RULE",{id:"ORIGIN_HAS_AT_LEAST_ONE",value:"ORIGIN_HAS_AT_LEAST_ONE"},"ORIGIN_HAS_AT_LEAST_ONE",!0,C.v.EXISTS,!0,C.u.STRING,C.Z.STORAGE_RULE):this.emitRemoveCriteriaEvent("RULE_ORIGIN_STORAGE_RULE",{id:"ORIGIN_HAS_AT_LEAST_ONE",value:"ORIGIN_HAS_AT_LEAST_ONE"}),this.previousStorageCriteriaValue.storageRuleOriginHasAtLeastOne=i;break;case"FINAL_ACTION_TYPE_COPY":i?this.addCriteria("FINAL_ACTION_TYPE_STORAGE_RULE",{id:"FINAL_ACTION_TYPE_COPY",value:"FINAL_ACTION_TYPE_COPY"},"FINAL_ACTION_TYPE_COPY",!0,C.v.EQ,!0,C.u.STRING,C.Z.STORAGE_RULE):this.emitRemoveCriteriaEvent("FINAL_ACTION_TYPE_STORAGE_RULE",{id:"FINAL_ACTION_TYPE_COPY",value:"FINAL_ACTION_TYPE_COPY"}),this.previousStorageCriteriaValue.copyFinalActionType=i;break;case"FINAL_ACTION_TYPE_TRANSFER":i?this.addCriteria("FINAL_ACTION_TYPE_STORAGE_RULE",{id:"FINAL_ACTION_TYPE_TRANSFER",value:"FINAL_ACTION_TYPE_TRANSFER"},"FINAL_ACTION_TYPE_TRANSFER",!0,C.v.EQ,!0,C.u.STRING,C.Z.STORAGE_RULE):this.emitRemoveCriteriaEvent("FINAL_ACTION_TYPE_STORAGE_RULE",{id:"FINAL_ACTION_TYPE_TRANSFER",value:"FINAL_ACTION_TYPE_TRANSFER"}),this.previousStorageCriteriaValue.transferFinalActionType=i;break;case"FINAL_ACTION_TYPE_RESTRICT_ACCESS":i?this.addCriteria("FINAL_ACTION_TYPE_STORAGE_RULE",{id:"FINAL_ACTION_TYPE_RESTRICT_ACCESS",value:"FINAL_ACTION_TYPE_RESTRICT_ACCESS"},"FINAL_ACTION_TYPE_RESTRICT_ACCESS",!0,C.v.EQ,!0,C.u.STRING,C.Z.STORAGE_RULE):this.emitRemoveCriteriaEvent("FINAL_ACTION_TYPE_STORAGE_RULE",{id:"FINAL_ACTION_TYPE_RESTRICT_ACCESS",value:"FINAL_ACTION_TYPE_RESTRICT_ACCESS"}),this.previousStorageCriteriaValue.restrictAccessFinalActionType=i;break;case"FINAL_ACTION_HAS_FINAL_ACTION":i?this.addCriteria("FINAL_ACTION_STORAGE_RULE",{id:"FINAL_ACTION_HAS_FINAL_ACTION",value:"FINAL_ACTION_HAS_FINAL_ACTION"},"FINAL_ACTION_HAS_FINAL_ACTION",!0,C.v.EQ,!0,C.u.STRING,C.Z.STORAGE_RULE):this.emitRemoveCriteriaEvent("FINAL_ACTION_STORAGE_RULE",{id:"FINAL_ACTION_HAS_FINAL_ACTION",value:"FINAL_ACTION_HAS_FINAL_ACTION"}),this.previousStorageCriteriaValue.storageRuleFinalActionHasFinalAction=i}}addBeginDtDucCriteria(){this.storageRuleCriteriaForm.value.storageRuleStartDate&&(this.addCriteria("RULE_END_DATE_STORAGE_RULE",{id:this.storageRuleCriteriaForm.value.storageRuleStartDate+"-",beginInterval:"",endInterval:this.storageRuleCriteriaForm.value.storageRuleStartDate},this.storageRuleCriteriaForm.value.storageRuleStartDate,!0,C.v.LTE,!1,C.u.INTERVAL,C.Z.STORAGE_RULE),this.storageRuleCriteriaForm.controls.storageRuleStartDate.setValue(null))}addCriteriaRulePostCheck(){this.storageRuleCriteriaForm.value.storageRuleIdentifier&&(this.addCriteria("RULE_IDENTIFIER_STORAGE_RULE",{id:this.storageRuleCriteriaForm.value.storageRuleIdentifier.trim(),value:this.storageRuleCriteriaForm.value.storageRuleIdentifier.trim()},this.storageRuleCriteriaForm.value.storageRuleIdentifier.trim(),!0,C.v.EQ,!1,C.u.STRING,C.Z.STORAGE_RULE),this.storageRuleCriteriaForm.controls.storageRuleIdentifier.setValue(null))}addIntervalDtDucCriteria(){this.storageRuleCriteriaForm.value.storageRuleStartDate&&this.storageRuleCriteriaForm.value.storageRuleEndDate&&(this.addCriteria("RULE_END_DATE_STORAGE_RULE",{id:this.storageRuleCriteriaForm.value.storageRuleStartDate+"-"+this.storageRuleCriteriaForm.value.storageRuleEndDate,beginInterval:this.storageRuleCriteriaForm.value.storageRuleStartDate,endInterval:this.storageRuleCriteriaForm.value.storageRuleEndDate},this.storageRuleCriteriaForm.value.storageRuleStartDate,!0,C.v.BETWEEN,!1,C.u.INTERVAL,C.Z.STORAGE_RULE),this.storageRuleCriteriaForm.controls.storageRuleStartDate.setValue(null),this.storageRuleCriteriaForm.controls.storageRuleEndDate.setValue(null))}isEmpty(e){return!!e&&(e.storageRuleIdentifier?(this.addCriteria("RULE_IDENTIFIER_STORAGE_RULE",{id:e.storageRuleIdentifier.trim(),value:e.storageRuleIdentifier.trim()},e.storageRuleIdentifier.trim(),!0,C.v.EQ,!1,C.u.STRING,C.Z.STORAGE_RULE),this.resetStorageRuleCriteriaForm(),!0):e.storageRuleTitle?(this.addCriteria("RULE_TITLE_STORAGE_RULE",{id:e.storageRuleTitle.trim(),value:e.storageRuleTitle.trim()},e.storageRuleTitle.trim(),!0,C.v.EQ,!1,C.u.STRING,C.Z.STORAGE_RULE),!0):void 0)}updateEndDateInterval(e){this.endDateInterval=e}resetStorageRuleCriteriaForm(){this.storageRuleCriteriaForm.reset(this.previousStorageCriteriaValue)}emitRemoveCriteriaEvent(e,t){this.archiveExchangeDataService.sendRemoveFromChildSearchCriteriaAction({keyElt:e,valueElt:t,action:"REMOVE"})}addCriteria(e,t,i,c,a,r,n,s){e&&t&&this.archiveExchangeDataService.addSimpleSearchCriteriaSubject({keyElt:e,valueElt:t,labelElt:i,keyTranslated:c,operator:a,category:s,valueTranslated:r,dataType:n})}ngOnDestroy(){this.subscriptionStorageFromMainSearchCriteria.unsubscribe()}get storageRuleIdentifier(){return this.storageRuleCriteriaForm.controls.storageRuleIdentifier}get storageRuleTitle(){return this.storageRuleCriteriaForm.controls.storageRuleTitle}get storageRuleStartDate(){return this.storageRuleCriteriaForm.controls.storageRuleStartDate}get storageRuleEndDate(){return this.storageRuleCriteriaForm.controls.storageRuleEndDate}get storageRuleEliminationIdentifier(){return this.storageRuleCriteriaForm.controls.storageRuleEliminationIdentifier}}return e.\u0275fac=function(t){return new(t||e)(_.Xb(a.e),_.Xb(n.b),_.Xb(de),_.Xb(na))},e.\u0275cmp=_.Rb({type:e,selectors:[["app-storage-rule-search"]],inputs:{hasWaitingToRecalculateCriteria:"hasWaitingToRecalculateCriteria"},decls:106,vars:71,consts:[[1,"container"],[3,"formGroup"],[1,"row","justify-content-start"],[1,"form-control"],[1,"title-text"],[1,"col-5","form-control"],["formControlName","storageRuleIdentifier","minlength","1",3,"validator","asyncValidator","label"],["errorKey","required"],["errorKey","ruleIdPattern"],["errorKey","ruleIdExists"],[1,"col-1","form-control"],["formControlName","storageRuleTitle",3,"validator","label"],[1,"col-11","form-control"],[1,"vitamui-input",3,"click"],["class","search-date-label",3,"click",4,"ngIf","ngIfElse"],["showBeginDtDuc",""],["size","0","formControlName","storageRuleStartDate",1,"hidden",3,"matDatepicker","max"],["pickerBeginDuc",""],["class","validate-action-button","type","button","mat-mini-fab","",3,"click",4,"ngIf"],[1,"col-4","form-control"],["class","title-text text-clicable-uppercase",3,"click",4,"ngIf"],["class","vitamui-input",3,"click",4,"ngIf"],["class","validate-date-small-button","type","button","mat-mini-fab","",3,"click",4,"ngIf"],[1,"row","justify-content-around"],[1,"row","criteria-choice"],[1,"row"],[1,"criteria-checkbox-choice"],["type","checkbox","id","HAS_AT_LEAST_ONE_RULE_ORIGIN",3,"checked","click"],["id","HAS_NO_RULE_ORIGIN","type","checkbox",3,"checked","click"],["id","WAITING_TO_RE_CALCULATE_RULE_ORIGIN","type","checkbox",3,"checked","click"],["id","HAS_FINAL_ACTION_TYPE","type","checkbox",3,"checked","click"],[1,"col-3","form-control"],["type","checkbox","id","COPY_FINAL_ACTION",3,"checked","click"],["type","checkbox","id","TRANSFER_FINAL_ACTION",3,"checked","click"],["type","checkbox","id","RESTRICT_ACCESS_FINAL_ACTION",3,"checked","click"],[1,"search-date-label",3,"click"],[3,"click"],["type","button","mat-mini-fab","",1,"validate-action-button",3,"click"],[1,"material-icons"],[1,"title-text","text-clicable-uppercase",3,"click"],["showEndDtDuc",""],["size","0","formControlName","storageRuleEndDate",1,"hidden",3,"matDatepicker","min"],["pickerEndDuc",""],["type","button","mat-mini-fab","",1,"validate-date-small-button",3,"click"]],template:function(e,t){if(1&e){const e=_.ec();_.dc(0,"div",0),_.dc(1,"form",1),_.dc(2,"div",2),_.dc(3,"div",3),_.dc(4,"p",4),_.Vc(5),_.qc(6,"translate"),_.cc(),_.cc(),_.cc(),_.dc(7,"div",2),_.dc(8,"div",5),_.dc(9,"vitamui-common-editable-input",6),_.qc(10,"translate"),_.dc(11,"vitamui-common-field-error",7),_.Vc(12),_.qc(13,"translate"),_.cc(),_.dc(14,"vitamui-common-field-error",8),_.Vc(15),_.qc(16,"translate"),_.cc(),_.dc(17,"vitamui-common-field-error",9),_.Vc(18),_.qc(19,"translate"),_.cc(),_.cc(),_.cc(),_.Yb(20,"div",10),_.dc(21,"div",5),_.Yb(22,"vitamui-common-editable-input",11),_.qc(23,"translate"),_.cc(),_.Yb(24,"div",10),_.cc(),_.dc(25,"div",2),_.dc(26,"div",12),_.dc(27,"p",4),_.Vc(28),_.qc(29,"translate"),_.cc(),_.cc(),_.cc(),_.dc(30,"div",2),_.dc(31,"div",5),_.dc(32,"div",13),_.lc("click",(function(){return _.Kc(e),_.Gc(38).open()})),_.Tc(33,la,3,3,"span",14),_.Tc(34,oa,3,4,"ng-template",null,15,_.Uc),_.Yb(36,"input",16),_.Yb(37,"mat-datepicker",null,17),_.cc(),_.cc(),_.dc(39,"div",10),_.Tc(40,da,3,0,"button",18),_.cc(),_.dc(41,"div",19),_.Tc(42,ua,3,3,"p",20),_.Tc(43,Ea,7,4,"div",21),_.cc(),_.dc(44,"div",10),_.Tc(45,Ra,3,0,"button",22),_.cc(),_.dc(46,"div",10),_.Tc(47,pa,3,3,"p",20),_.cc(),_.cc(),_.dc(48,"div",23),_.dc(49,"div",19),_.dc(50,"div",24),_.dc(51,"p",4),_.Vc(52),_.qc(53,"translate"),_.cc(),_.cc(),_.dc(54,"div",25),_.dc(55,"label",26),_.dc(56,"input",27),_.lc("click",(function(e){return t.checkBoxChange("ORIGIN_HAS_AT_LEAST_ONE",e)})),_.cc(),_.dc(57,"span"),_.Vc(58),_.qc(59,"translate"),_.cc(),_.cc(),_.cc(),_.dc(60,"div",25),_.dc(61,"label",26),_.dc(62,"input",28),_.lc("click",(function(e){return t.checkBoxChange("ORIGIN_HAS_NO_ONE",e)})),_.cc(),_.dc(63,"span"),_.Vc(64),_.qc(65,"translate"),_.cc(),_.cc(),_.cc(),_.dc(66,"div",25),_.dc(67,"label",26),_.dc(68,"input",29),_.lc("click",(function(e){return t.checkBoxChange("ORIGIN_WAITING_RECALCULATE",e)})),_.cc(),_.dc(69,"span"),_.Vc(70),_.qc(71,"translate"),_.cc(),_.cc(),_.cc(),_.cc(),_.dc(72,"div",19),_.dc(73,"div",24),_.dc(74,"p",4),_.Vc(75),_.qc(76,"translate"),_.cc(),_.cc(),_.dc(77,"div",25),_.dc(78,"label",26),_.dc(79,"input",30),_.lc("click",(function(e){return t.checkBoxChange("FINAL_ACTION_HAS_FINAL_ACTION",e)})),_.cc(),_.dc(80,"span"),_.Vc(81),_.qc(82,"translate"),_.cc(),_.cc(),_.cc(),_.cc(),_.dc(83,"div",31),_.dc(84,"div",24),_.dc(85,"p",4),_.Vc(86),_.qc(87,"translate"),_.cc(),_.cc(),_.dc(88,"div",25),_.dc(89,"label",26),_.dc(90,"input",32),_.lc("click",(function(e){return t.checkBoxChange("FINAL_ACTION_TYPE_COPY",e)})),_.cc(),_.dc(91,"span"),_.Vc(92),_.qc(93,"translate"),_.cc(),_.cc(),_.cc(),_.dc(94,"div",25),_.dc(95,"label",26),_.dc(96,"input",33),_.lc("click",(function(e){return t.checkBoxChange("FINAL_ACTION_TYPE_TRANSFER",e)})),_.cc(),_.dc(97,"span"),_.Vc(98),_.qc(99,"translate"),_.cc(),_.cc(),_.cc(),_.dc(100,"div",25),_.dc(101,"label",26),_.dc(102,"input",34),_.lc("click",(function(e){return t.checkBoxChange("FINAL_ACTION_TYPE_RESTRICT_ACCESS",e)})),_.cc(),_.dc(103,"span"),_.Vc(104),_.qc(105,"translate"),_.cc(),_.cc(),_.cc(),_.cc(),_.cc(),_.cc(),_.cc()}if(2&e){const e=_.Gc(35),r=_.Gc(38);var i=null,c=null,a=null;_.Lb(1),_.vc("formGroup",t.storageRuleCriteriaForm),_.Lb(4),_.Wc(_.rc(6,37,"COLLECT.SEARCH_CRITERIA_FILTER.STORAGE_TITLE")),_.Lb(4),_.wc("label",_.rc(10,39,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.ID_DUA")),_.vc("validator",null==t.storageRuleCriteriaForm||null==(i=t.storageRuleCriteriaForm.get("storageRuleIdentifier"))?null:i.validator)("asyncValidator",null==t.storageRuleCriteriaForm||null==(c=t.storageRuleCriteriaForm.get("storageRuleIdentifier"))?null:c.asyncValidator),_.Lb(3),_.Xc("",_.rc(13,41,"COMMON.REQUIRED")," "),_.Lb(3),_.Xc("",_.rc(16,43,"COLLECT.RULE.WRONG_FORMAT")," "),_.Lb(3),_.Xc("",_.rc(19,45,"COLLECT.RULE.CODE_NOT_EXIST")," "),_.Lb(4),_.wc("label",_.rc(23,47,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.TITLE_DUA")),_.vc("validator",null==t.storageRuleCriteriaForm||null==(a=t.storageRuleCriteriaForm.get("storageRuleTitle"))?null:a.validator),_.Lb(6),_.Wc(_.rc(29,49,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.END_DATE_DUA")),_.Lb(5),_.vc("ngIf",!t.storageRuleCriteriaForm.get("storageRuleStartDate").value)("ngIfElse",e),_.Lb(3),_.vc("matDatepicker",r)("max",t.storageRuleCriteriaForm.get("storageRuleEndDate").value),_.Lb(4),_.vc("ngIf",!t.endDateInterval&&t.storageRuleCriteriaForm.get("storageRuleStartDate").value),_.Lb(2),_.vc("ngIf",!t.endDateInterval),_.Lb(1),_.vc("ngIf",t.endDateInterval),_.Lb(2),_.vc("ngIf",t.endDateInterval&&t.storageRuleCriteriaForm.get("storageRuleStartDate").value&&t.storageRuleCriteriaForm.get("storageRuleEndDate").value),_.Lb(2),_.vc("ngIf",t.endDateInterval),_.Lb(5),_.Xc(" ",_.rc(53,51,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.ORIGIN.TITLE")," "),_.Lb(4),_.vc("checked",t.storageAdditionalCriteria.get("ORIGIN_HAS_AT_LEAST_ONE")),_.Lb(2),_.Wc(_.rc(59,53,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.ORIGIN.HAS_AT_LEAST_ONE_STORAGE_RULE")),_.Lb(4),_.vc("checked",t.storageAdditionalCriteria.get("ORIGIN_HAS_NO_ONE")),_.Lb(2),_.Wc(_.rc(65,55,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.ORIGIN.HAS_NO_STORAGE_RULE")),_.Lb(4),_.vc("checked",t.storageAdditionalCriteria.get("ORIGIN_WAITING_RECALCULATE")),_.Lb(2),_.Wc(_.rc(71,57,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.ORIGIN.WAITING_TO_RE_CALCULATE_STORAGE_RULE")),_.Lb(5),_.Xc(" ",_.rc(76,59,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.FINAL_ACTION_TYPE.TITLE")," "),_.Lb(4),_.vc("checked",t.storageAdditionalCriteria.get("FINAL_ACTION_HAS_FINAL_ACTION")),_.Lb(2),_.Wc(_.rc(82,61,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.FINAL_ACTION_TYPE.HAS_STORAGE_RULE")),_.Lb(5),_.Xc(" ",_.rc(87,63,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.FINAL_ACTION.TITLE")," "),_.Lb(4),_.vc("checked",t.storageAdditionalCriteria.get("FINAL_ACTION_TYPE_COPY")),_.Lb(2),_.Wc(_.rc(93,65,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.FINAL_ACTION.COPY_STORAGE_RULE")),_.Lb(4),_.vc("checked",t.storageAdditionalCriteria.get("FINAL_ACTION_TYPE_TRANSFER")),_.Lb(2),_.Wc(_.rc(99,67,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.FINAL_ACTION.TRANSFER_STORAGE_RULE")),_.Lb(4),_.vc("checked",t.storageAdditionalCriteria.get("FINAL_ACTION_TYPE_RESTRICT_ACCESS")),_.Lb(2),_.Wc(_.rc(105,69,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.FINAL_ACTION.RESTRICT_ACCESS_STORAGE_RULE"))}},directives:[a.x,a.q,a.i,C.C,a.p,a.h,a.l,C.mb,c.p,a.c,r.b,r.a,sa.a],pipes:[O.d,c.e],styles:['.check-rule[_ngcontent-%COMP%]{margin-right:25%;margin-left:-15%;margin-top:5px}.title-text[_ngcontent-%COMP%]{font-style:normal;font-weight:700;font-size:16px;color:var(--vitamui-primary)!important}.validate-action-button[_ngcontent-%COMP%]{background-color:"green";width:"30";height:"30"}']}),e})();function Ia(e,t){if(1&e){const e=_.ec();_.dc(0,"span",35),_.lc("click",(function(){return _.Kc(e),_.pc(),_.Gc(38).open()})),_.Vc(1),_.qc(2,"translate"),_.cc()}if(2&e){const e=_.pc();_.Lb(1),_.Wc(_.rc(2,1,e.endDateInterval?"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.END_DATE_DUA_BEGIN":"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.END_DATE_DUA_EQUAL"))}}function Ta(e,t){if(1&e){const e=_.ec();_.dc(0,"span",36),_.lc("click",(function(){return _.Kc(e),_.pc(),_.Gc(38).open()})),_.Vc(1),_.qc(2,"dateTime"),_.cc()}if(2&e){const e=_.pc();_.Lb(1),_.Xc("",_.sc(2,1,e.appraisalRuleCriteriaForm.get("appraisalRuleStartDate").value,"dd/MM/yyyy")," ")}}function ga(e,t){if(1&e){const e=_.ec();_.dc(0,"button",37),_.lc("click",(function(){return _.Kc(e),_.pc().addBeginDtDuaCriteria()})),_.dc(1,"i",38),_.Vc(2,"check"),_.cc(),_.cc()}}function La(e,t){if(1&e){const e=_.ec();_.dc(0,"p",39),_.lc("click",(function(){return _.Kc(e),_.pc().updateEndDateInterval(!0)})),_.Vc(1),_.qc(2,"translate"),_.cc()}2&e&&(_.Lb(1),_.Xc(" ",_.rc(2,1,"COLLECT.SEARCH_CRITERIA_FILTER.APPRAISAL_RULE.CREATE_INTERVAL")," "))}function ba(e,t){if(1&e){const e=_.ec();_.dc(0,"span",35),_.lc("click",(function(){return _.Kc(e),_.pc(),_.Gc(6).open()})),_.Vc(1),_.qc(2,"translate"),_.cc()}2&e&&(_.Lb(1),_.Wc(_.rc(2,1,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.END_DATE_DUA_END")))}function Aa(e,t){if(1&e){const e=_.ec();_.dc(0,"span",36),_.lc("click",(function(){return _.Kc(e),_.pc(),_.Gc(6).open()})),_.Vc(1),_.qc(2,"dateTime"),_.cc()}if(2&e){const e=_.pc(2);_.Lb(1),_.Xc("",_.sc(2,1,e.appraisalRuleCriteriaForm.get("appraisalRuleEndDate").value,"dd/MM/yyyy")," ")}}function Sa(e,t){if(1&e){const e=_.ec();_.dc(0,"div",13),_.lc("click",(function(){return _.Kc(e),_.Gc(6).open()})),_.Tc(1,ba,3,3,"span",14),_.Tc(2,Aa,3,4,"ng-template",null,40,_.Uc),_.Yb(4,"input",41),_.Yb(5,"mat-datepicker",null,42),_.cc()}if(2&e){const e=_.Gc(3),t=_.Gc(6),i=_.pc();_.Lb(1),_.vc("ngIf",!i.appraisalRuleCriteriaForm.get("appraisalRuleEndDate").value)("ngIfElse",e),_.Lb(3),_.vc("matDatepicker",t)("min",i.appraisalRuleCriteriaForm.get("appraisalRuleStartDate").value)}}function _a(e,t){if(1&e){const e=_.ec();_.dc(0,"button",37),_.lc("click",(function(){return _.Kc(e),_.pc().addIntervalDtDuaCriteria()})),_.dc(1,"i",38),_.Vc(2,"check"),_.cc(),_.cc()}}function ma(e,t){if(1&e){const e=_.ec();_.dc(0,"p",39),_.lc("click",(function(){return _.Kc(e),_.pc().updateEndDateInterval(!1)})),_.Vc(1),_.qc(2,"translate"),_.cc()}2&e&&(_.Lb(1),_.Xc(" ",_.rc(2,1,"COLLECT.SEARCH_CRITERIA_FILTER.APPRAISAL_RULE.DELETE_INTERVAL")," "))}let fa=(()=>{class e{constructor(e,t,i,c){this.formBuilder=e,this.dialog=t,this.archiveExchangeDataService=i,this.ruleValidator=c,this.appraisalCriteriaList=[],this.appraisalAdditionalCriteria=new Map,this.endDateInterval=!1,this.emptyAppraisalCriteriaForm={appraisalRuleIdentifier:"",appraisalRuleTitle:"",appraisalRuleStartDate:"",appraisalRuleEndDate:"",appraisalRuleOriginInheriteAtLeastOne:!0,appraisalRuleOriginHasAtLeastOne:!0,appraisalRuleOriginHasNoOne:!1,appraisalRuleOriginWaitingRecalculate:!1,eliminationFinalActionType:!1,keepFinalActionType:!1,appraisalRuleFinalActionHasFinalAction:!1,appraisalRuleFinalActionInheriteFinalAction:!1,appraisalRuleEliminationIdentifier:""},this.showUnitPreviewBlock=!1,this.appraisalRuleCriteriaForm=this.formBuilder.group({appraisalRuleIdentifier:[null,[z.c.ruleIdPattern],this.ruleValidator.uniqueRuleId()],appraisalRuleTitle:["",[]],appraisalRuleStartDate:["",[]],appraisalRuleEndDate:["",[]],appraisalRuleEliminationIdentifier:["",[]]}),Object(I.a)(this.appraisalRuleCriteriaForm.statusChanges,this.appraisalRuleCriteriaForm.valueChanges).pipe(Object(L.a)(me.UPDATE_DEBOUNCE_TIME),Object(b.a)(()=>this.appraisalRuleCriteriaForm.value),Object(b.a)(()=>Object(C.sb)(this.appraisalRuleCriteriaForm.value,this.previousAppraisalCriteriaValue)),Object(Pt.a)(e=>this.isEmpty(e))).subscribe(()=>{this.resetAppraisalRuleCriteriaForm()}),this.appraisalRuleCriteriaForm.get("appraisalRuleTitle").valueChanges.subscribe(e=>{null!==this.appraisalRuleCriteriaForm.get("appraisalRuleTitle").value&&""!==this.appraisalRuleCriteriaForm.get("appraisalRuleTitle").value&&(this.addCriteria("RULE_TITLE_APPRAISAL_RULE",{id:e,value:e},e,!0,C.v.EQ,!1,C.u.STRING,C.Z.APPRAISAL_RULE),this.resetAppraisalRuleCriteriaForm())}),this.subscriptionAppraisalFromMainSearchCriteria=this.archiveExchangeDataService.appraisalFromMainSearchCriteriaObservable.subscribe(e=>{e&&(e.action===C.d.ADD?this.appraisalAdditionalCriteria.set(e.valueElt.value,!0):e.action===C.d.REMOVE&&this.appraisalAdditionalCriteria&&this.appraisalAdditionalCriteria.has(e.valueElt.value)&&this.appraisalAdditionalCriteria.set(e.valueElt.value,!1))})}checkBoxChange(e,t){const i=t.target.checked;switch(this.appraisalAdditionalCriteria.set(e,i),e){case"ORIGIN_HAS_NO_ONE":i?this.addCriteria("RULE_ORIGIN_APPRAISAL_RULE",{id:"ORIGIN_HAS_NO_ONE",value:"ORIGIN_HAS_NO_ONE"},"ORIGIN_HAS_NO_ONE",!0,C.v.MISSING,!0,C.u.STRING,C.Z.APPRAISAL_RULE):this.emitRemoveCriteriaEvent("RULE_ORIGIN_APPRAISAL_RULE",{id:"ORIGIN_HAS_NO_ONE",value:"ORIGIN_HAS_NO_ONE"}),this.previousAppraisalCriteriaValue.appraisalRuleOriginHasNoOne=i;break;case"ORIGIN_WAITING_RECALCULATE":i?this.addCriteria("RULE_ORIGIN_APPRAISAL_RULE",{id:"ORIGIN_WAITING_RECALCULATE",value:"ORIGIN_WAITING_RECALCULATE"},"ORIGIN_WAITING_RECALCULATE",!0,C.v.EQ,!0,C.u.STRING,C.Z.APPRAISAL_RULE):this.emitRemoveCriteriaEvent("RULE_ORIGIN_APPRAISAL_RULE",{id:"ORIGIN_WAITING_RECALCULATE",value:"ORIGIN_WAITING_RECALCULATE"}),this.previousAppraisalCriteriaValue.appraisalRuleOriginWaitingRecalculate=i;break;case"ORIGIN_HAS_AT_LEAST_ONE":i?this.addCriteria("RULE_ORIGIN_APPRAISAL_RULE",{id:"ORIGIN_HAS_AT_LEAST_ONE",value:"ORIGIN_HAS_AT_LEAST_ONE"},"ORIGIN_HAS_AT_LEAST_ONE",!0,C.v.EXISTS,!0,C.u.STRING,C.Z.APPRAISAL_RULE):this.emitRemoveCriteriaEvent("RULE_ORIGIN_APPRAISAL_RULE",{id:"ORIGIN_HAS_AT_LEAST_ONE",value:"ORIGIN_HAS_AT_LEAST_ONE"}),this.previousAppraisalCriteriaValue.appraisalRuleOriginHasAtLeastOne=i;break;case"FINAL_ACTION_TYPE_ELIMINATION":i?this.addCriteria("FINAL_ACTION_TYPE_APPRAISAL_RULE",{id:"FINAL_ACTION_TYPE_ELIMINATION",value:"FINAL_ACTION_TYPE_ELIMINATION"},"FINAL_ACTION_TYPE_ELIMINATION",!0,C.v.EQ,!0,C.u.STRING,C.Z.APPRAISAL_RULE):this.emitRemoveCriteriaEvent("FINAL_ACTION_TYPE_APPRAISAL_RULE",{id:"FINAL_ACTION_TYPE_ELIMINATION",value:"FINAL_ACTION_TYPE_ELIMINATION"}),this.previousAppraisalCriteriaValue.eliminationFinalActionType=i;break;case"FINAL_ACTION_TYPE_KEEP":i?this.addCriteria("FINAL_ACTION_TYPE_APPRAISAL_RULE",{id:"FINAL_ACTION_TYPE_KEEP",value:"FINAL_ACTION_TYPE_KEEP"},"FINAL_ACTION_TYPE_KEEP",!0,C.v.EQ,!0,C.u.STRING,C.Z.APPRAISAL_RULE):this.emitRemoveCriteriaEvent("FINAL_ACTION_TYPE_APPRAISAL_RULE",{id:"FINAL_ACTION_TYPE_KEEP",value:"FINAL_ACTION_TYPE_KEEP"}),this.previousAppraisalCriteriaValue.keepFinalActionType=i;break;case"FINAL_ACTION_HAS_FINAL_ACTION":i?this.addCriteria("FINAL_ACTION_APPRAISAL_RULE",{id:"FINAL_ACTION_HAS_FINAL_ACTION",value:"FINAL_ACTION_HAS_FINAL_ACTION"},"FINAL_ACTION_HAS_FINAL_ACTION",!0,C.v.EQ,!0,C.u.STRING,C.Z.APPRAISAL_RULE):this.emitRemoveCriteriaEvent("FINAL_ACTION_APPRAISAL_RULE",{id:"FINAL_ACTION_HAS_FINAL_ACTION",value:"FINAL_ACTION_HAS_FINAL_ACTION"}),this.previousAppraisalCriteriaValue.appraisalRuleFinalActionHasFinalAction=i}}addBeginDtDuaCriteria(){this.appraisalRuleCriteriaForm.value.appraisalRuleStartDate&&(this.addCriteria("RULE_END_DATE_APPRAISAL_RULE",{id:this.appraisalRuleCriteriaForm.value.appraisalRuleStartDate+"-",beginInterval:"",endInterval:this.appraisalRuleCriteriaForm.value.appraisalRuleStartDate},this.appraisalRuleCriteriaForm.value.appraisalRuleStartDate,!0,C.v.LTE,!1,C.u.INTERVAL,C.Z.APPRAISAL_RULE),this.appraisalRuleCriteriaForm.controls.appraisalRuleStartDate.setValue(null))}addCriteriaRulePostCheck(){this.appraisalRuleCriteriaForm.value.appraisalRuleIdentifier&&(this.addCriteria("RULE_IDENTIFIER_APPRAISAL_RULE",{id:this.appraisalRuleCriteriaForm.value.appraisalRuleIdentifier.trim(),value:this.appraisalRuleCriteriaForm.value.appraisalRuleIdentifier.trim()},this.appraisalRuleCriteriaForm.value.appraisalRuleIdentifier.trim(),!0,C.v.EQ,!1,C.u.STRING,C.Z.APPRAISAL_RULE),this.appraisalRuleCriteriaForm.controls.appraisalRuleIdentifier.setValue(null))}addIntervalDtDuaCriteria(){this.appraisalRuleCriteriaForm.value.appraisalRuleStartDate&&this.appraisalRuleCriteriaForm.value.appraisalRuleEndDate&&(this.addCriteria("RULE_END_DATE_APPRAISAL_RULE",{id:this.appraisalRuleCriteriaForm.value.appraisalRuleStartDate+"-"+this.appraisalRuleCriteriaForm.value.appraisalRuleEndDate,beginInterval:this.appraisalRuleCriteriaForm.value.appraisalRuleStartDate,endInterval:this.appraisalRuleCriteriaForm.value.appraisalRuleEndDate},this.appraisalRuleCriteriaForm.value.appraisalRuleStartDate,!0,C.v.BETWEEN,!1,C.u.INTERVAL,C.Z.APPRAISAL_RULE),this.appraisalRuleCriteriaForm.controls.appraisalRuleStartDate.setValue(null),this.appraisalRuleCriteriaForm.controls.appraisalRuleEndDate.setValue(null))}isEmpty(e){return!!e&&(e.appraisalRuleIdentifier?(this.addCriteria("RULE_IDENTIFIER_APPRAISAL_RULE",{id:e.appraisalRuleIdentifier.trim(),value:e.appraisalRuleIdentifier.trim()},e.appraisalRuleIdentifier.trim(),!0,C.v.EQ,!1,C.u.STRING,C.Z.APPRAISAL_RULE),this.resetAppraisalRuleCriteriaForm(),!0):e.appraisalRuleTitle?(this.addCriteria("RULE_TITLE_APPRAISAL_RULE",{id:e.appraisalRuleTitle.trim(),value:e.appraisalRuleTitle.trim()},e.appraisalRuleTitle.trim(),!0,C.v.EQ,!1,C.u.STRING,C.Z.APPRAISAL_RULE),!0):e.appraisalRuleEliminationIdentifier?(this.addCriteria("ELIMINATION_TECHNICAL_ID_APPRAISAL_RULE",{id:e.appraisalRuleEliminationIdentifier.trim(),value:e.appraisalRuleEliminationIdentifier.trim()},e.appraisalRuleEliminationIdentifier.trim(),!0,C.v.EQ,!1,C.u.STRING,C.Z.FIELDS),!0):void 0)}updateEndDateInterval(e){this.endDateInterval=e}resetAppraisalRuleCriteriaForm(){this.appraisalRuleCriteriaForm.reset(this.previousAppraisalCriteriaValue)}ngOnInit(){this.appraisalAdditionalCriteria=new Map,this.appraisalAdditionalCriteria.set("ORIGIN_WAITING_RECALCULATE",!0===this.hasWaitingToRecalculateCriteria),this.appraisalAdditionalCriteria.set("FINAL_ACTION_TYPE_ELIMINATION",!1),this.appraisalAdditionalCriteria.set("FINAL_ACTION_TYPE_KEEP",!1),this.appraisalAdditionalCriteria.set("ORIGIN_HAS_NO_ONE",!1),this.appraisalAdditionalCriteria.set("ORIGIN_HAS_AT_LEAST_ONE",!1),this.appraisalAdditionalCriteria.set("FINAL_ACTION_HAS_FINAL_ACTION",!1),this.previousAppraisalCriteriaValue={appraisalRuleIdentifier:"",appraisalRuleTitle:"",appraisalRuleStartDate:"",appraisalRuleEndDate:"",appraisalRuleOriginInheriteAtLeastOne:!0,appraisalRuleOriginHasAtLeastOne:!0,appraisalRuleOriginHasNoOne:!1,appraisalRuleOriginWaitingRecalculate:this.hasWaitingToRecalculateCriteria,eliminationFinalActionType:!1,keepFinalActionType:!1,appraisalRuleFinalActionHasFinalAction:!1,appraisalRuleFinalActionInheriteFinalAction:!1,appraisalRuleEliminationIdentifier:""},this.addCriteria("RULE_ORIGIN_APPRAISAL_RULE",{value:"ORIGIN_HAS_AT_LEAST_ONE",id:"ORIGIN_HAS_AT_LEAST_ONE"},"ORIGIN_HAS_AT_LEAST_ONE",!0,C.v.EXISTS,!0,C.u.STRING,C.Z.APPRAISAL_RULE),this.appraisalAdditionalCriteria.set("ORIGIN_HAS_AT_LEAST_ONE",!0)}emitRemoveCriteriaEvent(e,t){this.archiveExchangeDataService.sendRemoveFromChildSearchCriteriaAction({keyElt:e,valueElt:t,action:"REMOVE"})}addCriteria(e,t,i,c,a,r,n,s){e&&t&&this.archiveExchangeDataService.addSimpleSearchCriteriaSubject({keyElt:e,valueElt:t,labelElt:i,keyTranslated:c,operator:a,category:s,valueTranslated:r,dataType:n})}ngOnDestroy(){this.subscriptionAppraisalFromMainSearchCriteria.unsubscribe()}get appraisalRuleIdentifier(){return this.appraisalRuleCriteriaForm.controls.appraisalRuleIdentifier}get appraisalRuleTitle(){return this.appraisalRuleCriteriaForm.controls.appraisalRuleTitle}get appraisalRuleStartDate(){return this.appraisalRuleCriteriaForm.controls.appraisalRuleStartDate}get appraisalRuleEndDate(){return this.appraisalRuleCriteriaForm.controls.appraisalRuleEndDate}get appraisalRuleEliminationIdentifier(){return this.appraisalRuleCriteriaForm.controls.appraisalRuleEliminationIdentifier}}return e.\u0275fac=function(t){return new(t||e)(_.Xb(a.e),_.Xb(n.b),_.Xb(de),_.Xb(na))},e.\u0275cmp=_.Rb({type:e,selectors:[["app-appraisal-rule-search"]],inputs:{hasWaitingToRecalculateCriteria:"hasWaitingToRecalculateCriteria"},decls:105,vars:71,consts:[[1,"container"],[3,"formGroup"],[1,"row","justify-content-start"],[1,"form-control"],[1,"title-text"],[1,"col-5","form-control"],["formControlName","appraisalRuleIdentifier","minlength","1",3,"validator","asyncValidator","label"],["errorKey","required"],["errorKey","ruleIdPattern"],["errorKey","ruleIdExists"],[1,"col-1","form-control"],["formControlName","appraisalRuleTitle",3,"validator","label"],[1,"col-11","form-control"],[1,"vitamui-input",3,"click"],["class","search-date-label",3,"click",4,"ngIf","ngIfElse"],["showBeginDtDua",""],["size","0","formControlName","appraisalRuleStartDate",1,"hidden",3,"matDatepicker","max"],["pickerBeginDua",""],["class","validate-date-small-button","type","button","mat-mini-fab","",3,"click",4,"ngIf"],[1,"col-4","form-control"],["class","title-text text-clicable-uppercase",3,"click",4,"ngIf"],["class","vitamui-input",3,"click",4,"ngIf"],[1,"row","justify-content-around"],[1,"row","criteria-choice"],[1,"row"],[1,"criteria-checkbox-choice"],["type","checkbox","id","HAS_AT_LEAST_ONE_RULE_ORIGIN",3,"checked","click"],["id","HAS_NO_RULE_ORIGIN","type","checkbox",3,"checked","click"],["id","WAITING_TO_RE_CALCULATE_RULE_ORIGIN","type","checkbox",3,"checked","click"],["id","HAS_FINAL_ACTION_TYPE","type","checkbox",3,"checked","click"],[1,"col-3","form-control"],["type","checkbox","id","ELIMINATION_FINAL_ACTION",3,"checked","click"],["type","checkbox","id","KEEP_FINAL_ACTION","type","checkbox",3,"checked","click"],["formControlName","appraisalRuleEliminationIdentifier",3,"validator","label"],[1,"col-7","form-control"],[1,"search-date-label",3,"click"],[3,"click"],["type","button","mat-mini-fab","",1,"validate-date-small-button",3,"click"],[1,"material-icons"],[1,"title-text","text-clicable-uppercase",3,"click"],["showEndDtDua",""],["size","0","formControlName","appraisalRuleEndDate",1,"hidden",3,"matDatepicker","min"],["pickerEndDua",""]],template:function(e,t){if(1&e){const e=_.ec();_.dc(0,"div",0),_.dc(1,"form",1),_.dc(2,"div",2),_.dc(3,"div",3),_.dc(4,"p",4),_.Vc(5),_.qc(6,"translate"),_.cc(),_.cc(),_.cc(),_.dc(7,"div",2),_.dc(8,"div",5),_.dc(9,"vitamui-common-editable-input",6),_.qc(10,"translate"),_.dc(11,"vitamui-common-field-error",7),_.Vc(12),_.qc(13,"translate"),_.cc(),_.dc(14,"vitamui-common-field-error",8),_.Vc(15),_.qc(16,"translate"),_.cc(),_.dc(17,"vitamui-common-field-error",9),_.Vc(18),_.qc(19,"translate"),_.cc(),_.cc(),_.cc(),_.Yb(20,"div",10),_.dc(21,"div",5),_.Yb(22,"vitamui-common-editable-input",11),_.qc(23,"translate"),_.cc(),_.Yb(24,"div",10),_.cc(),_.dc(25,"div",2),_.dc(26,"div",12),_.dc(27,"p",4),_.Vc(28),_.qc(29,"translate"),_.cc(),_.cc(),_.cc(),_.dc(30,"div",2),_.dc(31,"div",5),_.dc(32,"div",13),_.lc("click",(function(){return _.Kc(e),_.Gc(38).open()})),_.Tc(33,Ia,3,3,"span",14),_.Tc(34,Ta,3,4,"ng-template",null,15,_.Uc),_.Yb(36,"input",16),_.Yb(37,"mat-datepicker",null,17),_.cc(),_.cc(),_.dc(39,"div",10),_.Tc(40,ga,3,0,"button",18),_.cc(),_.dc(41,"div",19),_.Tc(42,La,3,3,"p",20),_.Tc(43,Sa,7,4,"div",21),_.cc(),_.dc(44,"div",10),_.Tc(45,_a,3,0,"button",18),_.cc(),_.dc(46,"div",10),_.Tc(47,ma,3,3,"p",20),_.cc(),_.cc(),_.dc(48,"div",22),_.dc(49,"div",19),_.dc(50,"div",23),_.dc(51,"p",4),_.Vc(52),_.qc(53,"translate"),_.cc(),_.cc(),_.dc(54,"div",24),_.dc(55,"label",25),_.dc(56,"input",26),_.lc("click",(function(e){return t.checkBoxChange("ORIGIN_HAS_AT_LEAST_ONE",e)})),_.cc(),_.dc(57,"span"),_.Vc(58),_.qc(59,"translate"),_.cc(),_.cc(),_.cc(),_.dc(60,"div",24),_.dc(61,"label",25),_.dc(62,"input",27),_.lc("click",(function(e){return t.checkBoxChange("ORIGIN_HAS_NO_ONE",e)})),_.cc(),_.dc(63,"span"),_.Vc(64),_.qc(65,"translate"),_.cc(),_.cc(),_.cc(),_.dc(66,"div",24),_.dc(67,"label",25),_.dc(68,"input",28),_.lc("click",(function(e){return t.checkBoxChange("ORIGIN_WAITING_RECALCULATE",e)})),_.cc(),_.dc(69,"span"),_.Vc(70),_.qc(71,"translate"),_.cc(),_.cc(),_.cc(),_.cc(),_.dc(72,"div",19),_.dc(73,"div",23),_.dc(74,"p",4),_.Vc(75),_.qc(76,"translate"),_.cc(),_.cc(),_.dc(77,"div",24),_.dc(78,"label",25),_.dc(79,"input",29),_.lc("click",(function(e){return t.checkBoxChange("FINAL_ACTION_HAS_FINAL_ACTION",e)})),_.cc(),_.dc(80,"span"),_.Vc(81),_.qc(82,"translate"),_.cc(),_.cc(),_.cc(),_.cc(),_.dc(83,"div",30),_.dc(84,"div",23),_.dc(85,"p",4),_.Vc(86),_.qc(87,"translate"),_.cc(),_.cc(),_.dc(88,"div",24),_.dc(89,"label",25),_.dc(90,"input",31),_.lc("click",(function(e){return t.checkBoxChange("FINAL_ACTION_TYPE_ELIMINATION",e)})),_.cc(),_.dc(91,"span"),_.Vc(92),_.qc(93,"translate"),_.cc(),_.cc(),_.cc(),_.dc(94,"div",24),_.dc(95,"label",25),_.dc(96,"input",32),_.lc("click",(function(e){return t.checkBoxChange("FINAL_ACTION_TYPE_KEEP",e)})),_.cc(),_.dc(97,"span"),_.Vc(98),_.qc(99,"translate"),_.cc(),_.cc(),_.cc(),_.cc(),_.cc(),_.dc(100,"div",2),_.dc(101,"div",19),_.Yb(102,"vitamui-common-editable-input",33),_.qc(103,"translate"),_.cc(),_.Yb(104,"div",34),_.cc(),_.cc(),_.cc()}if(2&e){const e=_.Gc(35),n=_.Gc(38);var i=null,c=null,a=null,r=null;_.Lb(1),_.vc("formGroup",t.appraisalRuleCriteriaForm),_.Lb(4),_.Wc(_.rc(6,37,"COLLECT.SEARCH_CRITERIA_FILTER.DUA_TITLE")),_.Lb(4),_.wc("label",_.rc(10,39,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.ID_DUA")),_.vc("validator",null==t.appraisalRuleCriteriaForm||null==(i=t.appraisalRuleCriteriaForm.get("appraisalRuleIdentifier"))?null:i.validator)("asyncValidator",null==t.appraisalRuleCriteriaForm||null==(c=t.appraisalRuleCriteriaForm.get("appraisalRuleIdentifier"))?null:c.asyncValidator),_.Lb(3),_.Xc("",_.rc(13,41,"COMMON.REQUIRED")," "),_.Lb(3),_.Xc("",_.rc(16,43,"COLLECT.RULE.WRONG_FORMAT")," "),_.Lb(3),_.Xc("",_.rc(19,45,"COLLECT.RULE.CODE_NOT_EXIST")," "),_.Lb(4),_.wc("label",_.rc(23,47,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.TITLE_DUA")),_.vc("validator",null==t.appraisalRuleCriteriaForm||null==(a=t.appraisalRuleCriteriaForm.get("appraisalRuleTitle"))?null:a.validator),_.Lb(6),_.Wc(_.rc(29,49,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.END_DATE_DUA")),_.Lb(5),_.vc("ngIf",!t.appraisalRuleCriteriaForm.get("appraisalRuleStartDate").value)("ngIfElse",e),_.Lb(3),_.vc("matDatepicker",n)("max",t.appraisalRuleCriteriaForm.get("appraisalRuleEndDate").value),_.Lb(4),_.vc("ngIf",!t.endDateInterval&&t.appraisalRuleCriteriaForm.get("appraisalRuleStartDate").value),_.Lb(2),_.vc("ngIf",!t.endDateInterval),_.Lb(1),_.vc("ngIf",t.endDateInterval),_.Lb(2),_.vc("ngIf",t.endDateInterval&&t.appraisalRuleCriteriaForm.get("appraisalRuleStartDate").value&&t.appraisalRuleCriteriaForm.get("appraisalRuleEndDate").value),_.Lb(2),_.vc("ngIf",t.endDateInterval),_.Lb(5),_.Xc(" ",_.rc(53,51,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.ORIGIN.TITLE")," "),_.Lb(4),_.vc("checked",t.appraisalAdditionalCriteria.get("ORIGIN_HAS_AT_LEAST_ONE")),_.Lb(2),_.Wc(_.rc(59,53,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.ORIGIN.HAS_AT_LEAST_ONE_APPRAISAL_RULE")),_.Lb(4),_.vc("checked",t.appraisalAdditionalCriteria.get("ORIGIN_HAS_NO_ONE")),_.Lb(2),_.Wc(_.rc(65,55,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.ORIGIN.HAS_NO_APPRAISAL_RULE")),_.Lb(4),_.vc("checked",t.appraisalAdditionalCriteria.get("ORIGIN_WAITING_RECALCULATE")),_.Lb(2),_.Wc(_.rc(71,57,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.ORIGIN.WAITING_TO_RE_CALCULATE_APPRAISAL_RULE")),_.Lb(5),_.Xc(" ",_.rc(76,59,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.FINAL_ACTION_TYPE.TITLE")," "),_.Lb(4),_.vc("checked",t.appraisalAdditionalCriteria.get("FINAL_ACTION_HAS_FINAL_ACTION")),_.Lb(2),_.Wc(_.rc(82,61,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.FINAL_ACTION_TYPE.HAS_APPRAISAL_RULE")),_.Lb(5),_.Xc(" ",_.rc(87,63,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.FINAL_ACTION.TITLE")," "),_.Lb(4),_.vc("checked",t.appraisalAdditionalCriteria.get("FINAL_ACTION_TYPE_ELIMINATION")),_.Lb(2),_.Wc(_.rc(93,65,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.FINAL_ACTION.ELIMINATION_APPRAISAL_RULE")),_.Lb(4),_.vc("checked",t.appraisalAdditionalCriteria.get("FINAL_ACTION_TYPE_KEEP")),_.Lb(2),_.Wc(_.rc(99,67,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.FINAL_ACTION.KEEP_APPRAISAL_RULE")),_.Lb(4),_.wc("label",_.rc(103,69,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.ELIMINATION_TECHNICAL_ID")),_.vc("validator",null==t.appraisalRuleCriteriaForm||null==(r=t.appraisalRuleCriteriaForm.get("appraisalRuleEliminationIdentifier"))?null:r.validator)}},directives:[a.x,a.q,a.i,C.C,a.p,a.h,a.l,C.mb,c.p,a.c,r.b,r.a,sa.a],pipes:[O.d,C.Vb],styles:[".check-rule[_ngcontent-%COMP%]{margin-right:25%;margin-left:-15%;margin-top:5px}.title-text[_ngcontent-%COMP%]{font-style:normal;font-weight:700;font-size:16px;color:var(--vitamui-primary)!important}"]}),e})();function Oa(e,t){if(1&e){const e=_.ec();_.dc(0,"span",30),_.lc("click",(function(){return _.Kc(e),_.pc(),_.Gc(38).open()})),_.Vc(1),_.qc(2,"translate"),_.cc()}if(2&e){const e=_.pc();_.Lb(1),_.Wc(_.rc(2,1,e.endDateInterval?"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.END_DATE_ACCESS_BEGIN":"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.END_DATE_ACCESS_EQUAL"))}}function Na(e,t){if(1&e){const e=_.ec();_.dc(0,"span",31),_.lc("click",(function(){return _.Kc(e),_.pc(),_.Gc(38).open()})),_.Vc(1),_.qc(2,"dateTime"),_.cc()}if(2&e){const e=_.pc();_.Lb(1),_.Xc("",_.sc(2,1,e.accessRuleCriteriaForm.get("accessRuleStartDate").value,"dd/MM/yyyy")," ")}}function Fa(e,t){if(1&e){const e=_.ec();_.dc(0,"button",32),_.lc("click",(function(){return _.Kc(e),_.pc().addBeginDtAccessRuleCriteria()})),_.dc(1,"i",33),_.Vc(2,"check"),_.cc(),_.cc()}}function Da(e,t){if(1&e){const e=_.ec();_.dc(0,"p",34),_.lc("click",(function(){return _.Kc(e),_.pc().updateEndDateInterval(!0)})),_.Vc(1),_.qc(2,"translate"),_.cc()}2&e&&(_.Lb(1),_.Xc(" ",_.rc(2,1,"COLLECT.SEARCH_CRITERIA_FILTER.ACCESS_RULE.CREATE_INTERVAL")," "))}function Ua(e,t){if(1&e){const e=_.ec();_.dc(0,"span",30),_.lc("click",(function(){return _.Kc(e),_.pc(),_.Gc(6).open()})),_.Vc(1),_.qc(2,"translate"),_.cc()}2&e&&(_.Lb(1),_.Wc(_.rc(2,1,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.END_DATE_ACCESS_END")))}function ya(e,t){if(1&e){const e=_.ec();_.dc(0,"span",31),_.lc("click",(function(){return _.Kc(e),_.pc(),_.Gc(6).open()})),_.Vc(1),_.qc(2,"dateTime"),_.cc()}if(2&e){const e=_.pc(2);_.Lb(1),_.Xc("",_.sc(2,1,e.accessRuleCriteriaForm.get("accessRuleEndDate").value,"dd/MM/yyyy")," ")}}function Pa(e,t){if(1&e){const e=_.ec();_.dc(0,"div",13),_.lc("click",(function(){return _.Kc(e),_.Gc(6).open()})),_.Tc(1,Ua,3,3,"span",14),_.Tc(2,ya,3,4,"ng-template",null,35,_.Uc),_.Yb(4,"input",36),_.Yb(5,"mat-datepicker",null,37),_.cc()}if(2&e){const e=_.Gc(3),t=_.Gc(6),i=_.pc();_.Lb(1),_.vc("ngIf",!i.accessRuleCriteriaForm.get("accessRuleEndDate").value)("ngIfElse",e),_.Lb(3),_.vc("matDatepicker",t)("min",i.accessRuleCriteriaForm.get("accessRuleStartDate").value)}}function xa(e,t){if(1&e){const e=_.ec();_.dc(0,"button",32),_.lc("click",(function(){return _.Kc(e),_.pc().addIntervalDtAccessRuleCriteria()})),_.dc(1,"i",33),_.Vc(2,"check"),_.cc(),_.cc()}}function ka(e,t){if(1&e){const e=_.ec();_.dc(0,"p",34),_.lc("click",(function(){return _.Kc(e),_.pc().updateEndDateInterval(!1)})),_.Vc(1),_.qc(2,"translate"),_.cc()}2&e&&(_.Lb(1),_.Xc(" ",_.rc(2,1,"COLLECT.SEARCH_CRITERIA_FILTER.ACCESS_RULE.DELETE_INTERVAL")," "))}let Ma=(()=>{class e{constructor(e,t,i,c){this.formBuilder=e,this.dialog=t,this.archiveExchangeDataService=i,this.ruleValidator=c,this.accessCriteriaList=[],this.accessAdditionalCriteria=new Map,this.endDateInterval=!1,this.emptyAccessCriteriaForm={accessRuleIdentifier:"",accessRuleTitle:"",accessRuleStartDate:"",accessRuleEndDate:"",accessRuleOriginInheriteAtLeastOne:!0,accessRuleOriginHasAtLeastOne:!0,accessRuleOriginHasNoOne:!1,accessRuleOriginWaitingRecalculate:!1},this.showUnitPreviewBlock=!1,this.accessRuleCriteriaForm=this.formBuilder.group({accessRuleIdentifier:[null,[z.c.ruleIdPattern],this.ruleValidator.uniqueRuleId()],accessRuleTitle:["",[]],accessRuleStartDate:["",[]],accessRuleEndDate:["",[]],accessRuleEliminationIdentifier:["",[]]}),Object(I.a)(this.accessRuleCriteriaForm.statusChanges,this.accessRuleCriteriaForm.valueChanges).pipe(Object(L.a)(me.UPDATE_DEBOUNCE_TIME),Object(b.a)(()=>this.accessRuleCriteriaForm.value),Object(b.a)(()=>Object(C.sb)(this.accessRuleCriteriaForm.value,this.previousAccessCriteriaValue)),Object(Pt.a)(e=>this.isEmpty(e))).subscribe(()=>{this.resetAccessRuleCriteriaForm()}),this.accessRuleCriteriaForm.get("accessRuleTitle").valueChanges.subscribe(e=>{null!==this.accessRuleCriteriaForm.get("accessRuleTitle").value&&""!==this.accessRuleCriteriaForm.get("accessRuleTitle").value&&(this.addCriteria("RULE_TITLE_ACCESS_RULE",{id:e,value:e},e,!0,C.v.EQ,!1,C.u.STRING,C.Z.ACCESS_RULE),this.resetAccessRuleCriteriaForm())}),this.subscriptionAccessFromMainSearchCriteria=this.archiveExchangeDataService.accessFromMainSearchCriteriaObservable.subscribe(e=>{e&&(this.accessAdditionalCriteria&&e.action===C.d.ADD?this.accessAdditionalCriteria.set(e.valueElt.value,!0):e.action===C.d.REMOVE&&this.accessAdditionalCriteria&&this.accessAdditionalCriteria.has(e.valueElt.value)&&this.accessAdditionalCriteria.set(e.valueElt.value,!1))})}checkBoxChange(e,t){const i=t.target.checked;switch(this.accessAdditionalCriteria.set(e,i),e){case"ORIGIN_HAS_NO_ONE":i?this.addCriteria("RULE_ORIGIN_ACCESS_RULE",{id:"ORIGIN_HAS_NO_ONE",value:"ORIGIN_HAS_NO_ONE"},"ORIGIN_HAS_NO_ONE",!0,C.v.MISSING,!0,C.u.STRING,C.Z.ACCESS_RULE):this.emitRemoveCriteriaEvent("RULE_ORIGIN_ACCESS_RULE",{id:"ORIGIN_HAS_NO_ONE",value:"ORIGIN_HAS_NO_ONE"}),this.previousAccessCriteriaValue.accessRuleOriginHasNoOne=i;break;case"ORIGIN_WAITING_RECALCULATE":i?this.addCriteria("RULE_ORIGIN_ACCESS_RULE",{id:"ORIGIN_WAITING_RECALCULATE",value:"ORIGIN_WAITING_RECALCULATE"},"ORIGIN_WAITING_RECALCULATE",!0,C.v.EQ,!0,C.u.STRING,C.Z.ACCESS_RULE):this.emitRemoveCriteriaEvent("RULE_ORIGIN_ACCESS_RULE",{id:"ORIGIN_WAITING_RECALCULATE",value:"ORIGIN_WAITING_RECALCULATE"}),this.previousAccessCriteriaValue.accessRuleOriginWaitingRecalculate=i;break;case"ORIGIN_HAS_AT_LEAST_ONE":i?this.addCriteria("RULE_ORIGIN_ACCESS_RULE",{id:"ORIGIN_HAS_AT_LEAST_ONE",value:"ORIGIN_HAS_AT_LEAST_ONE"},"ORIGIN_HAS_AT_LEAST_ONE",!0,C.v.EXISTS,!0,C.u.STRING,C.Z.ACCESS_RULE):this.emitRemoveCriteriaEvent("RULE_ORIGIN_ACCESS_RULE",{id:"ORIGIN_HAS_AT_LEAST_ONE",value:"ORIGIN_HAS_AT_LEAST_ONE"}),this.previousAccessCriteriaValue.accessRuleOriginHasAtLeastOne=i}}addBeginDtAccessRuleCriteria(){this.accessRuleCriteriaForm.value.accessRuleStartDate&&(this.addCriteria("RULE_END_DATE_ACCESS_RULE",{id:this.accessRuleCriteriaForm.value.accessRuleStartDate+"-",beginInterval:"",endInterval:this.accessRuleCriteriaForm.value.accessRuleStartDate},this.accessRuleCriteriaForm.value.accessRuleStartDate,!0,C.v.LTE,!1,C.u.INTERVAL,C.Z.ACCESS_RULE),this.accessRuleCriteriaForm.controls.accessRuleStartDate.setValue(null))}addCriteriaRulePostCheck(){this.accessRuleCriteriaForm.value.accessRuleIdentifier&&(this.addCriteria("RULE_IDENTIFIER_ACCESS_RULE",{id:this.accessRuleCriteriaForm.value.accessRuleIdentifier.trim(),value:this.accessRuleCriteriaForm.value.accessRuleIdentifier.trim()},this.accessRuleCriteriaForm.value.accessRuleIdentifier.trim(),!0,C.v.EQ,!1,C.u.STRING,C.Z.ACCESS_RULE),this.accessRuleCriteriaForm.controls.accessRuleIdentifier.setValue(null))}addIntervalDtAccessRuleCriteria(){this.accessRuleCriteriaForm.value.accessRuleStartDate&&this.accessRuleCriteriaForm.value.accessRuleEndDate&&(this.addCriteria("RULE_END_DATE_ACCESS_RULE",{id:this.accessRuleCriteriaForm.value.accessRuleStartDate+"-"+this.accessRuleCriteriaForm.value.accessRuleEndDate,beginInterval:this.accessRuleCriteriaForm.value.accessRuleStartDate,endInterval:this.accessRuleCriteriaForm.value.accessRuleEndDate},this.accessRuleCriteriaForm.value.accessRuleStartDate,!0,C.v.BETWEEN,!1,C.u.INTERVAL,C.Z.ACCESS_RULE),this.accessRuleCriteriaForm.controls.accessRuleStartDate.setValue(null),this.accessRuleCriteriaForm.controls.accessRuleEndDate.setValue(null))}isEmpty(e){return!!e&&(e.accessRuleIdentifier?(this.addCriteria("RULE_IDENTIFIER_ACCESS_RULE",{id:e.accessRuleIdentifier.trim(),value:e.accessRuleIdentifier.trim()},e.accessRuleIdentifier.trim(),!0,C.v.EQ,!1,C.u.STRING,C.Z.ACCESS_RULE),this.resetAccessRuleCriteriaForm(),!0):e.accessRuleTitle?(this.addCriteria("RULE_TITLE_ACCESS_RULE",{id:e.accessRuleTitle.trim(),value:e.accessRuleTitle.trim()},e.accessRuleTitle.trim(),!0,C.v.EQ,!1,C.u.STRING,C.Z.ACCESS_RULE),!0):void 0)}updateEndDateInterval(e){this.endDateInterval=e}resetAccessRuleCriteriaForm(){this.accessRuleCriteriaForm.reset(this.previousAccessCriteriaValue)}ngOnInit(){this.accessAdditionalCriteria=new Map,this.accessAdditionalCriteria.set("ORIGIN_WAITING_RECALCULATE",!0===this.hasWaitingToRecalculateCriteria),this.accessAdditionalCriteria.set("ORIGIN_HAS_NO_ONE",!1),this.accessAdditionalCriteria.set("ORIGIN_HAS_AT_LEAST_ONE",!1),this.previousAccessCriteriaValue={accessRuleIdentifier:"",accessRuleTitle:"",accessRuleStartDate:"",accessRuleEndDate:"",accessRuleOriginInheriteAtLeastOne:!0,accessRuleOriginHasAtLeastOne:!0,accessRuleOriginHasNoOne:!1,accessRuleOriginWaitingRecalculate:this.hasWaitingToRecalculateCriteria},this.addCriteria("RULE_ORIGIN_ACCESS_RULE",{value:"ORIGIN_HAS_AT_LEAST_ONE",id:"ORIGIN_HAS_AT_LEAST_ONE"},"ORIGIN_HAS_AT_LEAST_ONE",!0,C.v.EXISTS,!0,C.u.STRING,C.Z.ACCESS_RULE),this.accessAdditionalCriteria.set("ORIGIN_HAS_AT_LEAST_ONE",!0)}emitRemoveCriteriaEvent(e,t){this.archiveExchangeDataService.sendRemoveFromChildSearchCriteriaAction({keyElt:e,valueElt:t,action:"REMOVE"})}addCriteria(e,t,i,c,a,r,n,s){e&&t&&this.archiveExchangeDataService.addSimpleSearchCriteriaSubject({keyElt:e,valueElt:t,labelElt:i,keyTranslated:c,operator:a,category:s,valueTranslated:r,dataType:n})}ngOnDestroy(){this.subscriptionAccessFromMainSearchCriteria.unsubscribe()}get accessRuleIdentifier(){return this.accessRuleCriteriaForm.controls.accessRuleIdentifier}get accessRuleTitle(){return this.accessRuleCriteriaForm.controls.accessRuleTitle}get accessRuleStartDate(){return this.accessRuleCriteriaForm.controls.accessRuleStartDate}get accessRuleEndDate(){return this.accessRuleCriteriaForm.controls.accessRuleEndDate}}return e.\u0275fac=function(t){return new(t||e)(_.Xb(a.e),_.Xb(n.b),_.Xb(de),_.Xb(na))},e.\u0275cmp=_.Rb({type:e,selectors:[["app-access-rule-search"]],inputs:{hasWaitingToRecalculateCriteria:"hasWaitingToRecalculateCriteria"},decls:74,vars:49,consts:[[1,"container"],[3,"formGroup"],[1,"row","justify-content-start"],[1,"form-control"],[1,"title-text"],[1,"col-5","form-control"],["formControlName","accessRuleIdentifier","minlength","1",3,"validator","asyncValidator","label"],["errorKey","required"],["errorKey","ruleIdPattern"],["errorKey","ruleIdExists"],[1,"col-1","form-control"],["formControlName","accessRuleTitle",3,"validator","label"],[1,"col-11","form-control"],[1,"vitamui-input",3,"click"],["class","search-date-label",3,"click",4,"ngIf","ngIfElse"],["showBeginDtAccessRule",""],["size","0","formControlName","accessRuleStartDate",1,"hidden",3,"matDatepicker","max"],["pickerBeginAccessRule",""],["class","validate-date-small-button","type","button","mat-mini-fab","",3,"click",4,"ngIf"],[1,"col-4","form-control"],["class","title-text text-clicable-uppercase",3,"click",4,"ngIf"],["class","vitamui-input",3,"click",4,"ngIf"],[1,"row","justify-content-around"],[1,"row","criteria-choice"],[1,"row"],[1,"criteria-checkbox-choice"],["type","checkbox","id","HAS_AT_LEAST_ONE_ACCESS_RULE_ORIGIN",3,"checked","click"],["id","HAS_NO_ACCESS_RULE_ORIGIN","type","checkbox",3,"checked","click"],["id","WAITING_TO_RE_CALCULATE_ACCESS_RULE_ORIGIN","type","checkbox",3,"checked","click"],[1,"col-3","form-control"],[1,"search-date-label",3,"click"],[3,"click"],["type","button","mat-mini-fab","",1,"validate-date-small-button",3,"click"],[1,"material-icons"],[1,"title-text","text-clicable-uppercase",3,"click"],["showEndDtAccessRule",""],["size","0","formControlName","accessRuleEndDate",1,"hidden",3,"matDatepicker","min"],["pickerEndAccessRule",""]],template:function(e,t){if(1&e){const e=_.ec();_.dc(0,"div",0),_.dc(1,"form",1),_.dc(2,"div",2),_.dc(3,"div",3),_.dc(4,"p",4),_.Vc(5),_.qc(6,"translate"),_.cc(),_.cc(),_.cc(),_.dc(7,"div",2),_.dc(8,"div",5),_.dc(9,"vitamui-common-editable-input",6),_.qc(10,"translate"),_.dc(11,"vitamui-common-field-error",7),_.Vc(12),_.qc(13,"translate"),_.cc(),_.dc(14,"vitamui-common-field-error",8),_.Vc(15),_.qc(16,"translate"),_.cc(),_.dc(17,"vitamui-common-field-error",9),_.Vc(18),_.qc(19,"translate"),_.cc(),_.cc(),_.cc(),_.Yb(20,"div",10),_.dc(21,"div",5),_.Yb(22,"vitamui-common-editable-input",11),_.qc(23,"translate"),_.cc(),_.Yb(24,"div",10),_.cc(),_.dc(25,"div",2),_.dc(26,"div",12),_.dc(27,"p",4),_.Vc(28),_.qc(29,"translate"),_.cc(),_.cc(),_.cc(),_.dc(30,"div",2),_.dc(31,"div",5),_.dc(32,"div",13),_.lc("click",(function(){return _.Kc(e),_.Gc(38).open()})),_.Tc(33,Oa,3,3,"span",14),_.Tc(34,Na,3,4,"ng-template",null,15,_.Uc),_.Yb(36,"input",16),_.Yb(37,"mat-datepicker",null,17),_.cc(),_.cc(),_.dc(39,"div",10),_.Tc(40,Fa,3,0,"button",18),_.cc(),_.dc(41,"div",19),_.Tc(42,Da,3,3,"p",20),_.Tc(43,Pa,7,4,"div",21),_.cc(),_.dc(44,"div",10),_.Tc(45,xa,3,0,"button",18),_.cc(),_.dc(46,"div",10),_.Tc(47,ka,3,3,"p",20),_.cc(),_.cc(),_.dc(48,"div",22),_.dc(49,"div",19),_.dc(50,"div",23),_.dc(51,"p",4),_.Vc(52),_.qc(53,"translate"),_.cc(),_.cc(),_.dc(54,"div",24),_.dc(55,"label",25),_.dc(56,"input",26),_.lc("click",(function(e){return t.checkBoxChange("ORIGIN_HAS_AT_LEAST_ONE",e)})),_.cc(),_.dc(57,"span"),_.Vc(58),_.qc(59,"translate"),_.cc(),_.cc(),_.cc(),_.dc(60,"div",24),_.dc(61,"label",25),_.dc(62,"input",27),_.lc("click",(function(e){return t.checkBoxChange("ORIGIN_HAS_NO_ONE",e)})),_.cc(),_.dc(63,"span"),_.Vc(64),_.qc(65,"translate"),_.cc(),_.cc(),_.cc(),_.dc(66,"div",24),_.dc(67,"label",25),_.dc(68,"input",28),_.lc("click",(function(e){return t.checkBoxChange("ORIGIN_WAITING_RECALCULATE",e)})),_.cc(),_.dc(69,"span"),_.Vc(70),_.qc(71,"translate"),_.cc(),_.cc(),_.cc(),_.cc(),_.Yb(72,"div",19),_.Yb(73,"div",29),_.cc(),_.cc(),_.cc()}if(2&e){const e=_.Gc(35),r=_.Gc(38);var i=null,c=null,a=null;_.Lb(1),_.vc("formGroup",t.accessRuleCriteriaForm),_.Lb(4),_.Wc(_.rc(6,27,"COLLECT.SEARCH_CRITERIA_FILTER.ACCESS_TITLE")),_.Lb(4),_.wc("label",_.rc(10,29,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.ID_ACCESS")),_.vc("validator",null==t.accessRuleCriteriaForm||null==(i=t.accessRuleCriteriaForm.get("accessRuleIdentifier"))?null:i.validator)("asyncValidator",null==t.accessRuleCriteriaForm||null==(c=t.accessRuleCriteriaForm.get("accessRuleIdentifier"))?null:c.asyncValidator),_.Lb(3),_.Xc("",_.rc(13,31,"COMMON.REQUIRED")," "),_.Lb(3),_.Xc("",_.rc(16,33,"COLLECT.RULE.WRONG_FORMAT")," "),_.Lb(3),_.Xc("",_.rc(19,35,"COLLECT.RULE.CODE_NOT_EXIST")," "),_.Lb(4),_.wc("label",_.rc(23,37,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.TITLE_ACCESS")),_.vc("validator",null==t.accessRuleCriteriaForm||null==(a=t.accessRuleCriteriaForm.get("accessRuleTitle"))?null:a.validator),_.Lb(6),_.Wc(_.rc(29,39,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.END_DATE_ACCESS")),_.Lb(5),_.vc("ngIf",!t.accessRuleCriteriaForm.get("accessRuleStartDate").value)("ngIfElse",e),_.Lb(3),_.vc("matDatepicker",r)("max",t.accessRuleCriteriaForm.get("accessRuleEndDate").value),_.Lb(4),_.vc("ngIf",!t.endDateInterval&&t.accessRuleCriteriaForm.get("accessRuleStartDate").value),_.Lb(2),_.vc("ngIf",!t.endDateInterval),_.Lb(1),_.vc("ngIf",t.endDateInterval),_.Lb(2),_.vc("ngIf",t.endDateInterval&&t.accessRuleCriteriaForm.get("accessRuleStartDate").value&&t.accessRuleCriteriaForm.get("accessRuleEndDate").value),_.Lb(2),_.vc("ngIf",t.endDateInterval),_.Lb(5),_.Xc(" ",_.rc(53,41,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.ORIGIN.TITLE")," "),_.Lb(4),_.vc("checked",t.accessAdditionalCriteria.get("ORIGIN_HAS_AT_LEAST_ONE")),_.Lb(2),_.Wc(_.rc(59,43,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.ORIGIN.HAS_AT_LEAST_ONE_ACCESS_RULE")),_.Lb(4),_.vc("checked",t.accessAdditionalCriteria.get("ORIGIN_HAS_NO_ONE")),_.Lb(2),_.Wc(_.rc(65,45,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.ORIGIN.HAS_NO_ACCESS_RULE")),_.Lb(4),_.vc("checked",t.accessAdditionalCriteria.get("ORIGIN_WAITING_RECALCULATE")),_.Lb(2),_.Wc(_.rc(71,47,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.ORIGIN.WAITING_TO_RE_CALCULATE_ACCESS_RULE"))}},directives:[a.x,a.q,a.i,C.C,a.p,a.h,a.l,C.mb,c.p,a.c,r.b,r.a,sa.a],pipes:[O.d,C.Vb],styles:['.check-rule[_ngcontent-%COMP%]{margin-right:25%;margin-left:-15%;margin-top:5px}.title-text[_ngcontent-%COMP%]{font-style:normal;font-weight:700;font-size:16px;color:var(--vitamui-primary)!important}.validate-date-small-button[_ngcontent-%COMP%]{background-color:"green";width:30px;height:30px}']}),e})();function Va(e,t){if(1&e){const e=_.ec();_.dc(0,"span",30),_.lc("click",(function(){return _.Kc(e),_.pc(),_.Gc(38).open()})),_.Vc(1),_.qc(2,"translate"),_.cc()}if(2&e){const e=_.pc();_.Lb(1),_.Wc(_.rc(2,1,e.endDateInterval?"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.END_DATE_REUSE_BEGIN":"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.END_DATE_REUSE_EQUAL"))}}function wa(e,t){if(1&e){const e=_.ec();_.dc(0,"span",31),_.lc("click",(function(){return _.Kc(e),_.pc(),_.Gc(38).open()})),_.Vc(1),_.qc(2,"dateTime"),_.cc()}if(2&e){const e=_.pc();_.Lb(1),_.Xc("",_.sc(2,1,e.reuseRuleCriteriaForm.get("reuseRuleStartDate").value,"dd/MM/yyyy")," ")}}function Ha(e,t){if(1&e){const e=_.ec();_.dc(0,"button",32),_.lc("click",(function(){return _.Kc(e),_.pc().addBeginDtReuseRuleCriteria()})),_.dc(1,"i",33),_.Vc(2,"check"),_.cc(),_.cc()}}function Ga(e,t){if(1&e){const e=_.ec();_.dc(0,"p",34),_.lc("click",(function(){return _.Kc(e),_.pc().updateEndDateInterval(!0)})),_.Vc(1),_.qc(2,"translate"),_.cc()}2&e&&(_.Lb(1),_.Xc(" ",_.rc(2,1,"COLLECT.SEARCH_CRITERIA_FILTER.REUSE_RULE.CREATE_INTERVAL")," "))}function qa(e,t){if(1&e){const e=_.ec();_.dc(0,"span",30),_.lc("click",(function(){return _.Kc(e),_.pc(),_.Gc(6).open()})),_.Vc(1),_.qc(2,"translate"),_.cc()}2&e&&(_.Lb(1),_.Wc(_.rc(2,1,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.END_DATE_REUSE_END")))}function Ba(e,t){if(1&e){const e=_.ec();_.dc(0,"span",31),_.lc("click",(function(){return _.Kc(e),_.pc(),_.Gc(6).open()})),_.Vc(1),_.qc(2,"dateTime"),_.cc()}if(2&e){const e=_.pc(2);_.Lb(1),_.Xc("",_.sc(2,1,e.reuseRuleCriteriaForm.get("reuseRuleEndDate").value,"dd/MM/yyyy")," ")}}function Wa(e,t){if(1&e){const e=_.ec();_.dc(0,"div",13),_.lc("click",(function(){return _.Kc(e),_.Gc(6).open()})),_.Tc(1,qa,3,3,"span",14),_.Tc(2,Ba,3,4,"ng-template",null,35,_.Uc),_.Yb(4,"input",36),_.Yb(5,"mat-datepicker",null,37),_.cc()}if(2&e){const e=_.Gc(3),t=_.Gc(6),i=_.pc();_.Lb(1),_.vc("ngIf",!i.reuseRuleCriteriaForm.get("reuseRuleEndDate").value)("ngIfElse",e),_.Lb(3),_.vc("matDatepicker",t)("min",i.reuseRuleCriteriaForm.get("reuseRuleStartDate").value)}}function ja(e,t){if(1&e){const e=_.ec();_.dc(0,"button",32),_.lc("click",(function(){return _.Kc(e),_.pc().addIntervalDtReuseRuleCriteria()})),_.dc(1,"i",33),_.Vc(2,"check"),_.cc(),_.cc()}}function Ya(e,t){if(1&e){const e=_.ec();_.dc(0,"p",34),_.lc("click",(function(){return _.Kc(e),_.pc().updateEndDateInterval(!1)})),_.Vc(1),_.qc(2,"translate"),_.cc()}2&e&&(_.Lb(1),_.Xc(" ",_.rc(2,1,"COLLECT.SEARCH_CRITERIA_FILTER.REUSE_RULE.DELETE_INTERVAL")," "))}let Xa=(()=>{class e{constructor(e,t,i,c){this.formBuilder=e,this.dialog=t,this.archiveExchangeDataService=i,this.ruleValidator=c,this.reuseCriteriaList=[],this.reuseAdditionalCriteria=new Map,this.endDateInterval=!1,this.emptyReuseCriteriaForm={reuseRuleIdentifier:"",reuseRuleTitle:"",reuseRuleStartDate:"",reuseRuleEndDate:"",reuseRuleOriginInheriteAtLeastOne:!0,reuseRuleOriginHasAtLeastOne:!0,reuseRuleOriginHasNoOne:!1,reuseRuleOriginWaitingRecalculate:!1},this.showUnitPreviewBlock=!1,this.reuseRuleCriteriaForm=this.formBuilder.group({reuseRuleIdentifier:[null,[z.c.ruleIdPattern],this.ruleValidator.uniqueRuleId()],reuseRuleTitle:["",[]],reuseRuleStartDate:["",[]],reuseRuleEndDate:["",[]],reuseRuleEliminationIdentifier:["",[]]}),Object(I.a)(this.reuseRuleCriteriaForm.statusChanges,this.reuseRuleCriteriaForm.valueChanges).pipe(Object(L.a)(me.UPDATE_DEBOUNCE_TIME),Object(b.a)(()=>this.reuseRuleCriteriaForm.value),Object(b.a)(()=>Object(C.sb)(this.reuseRuleCriteriaForm.value,this.previousReuseCriteriaValue)),Object(Pt.a)(e=>this.isEmpty(e))).subscribe(()=>{this.resetReuseRuleCriteriaForm()}),this.reuseRuleCriteriaForm.get("reuseRuleTitle").valueChanges.subscribe(e=>{null!==this.reuseRuleCriteriaForm.get("reuseRuleTitle").value&&""!==this.reuseRuleCriteriaForm.get("reuseRuleTitle").value&&(this.addCriteria("RULE_TITLE_REUSE_RULE",{id:e,value:e},e,!0,C.v.EQ,!1,C.u.STRING,C.Z.REUSE_RULE),this.resetReuseRuleCriteriaForm())}),this.subscriptionReuseFromMainSearchCriteria=this.archiveExchangeDataService.reuseFromMainSearchCriteriaObservable.subscribe(e=>{e&&(this.reuseAdditionalCriteria&&e.action===C.d.ADD?this.reuseAdditionalCriteria.set(e.valueElt.value,!0):e.action===C.d.REMOVE&&this.reuseAdditionalCriteria&&this.reuseAdditionalCriteria.has(e.valueElt.value)&&this.reuseAdditionalCriteria.set(e.valueElt.value,!1))})}checkBoxChange(e,t){const i=t.target.checked;switch(this.reuseAdditionalCriteria.set(e,i),e){case"ORIGIN_HAS_NO_ONE":i?this.addCriteria("RULE_ORIGIN_REUSE_RULE",{id:"ORIGIN_HAS_NO_ONE",value:"ORIGIN_HAS_NO_ONE"},"ORIGIN_HAS_NO_ONE",!0,C.v.MISSING,!0,C.u.STRING,C.Z.REUSE_RULE):this.emitRemoveCriteriaEvent("RULE_ORIGIN_REUSE_RULE",{id:"ORIGIN_HAS_NO_ONE",value:"ORIGIN_HAS_NO_ONE"}),this.previousReuseCriteriaValue.reuseRuleOriginHasNoOne=i;break;case"ORIGIN_WAITING_RECALCULATE":i?this.addCriteria("RULE_ORIGIN_REUSE_RULE",{id:"ORIGIN_WAITING_RECALCULATE",value:"ORIGIN_WAITING_RECALCULATE"},"ORIGIN_WAITING_RECALCULATE",!0,C.v.EQ,!0,C.u.STRING,C.Z.REUSE_RULE):this.emitRemoveCriteriaEvent("RULE_ORIGIN_REUSE_RULE",{id:"ORIGIN_WAITING_RECALCULATE",value:"ORIGIN_WAITING_RECALCULATE"}),this.previousReuseCriteriaValue.reuseRuleOriginWaitingRecalculate=i;break;case"ORIGIN_HAS_AT_LEAST_ONE":i?this.addCriteria("RULE_ORIGIN_REUSE_RULE",{id:"ORIGIN_HAS_AT_LEAST_ONE",value:"ORIGIN_HAS_AT_LEAST_ONE"},"ORIGIN_HAS_AT_LEAST_ONE",!0,C.v.EXISTS,!0,C.u.STRING,C.Z.REUSE_RULE):this.emitRemoveCriteriaEvent("RULE_ORIGIN_REUSE_RULE",{id:"ORIGIN_HAS_AT_LEAST_ONE",value:"ORIGIN_HAS_AT_LEAST_ONE"}),this.previousReuseCriteriaValue.reuseRuleOriginHasAtLeastOne=i}}addBeginDtReuseRuleCriteria(){this.reuseRuleCriteriaForm.value.reuseRuleStartDate&&(this.addCriteria("RULE_END_DATE_REUSE_RULE",{id:this.reuseRuleCriteriaForm.value.reuseRuleStartDate+"-",beginInterval:"",endInterval:this.reuseRuleCriteriaForm.value.reuseRuleStartDate},this.reuseRuleCriteriaForm.value.reuseRuleStartDate,!0,C.v.LTE,!1,C.u.INTERVAL,C.Z.REUSE_RULE),this.reuseRuleCriteriaForm.controls.reuseRuleStartDate.setValue(null))}addCriteriaRulePostCheck(){this.reuseRuleCriteriaForm.value.reuseRuleIdentifier&&(this.addCriteria("RULE_IDENTIFIER_REUSE_RULE",{id:this.reuseRuleCriteriaForm.value.reuseRuleIdentifier.trim(),value:this.reuseRuleCriteriaForm.value.reuseRuleIdentifier.trim()},this.reuseRuleCriteriaForm.value.reuseRuleIdentifier.trim(),!0,C.v.EQ,!1,C.u.STRING,C.Z.REUSE_RULE),this.reuseRuleCriteriaForm.controls.reuseRuleIdentifier.setValue(null))}addIntervalDtReuseRuleCriteria(){this.reuseRuleCriteriaForm.value.reuseRuleStartDate&&this.reuseRuleCriteriaForm.value.reuseRuleEndDate&&(this.addCriteria("RULE_END_DATE_REUSE_RULE",{id:this.reuseRuleCriteriaForm.value.reuseRuleStartDate+"-"+this.reuseRuleCriteriaForm.value.reuseRuleEndDate,beginInterval:this.reuseRuleCriteriaForm.value.reuseRuleStartDate,endInterval:this.reuseRuleCriteriaForm.value.reuseRuleEndDate},this.reuseRuleCriteriaForm.value.reuseRuleStartDate,!0,C.v.BETWEEN,!1,C.u.INTERVAL,C.Z.REUSE_RULE),this.reuseRuleCriteriaForm.controls.reuseRuleStartDate.setValue(null),this.reuseRuleCriteriaForm.controls.reuseRuleEndDate.setValue(null))}isEmpty(e){return!!e&&(e.reuseRuleIdentifier?(this.addCriteria("RULE_IDENTIFIER_REUSE_RULE",{id:e.reuseRuleIdentifier.trim(),value:e.reuseRuleIdentifier.trim()},e.reuseRuleIdentifier.trim(),!0,C.v.EQ,!1,C.u.STRING,C.Z.REUSE_RULE),this.resetReuseRuleCriteriaForm(),!0):e.reuseRuleTitle?(this.addCriteria("RULE_TITLE_REUSE_RULE",{id:e.reuseRuleTitle.trim(),value:e.reuseRuleTitle.trim()},e.reuseRuleTitle.trim(),!0,C.v.EQ,!1,C.u.STRING,C.Z.REUSE_RULE),!0):void 0)}updateEndDateInterval(e){this.endDateInterval=e}resetReuseRuleCriteriaForm(){this.reuseRuleCriteriaForm.reset(this.previousReuseCriteriaValue)}ngOnInit(){this.reuseAdditionalCriteria=new Map,this.reuseAdditionalCriteria.set("ORIGIN_WAITING_RECALCULATE",!0===this.hasWaitingToRecalculateCriteria),this.reuseAdditionalCriteria.set("ORIGIN_HAS_NO_ONE",!1),this.reuseAdditionalCriteria.set("ORIGIN_HAS_AT_LEAST_ONE",!1),this.previousReuseCriteriaValue={reuseRuleIdentifier:"",reuseRuleTitle:"",reuseRuleStartDate:"",reuseRuleEndDate:"",reuseRuleOriginInheriteAtLeastOne:!0,reuseRuleOriginHasAtLeastOne:!0,reuseRuleOriginHasNoOne:!1,reuseRuleOriginWaitingRecalculate:this.hasWaitingToRecalculateCriteria},this.addCriteria("RULE_ORIGIN_REUSE_RULE",{value:"ORIGIN_HAS_AT_LEAST_ONE",id:"ORIGIN_HAS_AT_LEAST_ONE"},"ORIGIN_HAS_AT_LEAST_ONE",!0,C.v.EXISTS,!0,C.u.STRING,C.Z.REUSE_RULE),this.reuseAdditionalCriteria.set("ORIGIN_HAS_AT_LEAST_ONE",!0)}emitRemoveCriteriaEvent(e,t){this.archiveExchangeDataService.sendRemoveFromChildSearchCriteriaAction({keyElt:e,valueElt:t,action:"REMOVE"})}addCriteria(e,t,i,c,a,r,n,s){e&&t&&this.archiveExchangeDataService.addSimpleSearchCriteriaSubject({keyElt:e,valueElt:t,labelElt:i,keyTranslated:c,operator:a,category:s,valueTranslated:r,dataType:n})}ngOnDestroy(){this.subscriptionReuseFromMainSearchCriteria.unsubscribe()}get reuseRuleIdentifier(){return this.reuseRuleCriteriaForm.controls.reuseRuleIdentifier}get reuseRuleTitle(){return this.reuseRuleCriteriaForm.controls.reuseRuleTitle}get reuseRuleStartDate(){return this.reuseRuleCriteriaForm.controls.reuseRuleStartDate}get reuseRuleEndDate(){return this.reuseRuleCriteriaForm.controls.reuseRuleEndDate}}return e.\u0275fac=function(t){return new(t||e)(_.Xb(a.e),_.Xb(n.b),_.Xb(de),_.Xb(na))},e.\u0275cmp=_.Rb({type:e,selectors:[["app-reuse-rule-search"]],inputs:{hasWaitingToRecalculateCriteria:"hasWaitingToRecalculateCriteria"},decls:74,vars:49,consts:[[1,"container"],[3,"formGroup"],[1,"row","justify-content-start"],[1,"form-control"],[1,"title-text"],[1,"col-5","form-control"],["formControlName","reuseRuleIdentifier","minlength","1",3,"validator","asyncValidator","label"],["errorKey","required"],["errorKey","ruleIdPattern"],["errorKey","ruleIdExists"],[1,"col-1","form-control"],["formControlName","reuseRuleTitle",3,"validator","label"],[1,"col-11","form-control"],[1,"vitamui-input",3,"click"],["class","search-date-label",3,"click",4,"ngIf","ngIfElse"],["showBeginDtReuseRule",""],["size","0","formControlName","reuseRuleStartDate",1,"hidden",3,"matDatepicker","max"],["pickerBeginReuseRule",""],["class","validate-date-small-button","type","button","mat-mini-fab","",3,"click",4,"ngIf"],[1,"col-4","form-control"],["class","title-text text-clicable-uppercase",3,"click",4,"ngIf"],["class","vitamui-input",3,"click",4,"ngIf"],[1,"row","justify-content-around"],[1,"row","criteria-choice"],[1,"row"],[1,"criteria-checkbox-choice"],["type","checkbox","id","HAS_AT_LEAST_ONE_REUSE_RULE_ORIGIN",3,"checked","click"],["id","HAS_NO_REUSE_RULE_ORIGIN","type","checkbox",3,"checked","click"],["id","WAITING_TO_RE_CALCULATE_REUSE_RULE_ORIGIN","type","checkbox",3,"checked","click"],[1,"col-3","form-control"],[1,"search-date-label",3,"click"],[3,"click"],["type","button","mat-mini-fab","",1,"validate-date-small-button",3,"click"],[1,"material-icons"],[1,"title-text","text-clicable-uppercase",3,"click"],["showEndDtReuseRule",""],["size","0","formControlName","reuseRuleEndDate",1,"hidden",3,"matDatepicker","min"],["pickerEndReuseRule",""]],template:function(e,t){if(1&e){const e=_.ec();_.dc(0,"div",0),_.dc(1,"form",1),_.dc(2,"div",2),_.dc(3,"div",3),_.dc(4,"p",4),_.Vc(5),_.qc(6,"translate"),_.cc(),_.cc(),_.cc(),_.dc(7,"div",2),_.dc(8,"div",5),_.dc(9,"vitamui-common-editable-input",6),_.qc(10,"translate"),_.dc(11,"vitamui-common-field-error",7),_.Vc(12),_.qc(13,"translate"),_.cc(),_.dc(14,"vitamui-common-field-error",8),_.Vc(15),_.qc(16,"translate"),_.cc(),_.dc(17,"vitamui-common-field-error",9),_.Vc(18),_.qc(19,"translate"),_.cc(),_.cc(),_.cc(),_.Yb(20,"div",10),_.dc(21,"div",5),_.Yb(22,"vitamui-common-editable-input",11),_.qc(23,"translate"),_.cc(),_.Yb(24,"div",10),_.cc(),_.dc(25,"div",2),_.dc(26,"div",12),_.dc(27,"p",4),_.Vc(28),_.qc(29,"translate"),_.cc(),_.cc(),_.cc(),_.dc(30,"div",2),_.dc(31,"div",5),_.dc(32,"div",13),_.lc("click",(function(){return _.Kc(e),_.Gc(38).open()})),_.Tc(33,Va,3,3,"span",14),_.Tc(34,wa,3,4,"ng-template",null,15,_.Uc),_.Yb(36,"input",16),_.Yb(37,"mat-datepicker",null,17),_.cc(),_.cc(),_.dc(39,"div",10),_.Tc(40,Ha,3,0,"button",18),_.cc(),_.dc(41,"div",19),_.Tc(42,Ga,3,3,"p",20),_.Tc(43,Wa,7,4,"div",21),_.cc(),_.dc(44,"div",10),_.Tc(45,ja,3,0,"button",18),_.cc(),_.dc(46,"div",10),_.Tc(47,Ya,3,3,"p",20),_.cc(),_.cc(),_.dc(48,"div",22),_.dc(49,"div",19),_.dc(50,"div",23),_.dc(51,"p",4),_.Vc(52),_.qc(53,"translate"),_.cc(),_.cc(),_.dc(54,"div",24),_.dc(55,"label",25),_.dc(56,"input",26),_.lc("click",(function(e){return t.checkBoxChange("ORIGIN_HAS_AT_LEAST_ONE",e)})),_.cc(),_.dc(57,"span"),_.Vc(58),_.qc(59,"translate"),_.cc(),_.cc(),_.cc(),_.dc(60,"div",24),_.dc(61,"label",25),_.dc(62,"input",27),_.lc("click",(function(e){return t.checkBoxChange("ORIGIN_HAS_NO_ONE",e)})),_.cc(),_.dc(63,"span"),_.Vc(64),_.qc(65,"translate"),_.cc(),_.cc(),_.cc(),_.dc(66,"div",24),_.dc(67,"label",25),_.dc(68,"input",28),_.lc("click",(function(e){return t.checkBoxChange("ORIGIN_WAITING_RECALCULATE",e)})),_.cc(),_.dc(69,"span"),_.Vc(70),_.qc(71,"translate"),_.cc(),_.cc(),_.cc(),_.cc(),_.Yb(72,"div",19),_.Yb(73,"div",29),_.cc(),_.cc(),_.cc()}if(2&e){const e=_.Gc(35),r=_.Gc(38);var i=null,c=null,a=null;_.Lb(1),_.vc("formGroup",t.reuseRuleCriteriaForm),_.Lb(4),_.Wc(_.rc(6,27,"COLLECT.SEARCH_CRITERIA_FILTER.REUSE_TITLE")),_.Lb(4),_.wc("label",_.rc(10,29,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.ID_REUSE")),_.vc("validator",null==t.reuseRuleCriteriaForm||null==(i=t.reuseRuleCriteriaForm.get("reuseRuleIdentifier"))?null:i.validator)("asyncValidator",null==t.reuseRuleCriteriaForm||null==(c=t.reuseRuleCriteriaForm.get("reuseRuleIdentifier"))?null:c.asyncValidator),_.Lb(3),_.Xc("",_.rc(13,31,"COMMON.REQUIRED")," "),_.Lb(3),_.Xc("",_.rc(16,33,"COLLECT.RULE.WRONG_FORMAT")," "),_.Lb(3),_.Xc("",_.rc(19,35,"COLLECT.RULE.CODE_NOT_EXIST")," "),_.Lb(4),_.wc("label",_.rc(23,37,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.TITLE_REUSE")),_.vc("validator",null==t.reuseRuleCriteriaForm||null==(a=t.reuseRuleCriteriaForm.get("reuseRuleTitle"))?null:a.validator),_.Lb(6),_.Wc(_.rc(29,39,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.END_DATE_REUSE")),_.Lb(5),_.vc("ngIf",!t.reuseRuleCriteriaForm.get("reuseRuleStartDate").value)("ngIfElse",e),_.Lb(3),_.vc("matDatepicker",r)("max",t.reuseRuleCriteriaForm.get("reuseRuleEndDate").value),_.Lb(4),_.vc("ngIf",!t.endDateInterval&&t.reuseRuleCriteriaForm.get("reuseRuleStartDate").value),_.Lb(2),_.vc("ngIf",!t.endDateInterval),_.Lb(1),_.vc("ngIf",t.endDateInterval),_.Lb(2),_.vc("ngIf",t.endDateInterval&&t.reuseRuleCriteriaForm.get("reuseRuleStartDate").value&&t.reuseRuleCriteriaForm.get("reuseRuleEndDate").value),_.Lb(2),_.vc("ngIf",t.endDateInterval),_.Lb(5),_.Xc(" ",_.rc(53,41,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.ORIGIN.TITLE")," "),_.Lb(4),_.vc("checked",t.reuseAdditionalCriteria.get("ORIGIN_HAS_AT_LEAST_ONE")),_.Lb(2),_.Wc(_.rc(59,43,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.ORIGIN.HAS_AT_LEAST_ONE_REUSE_RULE")),_.Lb(4),_.vc("checked",t.reuseAdditionalCriteria.get("ORIGIN_HAS_NO_ONE")),_.Lb(2),_.Wc(_.rc(65,45,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.ORIGIN.HAS_NO_REUSE_RULE")),_.Lb(4),_.vc("checked",t.reuseAdditionalCriteria.get("ORIGIN_WAITING_RECALCULATE")),_.Lb(2),_.Wc(_.rc(71,47,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.ORIGIN.WAITING_TO_RE_CALCULATE_REUSE_RULE"))}},directives:[a.x,a.q,a.i,C.C,a.p,a.h,a.l,C.mb,c.p,a.c,r.b,r.a,sa.a],pipes:[O.d,C.Vb],styles:['.check-rule[_ngcontent-%COMP%]{margin-right:25%;margin-left:-15%;margin-top:5px}.title-text[_ngcontent-%COMP%]{font-style:normal;font-weight:700;font-size:16px;color:var(--vitamui-primary)!important}.validate-date-small-button[_ngcontent-%COMP%]{background-color:"green";width:30px;height:30px}']}),e})();function Ka(e,t){if(1&e){const e=_.ec();_.dc(0,"span",30),_.lc("click",(function(){return _.Kc(e),_.pc(),_.Gc(38).open()})),_.Vc(1),_.qc(2,"translate"),_.cc()}if(2&e){const e=_.pc();_.Lb(1),_.Wc(_.rc(2,1,e.endDateInterval?"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.END_DATE_DISSEMINATION_BEGIN":"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.END_DATE_DISSEMINATION_EQUAL"))}}function za(e,t){if(1&e){const e=_.ec();_.dc(0,"span",31),_.lc("click",(function(){return _.Kc(e),_.pc(),_.Gc(38).open()})),_.Vc(1),_.qc(2,"dateTime"),_.cc()}if(2&e){const e=_.pc();_.Lb(1),_.Xc("",_.sc(2,1,e.disseminationRuleCriteriaForm.get("disseminationRuleStartDate").value,"dd/MM/yyyy")," ")}}function $a(e,t){if(1&e){const e=_.ec();_.dc(0,"button",32),_.lc("click",(function(){return _.Kc(e),_.pc().addBeginDtDisseminationRuleCriteria()})),_.dc(1,"i",33),_.Vc(2,"check"),_.cc(),_.cc()}}function Za(e,t){if(1&e){const e=_.ec();_.dc(0,"p",34),_.lc("click",(function(){return _.Kc(e),_.pc().updateEndDateInterval(!0)})),_.Vc(1),_.qc(2,"translate"),_.cc()}2&e&&(_.Lb(1),_.Xc(" ",_.rc(2,1,"COLLECT.SEARCH_CRITERIA_FILTER.DISSEMINATION_RULE.CREATE_INTERVAL")," "))}function Qa(e,t){if(1&e){const e=_.ec();_.dc(0,"span",30),_.lc("click",(function(){return _.Kc(e),_.pc(),_.Gc(6).open()})),_.Vc(1),_.qc(2,"translate"),_.cc()}2&e&&(_.Lb(1),_.Wc(_.rc(2,1,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.END_DATE_DISSEMINATION_END")))}function Ja(e,t){if(1&e){const e=_.ec();_.dc(0,"span",31),_.lc("click",(function(){return _.Kc(e),_.pc(),_.Gc(6).open()})),_.Vc(1),_.qc(2,"dateTime"),_.cc()}if(2&e){const e=_.pc(2);_.Lb(1),_.Xc("",_.sc(2,1,e.disseminationRuleCriteriaForm.get("disseminationRuleEndDate").value,"dd/MM/yyyy")," ")}}function er(e,t){if(1&e){const e=_.ec();_.dc(0,"div",13),_.lc("click",(function(){return _.Kc(e),_.Gc(6).open()})),_.Tc(1,Qa,3,3,"span",14),_.Tc(2,Ja,3,4,"ng-template",null,35,_.Uc),_.Yb(4,"input",36),_.Yb(5,"mat-datepicker",null,37),_.cc()}if(2&e){const e=_.Gc(3),t=_.Gc(6),i=_.pc();_.Lb(1),_.vc("ngIf",!i.disseminationRuleCriteriaForm.get("disseminationRuleEndDate").value)("ngIfElse",e),_.Lb(3),_.vc("matDatepicker",t)("min",i.disseminationRuleCriteriaForm.get("disseminationRuleStartDate").value)}}function tr(e,t){if(1&e){const e=_.ec();_.dc(0,"button",32),_.lc("click",(function(){return _.Kc(e),_.pc().addIntervalDtDisseminationRuleCriteria()})),_.dc(1,"i",33),_.Vc(2,"check"),_.cc(),_.cc()}}function ir(e,t){if(1&e){const e=_.ec();_.dc(0,"p",34),_.lc("click",(function(){return _.Kc(e),_.pc().updateEndDateInterval(!1)})),_.Vc(1),_.qc(2,"translate"),_.cc()}2&e&&(_.Lb(1),_.Xc(" ",_.rc(2,1,"COLLECT.SEARCH_CRITERIA_FILTER.DISSEMINATION_RULE.DELETE_INTERVAL")," "))}let cr=(()=>{class e{constructor(e,t,i,c){this.formBuilder=e,this.dialog=t,this.archiveExchangeDataService=i,this.ruleValidator=c,this.disseminationCriteriaList=[],this.disseminationAdditionalCriteria=new Map,this.endDateInterval=!1,this.emptyDisseminationCriteriaForm={disseminationRuleIdentifier:"",disseminationRuleTitle:"",disseminationRuleStartDate:"",disseminationRuleEndDate:"",disseminationRuleOriginInheriteAtLeastOne:!0,disseminationRuleOriginHasAtLeastOne:!0,disseminationRuleOriginHasNoOne:!1,disseminationRuleOriginWaitingRecalculate:!1},this.showUnitPreviewBlock=!1,this.disseminationRuleCriteriaForm=this.formBuilder.group({disseminationRuleIdentifier:[null,[z.c.ruleIdPattern],this.ruleValidator.uniqueRuleId()],disseminationRuleTitle:["",[]],disseminationRuleStartDate:["",[]],disseminationRuleEndDate:["",[]],disseminationRuleEliminationIdentifier:["",[]]}),Object(I.a)(this.disseminationRuleCriteriaForm.statusChanges,this.disseminationRuleCriteriaForm.valueChanges).pipe(Object(L.a)(me.UPDATE_DEBOUNCE_TIME),Object(b.a)(()=>this.disseminationRuleCriteriaForm.value),Object(b.a)(()=>Object(C.sb)(this.disseminationRuleCriteriaForm.value,this.previousDisseminationCriteriaValue)),Object(Pt.a)(e=>this.isEmpty(e))).subscribe(()=>{this.resetDisseminationRuleCriteriaForm()}),this.disseminationRuleCriteriaForm.get("disseminationRuleTitle").valueChanges.subscribe(e=>{null!==this.disseminationRuleCriteriaForm.get("disseminationRuleTitle").value&&""!==this.disseminationRuleCriteriaForm.get("disseminationRuleTitle").value&&(this.addCriteria("RULE_TITLE_DISSEMINATION_RULE",{id:e,value:e},e,!0,C.v.EQ,!1,C.u.STRING,C.Z.DISSEMINATION_RULE),this.resetDisseminationRuleCriteriaForm())}),this.subscriptionDisseminationFromMainSearchCriteria=this.archiveExchangeDataService.disseminationFromMainSearchCriteriaObservable.subscribe(e=>{e&&(this.disseminationAdditionalCriteria&&e.action===C.d.ADD?this.disseminationAdditionalCriteria.set(e.valueElt.value,!0):e.action===C.d.REMOVE&&this.disseminationAdditionalCriteria&&this.disseminationAdditionalCriteria.has(e.valueElt.value)&&this.disseminationAdditionalCriteria.set(e.valueElt.value,!1))})}checkBoxChange(e,t){const i=t.target.checked;switch(this.disseminationAdditionalCriteria.set(e,i),e){case"ORIGIN_HAS_NO_ONE":i?this.addCriteria("RULE_ORIGIN_DISSEMINATION_RULE",{id:"ORIGIN_HAS_NO_ONE",value:"ORIGIN_HAS_NO_ONE"},"ORIGIN_HAS_NO_ONE",!0,C.v.MISSING,!0,C.u.STRING,C.Z.DISSEMINATION_RULE):this.emitRemoveCriteriaEvent("RULE_ORIGIN_DISSEMINATION_RULE",{id:"ORIGIN_HAS_NO_ONE",value:"ORIGIN_HAS_NO_ONE"}),this.previousDisseminationCriteriaValue.disseminationRuleOriginHasNoOne=i;break;case"ORIGIN_WAITING_RECALCULATE":i?this.addCriteria("RULE_ORIGIN_DISSEMINATION_RULE",{id:"ORIGIN_WAITING_RECALCULATE",value:"ORIGIN_WAITING_RECALCULATE"},"ORIGIN_WAITING_RECALCULATE",!0,C.v.EQ,!0,C.u.STRING,C.Z.DISSEMINATION_RULE):this.emitRemoveCriteriaEvent("RULE_ORIGIN_DISSEMINATION_RULE",{id:"ORIGIN_WAITING_RECALCULATE",value:"ORIGIN_WAITING_RECALCULATE"}),this.previousDisseminationCriteriaValue.disseminationRuleOriginWaitingRecalculate=i;break;case"ORIGIN_HAS_AT_LEAST_ONE":i?this.addCriteria("RULE_ORIGIN_DISSEMINATION_RULE",{id:"ORIGIN_HAS_AT_LEAST_ONE",value:"ORIGIN_HAS_AT_LEAST_ONE"},"ORIGIN_HAS_AT_LEAST_ONE",!0,C.v.EXISTS,!0,C.u.STRING,C.Z.DISSEMINATION_RULE):this.emitRemoveCriteriaEvent("RULE_ORIGIN_DISSEMINATION_RULE",{id:"ORIGIN_HAS_AT_LEAST_ONE",value:"ORIGIN_HAS_AT_LEAST_ONE"}),this.previousDisseminationCriteriaValue.disseminationRuleOriginHasAtLeastOne=i}}addBeginDtDisseminationRuleCriteria(){this.disseminationRuleCriteriaForm.value.disseminationRuleStartDate&&(this.addCriteria("RULE_END_DATE_DISSEMINATION_RULE",{id:this.disseminationRuleCriteriaForm.value.disseminationRuleStartDate+"-",beginInterval:"",endInterval:this.disseminationRuleCriteriaForm.value.disseminationRuleStartDate},this.disseminationRuleCriteriaForm.value.disseminationRuleStartDate,!0,C.v.LTE,!1,C.u.INTERVAL,C.Z.DISSEMINATION_RULE),this.disseminationRuleCriteriaForm.controls.disseminationRuleStartDate.setValue(null))}addCriteriaRulePostCheck(){this.disseminationRuleCriteriaForm.value.disseminationRuleIdentifier&&(this.addCriteria("RULE_IDENTIFIER_DISSEMINATION_RULE",{id:this.disseminationRuleCriteriaForm.value.disseminationRuleIdentifier.trim(),value:this.disseminationRuleCriteriaForm.value.disseminationRuleIdentifier.trim()},this.disseminationRuleCriteriaForm.value.disseminationRuleIdentifier.trim(),!0,C.v.EQ,!1,C.u.STRING,C.Z.DISSEMINATION_RULE),this.disseminationRuleCriteriaForm.controls.disseminationRuleIdentifier.setValue(null))}addIntervalDtDisseminationRuleCriteria(){this.disseminationRuleCriteriaForm.value.disseminationRuleStartDate&&this.disseminationRuleCriteriaForm.value.disseminationRuleEndDate&&(this.addCriteria("RULE_END_DATE_DISSEMINATION_RULE",{id:this.disseminationRuleCriteriaForm.value.disseminationRuleStartDate+"-"+this.disseminationRuleCriteriaForm.value.disseminationRuleEndDate,beginInterval:this.disseminationRuleCriteriaForm.value.disseminationRuleStartDate,endInterval:this.disseminationRuleCriteriaForm.value.disseminationRuleEndDate},this.disseminationRuleCriteriaForm.value.disseminationRuleStartDate,!0,C.v.BETWEEN,!1,C.u.INTERVAL,C.Z.DISSEMINATION_RULE),this.disseminationRuleCriteriaForm.controls.disseminationRuleStartDate.setValue(null),this.disseminationRuleCriteriaForm.controls.disseminationRuleEndDate.setValue(null))}isEmpty(e){return!!e&&(e.disseminationRuleIdentifier?(this.addCriteria("RULE_IDENTIFIER_DISSEMINATION_RULE",{id:e.disseminationRuleIdentifier.trim(),value:e.disseminationRuleIdentifier.trim()},e.disseminationRuleIdentifier.trim(),!0,C.v.EQ,!1,C.u.STRING,C.Z.DISSEMINATION_RULE),this.resetDisseminationRuleCriteriaForm(),!0):e.disseminationRuleTitle?(this.addCriteria("RULE_TITLE_DISSEMINATION_RULE",{id:e.disseminationRuleTitle.trim(),value:e.disseminationRuleTitle.trim()},e.disseminationRuleTitle.trim(),!0,C.v.EQ,!1,C.u.STRING,C.Z.DISSEMINATION_RULE),!0):void 0)}updateEndDateInterval(e){this.endDateInterval=e}resetDisseminationRuleCriteriaForm(){this.disseminationRuleCriteriaForm.reset(this.previousDisseminationCriteriaValue)}ngOnInit(){this.disseminationAdditionalCriteria=new Map,this.disseminationAdditionalCriteria.set("ORIGIN_WAITING_RECALCULATE",!0===this.hasWaitingToRecalculateCriteria),this.disseminationAdditionalCriteria.set("ORIGIN_HAS_NO_ONE",!1),this.disseminationAdditionalCriteria.set("ORIGIN_HAS_AT_LEAST_ONE",!1),this.previousDisseminationCriteriaValue={disseminationRuleIdentifier:"",disseminationRuleTitle:"",disseminationRuleStartDate:"",disseminationRuleEndDate:"",disseminationRuleOriginInheriteAtLeastOne:!0,disseminationRuleOriginHasAtLeastOne:!0,disseminationRuleOriginHasNoOne:!1,disseminationRuleOriginWaitingRecalculate:this.hasWaitingToRecalculateCriteria},this.addCriteria("RULE_ORIGIN_DISSEMINATION_RULE",{value:"ORIGIN_HAS_AT_LEAST_ONE",id:"ORIGIN_HAS_AT_LEAST_ONE"},"ORIGIN_HAS_AT_LEAST_ONE",!0,C.v.EXISTS,!0,C.u.STRING,C.Z.DISSEMINATION_RULE),this.disseminationAdditionalCriteria.set("ORIGIN_HAS_AT_LEAST_ONE",!0)}emitRemoveCriteriaEvent(e,t){this.archiveExchangeDataService.sendRemoveFromChildSearchCriteriaAction({keyElt:e,valueElt:t,action:"REMOVE"})}addCriteria(e,t,i,c,a,r,n,s){e&&t&&this.archiveExchangeDataService.addSimpleSearchCriteriaSubject({keyElt:e,valueElt:t,labelElt:i,keyTranslated:c,operator:a,category:s,valueTranslated:r,dataType:n})}ngOnDestroy(){this.subscriptionDisseminationFromMainSearchCriteria.unsubscribe()}get disseminationRuleIdentifier(){return this.disseminationRuleCriteriaForm.controls.disseminationRuleIdentifier}get disseminationRuleTitle(){return this.disseminationRuleCriteriaForm.controls.disseminationRuleTitle}get disseminationRuleStartDate(){return this.disseminationRuleCriteriaForm.controls.disseminationRuleStartDate}get disseminationRuleEndDate(){return this.disseminationRuleCriteriaForm.controls.disseminationRuleEndDate}}return e.\u0275fac=function(t){return new(t||e)(_.Xb(a.e),_.Xb(n.b),_.Xb(de),_.Xb(na))},e.\u0275cmp=_.Rb({type:e,selectors:[["app-dissemination-rule-search"]],inputs:{hasWaitingToRecalculateCriteria:"hasWaitingToRecalculateCriteria"},decls:74,vars:49,consts:[[1,"container"],[3,"formGroup"],[1,"row","justify-content-start"],[1,"form-control"],[1,"title-text"],[1,"col-5","form-control"],["formControlName","disseminationRuleIdentifier","minlength","1",3,"validator","asyncValidator","label"],["errorKey","required"],["errorKey","ruleIdPattern"],["errorKey","ruleIdExists"],[1,"col-1","form-control"],["formControlName","disseminationRuleTitle",3,"validator","label"],[1,"col-11","form-control"],[1,"vitamui-input",3,"click"],["class","search-date-label",3,"click",4,"ngIf","ngIfElse"],["showBeginDtDisseminationRule",""],["size","0","formControlName","disseminationRuleStartDate",1,"hidden",3,"matDatepicker","max"],["pickerBeginDisseminationRule",""],["class","validate-date-small-button","type","button","mat-mini-fab","",3,"click",4,"ngIf"],[1,"col-4","form-control"],["class","title-text text-clicable-uppercase",3,"click",4,"ngIf"],["class","vitamui-input",3,"click",4,"ngIf"],[1,"row","justify-content-around"],[1,"row","criteria-choice"],[1,"row"],[1,"criteria-checkbox-choice"],["type","checkbox","id","HAS_AT_LEAST_ONE_DISSEMINATION_RULE_ORIGIN",3,"checked","click"],["id","HAS_NO_DISSEMINATION_RULE_ORIGIN","type","checkbox",3,"checked","click"],["id","WAITING_TO_RE_CALCULATE_DISSEMINATION_RULE_ORIGIN","type","checkbox",3,"checked","click"],[1,"col-3","form-control"],[1,"search-date-label",3,"click"],[3,"click"],["type","button","mat-mini-fab","",1,"validate-date-small-button",3,"click"],[1,"material-icons"],[1,"title-text","text-clicable-uppercase",3,"click"],["showEndDtDisseminationRule",""],["size","0","formControlName","disseminationRuleEndDate",1,"hidden",3,"matDatepicker","min"],["pickerEndDisseminationRule",""]],template:function(e,t){if(1&e){const e=_.ec();_.dc(0,"div",0),_.dc(1,"form",1),_.dc(2,"div",2),_.dc(3,"div",3),_.dc(4,"p",4),_.Vc(5),_.qc(6,"translate"),_.cc(),_.cc(),_.cc(),_.dc(7,"div",2),_.dc(8,"div",5),_.dc(9,"vitamui-common-editable-input",6),_.qc(10,"translate"),_.dc(11,"vitamui-common-field-error",7),_.Vc(12),_.qc(13,"translate"),_.cc(),_.dc(14,"vitamui-common-field-error",8),_.Vc(15),_.qc(16,"translate"),_.cc(),_.dc(17,"vitamui-common-field-error",9),_.Vc(18),_.qc(19,"translate"),_.cc(),_.cc(),_.cc(),_.Yb(20,"div",10),_.dc(21,"div",5),_.Yb(22,"vitamui-common-editable-input",11),_.qc(23,"translate"),_.cc(),_.Yb(24,"div",10),_.cc(),_.dc(25,"div",2),_.dc(26,"div",12),_.dc(27,"p",4),_.Vc(28),_.qc(29,"translate"),_.cc(),_.cc(),_.cc(),_.dc(30,"div",2),_.dc(31,"div",5),_.dc(32,"div",13),_.lc("click",(function(){return _.Kc(e),_.Gc(38).open()})),_.Tc(33,Ka,3,3,"span",14),_.Tc(34,za,3,4,"ng-template",null,15,_.Uc),_.Yb(36,"input",16),_.Yb(37,"mat-datepicker",null,17),_.cc(),_.cc(),_.dc(39,"div",10),_.Tc(40,$a,3,0,"button",18),_.cc(),_.dc(41,"div",19),_.Tc(42,Za,3,3,"p",20),_.Tc(43,er,7,4,"div",21),_.cc(),_.dc(44,"div",10),_.Tc(45,tr,3,0,"button",18),_.cc(),_.dc(46,"div",10),_.Tc(47,ir,3,3,"p",20),_.cc(),_.cc(),_.dc(48,"div",22),_.dc(49,"div",19),_.dc(50,"div",23),_.dc(51,"p",4),_.Vc(52),_.qc(53,"translate"),_.cc(),_.cc(),_.dc(54,"div",24),_.dc(55,"label",25),_.dc(56,"input",26),_.lc("click",(function(e){return t.checkBoxChange("ORIGIN_HAS_AT_LEAST_ONE",e)})),_.cc(),_.dc(57,"span"),_.Vc(58),_.qc(59,"translate"),_.cc(),_.cc(),_.cc(),_.dc(60,"div",24),_.dc(61,"label",25),_.dc(62,"input",27),_.lc("click",(function(e){return t.checkBoxChange("ORIGIN_HAS_NO_ONE",e)})),_.cc(),_.dc(63,"span"),_.Vc(64),_.qc(65,"translate"),_.cc(),_.cc(),_.cc(),_.dc(66,"div",24),_.dc(67,"label",25),_.dc(68,"input",28),_.lc("click",(function(e){return t.checkBoxChange("ORIGIN_WAITING_RECALCULATE",e)})),_.cc(),_.dc(69,"span"),_.Vc(70),_.qc(71,"translate"),_.cc(),_.cc(),_.cc(),_.cc(),_.Yb(72,"div",19),_.Yb(73,"div",29),_.cc(),_.cc(),_.cc()}if(2&e){const e=_.Gc(35),r=_.Gc(38);var i=null,c=null,a=null;_.Lb(1),_.vc("formGroup",t.disseminationRuleCriteriaForm),_.Lb(4),_.Wc(_.rc(6,27,"COLLECT.SEARCH_CRITERIA_FILTER.DISSEMINATION_TITLE")),_.Lb(4),_.wc("label",_.rc(10,29,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.ID_DISSEMINATION")),_.vc("validator",null==t.disseminationRuleCriteriaForm||null==(i=t.disseminationRuleCriteriaForm.get("disseminationRuleIdentifier"))?null:i.validator)("asyncValidator",null==t.disseminationRuleCriteriaForm||null==(c=t.disseminationRuleCriteriaForm.get("disseminationRuleIdentifier"))?null:c.asyncValidator),_.Lb(3),_.Xc("",_.rc(13,31,"COMMON.REQUIRED")," "),_.Lb(3),_.Xc("",_.rc(16,33,"COLLECT.RULE.WRONG_FORMAT")," "),_.Lb(3),_.Xc("",_.rc(19,35,"COLLECT.RULE.CODE_NOT_EXIST")," "),_.Lb(4),_.wc("label",_.rc(23,37,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.TITLE_DISSEMINATION")),_.vc("validator",null==t.disseminationRuleCriteriaForm||null==(a=t.disseminationRuleCriteriaForm.get("disseminationRuleTitle"))?null:a.validator),_.Lb(6),_.Wc(_.rc(29,39,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.END_DATE_DISSEMINATION")),_.Lb(5),_.vc("ngIf",!t.disseminationRuleCriteriaForm.get("disseminationRuleStartDate").value)("ngIfElse",e),_.Lb(3),_.vc("matDatepicker",r)("max",t.disseminationRuleCriteriaForm.get("disseminationRuleEndDate").value),_.Lb(4),_.vc("ngIf",!t.endDateInterval&&t.disseminationRuleCriteriaForm.get("disseminationRuleStartDate").value),_.Lb(2),_.vc("ngIf",!t.endDateInterval),_.Lb(1),_.vc("ngIf",t.endDateInterval),_.Lb(2),_.vc("ngIf",t.endDateInterval&&t.disseminationRuleCriteriaForm.get("disseminationRuleStartDate").value&&t.disseminationRuleCriteriaForm.get("disseminationRuleEndDate").value),_.Lb(2),_.vc("ngIf",t.endDateInterval),_.Lb(5),_.Xc(" ",_.rc(53,41,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.ORIGIN.TITLE")," "),_.Lb(4),_.vc("checked",t.disseminationAdditionalCriteria.get("ORIGIN_HAS_AT_LEAST_ONE")),_.Lb(2),_.Wc(_.rc(59,43,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.ORIGIN.HAS_AT_LEAST_ONE_DISSEMINATION_RULE")),_.Lb(4),_.vc("checked",t.disseminationAdditionalCriteria.get("ORIGIN_HAS_NO_ONE")),_.Lb(2),_.Wc(_.rc(65,45,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.ORIGIN.HAS_NO_DISSEMINATION_RULE")),_.Lb(4),_.vc("checked",t.disseminationAdditionalCriteria.get("ORIGIN_WAITING_RECALCULATE")),_.Lb(2),_.Wc(_.rc(71,47,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.ORIGIN.WAITING_TO_RE_CALCULATE_DISSEMINATION_RULE"))}},directives:[a.x,a.q,a.i,C.C,a.p,a.h,a.l,C.mb,c.p,a.c,r.b,r.a,sa.a],pipes:[O.d,C.Vb],styles:['.check-rule[_ngcontent-%COMP%]{margin-right:25%;margin-left:-15%;margin-top:5px}.title-text[_ngcontent-%COMP%]{font-style:normal;font-weight:700;font-size:16px;color:var(--vitamui-primary)!important}.validate-date-small-button[_ngcontent-%COMP%]{background-color:"green";width:30px;height:30px}']}),e})();function ar(e,t){if(1&e){const e=_.ec();_.dc(0,"mat-sidenav",7),_.dc(1,"app-filing-holding-scheme",8),_.lc("showArchiveUnitDetails",(function(t){return _.Kc(e),_.pc().showPreviewArchiveUnit(t)})),_.cc(),_.cc()}if(2&e){const e=_.pc();_.vc("fixedInViewport",!0)("opened",e.show),_.Lb(1),_.vc("transactionId",null==e.transaction?null:e.transaction.id)("searchHasMatches",e.searchHasResults)("searchRequestTotalResults",e.totalResults)}}function rr(e,t){if(1&e){const e=_.ec();_.dc(0,"app-archive-preview",9),_.lc("previewClose",(function(){return _.Kc(e),_.pc().closePanel()}))("showExtendedLateralPanel",(function(){return _.Kc(e),_.pc().showExtendedLateralPanel()}))("backToNormalLateralPanel",(function(){return _.Kc(e),_.pc().backToNormalLateralPanel()})),_.cc()}if(2&e){const e=_.pc();_.vc("archiveUnit",e.openedItem)("accessContractAllowUpdating",e.accessContractAllowUpdating)("hasUpdateDescriptiveUnitMetadataRole",e.hasUpdateDescriptiveUnitMetadataRole)("transactionId",e.transaction.id)}}function nr(e,t){if(1&e){const e=_.ec();_.dc(0,"button",66),_.lc("click",(function(){_.Kc(e);const t=_.pc(2);return t.hiddenTreeBlock(t.show)})),_.qc(1,"translate"),_.dc(2,"i",67),_.Vc(3,"chevron_right"),_.cc(),_.cc()}2&e&&(_.wc("matTooltip",_.rc(1,2,"COLLECT.SHOW_TREES_PLANS")),_.vc("matTooltipShowDelay",300))}function sr(e,t){if(1&e){const e=_.ec();_.bc(0),_.dc(1,"app-criteria-search",68),_.lc("criteriaRemoveEvent",(function(t){return _.Kc(e),_.pc(3).removeCriteriaEvent(t)})),_.cc(),_.ac()}if(2&e){const e=t.ngIf,i=_.pc().$implicit;_.Lb(1),_.vc("criteriaKey",i)("criteriaVal",e)}}function lr(e,t){if(1&e&&(_.bc(0),_.Tc(1,sr,2,2,"ng-container",65),_.ac()),2&e){const e=t.$implicit,i=_.pc(2);_.Lb(1),_.vc("ngIf",i.searchCriterias.get(e))}}function or(e,t){if(1&e){const e=_.ec();_.dc(0,"div",69),_.dc(1,"button",70),_.dc(2,"button",71),_.lc("click",(function(){return _.Kc(e),_.pc(2).clearCriterias()})),_.dc(3,"i",28),_.Vc(4,"delete"),_.cc(),_.cc(),_.cc(),_.cc()}}function dr(e,t){1&e&&(_.dc(0,"div",72),_.Yb(1,"mat-spinner",73),_.cc())}function ur(e,t){if(1&e){const e=_.ec();_.dc(0,"i",76),_.lc("click",(function(){return _.Kc(e),_.pc(3).showHideFacets(!1)})),_.cc()}2&e&&_.vc("ngClass","vitamui-icon vitamui-icon-cross vitamui-row-icon")}function hr(e,t){if(1&e&&(_.dc(0,"div",40),_.Tc(1,ur,1,1,"i",74),_.Yb(2,"app-archive-search-rules-facets",75),_.cc()),2&e){const e=_.pc(2);_.Lb(1),_.vc("ngIf",!e.pendingComputeFacets&&e.showingFacets&&e.submited),_.Lb(1),_.vc("exactCount",!e.waitingToGetFixedCount)("appraisalRuleFacets",null==e.archiveSearchResultFacets?null:e.archiveSearchResultFacets.appraisalRuleFacets)("accessRuleFacets",null==e.archiveSearchResultFacets?null:e.archiveSearchResultFacets.accessRuleFacets)("storageRuleFacets",null==e.archiveSearchResultFacets?null:e.archiveSearchResultFacets.storageRuleFacets)("reuseRuleFacets",null==e.archiveSearchResultFacets?null:e.archiveSearchResultFacets.reuseRuleFacets)("disseminationRuleFacets",null==e.archiveSearchResultFacets?null:e.archiveSearchResultFacets.disseminationRuleFacets)("holdRuleFacets",null==e.archiveSearchResultFacets?null:e.archiveSearchResultFacets.holdRuleFacets)("classificationRuleFacets",null==e.archiveSearchResultFacets?null:e.archiveSearchResultFacets.classificationRuleFacets)("tenantIdentifier",e.tenantIdentifier)("totalResults",e.totalResults)("defaultFacetTabIndex",e.defaultFacetTabIndex)}}function Cr(e,t){if(1&e){const e=_.ec();_.dc(0,"a",78),_.lc("click",(function(){return _.Kc(e),_.pc(3).showHidePanel(!0)})),_.Vc(1),_.qc(2,"translate"),_.cc()}2&e&&(_.Lb(1),_.Wc(_.rc(2,1,"COLLECT.SHOW_SEARCH_CRITERIA")))}function Er(e,t){if(1&e){const e=_.ec();_.dc(0,"a",78),_.lc("click",(function(){return _.Kc(e),_.pc(3).showHideFacets(!0)})),_.Vc(1),_.qc(2,"translate"),_.cc()}2&e&&(_.Lb(1),_.Wc(_.rc(2,1,"COLLECT.COMPUTE_RULES_FACETS")))}function Rr(e,t){if(1&e&&(_.dc(0,"div",72),_.Tc(1,Cr,3,3,"a",77),_.Tc(2,Er,3,3,"a",77),_.cc()),2&e){const e=_.pc(2);_.Lb(1),_.vc("ngIf",!e.showCriteriaPanel),_.Lb(1),_.vc("ngIf",!e.pendingComputeFacets&&!e.showingFacets&&e.submited)}}function pr(e,t){if(1&e){const e=_.ec();_.dc(0,"span",79),_.lc("click",(function(){_.Kc(e);const t=_.pc().$implicit;return _.pc(2).sendRuleCategorySelected(t.name)})),_.Vc(1),_.qc(2,"translate"),_.cc(),_.dc(3,"button",80),_.lc("click",(function(){_.Kc(e);const t=_.pc().$implicit;return _.pc(2).removeCriteriaCategory(t.name)})),_.Yb(4,"i",81),_.cc()}if(2&e){const e=_.pc().$implicit;_.Lb(1),_.Xc(" ",_.rc(2,1,"COLLECT.CRITERIA_CATEGORY_SHORT_NAME."+e.name)," ")}}function vr(e,t){if(1&e){const e=_.ec();_.dc(0,"div",40),_.dc(1,"div",82),_.dc(2,"a",78),_.lc("click",(function(){return _.Kc(e),_.pc(3).removeCriteriaByCategory("STORAGE_RULE")})),_.Vc(3),_.qc(4,"translate"),_.cc(),_.cc(),_.Yb(5,"app-storage-rule-search",83),_.cc()}if(2&e){const e=_.pc(3);_.Lb(3),_.Wc(_.rc(4,2,"COLLECT.REMOVE_SEARCH_CRITERIA_BY_CATEGORY")),_.Lb(2),_.vc("hasWaitingToRecalculateCriteria",e.containsWaitingToRecalculateInheritenceRuleCriteria())}}function Ir(e,t){if(1&e){const e=_.ec();_.dc(0,"div",40),_.dc(1,"div",82),_.dc(2,"a",78),_.lc("click",(function(){return _.Kc(e),_.pc(3).removeCriteriaByCategory("APPRAISAL_RULE")})),_.Vc(3),_.qc(4,"translate"),_.cc(),_.cc(),_.Yb(5,"app-appraisal-rule-search",83),_.cc()}if(2&e){const e=_.pc(3);_.Lb(3),_.Wc(_.rc(4,2,"COLLECT.REMOVE_SEARCH_CRITERIA_BY_CATEGORY")),_.Lb(2),_.vc("hasWaitingToRecalculateCriteria",e.containsWaitingToRecalculateInheritenceRuleCriteria())}}function Tr(e,t){if(1&e){const e=_.ec();_.dc(0,"div",40),_.dc(1,"div",82),_.dc(2,"a",78),_.lc("click",(function(){return _.Kc(e),_.pc(3).removeCriteriaByCategory("ACCESS_RULE")})),_.Vc(3),_.qc(4,"translate"),_.cc(),_.cc(),_.Yb(5,"app-access-rule-search",83),_.cc()}if(2&e){const e=_.pc(3);_.Lb(3),_.Wc(_.rc(4,2,"COLLECT.REMOVE_SEARCH_CRITERIA_BY_CATEGORY")),_.Lb(2),_.vc("hasWaitingToRecalculateCriteria",e.containsWaitingToRecalculateInheritenceRuleCriteria())}}function gr(e,t){if(1&e){const e=_.ec();_.dc(0,"div",40),_.dc(1,"div",82),_.dc(2,"a",78),_.lc("click",(function(){return _.Kc(e),_.pc(3).removeCriteriaByCategory("REUSE_RULE")})),_.Vc(3),_.qc(4,"translate"),_.cc(),_.cc(),_.Yb(5,"app-reuse-rule-search",83),_.cc()}if(2&e){const e=_.pc(3);_.Lb(3),_.Wc(_.rc(4,2,"COLLECT.REMOVE_SEARCH_CRITERIA_BY_CATEGORY")),_.Lb(2),_.vc("hasWaitingToRecalculateCriteria",e.containsWaitingToRecalculateInheritenceRuleCriteria())}}function Lr(e,t){if(1&e){const e=_.ec();_.dc(0,"div",40),_.dc(1,"div",82),_.dc(2,"a",78),_.lc("click",(function(){return _.Kc(e),_.pc(3).removeCriteriaByCategory("DISSEMINATION_RULE")})),_.Vc(3),_.qc(4,"translate"),_.cc(),_.cc(),_.Yb(5,"app-dissemination-rule-search",83),_.cc()}if(2&e){const e=_.pc(3);_.Lb(3),_.Wc(_.rc(4,2,"COLLECT.REMOVE_SEARCH_CRITERIA_BY_CATEGORY")),_.Lb(2),_.vc("hasWaitingToRecalculateCriteria",e.containsWaitingToRecalculateInheritenceRuleCriteria())}}function br(e,t){if(1&e&&(_.dc(0,"mat-tab"),_.Tc(1,pr,5,3,"ng-template",42),_.bc(2),_.Tc(3,vr,6,4,"div",36),_.ac(),_.bc(4),_.Tc(5,Ir,6,4,"div",36),_.ac(),_.bc(6),_.Tc(7,Tr,6,4,"div",36),_.ac(),_.bc(8),_.Tc(9,gr,6,4,"div",36),_.ac(),_.bc(10),_.Tc(11,Lr,6,4,"div",36),_.ac(),_.cc()),2&e){const e=t.$implicit;_.Lb(3),_.vc("ngIf","STORAGE_RULE"===e.name),_.Lb(2),_.vc("ngIf","APPRAISAL_RULE"===e.name),_.Lb(2),_.vc("ngIf","ACCESS_RULE"===e.name),_.Lb(2),_.vc("ngIf","REUSE_RULE"===e.name),_.Lb(2),_.vc("ngIf","DISSEMINATION_RULE"===e.name)}}function Ar(e,t){if(1&e&&(_.dc(0,"button",84),_.Vc(1),_.qc(2,"translate"),_.Yb(3,"i",85),_.cc()),2&e){_.pc();const e=_.Gc(57);_.vc("matMenuTriggerFor",e),_.Lb(1),_.Xc(" ",_.rc(2,2,"COLLECT.CRITERIA_CATEGORY.ADD")," ")}}function Sr(e,t){if(1&e){const e=_.ec();_.dc(0,"div",82),_.dc(1,"a",78),_.lc("click",(function(){return _.Kc(e),_.pc(2).showHidePanel(!1)})),_.Vc(2),_.qc(3,"translate"),_.cc(),_.cc()}2&e&&(_.Lb(2),_.Wc(_.rc(3,1,"COLLECT.HIDE_SEARCH_CRITERIA")))}function _r(e,t){1&e&&(_.bc(0),_.Yb(1,"i",96),_.ac())}function mr(e,t){1&e&&(_.bc(0),_.Yb(1,"i",97),_.ac())}function fr(e,t){if(1&e&&(_.bc(0),_.dc(1,"span",95),_.Tc(2,_r,2,0,"ng-container",65),_.Tc(3,mr,2,0,"ng-container",65),_.cc(),_.ac()),2&e){const e=_.pc().$implicit;_.Lb(2),_.vc("ngIf",!e["#object"]),_.Lb(1),_.vc("ngIf",!!e["#object"])}}function Or(e,t){1&e&&(_.bc(0),_.Yb(1,"i",98),_.ac())}function Nr(e,t){1&e&&(_.bc(0),_.Yb(1,"i",99),_.ac())}function Fr(e,t){if(1&e){const e=_.ec();_.dc(0,"div",86),_.dc(1,"div",87),_.dc(2,"div",51),_.dc(3,"input",88),_.lc("click",(function(i){_.Kc(e);const c=t.$implicit;return _.pc(2).checkChildrenBoxChange(c["#id"],i)})),_.cc(),_.cc(),_.dc(4,"div",89),_.lc("click",(function(){_.Kc(e);const i=t.$implicit;return _.pc(2).showPreviewArchiveUnit(i)})),_.dc(5,"span",90),_.Tc(6,fr,4,2,"ng-container",91),_.Tc(7,Or,2,0,"ng-container",91),_.Tc(8,Nr,2,0,"ng-container",91),_.cc(),_.cc(),_.dc(9,"div",92),_.lc("click",(function(){_.Kc(e);const i=t.$implicit;return _.pc(2).showPreviewArchiveUnit(i)})),_.dc(10,"p",93),_.qc(11,"unitI18n"),_.dc(12,"b"),_.Vc(13),_.qc(14,"unitI18n"),_.cc(),_.Yb(15,"br"),_.Vc(16),_.qc(17,"truncate"),_.qc(18,"unitI18n"),_.cc(),_.cc(),_.dc(19,"div",94),_.lc("click",(function(){_.Kc(e);const i=t.$implicit;return _.pc(2).showPreviewArchiveUnit(i)})),_.Vc(20),_.qc(21,"dateTime"),_.cc(),_.dc(22,"div",94),_.lc("click",(function(){_.Kc(e);const i=t.$implicit;return _.pc(2).showPreviewArchiveUnit(i)})),_.Vc(23),_.qc(24,"dateTime"),_.cc(),_.dc(25,"div",94),_.lc("click",(function(){_.Kc(e);const i=t.$implicit;return _.pc(2).showPreviewArchiveUnit(i)})),_.dc(26,"p",93),_.Vc(27),_.cc(),_.cc(),_.cc(),_.cc()}if(2&e){const e=t.$implicit,i=_.pc(2);_.Lb(3),_.vc("checked",i.isAllChecked),_.Lb(2),_.vc("ngSwitch",i.getArchiveUnitType(e)),_.Lb(1),_.vc("ngSwitchCase",i.UnitType.INGEST),_.Lb(1),_.vc("ngSwitchCase",i.UnitType.HOLDING_UNIT),_.Lb(1),_.vc("ngSwitchCase",i.UnitType.FILING_UNIT),_.Lb(2),_.wc("matTooltip",_.sc(11,15,e,"Description")),_.vc("matTooltipShowDelay",300),_.Lb(3),_.Xc(" ",_.sc(14,18,e,"Title"),""),_.Lb(3),_.Xc(" ",_.sc(17,21,_.sc(18,24,e,"Description"),100)," "),_.Lb(4),_.Xc(" ",_.sc(21,27,e.StartDate,"dd/MM/yyyy")," "),_.Lb(3),_.Xc(" ",_.sc(24,30,e.EndDate,"dd/MM/yyyy")," "),_.Lb(3),_.yc("matTooltip","",e["#originating_agency"],"   (",e["#originating_agencies"],")"),_.vc("matTooltipShowDelay",300),_.Lb(1),_.Xc(" ",e["#originating_agency"]," ")}}function Dr(e,t){1&e&&_.Yb(0,"mat-spinner",100)}function Ur(e,t){if(1&e){const e=_.ec();_.dc(0,"button",101),_.lc("click",(function(){return _.Kc(e),_.pc(2).loadMore()})),_.Vc(1),_.qc(2,"translate"),_.cc()}2&e&&(_.Lb(1),_.Xc(" ",_.rc(2,1,"COLLECT.SHOW_MORE_RESULTS")," "))}function yr(e,t){1&e&&(_.dc(0,"span"),_.Vc(1),_.qc(2,"translate"),_.cc()),2&e&&(_.Lb(1),_.Wc(_.rc(2,1,"COLLECT.NO_MORE_RESULTS")))}function Pr(e,t){if(1&e){const e=_.ec();_.dc(0,"div",10),_.dc(1,"div",11),_.dc(2,"div",12),_.Tc(3,nr,4,4,"button",13),_.cc(),_.cc(),_.dc(4,"div",14),_.dc(5,"div",15),_.Yb(6,"app-title-and-description-criteria-search-collect"),_.cc(),_.dc(7,"div",16),_.dc(8,"button",17),_.lc("click",(function(){return _.Kc(e),_.pc().submit()})),_.Vc(9),_.qc(10,"translate"),_.cc(),_.cc(),_.dc(11,"div",18),_.dc(12,"vitamui-common-menu-button",19),_.qc(13,"translate"),_.dc(14,"button",20),_.lc("click",(function(){return _.Kc(e),_.pc().openUpdateUnitsForm()})),_.Vc(15),_.qc(16,"translate"),_.cc(),_.dc(17,"button",20),_.lc("click",(function(){return _.Kc(e),_.pc().validateTransaction()})),_.qc(18,"async"),_.Vc(19),_.qc(20,"translate"),_.cc(),_.dc(21,"button",20),_.lc("click",(function(){return _.Kc(e),_.pc().sendTransaction()})),_.qc(22,"async"),_.Vc(23),_.qc(24,"translate"),_.cc(),_.cc(),_.cc(),_.cc(),_.dc(25,"div",14),_.dc(26,"div",21),_.dc(27,"div",22),_.Tc(28,lr,2,1,"ng-container",23),_.cc(),_.cc(),_.dc(29,"div",24),_.dc(30,"div",25),_.dc(31,"button",26),_.dc(32,"button",27),_.dc(33,"i",28),_.Vc(34,"save"),_.cc(),_.cc(),_.cc(),_.dc(35,"mat-menu",29,30),_.dc(37,"button",31),_.lc("click",(function(){return _.Kc(e),_.pc().mapSearchCriteriaHistory()})),_.dc(38,"i",32),_.Vc(39,"add"),_.cc(),_.Vc(40),_.qc(41,"translate"),_.cc(),_.dc(42,"app-search-criteria-list",33),_.lc("storedSearchCriteriaHistory",(function(t){return _.Kc(e),_.pc().showStoredSearchCriteria(t)})),_.cc(),_.cc(),_.Tc(43,or,5,0,"div",34),_.cc(),_.cc(),_.cc(),_.Tc(44,dr,2,0,"div",35),_.Tc(45,hr,3,12,"div",36),_.Tc(46,Rr,3,2,"div",35),_.dc(47,"div",37),_.dc(48,"mat-tab-group",38),_.lc("selectedIndexChange",(function(t){return _.Kc(e),_.pc().selectedCategoryChange(t)})),_.dc(49,"mat-tab",39),_.qc(50,"translate"),_.dc(51,"div",40),_.Yb(52,"app-simple-criteria-search"),_.cc(),_.cc(),_.Tc(53,br,12,5,"mat-tab",23),_.dc(54,"mat-tab",41),_.Tc(55,Ar,4,4,"ng-template",42),_.cc(),_.dc(56,"mat-menu",29,43),_.dc(58,"button",31),_.lc("click",(function(){return _.Kc(e),_.pc().addCriteriaCategory("STORAGE_RULE")})),_.Vc(59),_.qc(60,"translate"),_.cc(),_.dc(61,"button",31),_.lc("click",(function(){return _.Kc(e),_.pc().addCriteriaCategory("APPRAISAL_RULE")})),_.Vc(62),_.qc(63,"translate"),_.cc(),_.dc(64,"button",31),_.lc("click",(function(){return _.Kc(e),_.pc().addCriteriaCategory("GEL")})),_.Vc(65),_.qc(66,"translate"),_.cc(),_.dc(67,"button",31),_.lc("click",(function(){return _.Kc(e),_.pc().addCriteriaCategory("ACCESS_RULE")})),_.Vc(68),_.qc(69,"translate"),_.cc(),_.dc(70,"button",31),_.lc("click",(function(){return _.Kc(e),_.pc().addCriteriaCategory("DISSEMINATION_RULE")})),_.Vc(71),_.qc(72,"translate"),_.cc(),_.dc(73,"button",31),_.lc("click",(function(){return _.Kc(e),_.pc().addCriteriaCategory("REUSE_RULE")})),_.Vc(74),_.qc(75,"translate"),_.cc(),_.dc(76,"button",31),_.lc("click",(function(){return _.Kc(e),_.pc().addCriteriaCategory("CLASSIFICATION")})),_.Vc(77),_.qc(78,"translate"),_.cc(),_.cc(),_.cc(),_.cc(),_.Tc(79,Sr,4,3,"div",44),_.dc(80,"div",45),_.lc("vitamuiScroll",(function(){return _.Kc(e),_.pc().loadMore()})),_.dc(81,"div",46),_.dc(82,"div",47),_.dc(83,"vitamui-common-archive-unit-count",48),_.lc("archiveUnitCountChange",(function(t){return _.Kc(e),_.pc().onArchiveUnitCountChange(t)}))("selectedArchiveUnitCountChange",(function(t){return _.Kc(e),_.pc().itemSelected=t}))("pendingChange",(function(t){return _.Kc(e),_.pc().pending=t})),_.cc(),_.Yb(84,"div",24),_.dc(85,"div",49),_.dc(86,"i",50),_.lc("click",(function(){return _.Kc(e),_.pc().exportArchiveUnitsToCsvFile()})),_.cc(),_.cc(),_.cc(),_.dc(87,"div",47),_.dc(88,"div",51),_.dc(89,"input",52),_.lc("change",(function(t){return _.Kc(e),_.pc().checkParentBoxChange(t)})),_.cc(),_.cc(),_.dc(90,"div",51),_.dc(91,"span"),_.Vc(92),_.qc(93,"translate"),_.cc(),_.dc(94,"vitamui-common-order-by-button",53),_.lc("orderByChange",(function(t){return _.Kc(e),_.pc().orderBy=t}))("directionChange",(function(t){return _.Kc(e),_.pc().direction=t}))("orderChange",(function(){return _.Kc(e),_.pc().emitOrderChange()})),_.cc(),_.cc(),_.dc(95,"div",54),_.dc(96,"span"),_.Vc(97),_.qc(98,"translate"),_.Yb(99,"br"),_.Vc(100),_.qc(101,"translate"),_.cc(),_.dc(102,"vitamui-common-order-by-button",55),_.lc("orderByChange",(function(t){return _.Kc(e),_.pc().orderBy=t}))("directionChange",(function(t){return _.Kc(e),_.pc().direction=t}))("orderChange",(function(){return _.Kc(e),_.pc().emitOrderChange()})),_.cc(),_.cc(),_.dc(103,"div",56),_.dc(104,"span"),_.Vc(105),_.qc(106,"translate"),_.cc(),_.dc(107,"vitamui-common-order-by-button",57),_.lc("orderByChange",(function(t){return _.Kc(e),_.pc().orderBy=t}))("directionChange",(function(t){return _.Kc(e),_.pc().direction=t}))("orderChange",(function(){return _.Kc(e),_.pc().emitOrderChange()})),_.cc(),_.cc(),_.dc(108,"div",56),_.dc(109,"span"),_.Vc(110),_.qc(111,"translate"),_.cc(),_.dc(112,"vitamui-common-order-by-button",58),_.lc("orderByChange",(function(t){return _.Kc(e),_.pc().orderBy=t}))("directionChange",(function(t){return _.Kc(e),_.pc().direction=t}))("orderChange",(function(){return _.Kc(e),_.pc().emitOrderChange()})),_.cc(),_.cc(),_.dc(113,"div",56),_.dc(114,"span"),_.Vc(115),_.qc(116,"translate"),_.cc(),_.dc(117,"vitamui-common-order-by-button",59),_.lc("orderByChange",(function(t){return _.Kc(e),_.pc().orderBy=t}))("directionChange",(function(t){return _.Kc(e),_.pc().direction=t}))("orderChange",(function(){return _.Kc(e),_.pc().emitOrderChange()})),_.cc(),_.cc(),_.cc(),_.dc(118,"div",60),_.Tc(119,Fr,28,33,"div",61),_.cc(),_.dc(120,"div",62),_.Tc(121,Dr,1,0,"mat-spinner",63),_.Tc(122,Ur,3,3,"button",64),_.Tc(123,yr,3,3,"span",65),_.cc(),_.cc(),_.cc(),_.cc()}if(2&e){const e=_.Gc(36),t=_.pc();_.Lb(3),_.vc("ngIf",!t.show),_.Lb(5),_.vc("disabled",!(t.searchCriteriaKeys&&0!==t.searchCriteriaKeys.length)),_.Lb(1),_.Xc(" ",_.rc(10,69,"COLLECT.LAUNCH_SEARCH_ACTION")," "),_.Lb(3),_.wc("matTooltip",_.rc(13,71,"COLLECT.OTHER_ACTION")),_.vc("overlayPos","end")("icon","vitamui-icon-more-horiz"),_.Lb(2),_.vc("disabled",t.updateUnitsMetadataDisabled()||t.isArchiveUnitsEmpty()),_.Lb(1),_.Xc(" ",_.rc(16,73,"COLLECT.UPDATE_UNITS_METADATA.ACTION_UPDATE")," "),_.Lb(2),_.vc("disabled",t.isArchiveUnitsEmpty()||_.rc(18,75,t.isNotOpen$)),_.Lb(2),_.Xc(" ",_.rc(20,77,"COLLECT.VALIDATE_ACTION")," "),_.Lb(2),_.vc("disabled",_.rc(22,79,t.isNotReady$)),_.Lb(2),_.Xc(" ",_.rc(24,81,"COLLECT.INGEST_ACTION")," "),_.Lb(5),_.vc("ngForOf",t.searchCriteriaKeys),_.Lb(3),_.vc("matMenuTriggerFor",e),_.Lb(6),_.vc("disabled",!t.searchCriterias||0===t.searchCriterias.size),_.Lb(3),_.Xc(" ",_.rc(41,83,"COLLECT.SEARCH_CRITERIA_SAVER.NEW_SAVE_MENU")," "),_.Lb(3),_.vc("ngIf",t.searchCriterias&&t.searchCriterias.size>0),_.Lb(1),_.vc("ngIf",t.pendingComputeFacets),_.Lb(1),_.vc("ngIf",!t.pendingComputeFacets&&t.submited&&t.rulesFacetsComputed&&t.showingFacets),_.Lb(1),_.vc("ngIf",!t.pending),_.Lb(1),_.vc("hidden",!t.showCriteriaPanel),_.Lb(1),_.vc("selectedIndex",t.additionalSearchCriteriaCategoryIndex),_.Lb(1),_.wc("label",_.rc(50,85,"COLLECT.SEARCH_CRITERIA_FILTER.TITLE")),_.Lb(4),_.vc("ngForOf",t.additionalSearchCriteriaCategories),_.Lb(5),_.vc("disabled",t.isCategoryAdded("STORAGE_RULE")),_.Lb(1),_.Xc(" ",_.rc(60,87,"COLLECT.CRITERIA_CATEGORY_SHORT_NAME.STORAGE_RULE")," "),_.Lb(2),_.vc("disabled",t.isCategoryAdded("APPRAISAL_RULE")),_.Lb(1),_.Xc(" ",_.rc(63,89,"COLLECT.CRITERIA_CATEGORY_SHORT_NAME.APPRAISAL_RULE")," "),_.Lb(2),_.vc("disabled",t.isCategoryAdded("GEL")||!0),_.Lb(1),_.Xc(" ",_.rc(66,91,"COLLECT.CRITERIA_CATEGORY_SHORT_NAME.GEL")," "),_.Lb(2),_.vc("disabled",t.isCategoryAdded("ACCESS_RULE")),_.Lb(1),_.Xc(" ",_.rc(69,93,"COLLECT.CRITERIA_CATEGORY_SHORT_NAME.ACCESS_RULE")," "),_.Lb(2),_.vc("disabled",t.isCategoryAdded("DISSEMINATION_RULE")),_.Lb(1),_.Xc(" ",_.rc(72,95,"COLLECT.CRITERIA_CATEGORY_SHORT_NAME.DISSEMINATION_RULE")," "),_.Lb(2),_.vc("disabled",t.isCategoryAdded("REUSE_RULE")),_.Lb(1),_.Xc(" ",_.rc(75,97,"COLLECT.CRITERIA_CATEGORY_SHORT_NAME.REUSE_RULE")," "),_.Lb(2),_.vc("disabled",t.isCategoryAdded("CLASSIFICATION")||!0),_.Lb(1),_.Xc(" ",_.rc(78,99,"COLLECT.CRITERIA_CATEGORY_SHORT_NAME.CLASSIFICATION")," "),_.Lb(2),_.vc("ngIf",t.showCriteriaPanel),_.Lb(4),_.vc("search",t.search$)("archiveUnitCount",t.totalResults)("selectedArchiveUnitCount",t.itemSelected)("threshold",1e4)("pending",t.pending)("allChecked",t.isAllChecked),_.Lb(2),_.vc("ngClass",null!=t.criteriaSearchList&&t.criteriaSearchList.length>0&&t.totalResults>0&&t.itemSelected>0?"enabled-div":"disabled-div"),_.Lb(4),_.vc("checked",t.isAllChecked)("indeterminate",t.isIndeterminate),_.Lb(3),_.Wc(_.rc(93,101,"COLLECT.ARCHIVE_UNIT.FIELDS.TYPE")),_.Lb(2),_.vc("orderBy",t.orderBy)("direction",t.direction),_.Lb(3),_.Xc("",_.rc(98,103,"COLLECT.ARCHIVE_UNIT.FIELDS.NAME")," "),_.Lb(3),_.Wc(_.rc(101,105,"COLLECT.ARCHIVE_UNIT.FIELDS.DESCRIPTION")),_.Lb(2),_.vc("orderBy",t.orderBy)("direction",t.direction),_.Lb(3),_.Xc("",_.rc(106,107,"COLLECT.ARCHIVE_UNIT.FIELDS.START_DATE")," "),_.Lb(2),_.vc("orderBy",t.orderBy)("direction",t.direction),_.Lb(3),_.Xc("",_.rc(111,109,"COLLECT.ARCHIVE_UNIT.FIELDS.END_DATE")," "),_.Lb(2),_.vc("orderBy",t.orderBy)("direction",t.direction),_.Lb(3),_.Wc(_.rc(116,111,"COLLECT.ARCHIVE_UNIT.FIELDS.SP")),_.Lb(2),_.vc("orderBy",t.orderBy)("direction",t.direction),_.Lb(2),_.vc("ngForOf",t.archiveUnits)("ngForTrackBy",t.trackBy),_.Lb(2),_.vc("ngIf",t.pending),_.Lb(1),_.vc("ngIf",!t.pending&&t.canLoadMore),_.Lb(1),_.vc("ngIf",!t.pending&&!t.canLoadMore)}}let xr=(()=>{class e extends C.cb{constructor(e,t,i,c,a,r,n,s,l,o){super(e,t),this.route=e,this.externalParameterService=i,this.translateService=c,this.archiveUnitCollectService=a,this.archiveHelperService=r,this.archiveExchangeDataService=n,this.archiveFacetsService=s,this.snackBar=l,this.dialog=o,this.UnitType=C.kb,this.subscriptions=new R.a,this.foundAccessContract=!1,this.accessContractAllowUpdating=!1,this.hasUpdateDescriptiveUnitMetadataRole=!1,this.isLPExtended=!1,this.show=!0,this.criteriaSearchList=[],this.nbQueryCriteria=0,this.additionalSearchCriteriaCategoryIndex=0,this.included=!1,this.showCriteriaPanel=!0,this.showSearchCriteriaPanel=!1,this.listOfUAIdToInclude=[],this.listOfUAIdToExclude=[],this.listOfUACriteriaSearch=[],this.nodeArray=[],this.pending=!1,this.submited=!1,this.currentPage=0,this.itemSelected=0,this.itemNotSelected=0,this.waitingToGetFixedCount=!1,this.totalResults=0,this.orderBy="Title",this.direction=C.z.ASCENDANT,this.DEFAULT_RESULT_THRESHOLD=1e4,this.searchHasResults=!1,this.pageNumbers=0,this.canLoadMore=!1,this.pendingGetFixedCount=!1,this.pendingComputeFacets=!1,this.archiveSearchResultFacets=new C.i,this.rulesFacetsComputed=!1,this.showingFacets=!1,this.defaultFacetTabIndex=1,this.submitedGetFixedCount=!1,this.rulesFacetsCanBeComputed=!1,this.filterChange=new p.a,this.orderChange=new p.a,this.isNotOpen$=new v.a(!0),this.isNotReady$=new v.a(!0),this.ofStaticAttachementUnit=e=>"STATIC_ATTACHEMENT"===e.Title,this.ofDynamicAttachementUnit=e=>e.Title.startsWith("DYNAMIC_ATTACHEMENT_"),this.subscriptionSimpleSearchCriteriaAdd=this.archiveExchangeDataService.receiveSimpleSearchCriteriaSubject().subscribe(e=>{e&&this.archiveHelperService.addCriteria(this.searchCriterias,this.searchCriteriaKeys,this.nbQueryCriteria,e.keyElt,e.valueElt,e.labelElt,e.keyTranslated,e.operator,e.category,e.valueTranslated,e.dataType,!1)}),this.subscriptions.add(this.archiveExchangeDataService.getNodes().subscribe(e=>{if(!e.checked)return e.count=null,void this.removeCriteria(e.id===C.Q?C.Q:"NODE",{id:e.id,value:e.id},!1);e.id===C.Q?this.archiveHelperService.addCriteria(this.searchCriterias,this.searchCriteriaKeys,this.nbQueryCriteria,C.Q,{id:C.Q,value:C.Q},e.title,!0,C.v.MISSING,C.Z.FIELDS,!1,C.u.STRING,!1):this.archiveHelperService.addCriteria(this.searchCriterias,this.searchCriteriaKeys,this.nbQueryCriteria,"NODE",{id:e.id,value:e.id},e.title,!0,C.v.EQ,C.Z.NODES,!1,C.u.STRING,!1)})),this.archiveExchangeDataService.receiveRemoveFromChildSearchCriteriaSubject().subscribe(e=>{e&&(e.valueElt?this.removeCriteria(e.keyElt,e.valueElt,!1):this.removeCriteriaAllValues(e.keyElt,!1))})}ngOnDestroy(){var e,t,i,c,a,r,n,s,l,o;null===(e=this.accessContractSub)||void 0===e||e.unsubscribe(),null===(t=this.accessContractSubscription)||void 0===t||t.unsubscribe(),null===(i=this.subscriptionSimpleSearchCriteriaAdd)||void 0===i||i.unsubscribe(),null===(c=this.subscriptionFilingHoldingSchemeNodes)||void 0===c||c.unsubscribe(),null===(a=this.subscriptionNodes)||void 0===a||a.unsubscribe(),null===(r=this.errorMessageSub)||void 0===r||r.unsubscribe(),null===(n=this.searchCriteriaChangeSubscription)||void 0===n||n.unsubscribe(),null===(s=this.subscriptions)||void 0===s||s.unsubscribe(),null===(l=this.transactionSubscription)||void 0===l||l.unsubscribe(),null===(o=this.uaMetadataUpdateDialogSub)||void 0===o||o.unsubscribe()}ngOnInit(){this.additionalSearchCriteriaCategoryIndex=0,this.additionalSearchCriteriaCategories=[],this.searchCriteriaKeys=[],this.searchCriterias=new Map,this.initializeSelectionParams(),this.addInitialCriteriaValues(),this.transactionSubscription=this.route.params.pipe(Object(T.a)(e=>{this.projectId=e.projectId,this.tenantIdentifier=e.tenantIdentifier}),Object(g.a)(e=>{const{projectId:t,transactionId:i}=e;return i?this.archiveUnitCollectService.getTransactionById(i):this.archiveUnitCollectService.getLastTransactionByProjectId(t)}),Object(T.a)(e=>{this.transaction=e})).subscribe(e=>{this.fetchUserAccessContractFromExternalParameters(),e?(this.isNotOpen$.next(e.status!==C.ib.OPEN),this.isNotReady$.next(e.status!==C.ib.READY)):(this.isNotOpen$.next(!0),this.isNotReady$.next(!0)),this.submit()}),this.projectName=this.route.snapshot.queryParamMap.get("projectName"),this.subscriptions.add(Object(I.a)(this.orderChange,this.filterChange).pipe(Object(L.a)(400)).subscribe(()=>{this.submit()})),this.subscriptions.add(this.archiveExchangeDataService.getToggle().subscribe(e=>{this.show=e})),this.hasUpdateUnitDescriptiveMetadataPermission()}hasUpdateUnitDescriptiveMetadataPermission(){this.archiveUnitCollectService.hasCollectRole("ROLE_UPDATE_UNIT_DESC_METADATA",Number(this.tenantIdentifier)).subscribe(e=>{this.hasUpdateDescriptiveUnitMetadataRole=e})}addInitialCriteriaValues(){this.archiveHelperService.addCriteria(this.searchCriterias,this.searchCriteriaKeys,this.nbQueryCriteria,"ALL_ARCHIVE_UNIT_TYPES",{value:"ARCHIVE_UNIT_WITH_OBJECTS",id:"ARCHIVE_UNIT_WITH_OBJECTS"},this.translateService.instant("COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.UNIT_TYPE.ARCHIVE_UNIT_WITH_OBJECTS"),!0,C.v.EQ,C.Z.FIELDS,!1,C.u.STRING,!1),this.archiveHelperService.addCriteria(this.searchCriterias,this.searchCriteriaKeys,this.nbQueryCriteria,"ALL_ARCHIVE_UNIT_TYPES",{value:"ARCHIVE_UNIT_WITHOUT_OBJECTS",id:"ARCHIVE_UNIT_WITHOUT_OBJECTS"},this.translateService.instant("COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.UNIT_TYPE.ARCHIVE_UNIT_WITHOUT_OBJECTS"),!0,C.v.EQ,C.Z.FIELDS,!1,C.u.STRING,!1)}initializeSelectionParams(){this.pending=!0,this.showCriteriaPanel=!1,this.showSearchCriteriaPanel=!1,this.currentPage=0,this.archiveUnits=[],this.criteriaSearchList=[],this.itemSelected=0,this.isIndeterminate=!1,this.itemNotSelected=0,this.isAllChecked=!1}fetchUserAccessContractFromExternalParameters(){this.accessContractSub=this.externalParameterService.getUserExternalParameters().subscribe(e=>{const t=e.get(C.E.PARAM_ACCESS_CONTRACT);t&&t.length>0?(this.accessContract=t,this.foundAccessContract=!0,this.fetchVitamAccessContract(),0===this.archiveUnits.length&&this.searchArchiveUnits(!0)):this.errorMessageSub=this.translateService.get("COLLECT.ACCESS_CONTRACT_NOT_FOUND").pipe(Object(b.a)(e=>{this.snackBar.open(e,null,{panelClass:"vitamui-snack-bar",duration:1e4})})).subscribe()})}fetchVitamAccessContract(){this.accessContractSubscription=this.archiveUnitCollectService.getAccessContractById(this.accessContract).subscribe(e=>{this.accessContractAllowUpdating=e.writingPermission,this.accessContractUpdatingRestrictedDesc=e.writingRestrictedDesc},e=>{this.logger.error("AccessContract not found :",e.message);const t=this.translateService.instant("COLLECT.ACCESS_CONTRACT_NOT_FOUND_IN_VITAM");this.snackBar.open(t+": "+this.accessContract,null,{panelClass:"vitamui-snack-bar",duration:1e4})})}submit(){var e;this.submited=!0,this.initializeSelectionParams(),this.archiveHelperService.buildNodesListForQUery(this.searchCriterias,this.criteriaSearchList),this.archiveHelperService.buildFieldsCriteriaListForQUery(this.searchCriterias,this.criteriaSearchList);for(const t in C.X)this.archiveHelperService.buildManagementRulesCriteriaListForQuery(t,this.searchCriterias,this.criteriaSearchList);this.criteriaSearchList&&this.criteriaSearchList.length>0&&(this.search$=this.archiveUnitCollectService.getTotalTrackHitsByCriteria(this.criteriaSearchList,(null===(e=this.transaction)||void 0===e?void 0:e.id)||null),this.rulesFacetsComputed=!1,this.rulesFacetsCanBeComputed=this.archiveHelperService.checkIfRulesFacetsCanBeComputed(this.searchCriterias),this.searchArchiveUnits(this.rulesFacetsCanBeComputed),this.showingFacets=this.rulesFacetsCanBeComputed)}searchArchiveUnits(e){var t;e&&(this.pendingComputeFacets=!0,this.showingFacets=!1),this.pending=!0;const i={criteriaList:this.criteriaSearchList,pageNumber:this.currentPage,size:10,sortingCriteria:{criteria:this.orderBy,sorting:this.direction},trackTotalHits:!1,computeFacets:e};this.archiveExchangeDataService.emitSearchCriterias(i),this.archiveUnitCollectService.searchArchiveUnitsByCriteria(i,(null===(t=this.transaction)||void 0===t?void 0:t.id)||null).subscribe(t=>{e&&(this.archiveSearchResultFacets=this.archiveFacetsService.extractRulesFacetsResults(t.facets),this.defaultFacetTabIndex=this.archiveHelperService.findDefaultFacetTabIndex(this.searchCriterias),this.pendingComputeFacets=!1,this.rulesFacetsComputed=!0),0===this.currentPage?(this.archiveUnits=t.results,this.searchHasResults=!Object(A.b)(t.results),this.archiveSearchResultFacets.nodesFacets=this.archiveFacetsService.extractNodesFacetsResults(t.facets),this.totalResults=t.totalResults,this.filterAttachementUnit(),this.archiveExchangeDataService.emitTotalResults(this.totalResults),this.archiveExchangeDataService.emitFacets(this.archiveSearchResultFacets.nodesFacets)):t.results&&t.results.forEach(e=>this.archiveUnits.push(e)),this.pageNumbers=t.pageNumbers,this.waitingToGetFixedCount=this.totalResults===this.DEFAULT_RESULT_THRESHOLD,this.isAllChecked&&(this.itemSelected=this.totalResults-this.itemNotSelected),this.canLoadMore=this.currentPage<this.pageNumbers-1,this.archiveHelperService.updateCriteriaStatus(this.searchCriterias,C.Y.IN_PROGRESS,C.Y.INCLUDED),this.pending=!1,this.included=!0},t=>{this.logger.error("Error message :",t.message),this.canLoadMore=!1,this.pending=!1,e&&(this.pendingComputeFacets=!1,this.archiveExchangeDataService.emitFacets([]))})}filterAttachementUnit(){let e=this.archiveUnits.findIndex(this.ofStaticAttachementUnit);e>-1&&(this.archiveUnits.splice(e,1),this.totalResults-=1),e=this.archiveUnits.findIndex(this.ofDynamicAttachementUnit),e>-1&&(this.archiveUnits.splice(e,1),this.totalResults-=1)}onArchiveUnitCountChange(e){this.totalResults=e,this.archiveExchangeDataService.emitTotalResults(e)}showExtendedLateralPanel(){this.isLPExtended=!0}backToNormalLateralPanel(){this.isLPExtended=!1}emitOrderChange(){this.orderChange.next()}showPreviewArchiveUnit(e){this.openPanel(e)}checkParentBoxChange(e){const{checked:t}=e.target;this.isAllChecked=t,this.itemSelected=t?this.totalResults:0,t||(this.isIndeterminate=!1),this.listOfUAIdToInclude=[],this.listOfUAIdToExclude=[],this.listOfUACriteriaSearch=[]}checkChildrenBoxChange(e,t){const i=t.target.checked;this.isAllChecked&&!i?(this.listOfUACriteriaSearch=[],this.isIndeterminate=!0,this.listOfUAIdToExclude.push({value:e,id:e}),this.listOfUAIdToInclude=[],this.itemSelected>0&&(this.itemSelected--,this.itemNotSelected++)):(this.itemNotSelected=0,i?(this.listOfUACriteriaSearch=[],this.itemSelected++,this.itemSelected===this.totalResults&&(this.isIndeterminate=!1),this.listOfUAIdToInclude.push({value:e,id:e}),this.listOfUAIdToExclude.splice(0,this.listOfUAIdToExclude.length)):(this.listOfUAIdToInclude=this.listOfUAIdToInclude.filter(t=>t.id!==e),this.itemSelected>0&&this.itemSelected--))}removeCriteriaEvent(e){e.valueElt?this.removeCriteria(e.keyElt,e.valueElt,!0):this.removeCriteriaAllValues(e.keyElt,!0)}removeCriteriaAllValues(e,t){this.searchCriterias&&this.searchCriterias.size>0&&this.searchCriterias.forEach((i,c)=>{c===e&&i.values.forEach(e=>{this.removeCriteria(c,e.value,t)})})}removeCriteria(e,t,i){this.archiveHelperService.removeCriteria(e,t,i,this.searchCriteriaKeys,this.searchCriterias,this.nbQueryCriteria),this.searchCriterias&&0===this.searchCriterias.size&&(this.submited=!1,this.showCriteriaPanel=!0,this.showSearchCriteriaPanel=!1,this.searchCriteriaKeys=[],this.searchCriterias=new Map,this.criteriaSearchList=[],this.searchArchiveUnits(!1),this.archiveExchangeDataService.emitNodeTarget(null))}clearCriterias(){Object.assign([],this.searchCriteriaKeys).forEach(e=>{this.searchCriterias.has(e)&&this.searchCriterias.get(e).values.forEach(t=>{this.removeCriteria(e,t.value,!0)})}),this.searchCriterias=new Map,this.searchCriteriaKeys=[],this.included=!1,this.nbQueryCriteria=0,this.pageNumbers=0,this.totalResults=0,this.itemSelected=0,this.isAllChecked=!1,this.isIndeterminate=!1,this.itemNotSelected=0,this.canLoadMore=!1}setFilingHoldingScheme(){this.subscriptionFilingHoldingSchemeNodes=this.archiveExchangeDataService.getFilingHoldingNodes().subscribe(e=>{this.nodeArray=e})}checkAllNodes(e){this.archiveHelperService.recursiveCheck(this.nodeArray,e)}selectedCategoryChange(e){this.additionalSearchCriteriaCategoryIndex=e}hiddenTreeBlock(e){this.show=!e}addCriteriaCategory(e){this.archiveExchangeDataService.emitRuleCategory(e),-1===this.additionalSearchCriteriaCategories.findIndex(t=>t.name===e)&&(this.additionalSearchCriteriaCategories.push({name:e,index:this.additionalSearchCriteriaCategories.length+1}),this.additionalSearchCriteriaCategories.forEach((e,t)=>{e.index=t+1}),this.additionalSearchCriteriaCategoryIndex=this.additionalSearchCriteriaCategories.length)}sendRuleCategorySelected(e){this.archiveExchangeDataService.emitRuleCategory(e)}isCategoryAdded(e){return-1!==this.additionalSearchCriteriaCategories.findIndex(t=>t.name===e)}removeCriteriaCategory(e){this.additionalSearchCriteriaCategories.forEach((t,i)=>{t.name===e&&(this.additionalSearchCriteriaCategories.splice(i,1),i===this.additionalSearchCriteriaCategoryIndex-1?this.additionalSearchCriteriaCategoryIndex=0:this.additionalSearchCriteriaCategoryIndex>0&&(this.additionalSearchCriteriaCategoryIndex=this.additionalSearchCriteriaCategoryIndex-1))}),this.additionalSearchCriteriaCategories.forEach((e,t)=>{e.index=t+1}),this.removeCriteriaByCategory(e)}removeCriteriaByCategory(e){this.searchCriterias&&this.searchCriterias.size>0&&(e===C.Z.APPRAISAL_RULE&&this.searchCriterias.forEach((e,t)=>{"ELIMINATION_TECHNICAL_ID"===t&&e.values.forEach(e=>{this.removeCriteria(t,e.value,!0)})}),this.searchCriterias.forEach((t,i)=>{C.Z[t.category]===e&&t.values.forEach(e=>{this.removeCriteria(i,e.value,!0)})}))}showHidePanel(e){this.showCriteriaPanel=e}containsWaitingToRecalculateInheritenceRuleCriteria(){return this.searchCriterias&&this.searchCriterias.has("WAITING_RECALCULATE")}mapSearchCriteriaHistory(){let e;const t=[];this.searchCriterias.forEach(e=>{const i=[];e.values.forEach(e=>{i.push(e.value)}),t.push({criteria:e.key,values:i,category:C.Z[e.category],operator:e.operator,keyTranslated:e.keyTranslated,valueTranslated:e.valueTranslated,dataType:e.dataType})}),e={id:null,name:"",savingDate:(new Date).toISOString(),searchCriteriaList:t},this.openCriteriaPopup(e)}openCriteriaPopup(e){const t=new n.e;t.panelClass="vitamui-modal",t.disableClose=!1,t.data={searchCriteriaHistory:e,originalSearchCriteria:this.searchCriterias,nbCriterias:this.archiveExchangeDataService.nbFilters(e)},this.dialog.open(_e,t).afterClosed().subscribe(e=>{})}launchComputingManagementRulesFacets(){this.pendingComputeFacets=!0;const e={criteriaList:this.criteriaSearchList,pageNumber:0,size:1,sortingCriteria:{criteria:this.orderBy,sorting:this.direction},trackTotalHits:!1,computeFacets:!0};this.loadExactCount(),this.archiveUnitCollectService.searchArchiveUnitsByCriteria(e,this.transaction?this.transaction.id:null).subscribe(e=>{this.archiveSearchResultFacets=this.archiveFacetsService.extractRulesFacetsResults(e.facets),this.pendingComputeFacets=!1,this.rulesFacetsComputed=!0,this.showingFacets=!0,this.defaultFacetTabIndex=this.archiveHelperService.findDefaultFacetTabIndex(this.searchCriterias)},e=>{this.pendingComputeFacets=!1,this.logger.error("Error message :",e.message)})}loadExactCount(){var e;this.criteriaSearchList&&this.criteriaSearchList.length>0&&(this.pendingGetFixedCount=!0,this.submitedGetFixedCount=!0,this.archiveUnitCollectService.getTotalTrackHitsByCriteria(this.criteriaSearchList,(null===(e=null==this?void 0:this.transaction)||void 0===e?void 0:e.id)||null).subscribe(e=>{-1!==e&&(this.totalResults=e,this.isAllChecked&&(this.itemSelected=this.totalResults-this.itemNotSelected),this.waitingToGetFixedCount=!1),this.pendingGetFixedCount=!1},e=>{this.pendingGetFixedCount=!1,this.logger.error("Error message :",e.message)}))}loadMore(){this.pending||(this.canLoadMore=this.currentPage<this.pageNumbers-1,this.canLoadMore&&(this.submited=!0,this.currentPage=this.currentPage+1,this.hasSearchCriterias()&&this.searchArchiveUnits(!1)))}hasSearchCriterias(){return this.criteriaSearchList&&this.criteriaSearchList.length>0||this.totalResults>=10}showHideFacets(e){!0===e?!0===this.rulesFacetsComputed?this.showingFacets=!0:this.launchFacetsComputing():this.showingFacets=!1}launchFacetsComputing(){!this.pendingComputeFacets&&this.criteriaSearchList&&this.criteriaSearchList.length>0&&this.launchComputingManagementRulesFacets()}showStoredSearchCriteria(e){this.searchCriterias.size>0&&(this.searchCriterias=new Map,this.searchCriteriaKeys=[],this.included=!1),this.reMapSearchCriteriaFromSearchCriteriaHistory(e)}reMapSearchCriteriaFromSearchCriteriaHistory(e){e.searchCriteriaList.forEach(e=>{this.fillTreeNodeAsSearchCriteriaHistory(e);const t=e.criteria;e.values.forEach(i=>{e.category===C.Z[C.Z.APPRAISAL_RULE]||e.category===C.Z[C.Z.NODES]||e.category===C.Z[C.Z.ACCESS_RULE]||e.category===C.Z[C.Z.STORAGE_RULE]||e.category===C.Z[C.Z.REUSE_RULE]||e.category===C.Z[C.Z.DISSEMINATION_RULE]?(this.addCriteriaCategory(e.category),this.archiveHelperService.addCriteria(this.searchCriterias,this.searchCriteriaKeys,this.nbQueryCriteria,t,i,i.value,e.keyTranslated,e.operator,e.category,e.valueTranslated,e.dataType,!0)):e.category===C.Z[C.Z.FIELDS]&&this.archiveHelperService.addCriteria(this.searchCriterias,this.searchCriteriaKeys,this.nbQueryCriteria,t,i,"ALL_ARCHIVE_UNIT_TYPES"===t?this.translateService.instant("COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.UNIT_TYPE."+i.id):i.value,e.keyTranslated,e.operator,C.Z.FIELDS,e.valueTranslated,e.dataType,!0)})})}fillTreeNodeAsSearchCriteriaHistory(e){e&&e.category===C.Z[C.Z.NODES]&&(e.values.forEach(e=>{this.archiveHelperService.fillNodeTitle(this.nodeArray,e.value,this.searchCriterias,this.searchCriteriaKeys,this.nbQueryCriteria)}),this.nodeArray=null,this.archiveExchangeDataService.emitToggle(!0))}exportArchiveUnitsToCsvFile(){this.criteriaSearchList&&this.criteriaSearchList.length>0&&(this.listOfUACriteriaSearch=this.prepareListOfUACriteriaSearch(),this.archiveUnitCollectService.exportCsvSearchArchiveUnitsByCriteria({criteriaList:this.listOfUACriteriaSearch,pageNumber:this.currentPage,size:10,sortingCriteria:{criteria:this.orderBy,sorting:this.direction},language:this.translateService.currentLang},this.transaction.id))}prepareListOfUACriteriaSearch(){return this.archiveHelperService.prepareUAIdList(this.criteriaSearchList,this.listOfUAIdToInclude,this.listOfUAIdToExclude,this.isAllChecked,this.isIndeterminate)}validateTransaction(){this.archiveUnitCollectService.validateTransaction(this.transaction.id).subscribe(()=>{this.isNotOpen$.next(!0),this.isNotReady$.next(!1);const e=this.translateService.instant("COLLECT.VALIDATE_TRANSACTION_VALIDATED");this.snackBar.open(e,null,{panelClass:"vitamui-snack-bar",duration:1e4})})}sendTransaction(){this.archiveUnitCollectService.sendTransaction(this.transaction.id).subscribe(()=>{this.isNotReady$.next(!0);const e=this.translateService.instant("COLLECT.INGEST_TRANSACTION_LAUNCHED");this.snackBar.open(e,null,{panelClass:"vitamui-snack-bar",duration:1e4})})}openUpdateUnitsForm(){const e=this.dialog.open(He,{panelClass:"vitamui-modal",disableClose:!0,data:{selectedTransaction:this.transaction,tenantIdentifier:this.tenantIdentifier}});this.uaMetadataUpdateDialogSub=e.afterClosed().subscribe(e=>{})}updateUnitsMetadataDisabled(){return!this.transaction||this.transaction.status!==C.ib.OPEN}isArchiveUnitsEmpty(){return 0===this.archiveUnits.length}getArchiveUnitType(e){if(e)return e["#unitType"]}trackBy(e,t){return t["#id"]}}return e.\u0275fac=function(t){return new(t||e)(_.Xb(E.a),_.Xb(C.J),_.Xb(C.F),_.Xb(O.e),_.Xb($),_.Xb(Oe),_.Xb(de),_.Xb(fe),_.Xb(f.b),_.Xb(n.b))},e.\u0275cmp=_.Rb({type:e,selectors:[["app-archive-search-collect"]],features:[_.Ib],decls:11,vars:11,consts:[[3,"autosize","hasBackdrop"],["mode","side","vitamuiCommonResizeSidebar","left",3,"fixedInViewport","opened",4,"ngIf"],["mode","side","position","end",3,"ngClass","fixedInViewport"],["panel",""],[3,"archiveUnit","accessContractAllowUpdating","hasUpdateDescriptiveUnitMetadataRole","transactionId","previewClose","showExtendedLateralPanel","backToNormalLateralPanel",4,"ngIf"],[1,"vitamui-heading"],["class","vitamui-content",4,"ngIf"],["mode","side","vitamuiCommonResizeSidebar","left",3,"fixedInViewport","opened"],[3,"transactionId","searchHasMatches","searchRequestTotalResults","showArchiveUnitDetails"],[3,"archiveUnit","accessContractAllowUpdating","hasUpdateDescriptiveUnitMetadataRole","transactionId","previewClose","showExtendedLateralPanel","backToNormalLateralPanel"],[1,"vitamui-content"],[1,"row","row","justify-content-around"],[1,"col-12"],["type","button","class","btn secondary right-arround left-not-arround","matTooltipClass","vitamui-tooltip",3,"matTooltip","matTooltipShowDelay","click",4,"ngIf"],[1,"row","justify-content-around"],[1,"col-6","form-control"],[1,"col-3","form-control","text-right"],["type","button",1,"btn","primary",3,"disabled","click"],[1,"col-1","form-control"],["matTooltipClass","vitamui-tooltip",3,"overlayPos","icon","matTooltip"],["mat-menu-item","",3,"disabled","click"],[1,"col-11"],[1,"area-criteria"],[4,"ngFor","ngForOf"],[1,"col-1"],[1,"d-flex","justify-content-end","button-space"],[1,"mat-boutton",3,"matMenuTriggerFor"],["type","button",1,"circle","editable-field-cancel","clickable"],[1,"material-icons","primary-save-icon"],[1,"my-menu"],["menu","matMenu"],["mat-menu-item","",1,"btn-new-save",3,"disabled","click"],[1,"material-icons","btn-add"],[3,"storedSearchCriteriaHistory"],["class","d-flex justify-content-end div-btn-delete",4,"ngIf"],["class","row",4,"ngIf"],["class","card-criteria",4,"ngIf"],[3,"hidden"],[3,"selectedIndex","selectedIndexChange"],[3,"label"],[1,"card-criteria"],["disabled",""],["mat-tab-label",""],["menuTabs","matMenu"],["class","row justify-content-end text-on-right-side",4,"ngIf"],["vitamuiCommonInfiniteScroll","",3,"vitamuiScroll"],[1,"vitamui-table"],[1,"vitamui-table-head"],[1,"col-8",3,"search","archiveUnitCount","selectedArchiveUnitCount","threshold","pending","allChecked","archiveUnitCountChange","selectedArchiveUnitCountChange","pendingChange"],[1,"col-3","area-download",3,"ngClass"],[1,"vitamui-icon","vitamui-icon-import-csv","vitamui-row-icon","clickable",3,"click"],[1,"col-1","d-flex","align-items-center"],["type","checkbox",1,"criteria-choice-input",3,"checked","indeterminate","change"],["orderByKey","DescriptionLevel",3,"orderBy","direction","orderByChange","directionChange","orderChange"],[1,"col-4","d-flex","align-items-center"],["orderByKey","Title",3,"orderBy","direction","orderByChange","directionChange","orderChange"],[1,"col-2","d-flex","align-items-center"],["orderByKey","StartDate",3,"orderBy","direction","orderByChange","directionChange","orderChange"],["orderByKey","EndDate",3,"orderBy","direction","orderByChange","directionChange","orderChange"],["orderByKey","#originating_agencies",3,"orderBy","direction","orderByChange","directionChange","orderChange"],[1,"vitamui-table-body"],["class","vitamui-table-rows",4,"ngFor","ngForOf","ngForTrackBy"],[1,"vitamui-table-footer"],["diameter","50","color","accent",4,"ngIf"],["class","btn",3,"click",4,"ngIf"],[4,"ngIf"],["type","button","matTooltipClass","vitamui-tooltip",1,"btn","secondary","right-arround","left-not-arround",3,"matTooltip","matTooltipShowDelay","click"],[1,"material-icons"],[3,"criteriaKey","criteriaVal","criteriaRemoveEvent"],[1,"d-flex","justify-content-end","div-btn-delete"],[1,"mat-boutton"],["type","button",1,"circle","editable-field-cancel","clickable",3,"click"],[1,"row"],["diameter","20","color","accent",1,"spinner-wrapper"],["id","show-hide-facet-button","class","vitamui-icon vitamui-icon-chevron-down vitamui-row-icon clickable",3,"ngClass","click",4,"ngIf"],[1,"facet-div",3,"exactCount","appraisalRuleFacets","accessRuleFacets","storageRuleFacets","reuseRuleFacets","disseminationRuleFacets","holdRuleFacets","classificationRuleFacets","tenantIdentifier","totalResults","defaultFacetTabIndex"],["id","show-hide-facet-button",1,"vitamui-icon","vitamui-icon-chevron-down","vitamui-row-icon","clickable",3,"ngClass","click"],["class","hide-ink",3,"click",4,"ngIf"],[1,"hide-ink",3,"click"],[3,"click"],[1,"mat-boutton","clickable",3,"click"],[1,"vitamui-icon","vitamui-icon-cross","vitamui-row-icon"],[1,"row","justify-content-end","text-on-right-side"],[3,"hasWaitingToRecalculateCriteria"],[1,"mat-boutton","clickable",3,"matMenuTriggerFor"],[1,"vitamui-icon","vitamui-icon-plus","vitamui-row-icon"],[1,"vitamui-table-rows"],[1,"vitamui-row","d-flex","align-items-center"],["type","checkbox",1,"criteria-choice-input",3,"checked","click"],[1,"col-1","d-flex","align-items-center","clickable",3,"click"],[1,"table-filter-icon",3,"ngSwitch"],[4,"ngSwitchCase"],[1,"col-4","d-flex","align-items-center","clickable",3,"click"],["matTooltipClass","vitamui-tooltip",3,"matTooltip","matTooltipShowDelay"],[1,"col-2","d-flex","align-items-center","clickable",3,"click"],[1,"table-filter-icon"],[1,"vitamui-icon","vitamui-icon-folder","vitamui-row-icon","status-badge"],[1,"vitamui-icon","vitamui-icon-file","vitamui-row-icon","status-badge"],[1,"vitamui-icon","vitamui-icon-ic24-arborescence","vitamui-row-icon","status-badge"],[1,"vitamui-icon","vitamui-icon-plan-classement","vitamui-row-icon","status-badge"],["diameter","50","color","accent"],[1,"btn",3,"click"]],template:function(e,t){1&e&&(_.dc(0,"mat-sidenav-container",0),_.Tc(1,ar,2,5,"mat-sidenav",1),_.dc(2,"mat-sidenav",2,3),_.Tc(4,rr,1,4,"app-archive-preview",4),_.cc(),_.dc(5,"mat-sidenav-content"),_.dc(6,"div",5),_.dc(7,"vitamui-common-title-breadcrumb"),_.Vc(8),_.qc(9,"translate"),_.cc(),_.cc(),_.Tc(10,Pr,124,113,"div",6),_.cc(),_.cc()),2&e&&(_.vc("autosize",!0)("hasBackdrop",!1),_.Lb(1),_.vc("ngIf",t.foundAccessContract),_.Lb(1),_.vc("ngClass",t.isLPExtended?"extended-lateral-panel":"normal-lateral-panel")("fixedInViewport",!0),_.Lb(2),_.vc("ngIf",t.openedItem),_.Lb(4),_.Yc(" ",_.rc(9,9,"COLLECT.TITLE_SEARCH_AREA")," : ",t.projectName," "),_.Lb(2),_.vc("ngIf",t.foundAccessContract))},directives:[d.b,c.p,d.a,c.n,d.c,C.Kb,C.Ob,Dt,Bi,Wi,C.Eb,he.a,Ce.a,c.o,Ce.c,Ce.d,$i,u.b,u.a,dc,u.c,C.K,C.Gb,C.S,qc,l.b,aa,va,fa,Ma,Xa,cr,c.r,c.s],pipes:[O.d,c.b,C.jb,C.Yb,C.Vb],styles:[".btn-validate[_ngcontent-%COMP%]{background-color:#155724}.text-title[_ngcontent-%COMP%]{font-family:Mulish;font-style:normal;font-weight:400;font-size:16px;line-height:24px;display:flex;align-items:center;color:#757575}.margin-btn[_ngcontent-%COMP%]{margin-right:140px}.facet-area[_ngcontent-%COMP%]{display:block;overflow:auto} .mat-menu-panel{max-width:-moz-fit-content!important;max-width:fit-content!important}.link-without-underline[_ngcontent-%COMP%]{cursor:pointer;color:#702382;font-weight:700;margin-top:10px;margin-bottom:10px}.mat-dialog-actions-right[_ngcontent-%COMP%]{justify-content:flex-end}.red-text[_ngcontent-%COMP%]{color:red;font-size:x-large;font-weight:700}.icon-style[_ngcontent-%COMP%]{font-size:50px;line-height:5px}.vertical-line[_ngcontent-%COMP%]{border-left:2px solid red;display:block;height:100%;margin:0 22px}.disabled-div[_ngcontent-%COMP%]{pointer-events:none}.enabled-div[_ngcontent-%COMP%]{pointer-events:painted}.facet-div[_ngcontent-%COMP%]{width:100%;padding:10px}#show-hide-facet-button[_ngcontent-%COMP%]{position:relative;float:right;cursor:pointer;width:40px;border:1px solid #bdbdbd;box-sizing:border-box;border-radius:20px;padding:10px;font-size:large;font-weight:700}"]}),e})();const kr=[{path:"",component:xr},{path:"/{transactionId}",component:xr}];let Mr=(()=>{class e{}return e.\u0275mod=_.Vb({type:e}),e.\u0275inj=_.Ub({factory:function(t){return new(t||e)},imports:[[c.c,E.g.forChild(kr)],E.g]}),e})(),Vr=(()=>{class e{}return e.\u0275mod=_.Vb({type:e}),e.\u0275inj=_.Ub({factory:function(t){return new(t||e)},imports:[[c.c,n.g,C.s,O.c,C.lb]]}),e})(),wr=(()=>{class e{}return e.\u0275mod=_.Vb({type:e}),e.\u0275inj=_.Ub({factory:function(t){return new(t||e)},imports:[[c.c,Mr,d.d,C.lb,l.a,s.d,o.b,a.u,u.d,r.c,n.g,Vr,h.c]]}),e})()},etrl:function(e,t,i){var c,a;void 0===(a="function"==typeof(c=function(){"use strict";function t(e,t,i){var c=new XMLHttpRequest;c.open("GET",e),c.responseType="blob",c.onload=function(){n(c.response,t,i)},c.onerror=function(){console.error("could not download file")},c.send()}function i(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function c(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(t){var i=document.createEvent("MouseEvents");i.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(i)}}var a="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,r=a.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),n=a.saveAs||("object"!=typeof window||window!==a?function(){}:"download"in HTMLAnchorElement.prototype&&!r?function(e,r,n){var s=a.URL||a.webkitURL,l=document.createElement("a");l.download=r=r||e.name||"download",l.rel="noopener","string"==typeof e?(l.href=e,l.origin===location.origin?c(l):i(l.href)?t(e,r,n):c(l,l.target="_blank")):(l.href=s.createObjectURL(e),setTimeout((function(){s.revokeObjectURL(l.href)}),4e4),setTimeout((function(){c(l)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,a,r){if(a=a||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(function(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}(e,r),a);else if(i(e))t(e,a,r);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout((function(){c(n)}))}}:function(e,i,c,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),"string"==typeof e)return t(e,i,c);var s="application/octet-stream"===e.type,l=/constructor/i.test(a.HTMLElement)||a.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||s&&l||r)&&"undefined"!=typeof FileReader){var d=new FileReader;d.onloadend=function(){var e=d.result;e=o?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=e:location=e,n=null},d.readAsDataURL(e)}else{var u=a.URL||a.webkitURL,h=u.createObjectURL(e);n?n.location=h:location.href=h,n=null,setTimeout((function(){u.revokeObjectURL(h)}),4e4)}});a.saveAs=n.saveAs=n,e.exports=n})?c.apply(t,[]):c)||(e.exports=a)}}]);