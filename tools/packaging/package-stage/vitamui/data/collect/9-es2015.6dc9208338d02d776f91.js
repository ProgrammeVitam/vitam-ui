(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{UX3d:function(t,c,n){"use strict";n.r(c),n.d(c,"TransactionModule",(function(){return _}));var e=n("AadN"),i=n("2kYt"),r=n("Jb3d"),a=n("csyo"),s=n("lQ7A"),o=n("OWX3"),d=n("HM3f"),u=n("YtkY"),l=n("NEmo"),b=n("C05f"),v=n("ublV"),T=n("cX0B"),p=n("EM62");let h=(()=>{class t extends o.ab{constructor(t,c){super(t,"ALL"),this.transactionApiService=t,this.projectApiService=c,this.transactions$=new b.a([]),this.project$=new b.a(null)}getTransactionsByProjectId(t,c=new o.T(0,o.w,"id",o.z.ASCENDANT)){return this.pageRequest=c,this.projectApiService.getTransactionsByProjectId(this.pageRequest,t)}getProject$(){return this.project$}search(t=null){return this.transactions$}getTransactionById(t){return this.transactionApiService.getTransactionById(t)}validateTransaction(t){return this.transactionApiService.validateTransaction(t)}sendTransaction(t){return this.transactionApiService.sendTransaction(t)}editTransaction(t){return this.transactionApiService.editTransaction(t)}abortTransaction(t){return this.transactionApiService.abortTransaction(t)}loadDataForTransactions(t,c){this.transactions$.next(t),this.project$.next(c)}}return t.\u0275fac=function(c){return new(c||t)(p.ic(T.a),p.ic(v.a))},t.\u0275prov=p.Tb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),m=(()=>{class t{constructor(t,c){this.transactionsService=t,this.projectService=c}resolve(t){const c=t.paramMap.get("projectId");return Object(d.a)([this.transactionsService.getTransactionsByProjectId(c),this.projectService.getProjectById(c)]).pipe(Object(u.a)(([t,c])=>(this.transactionsService.loadDataForTransactions(t.values,c),!0)))}}return t.\u0275fac=function(c){return new(c||t)(p.ic(h),p.ic(l.a))},t.\u0275prov=p.Tb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var C=n("sEIs"),L=n("W1gw"),I=n("s2Ay");const O=function(t){return{nb:t}};function S(t,c){if(1&t&&(p.bc(0),p.Vc(1),p.qc(2,"translate"),p.ac()),2&t){const t=p.pc();p.Lb(1),p.Xc(" ",p.sc(2,1,"COLLECT.SINGLE_TRANSACTION",p.Ac(4,O,null==t.dataSource?null:t.dataSource.length))," ")}}function f(t,c){if(1&t&&(p.bc(0),p.Vc(1),p.qc(2,"translate"),p.ac()),2&t){const t=p.pc();p.Lb(1),p.Xc(" ",p.sc(2,1,"COLLECT.NB_ENTRIES_TRANSACTIONS",p.Ac(4,O,null==t.dataSource?null:t.dataSource.length))," ")}}function E(t,c){if(1&t){const t=p.ec();p.dc(0,"div",20),p.dc(1,"div",21),p.dc(2,"div",9),p.dc(3,"i",22),p.Yb(4,"span",23),p.Yb(5,"span",24),p.Yb(6,"span",25),p.Yb(7,"span",26),p.cc(),p.cc(),p.dc(8,"div",10),p.Vc(9),p.cc(),p.dc(10,"div",10),p.Vc(11),p.cc(),p.dc(12,"div",13),p.Vc(13),p.qc(14,"translate"),p.cc(),p.dc(15,"div",9),p.dc(16,"vitamui-common-menu-button",27),p.dc(17,"button",28),p.lc("click",(function(){p.Kc(t);const n=c.$implicit;return p.pc().searchArchiveUnitsByTransaction(n)})),p.Vc(18),p.qc(19,"translate"),p.cc(),p.dc(20,"button",29),p.lc("click",(function(){p.Kc(t);const n=c.$implicit;return p.pc().validateTransaction(n)})),p.Vc(21),p.qc(22,"translate"),p.cc(),p.dc(23,"button",29),p.lc("click",(function(){p.Kc(t);const n=c.$implicit;return p.pc().sendTransaction(n)})),p.Vc(24),p.qc(25,"translate"),p.cc(),p.dc(26,"button",29),p.lc("click",(function(){p.Kc(t);const n=c.$implicit;return p.pc().editTransaction(n)})),p.Vc(27),p.qc(28,"translate"),p.cc(),p.dc(29,"button",29),p.lc("click",(function(){p.Kc(t);const n=c.$implicit;return p.pc().abortTransaction(n)})),p.Vc(30),p.qc(31,"translate"),p.cc(),p.cc(),p.cc(),p.cc(),p.cc()}if(2&t){const t=c.$implicit,n=p.pc();p.Lb(9),p.Wc(t.messageIdentifier),p.Lb(2),p.Wc(t.id),p.Lb(2),p.Wc(p.rc(14,14,"COLLECT.PROJECT_TRANSACTION_PREVIEW.STATUS."+t.status)),p.Lb(3),p.vc("icon","vitamui-icon-more-horiz")("overlayPos","end"),p.Lb(2),p.Xc(" ",p.rc(19,16,"COLLECT.PROJECT_UNIT_PREVIEW.ACTIONS.SHOW_PROJECT_ARCHIVE_UNITS")," "),p.Lb(2),p.vc("disabled",!n.transactionIsOpen(t)),p.Lb(1),p.Xc(" ",p.rc(22,18,"COLLECT.VALIDATE_ACTION")," "),p.Lb(2),p.vc("disabled",!n.transactionIsReady(t)),p.Lb(1),p.Xc(" ",p.rc(25,20,"COLLECT.INGEST_ACTION")," "),p.Lb(2),p.vc("disabled",!n.transactionIsEditable(t)),p.Lb(1),p.Xc(" ",p.rc(28,22,"COLLECT.EDIT_ACTION")," "),p.Lb(2),p.vc("disabled",!n.transactionIsAbortable(t)),p.Lb(1),p.Xc(" ",p.rc(31,24,"COLLECT.ABORT_ACTION")," ")}}function A(t,c){1&t&&(p.dc(0,"div",30),p.Vc(1),p.qc(2,"translate"),p.cc()),2&t&&(p.Lb(1),p.Wc(p.rc(2,1,"COLLECT.NO_RESULT")))}function g(t,c){if(1&t){const t=p.ec();p.dc(0,"div",31),p.lc("click",(function(){return p.Kc(t),p.pc().transactionService.loadMore()})),p.dc(1,"span",32),p.Vc(2),p.qc(3,"translate"),p.cc(),p.cc()}2&t&&(p.Lb(2),p.Wc(p.rc(3,1,"COLLECT.LOAD_MORE_RESULTS")))}function y(t,c){1&t&&(p.dc(0,"div",33),p.Yb(1,"mat-spinner",34),p.cc())}let N=(()=>{class t extends o.L{constructor(t,c,n,e,i){super(c),this.snackBar=t,this.transactionService=c,this.translateService=n,this.router=e,this.startupService=i,this.direction=o.z.DESCENDANT,this.orderBy="archivalAgreement",this.orderChange=new b.a(this.orderBy)}ngOnInit(){this.tenantIdentifier=this.startupService.getTenantIdentifier(),super.search(null)}onScroll(){this.loadMore()}emitOrderChange(t){this.orderChange.next(t)}searchArchiveUnitsByTransaction(t){this.router.navigate(["collect/tenant/"+this.tenantIdentifier+"/units",t.projectId,t.id],{queryParams:{projectName:t.messageIdentifier}})}sendTransaction(t){this.transactionService.sendTransaction(t.id).subscribe(()=>{const c=this.translateService.instant("COLLECT.INGEST_TRANSACTION_LAUNCHED");t.status=o.ib.SENDING,this.snackBar.open(c,null,{panelClass:"vitamui-snack-bar",duration:1e4})},()=>{t.status=o.ib.KO})}validateTransaction(t){this.transactionService.validateTransaction(t.id).subscribe(()=>{const c=this.translateService.instant("COLLECT.VALIDATE_TRANSACTION_VALIDATED");t.status=o.ib.READY,this.snackBar.open(c,null,{panelClass:"vitamui-snack-bar",duration:1e4})},()=>{t.status=o.ib.KO})}abortTransaction(t){this.transactionService.abortTransaction(t.id).subscribe(()=>{t.status=o.ib.ABORTED;const c=this.translateService.instant("COLLECT.TRANSACTION_ABORTED");this.snackBar.open(c,null,{panelClass:"vitamui-snack-bar",duration:1e4})},()=>{t.status=o.ib.KO})}editTransaction(t){this.transactionService.editTransaction(t.id).subscribe(()=>{t.status=o.ib.OPEN;const c=this.translateService.instant("COLLECT.TRANSACTION_REOPENED");this.snackBar.open(c,null,{panelClass:"vitamui-snack-bar",duration:1e4})},()=>{t.status=o.ib.KO})}transactionIsOpen(t){return o.ib.OPEN===t.status}transactionIsReady(t){return o.ib.READY===t.status}transactionIsEditable(t){return-1!==[o.ib.READY,o.ib.ACK_KO,o.ib.KO].indexOf(t.status)}transactionIsAbortable(t){return-1!==[o.ib.OPEN,o.ib.READY,o.ib.ACK_KO,o.ib.KO].indexOf(t.status)}}return t.\u0275fac=function(c){return new(c||t)(p.Xb(L.b),p.Xb(h),p.Xb(I.e),p.Xb(C.d),p.Xb(o.db))},t.\u0275cmp=p.Rb({type:t,selectors:[["app-transaction-list"]],features:[p.Ib],decls:39,vars:21,consts:[[1,"row"],[1,"col","mb-2"],[1,"col"],["vitamuiCommonInfiniteScroll",""],[1,"vitamui-table"],[1,"vitamui-table-head","title-text","result-layout"],[1,"col-13"],[4,"ngIf"],[1,"vitamui-table-head"],[1,"col-1"],[1,"col-3"],["orderByKey","messageIdentifier",3,"direction","orderBy","orderChange","directionChange","orderByChange"],["orderByKey","id",3,"direction","orderBy","orderChange","directionChange","orderByChange"],[1,"col-4"],["orderByKey","submissionAgencyIdentifier",3,"direction","orderBy","orderChange","directionChange","orderByChange"],[1,"vitamui-table-body"],["class","vitamui-table-rows",4,"ngFor","ngForOf"],["noResults",""],["loadMore",""],["loadingSpinner",""],[1,"vitamui-table-rows"],[1,"vitamui-row","d-flex","align-items-center"],[1,"vitamui-icon","vitamui-icon-flux-manuel-refus"],[1,"path1"],[1,"path2"],[1,"path3"],[1,"path4"],["menuButtonSize","medium",3,"icon","overlayPos"],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"disabled","click"],[1,"vitamui-min-content","vitamui-table-message"],[1,"vitamui-min-content","vitamui-table-message",3,"click"],[1,"clickable"],[1,"vitamui-min-content"],[1,"vitamui-spinner","medium"]],template:function(t,c){1&t&&(p.dc(0,"div",0),p.dc(1,"div",1),p.dc(2,"h5"),p.Vc(3),p.qc(4,"translate"),p.cc(),p.cc(),p.cc(),p.dc(5,"div",0),p.dc(6,"div",2),p.dc(7,"div",3),p.dc(8,"div",4),p.dc(9,"div",5),p.dc(10,"div",6),p.Tc(11,S,3,6,"ng-container",7),p.Tc(12,f,3,6,"ng-container",7),p.cc(),p.cc(),p.dc(13,"div",8),p.Yb(14,"div",9),p.dc(15,"div",10),p.dc(16,"span"),p.Vc(17),p.qc(18,"translate"),p.cc(),p.dc(19,"vitamui-common-order-by-button",11),p.lc("orderChange",(function(t){return c.emitOrderChange(t)}))("directionChange",(function(t){return c.direction=t}))("orderByChange",(function(t){return c.orderBy=t})),p.cc(),p.cc(),p.dc(20,"div",10),p.dc(21,"span"),p.Vc(22),p.qc(23,"translate"),p.cc(),p.dc(24,"vitamui-common-order-by-button",12),p.lc("orderChange",(function(t){return c.emitOrderChange(t)}))("directionChange",(function(t){return c.direction=t}))("orderByChange",(function(t){return c.orderBy=t})),p.cc(),p.cc(),p.dc(25,"div",13),p.dc(26,"span"),p.Vc(27),p.qc(28,"translate"),p.cc(),p.dc(29,"vitamui-common-order-by-button",14),p.lc("orderChange",(function(t){return c.emitOrderChange(t)}))("directionChange",(function(t){return c.direction=t}))("orderByChange",(function(t){return c.orderBy=t})),p.cc(),p.cc(),p.Yb(30,"div",9),p.cc(),p.dc(31,"div",15),p.Tc(32,E,32,26,"div",16),p.cc(),p.cc(),p.cc(),p.Tc(33,A,3,3,"ng-template",null,17,p.Uc),p.Tc(35,g,4,3,"ng-template",null,18,p.Uc),p.Tc(37,y,2,0,"ng-template",null,19,p.Uc),p.cc(),p.cc()),2&t&&(p.Lb(3),p.Wc(p.rc(4,13,"COLLECT.INGEST_LIST_TITLE")),p.Lb(8),p.vc("ngIf",(null==c.dataSource?null:c.dataSource.length)<=1),p.Lb(1),p.vc("ngIf",(null==c.dataSource?null:c.dataSource.length)>1),p.Lb(5),p.Wc(p.rc(18,15,"COLLECT.FIELD_MESSAGE_IDENTIFIER")),p.Lb(2),p.vc("direction",c.direction)("orderBy",c.orderBy),p.Lb(3),p.Wc(p.rc(23,17,"COLLECT.FIELD_OPERATION_ID")),p.Lb(2),p.vc("direction",c.direction)("orderBy",c.orderBy),p.Lb(3),p.Wc(p.rc(28,19,"COLLECT.FIELD_STATUS_TRANSACTION")),p.Lb(2),p.vc("direction",c.direction)("orderBy",c.orderBy),p.Lb(3),p.vc("ngForOf",c.dataSource))},directives:[o.K,i.p,o.S,i.o,o.Eb,r.a,a.b],pipes:[I.d],styles:[""]}),t})();const B=[{path:"",component:(()=>{class t extends o.cb{constructor(t,c,n){super(t,c),this.transactionsService=n}ngOnInit(){this.projectName$=this.transactionsService.getProject$().pipe(Object(u.a)(t=>t.messageIdentifier)),this.dataBreadcrumb=[{identifier:o.h.PORTAL_APP},{identifier:o.h.COLLECT_APP},{identifier:"TRANSACTIONS_MONITORING"}],this.transactions$=this.transactionsService.search()}}return t.\u0275fac=function(c){return new(c||t)(p.Xb(C.a),p.Xb(o.J),p.Xb(h))},t.\u0275cmp=p.Rb({type:t,selectors:[["app-projects"]],features:[p.Ib],decls:14,vars:9,consts:[[3,"autosize","hasBackdrop"],[1,"vitamui-heading"],[3,"data"],[1,"vitamui-content"],[1,"mt-3"]],template:function(t,c){1&t&&(p.dc(0,"mat-sidenav-container",0),p.dc(1,"mat-sidenav-content"),p.dc(2,"div",1),p.dc(3,"vitamui-common-title-breadcrumb",2),p.Vc(4),p.qc(5,"translate"),p.qc(6,"async"),p.cc(),p.cc(),p.dc(7,"div",3),p.Yb(8,"div"),p.dc(9,"div",4),p.dc(10,"div",3),p.Yb(11,"div"),p.dc(12,"div",4),p.Yb(13,"app-transaction-list"),p.cc(),p.cc(),p.cc(),p.cc(),p.cc(),p.cc()),2&t&&(p.vc("autosize",!0)("hasBackdrop",!1),p.Lb(3),p.vc("data",c.dataBreadcrumb),p.Lb(1),p.Yc(" ",p.rc(5,5,"COLLECT.TITLE_TRANSACTIONS_MONITORING")," ",p.rc(6,7,c.projectName$),": "))},directives:[s.b,s.c,o.Kb,N],pipes:[I.d,i.b],styles:[""]}),t})(),resolve:{transaction:m}}];let R=(()=>{class t{}return t.\u0275mod=p.Vb({type:t}),t.\u0275inj=p.Ub({factory:function(c){return new(c||t)},imports:[[i.c,C.g.forChild(B)],C.g]}),t})(),_=(()=>{class t{}return t.\u0275mod=p.Vb({type:t}),t.\u0275inj=p.Ub({factory:function(c){return new(c||t)},providers:[m,{provide:e.a,useValue:{useUtc:!0}}],imports:[[i.c,R,r.b,s.d,o.lb,a.a]]}),t})()}}]);