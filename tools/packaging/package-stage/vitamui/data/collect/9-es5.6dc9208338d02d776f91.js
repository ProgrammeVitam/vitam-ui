!function(){function t(){return(t="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,c){var r=n(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:c):i.value}}).apply(this,arguments)}function n(t,n){for(;!Object.prototype.hasOwnProperty.call(t,n)&&null!==(t=s(t)););return t}function e(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var c,r,i,a,o=[],u=!0,s=!1;try{if(i=(e=e.call(t)).next,0===n){if(Object(e)!==e)return;u=!1}else for(;!(u=(c=i.call(e)).done)&&(o.push(c.value),o.length!==n);u=!0);}catch(t){s=!0,r=t}finally{try{if(!u&&null!=e.return&&(a=e.return(),Object(a)!==a))return}finally{if(s)throw r}}return o}}(t,n)||function(t,n){if(!t)return;if("string"==typeof t)return c(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return c(t,n)}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,c=new Array(n);e<n;e++)c[e]=t[e];return c}function r(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function i(t,n){for(var e=0;e<n.length;e++){var c=n[e];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(t,o(c.key),c)}}function a(t,n,e){return n&&i(t.prototype,n),e&&i(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function o(t){var n=function(t,n){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var c=e.call(t,n||"default");if("object"!=typeof c)return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==typeof n?n:String(n)}function u(t,n,e){return n=s(n),function(t,n){if(n&&("object"==typeof n||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(n,e||[],s(t).constructor):n.apply(t,e))}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function d(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&l(t,n)}function l(t,n){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t})(t,n)}(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{UX3d:function(n,c,i){"use strict";i.r(c),i.d(c,"TransactionModule",(function(){return W}));var o,l,v=i("AadN"),f=i("2kYt"),b=i("Jb3d"),p=i("csyo"),y=i("lQ7A"),T=i("OWX3"),h=i("HM3f"),m=i("YtkY"),O=i("NEmo"),C=i("C05f"),g=i("ublV"),L=i("cX0B"),S=i("EM62"),I=((l=function(t){function n(t,e){var c;return r(this,n),(c=u(this,n,[t,"ALL"])).transactionApiService=t,c.projectApiService=e,c.transactions$=new C.a([]),c.project$=new C.a(null),c}return d(n,t),a(n,[{key:"getTransactionsByProjectId",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new T.T(0,T.w,"id",T.z.ASCENDANT);return this.pageRequest=n,this.projectApiService.getTransactionsByProjectId(this.pageRequest,t)}},{key:"getProject$",value:function(){return this.project$}},{key:"search",value:function(){return this.transactions$}},{key:"getTransactionById",value:function(t){return this.transactionApiService.getTransactionById(t)}},{key:"validateTransaction",value:function(t){return this.transactionApiService.validateTransaction(t)}},{key:"sendTransaction",value:function(t){return this.transactionApiService.sendTransaction(t)}},{key:"editTransaction",value:function(t){return this.transactionApiService.editTransaction(t)}},{key:"abortTransaction",value:function(t){return this.transactionApiService.abortTransaction(t)}},{key:"loadDataForTransactions",value:function(t,n){this.transactions$.next(t),this.project$.next(n)}}]),n}(T.ab)).\u0275fac=function(t){return new(t||l)(S.ic(L.a),S.ic(g.a))},l.\u0275prov=S.Tb({token:l,factory:l.\u0275fac,providedIn:"root"}),l),E=((o=function(){function t(n,e){r(this,t),this.transactionsService=n,this.projectService=e}return a(t,[{key:"resolve",value:function(t){var n=this,c=t.paramMap.get("projectId");return Object(h.a)([this.transactionsService.getTransactionsByProjectId(c),this.projectService.getProjectById(c)]).pipe(Object(m.a)((function(t){var c=e(t,2),r=c[0],i=c[1];return n.transactionsService.loadDataForTransactions(r.values,i),!0})))}}]),t}()).\u0275fac=function(t){return new(t||o)(S.ic(I),S.ic(O.a))},o.\u0275prov=S.Tb({token:o,factory:o.\u0275fac,providedIn:"root"}),o),A=i("sEIs"),N=i("W1gw"),k=i("s2Ay"),B=function(t){return{nb:t}};function R(t,n){if(1&t&&(S.bc(0),S.Vc(1),S.qc(2,"translate"),S.ac()),2&t){var e=S.pc();S.Lb(1),S.Xc(" ",S.sc(2,1,"COLLECT.SINGLE_TRANSACTION",S.Ac(4,B,null==e.dataSource?null:e.dataSource.length))," ")}}function _(t,n){if(1&t&&(S.bc(0),S.Vc(1),S.qc(2,"translate"),S.ac()),2&t){var e=S.pc();S.Lb(1),S.Xc(" ",S.sc(2,1,"COLLECT.NB_ENTRIES_TRANSACTIONS",S.Ac(4,B,null==e.dataSource?null:e.dataSource.length))," ")}}function j(t,n){if(1&t){var e=S.ec();S.dc(0,"div",20),S.dc(1,"div",21),S.dc(2,"div",9),S.dc(3,"i",22),S.Yb(4,"span",23),S.Yb(5,"span",24),S.Yb(6,"span",25),S.Yb(7,"span",26),S.cc(),S.cc(),S.dc(8,"div",10),S.Vc(9),S.cc(),S.dc(10,"div",10),S.Vc(11),S.cc(),S.dc(12,"div",13),S.Vc(13),S.qc(14,"translate"),S.cc(),S.dc(15,"div",9),S.dc(16,"vitamui-common-menu-button",27),S.dc(17,"button",28),S.lc("click",(function(){S.Kc(e);var t=n.$implicit;return S.pc().searchArchiveUnitsByTransaction(t)})),S.Vc(18),S.qc(19,"translate"),S.cc(),S.dc(20,"button",29),S.lc("click",(function(){S.Kc(e);var t=n.$implicit;return S.pc().validateTransaction(t)})),S.Vc(21),S.qc(22,"translate"),S.cc(),S.dc(23,"button",29),S.lc("click",(function(){S.Kc(e);var t=n.$implicit;return S.pc().sendTransaction(t)})),S.Vc(24),S.qc(25,"translate"),S.cc(),S.dc(26,"button",29),S.lc("click",(function(){S.Kc(e);var t=n.$implicit;return S.pc().editTransaction(t)})),S.Vc(27),S.qc(28,"translate"),S.cc(),S.dc(29,"button",29),S.lc("click",(function(){S.Kc(e);var t=n.$implicit;return S.pc().abortTransaction(t)})),S.Vc(30),S.qc(31,"translate"),S.cc(),S.cc(),S.cc(),S.cc(),S.cc()}if(2&t){var c=n.$implicit,r=S.pc();S.Lb(9),S.Wc(c.messageIdentifier),S.Lb(2),S.Wc(c.id),S.Lb(2),S.Wc(S.rc(14,14,"COLLECT.PROJECT_TRANSACTION_PREVIEW.STATUS."+c.status)),S.Lb(3),S.vc("icon","vitamui-icon-more-horiz")("overlayPos","end"),S.Lb(2),S.Xc(" ",S.rc(19,16,"COLLECT.PROJECT_UNIT_PREVIEW.ACTIONS.SHOW_PROJECT_ARCHIVE_UNITS")," "),S.Lb(2),S.vc("disabled",!r.transactionIsOpen(c)),S.Lb(1),S.Xc(" ",S.rc(22,18,"COLLECT.VALIDATE_ACTION")," "),S.Lb(2),S.vc("disabled",!r.transactionIsReady(c)),S.Lb(1),S.Xc(" ",S.rc(25,20,"COLLECT.INGEST_ACTION")," "),S.Lb(2),S.vc("disabled",!r.transactionIsEditable(c)),S.Lb(1),S.Xc(" ",S.rc(28,22,"COLLECT.EDIT_ACTION")," "),S.Lb(2),S.vc("disabled",!r.transactionIsAbortable(c)),S.Lb(1),S.Xc(" ",S.rc(31,24,"COLLECT.ABORT_ACTION")," ")}}function w(t,n){1&t&&(S.dc(0,"div",30),S.Vc(1),S.qc(2,"translate"),S.cc()),2&t&&(S.Lb(1),S.Wc(S.rc(2,1,"COLLECT.NO_RESULT")))}function P(t,n){if(1&t){var e=S.ec();S.dc(0,"div",31),S.lc("click",(function(){return S.Kc(e),S.pc().transactionService.loadMore()})),S.dc(1,"span",32),S.Vc(2),S.qc(3,"translate"),S.cc(),S.cc()}2&t&&(S.Lb(2),S.Wc(S.rc(3,1,"COLLECT.LOAD_MORE_RESULTS")))}function D(t,n){1&t&&(S.dc(0,"div",33),S.Yb(1,"mat-spinner",34),S.cc())}var V,K,q,X,Y=((V=function(n){function e(t,n,c,i,a){var o;return r(this,e),(o=u(this,e,[n])).snackBar=t,o.transactionService=n,o.translateService=c,o.router=i,o.startupService=a,o.direction=T.z.DESCENDANT,o.orderBy="archivalAgreement",o.orderChange=new C.a(o.orderBy),o}return d(e,n),a(e,[{key:"ngOnInit",value:function(){this.tenantIdentifier=this.startupService.getTenantIdentifier(),t(s(e.prototype),"search",this).call(this,null)}},{key:"onScroll",value:function(){this.loadMore()}},{key:"emitOrderChange",value:function(t){this.orderChange.next(t)}},{key:"searchArchiveUnitsByTransaction",value:function(t){this.router.navigate(["collect/tenant/"+this.tenantIdentifier+"/units",t.projectId,t.id],{queryParams:{projectName:t.messageIdentifier}})}},{key:"sendTransaction",value:function(t){var n=this;this.transactionService.sendTransaction(t.id).subscribe((function(){var e=n.translateService.instant("COLLECT.INGEST_TRANSACTION_LAUNCHED");t.status=T.ib.SENDING,n.snackBar.open(e,null,{panelClass:"vitamui-snack-bar",duration:1e4})}),(function(){t.status=T.ib.KO}))}},{key:"validateTransaction",value:function(t){var n=this;this.transactionService.validateTransaction(t.id).subscribe((function(){var e=n.translateService.instant("COLLECT.VALIDATE_TRANSACTION_VALIDATED");t.status=T.ib.READY,n.snackBar.open(e,null,{panelClass:"vitamui-snack-bar",duration:1e4})}),(function(){t.status=T.ib.KO}))}},{key:"abortTransaction",value:function(t){var n=this;this.transactionService.abortTransaction(t.id).subscribe((function(){t.status=T.ib.ABORTED;var e=n.translateService.instant("COLLECT.TRANSACTION_ABORTED");n.snackBar.open(e,null,{panelClass:"vitamui-snack-bar",duration:1e4})}),(function(){t.status=T.ib.KO}))}},{key:"editTransaction",value:function(t){var n=this;this.transactionService.editTransaction(t.id).subscribe((function(){t.status=T.ib.OPEN;var e=n.translateService.instant("COLLECT.TRANSACTION_REOPENED");n.snackBar.open(e,null,{panelClass:"vitamui-snack-bar",duration:1e4})}),(function(){t.status=T.ib.KO}))}},{key:"transactionIsOpen",value:function(t){return T.ib.OPEN===t.status}},{key:"transactionIsReady",value:function(t){return T.ib.READY===t.status}},{key:"transactionIsEditable",value:function(t){return-1!==[T.ib.READY,T.ib.ACK_KO,T.ib.KO].indexOf(t.status)}},{key:"transactionIsAbortable",value:function(t){return-1!==[T.ib.OPEN,T.ib.READY,T.ib.ACK_KO,T.ib.KO].indexOf(t.status)}}]),e}(T.L)).\u0275fac=function(t){return new(t||V)(S.Xb(N.b),S.Xb(I),S.Xb(k.e),S.Xb(A.d),S.Xb(T.db))},V.\u0275cmp=S.Rb({type:V,selectors:[["app-transaction-list"]],features:[S.Ib],decls:39,vars:21,consts:[[1,"row"],[1,"col","mb-2"],[1,"col"],["vitamuiCommonInfiniteScroll",""],[1,"vitamui-table"],[1,"vitamui-table-head","title-text","result-layout"],[1,"col-13"],[4,"ngIf"],[1,"vitamui-table-head"],[1,"col-1"],[1,"col-3"],["orderByKey","messageIdentifier",3,"direction","orderBy","orderChange","directionChange","orderByChange"],["orderByKey","id",3,"direction","orderBy","orderChange","directionChange","orderByChange"],[1,"col-4"],["orderByKey","submissionAgencyIdentifier",3,"direction","orderBy","orderChange","directionChange","orderByChange"],[1,"vitamui-table-body"],["class","vitamui-table-rows",4,"ngFor","ngForOf"],["noResults",""],["loadMore",""],["loadingSpinner",""],[1,"vitamui-table-rows"],[1,"vitamui-row","d-flex","align-items-center"],[1,"vitamui-icon","vitamui-icon-flux-manuel-refus"],[1,"path1"],[1,"path2"],[1,"path3"],[1,"path4"],["menuButtonSize","medium",3,"icon","overlayPos"],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"disabled","click"],[1,"vitamui-min-content","vitamui-table-message"],[1,"vitamui-min-content","vitamui-table-message",3,"click"],[1,"clickable"],[1,"vitamui-min-content"],[1,"vitamui-spinner","medium"]],template:function(t,n){1&t&&(S.dc(0,"div",0),S.dc(1,"div",1),S.dc(2,"h5"),S.Vc(3),S.qc(4,"translate"),S.cc(),S.cc(),S.cc(),S.dc(5,"div",0),S.dc(6,"div",2),S.dc(7,"div",3),S.dc(8,"div",4),S.dc(9,"div",5),S.dc(10,"div",6),S.Tc(11,R,3,6,"ng-container",7),S.Tc(12,_,3,6,"ng-container",7),S.cc(),S.cc(),S.dc(13,"div",8),S.Yb(14,"div",9),S.dc(15,"div",10),S.dc(16,"span"),S.Vc(17),S.qc(18,"translate"),S.cc(),S.dc(19,"vitamui-common-order-by-button",11),S.lc("orderChange",(function(t){return n.emitOrderChange(t)}))("directionChange",(function(t){return n.direction=t}))("orderByChange",(function(t){return n.orderBy=t})),S.cc(),S.cc(),S.dc(20,"div",10),S.dc(21,"span"),S.Vc(22),S.qc(23,"translate"),S.cc(),S.dc(24,"vitamui-common-order-by-button",12),S.lc("orderChange",(function(t){return n.emitOrderChange(t)}))("directionChange",(function(t){return n.direction=t}))("orderByChange",(function(t){return n.orderBy=t})),S.cc(),S.cc(),S.dc(25,"div",13),S.dc(26,"span"),S.Vc(27),S.qc(28,"translate"),S.cc(),S.dc(29,"vitamui-common-order-by-button",14),S.lc("orderChange",(function(t){return n.emitOrderChange(t)}))("directionChange",(function(t){return n.direction=t}))("orderByChange",(function(t){return n.orderBy=t})),S.cc(),S.cc(),S.Yb(30,"div",9),S.cc(),S.dc(31,"div",15),S.Tc(32,j,32,26,"div",16),S.cc(),S.cc(),S.cc(),S.Tc(33,w,3,3,"ng-template",null,17,S.Uc),S.Tc(35,P,4,3,"ng-template",null,18,S.Uc),S.Tc(37,D,2,0,"ng-template",null,19,S.Uc),S.cc(),S.cc()),2&t&&(S.Lb(3),S.Wc(S.rc(4,13,"COLLECT.INGEST_LIST_TITLE")),S.Lb(8),S.vc("ngIf",(null==n.dataSource?null:n.dataSource.length)<=1),S.Lb(1),S.vc("ngIf",(null==n.dataSource?null:n.dataSource.length)>1),S.Lb(5),S.Wc(S.rc(18,15,"COLLECT.FIELD_MESSAGE_IDENTIFIER")),S.Lb(2),S.vc("direction",n.direction)("orderBy",n.orderBy),S.Lb(3),S.Wc(S.rc(23,17,"COLLECT.FIELD_OPERATION_ID")),S.Lb(2),S.vc("direction",n.direction)("orderBy",n.orderBy),S.Lb(3),S.Wc(S.rc(28,19,"COLLECT.FIELD_STATUS_TRANSACTION")),S.Lb(2),S.vc("direction",n.direction)("orderBy",n.orderBy),S.Lb(3),S.vc("ngForOf",n.dataSource))},directives:[T.K,f.p,T.S,f.o,T.Eb,b.a,p.b],pipes:[k.d],styles:[""]}),V),$=[{path:"",component:(K=function(t){function n(t,e,c){var i;return r(this,n),(i=u(this,n,[t,e])).transactionsService=c,i}return d(n,t),a(n,[{key:"ngOnInit",value:function(){this.projectName$=this.transactionsService.getProject$().pipe(Object(m.a)((function(t){return t.messageIdentifier}))),this.dataBreadcrumb=[{identifier:T.h.PORTAL_APP},{identifier:T.h.COLLECT_APP},{identifier:"TRANSACTIONS_MONITORING"}],this.transactions$=this.transactionsService.search()}}]),n}(T.cb),K.\u0275fac=function(t){return new(t||K)(S.Xb(A.a),S.Xb(T.J),S.Xb(I))},K.\u0275cmp=S.Rb({type:K,selectors:[["app-projects"]],features:[S.Ib],decls:14,vars:9,consts:[[3,"autosize","hasBackdrop"],[1,"vitamui-heading"],[3,"data"],[1,"vitamui-content"],[1,"mt-3"]],template:function(t,n){1&t&&(S.dc(0,"mat-sidenav-container",0),S.dc(1,"mat-sidenav-content"),S.dc(2,"div",1),S.dc(3,"vitamui-common-title-breadcrumb",2),S.Vc(4),S.qc(5,"translate"),S.qc(6,"async"),S.cc(),S.cc(),S.dc(7,"div",3),S.Yb(8,"div"),S.dc(9,"div",4),S.dc(10,"div",3),S.Yb(11,"div"),S.dc(12,"div",4),S.Yb(13,"app-transaction-list"),S.cc(),S.cc(),S.cc(),S.cc(),S.cc(),S.cc()),2&t&&(S.vc("autosize",!0)("hasBackdrop",!1),S.Lb(3),S.vc("data",n.dataBreadcrumb),S.Lb(1),S.Yc(" ",S.rc(5,5,"COLLECT.TITLE_TRANSACTIONS_MONITORING")," ",S.rc(6,7,n.projectName$),": "))},directives:[y.b,y.c,T.Kb,Y],pipes:[k.d,f.b],styles:[""]}),K),resolve:{transaction:E}}],U=((X=a((function t(){r(this,t)}))).\u0275mod=S.Vb({type:X}),X.\u0275inj=S.Ub({factory:function(t){return new(t||X)},imports:[[f.c,A.g.forChild($)],A.g]}),X),W=((q=a((function t(){r(this,t)}))).\u0275mod=S.Vb({type:q}),q.\u0275inj=S.Ub({factory:function(t){return new(t||q)},providers:[E,{provide:v.a,useValue:{useUtc:!0}}],imports:[[f.c,U,b.b,y.d,T.lb,p.a]]}),q)}}])}();