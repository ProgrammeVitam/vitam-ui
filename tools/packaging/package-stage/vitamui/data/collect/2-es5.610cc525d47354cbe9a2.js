!function(){function e(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */e=function(){return i};var t,i={},a=Object.prototype,c=a.hasOwnProperty,r=Object.defineProperty||function(e,t,i){e[t]=i.value},n="function"==typeof Symbol?Symbol:{},s=n.iterator||"@@iterator",l=n.asyncIterator||"@@asyncIterator",o=n.toStringTag||"@@toStringTag";function u(e,t,i){return Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(t){u=function(e,t,i){return e[t]=i}}function d(e,t,i,a){var c=t&&t.prototype instanceof p?t:p,n=Object.create(c.prototype),s=new N(a||[]);return r(n,"_invoke",{value:S(e,i,s)}),n}function h(e,t,i){try{return{type:"normal",arg:e.call(t,i)}}catch(e){return{type:"throw",arg:e}}}i.wrap=d;var v="suspendedStart",C="executing",E="completed",R={};function p(){}function f(){}function I(){}var T={};u(T,s,(function(){return this}));var g=Object.getPrototypeOf,L=g&&g(g(F([])));L&&L!==a&&c.call(L,s)&&(T=L);var b=I.prototype=p.prototype=Object.create(T);function m(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function A(e,t){function i(a,r,n,s){var l=h(e[a],e,r);if("throw"!==l.type){var o=l.arg,u=o.value;return u&&"object"==typeof u&&c.call(u,"__await")?t.resolve(u.__await).then((function(e){i("next",e,n,s)}),(function(e){i("throw",e,n,s)})):t.resolve(u).then((function(e){o.value=e,n(o)}),(function(e){return i("throw",e,n,s)}))}s(l.arg)}var a;r(this,"_invoke",{value:function(e,c){function r(){return new t((function(t,a){i(e,c,t,a)}))}return a=a?a.then(r,r):r()}})}function S(e,i,a){var c=v;return function(r,n){if(c===C)throw new Error("Generator is already running");if(c===E){if("throw"===r)throw n;return{value:t,done:!0}}for(a.method=r,a.arg=n;;){var s=a.delegate;if(s){var l=_(s,a);if(l){if(l===R)continue;return l}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(c===v)throw c=E,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);c=C;var o=h(e,i,a);if("normal"===o.type){if(c=a.done?E:"suspendedYield",o.arg===R)continue;return{value:o.arg,done:a.done}}"throw"===o.type&&(c=E,a.method="throw",a.arg=o.arg)}}}function _(e,i){var a=i.method,c=e.iterator[a];if(c===t)return i.delegate=null,"throw"===a&&e.iterator.return&&(i.method="return",i.arg=t,_(e,i),"throw"===i.method)||"return"!==a&&(i.method="throw",i.arg=new TypeError("The iterator does not provide a '"+a+"' method")),R;var r=h(c,e.iterator,i.arg);if("throw"===r.type)return i.method="throw",i.arg=r.arg,i.delegate=null,R;var n=r.arg;return n?n.done?(i[e.resultName]=n.value,i.next=e.nextLoc,"return"!==i.method&&(i.method="next",i.arg=t),i.delegate=null,R):n:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,R)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function y(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function N(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function F(e){if(e||""===e){var i=e[s];if(i)return i.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,r=function i(){for(;++a<e.length;)if(c.call(e,a))return i.value=e[a],i.done=!1,i;return i.value=t,i.done=!0,i};return r.next=r}}throw new TypeError(typeof e+" is not iterable")}return f.prototype=I,r(b,"constructor",{value:I,configurable:!0}),r(I,"constructor",{value:f,configurable:!0}),f.displayName=u(I,o,"GeneratorFunction"),i.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},i.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,I):(e.__proto__=I,u(e,o,"GeneratorFunction")),e.prototype=Object.create(b),e},i.awrap=function(e){return{__await:e}},m(A.prototype),u(A.prototype,l,(function(){return this})),i.AsyncIterator=A,i.async=function(e,t,a,c,r){void 0===r&&(r=Promise);var n=new A(d(e,t,a,c),r);return i.isGeneratorFunction(t)?n:n.next().then((function(e){return e.done?e.value:n.next()}))},m(b),u(b,o,"Generator"),u(b,s,(function(){return this})),u(b,"toString",(function(){return"[object Generator]"})),i.keys=function(e){var t=Object(e),i=[];for(var a in t)i.push(a);return i.reverse(),function e(){for(;i.length;){var a=i.pop();if(a in t)return e.value=a,e.done=!1,e}return e.done=!0,e}},i.values=F,N.prototype={constructor:N,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(y),!e)for(var i in this)"t"===i.charAt(0)&&c.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var i=this;function a(a,c){return s.type="throw",s.arg=e,i.next=a,c&&(i.method="next",i.arg=t),!!c}for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r],s=n.completion;if("root"===n.tryLoc)return a("end");if(n.tryLoc<=this.prev){var l=c.call(n,"catchLoc"),o=c.call(n,"finallyLoc");if(l&&o){if(this.prev<n.catchLoc)return a(n.catchLoc,!0);if(this.prev<n.finallyLoc)return a(n.finallyLoc)}else if(l){if(this.prev<n.catchLoc)return a(n.catchLoc,!0)}else{if(!o)throw new Error("try statement without catch or finally");if(this.prev<n.finallyLoc)return a(n.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i];if(a.tryLoc<=this.prev&&c.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var r=a;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var n=r?r.completion:{};return n.type=e,n.arg=t,r?(this.method="next",this.next=r.finallyLoc,R):this.complete(n)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),R},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.finallyLoc===e)return this.complete(i.completion,i.afterLoc),y(i),R}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.tryLoc===e){var a=i.completion;if("throw"===a.type){var c=a.arg;y(i)}return c}}throw new Error("illegal catch attempt")},delegateYield:function(e,i,a){return this.delegate={iterator:F(e),resultName:i,nextLoc:a},"next"===this.method&&(this.arg=t),R}},i}function t(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=a(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var c=0,r=function(){};return{s:r,n:function(){return c>=e.length?{done:!0}:{done:!1,value:e[c++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,s=!0,l=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return s=e.done,e},e:function(e){l=!0,n=e},f:function(){try{s||null==i.return||i.return()}finally{if(l)throw n}}}}function i(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||a(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){if(e){if("string"==typeof e)return c(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?c(e,t):void 0}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,a=new Array(t);i<t;i++)a[i]=e[i];return a}function r(e,t,i){return t=n(t),function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}()?Reflect.construct(t,i||[],n(e).constructor):t.apply(e,i))}function n(e){return(n=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,h(a.key),a)}}function d(e,t,i){return t&&u(e.prototype,t),i&&u(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function h(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var a=i.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{Po3Y:function(a,c,n){"use strict";n.r(c),n.d(c,"ArchiveSearchCollectModule",(function(){return xn}));var l=n("2kYt"),u=n("nIj0"),h=n("gcUQ"),v=n("OZ4H"),C=n("29Wa"),E=n("csyo"),R=n("R7+U"),p=n("lQ7A"),f=n("KZIX"),I=n("QcI7"),T=n("OWX3"),g=n("sEIs"),L=n("bwdy"),b=n("ZTXN"),m=n("C05f"),A=n("g6G6"),S=n("8j5Y"),_=n("cJ9h"),O=n("mWib"),y=n("YtkY"),N=n("6WTZ"),F=n("vobO"),D=n("EM62"),U=n("etrl"),k=n("W1gw"),P=n("s2Ay");function x(e,t){1&e&&(D.bc(0),D.Yb(1,"i",5),D.Vc(2," Un ou plusieurs versement(s) sont en cours "),D.Yb(3,"br"),D.dc(4,"span"),D.Vc(5," (Merci de ne pas \xe9teindre votre navigateur pendant le processus)"),D.cc(),D.ac())}function w(e,t){if(1&e&&(D.bc(0),D.Vc(1),D.qc(2,"translate"),D.dc(3,"strong"),D.Vc(4),D.cc(),D.Vc(5,'" '),D.ac()),2&e){var i=D.pc();D.Lb(1),D.Xc(" ",D.rc(2,2,"ARCHIVE_SEARCH.SEARCH_CRITERIA_SAVER.SAVED_WITH_SUCCESS"),' "'),D.Lb(3),D.Wc(null==i.data?null:i.data.name)}}function M(e,t){1&e&&(D.bc(0),D.dc(1,"span"),D.Vc(2),D.qc(3,"translate"),D.cc(),D.ac()),2&e&&(D.Lb(2),D.Xc(" ",D.rc(3,1,"ARCHIVE_SEARCH.EXPORT_CSV.EXPORT_CSV_LIMIT_REACHED")," "))}function V(e,t){if(1&e&&(D.bc(0),D.Vc(1),D.qc(2,"translate"),D.dc(3,"strong"),D.Vc(4),D.cc(),D.Vc(5),D.qc(6,"translate"),D.ac()),2&e){var i=D.pc();D.Lb(1),D.Xc(" ",D.rc(2,3,"ARCHIVE_SEARCH.SEARCH_CRITERIA_SAVER.DELETED_WITH_SUCCESS_1"),' "'),D.Lb(3),D.Wc(null==i.data?null:i.data.name),D.Lb(1),D.Xc(' " ',D.rc(6,5,"ARCHIVE_SEARCH.SEARCH_CRITERIA_SAVER.DELETED_WITH_SUCCESS_2")," ")}}function H(e,t){if(1&e){var i=D.ec();D.bc(0),D.dc(1,"span",6),D.Vc(2),D.cc(),D.dc(3,"button",7),D.lc("click",(function(){D.Kc(i);var e=D.pc();return e.goToLogbook(null==e.data?null:e.data.serviceUrl)})),D.Vc(4),D.qc(5,"translate"),D.cc(),D.ac()}if(2&e){var a=D.pc();D.Lb(2),D.Wc(null==a.data?null:a.data.message),D.Lb(2),D.Xc(" ",D.rc(5,2,"ARCHIVE_SEARCH.DIP.TO_OPERATION_APP")," ")}}function G(e,t){1&e&&(D.bc(0),D.Vc(1),D.qc(2,"translate"),D.ac()),2&e&&(D.Lb(1),D.Xc(" ",D.rc(2,1,"ARCHIVE_SEARCH.DIP.EXPORT_LIMITS")," "))}function q(e,t){1&e&&(D.bc(0),D.Vc(1),D.qc(2,"translate"),D.ac()),2&e&&(D.Lb(1),D.Xc(" ",D.rc(2,1,"ARCHIVE_SEARCH.ELIMINATION.THRESHOLD_EXCEEDED")," "))}var B,W=((B=function(){function e(t,i){o(this,e),this.data=t,this.matSnackBarRef=i}return d(e,[{key:"close",value:function(){this.matSnackBarRef.dismiss()}},{key:"goToLogbook",value:function(e){window.location.href=e}}]),e}()).\u0275fac=function(e){return new(e||B)(D.Xb(k.a),D.Xb(k.f))},B.\u0275cmp=D.Rb({type:B,selectors:[["app-vitamui-snack-bar"]],decls:12,vars:8,consts:[[1,"vitamui-snack-bar-container"],[1,"vitamui-snack-bar-content",3,"ngSwitch"],[4,"ngSwitchCase"],[1,"close-btn",3,"click"],[1,"material-icons"],[1,"vitamui-icon","vitamui-icon-archive-ingest"],[1,"space-style"],["type","button",1,"btn","white",3,"click"]],template:function(e,t){1&e&&(D.dc(0,"div",0),D.dc(1,"span",1),D.Tc(2,x,6,0,"ng-container",2),D.Tc(3,w,6,4,"ng-container",2),D.Tc(4,M,4,3,"ng-container",2),D.Tc(5,V,7,7,"ng-container",2),D.Tc(6,H,6,4,"ng-container",2),D.Tc(7,G,3,3,"ng-container",2),D.Tc(8,q,3,3,"ng-container",2),D.cc(),D.dc(9,"button",3),D.lc("click",(function(){return t.close()})),D.dc(10,"i",4),D.Vc(11,"clear"),D.cc(),D.cc(),D.cc()),2&e&&(D.Lb(1),D.vc("ngSwitch",null==t.data?null:t.data.type),D.Lb(1),D.vc("ngSwitchCase","sipUploaded"),D.Lb(1),D.vc("ngSwitchCase","searchCriteriaHistoryCreated"),D.Lb(1),D.vc("ngSwitchCase","exportCsvLimitReached"),D.Lb(1),D.vc("ngSwitchCase","searchCriteriaHistoryDeleted"),D.Lb(1),D.vc("ngSwitchCase","WorkflowSuccessSnackBar"),D.Lb(1),D.vc("ngSwitchCase","exportDIPLimitReached"),D.Lb(1),D.vc("ngSwitchCase","thresholdExceeded"))},directives:[l.r,l.s],pipes:[P.d],styles:["[_nghost-%COMP%]{display:flex;align-items:center;justify-content:space-between;height:100%;width:100%}.btn-link[_ngcontent-%COMP%]{color:#fff;font-weight:700;margin-left:10px}.space-style[_ngcontent-%COMP%]{margin-right:30px}"]}),B),j=n("HOZh"),Y=n("HYj3"),X=n("Sv/w"),K=n("kuMc"),z=n("J+dc"),Z=n("sg/T");new D.w("mat-snack-bar-default-options",{providedIn:"root",factory:function(){return new k.c}});var $,Q=n("cmhy"),J=n("47ST"),ee=n("ROBh"),te=n("4e/d"),ie=n("ublV"),ae=n("cX0B"),ce=n("7zxd"),re=(($=function(e){function t(e,i,a,c,n,s,l){var u;return o(this,t),(u=r(this,t,[e,"ALL"])).projectsApiService=e,u.transactionApiService=i,u.searchUnitApiService=a,u.locale=c,u.snackBar=n,u.accessContractApiService=s,u.securityService=l,u.headers=new F.g,u}return s(t,e),d(t,[{key:"sortByTitle",value:function(e){return e.sort((t=this.locale,function(e,i){return e&&i&&e.title&&i.title?e.title.localeCompare(i.title,t,{numeric:!0}):0}));var t}},{key:"getTransactionById",value:function(e){return this.projectsApiService.getTransactionById(e).pipe(Object(y.a)((function(e){return e})))}},{key:"getLastTransactionByProjectId",value:function(e){return this.projectsApiService.getLastTransactionByProjectId(e).pipe(Object(y.a)((function(e){return e})))}},{key:"searchArchiveUnitsByCriteria",value:function(e,i){var a=(new F.g).append("Content-Type","application/json");return i?this.transactionApiService.searchArchiveUnitsByCriteria(e,i,a).pipe(Object(te.a)((function(e){return e instanceof Q.a?Object(J.a)("Erreur : d\xe9lai d\u2019attente d\xe9pass\xe9 pour votre recherche"):Object(ee.a)({$hits:null,$results:[]})})),Object(y.a)((function(e){return t.buildPagedResults(e)}))):Object(ee.a)({pageNumbers:1,results:[],totalResults:0})}},{key:"getTotalTrackHitsByCriteria",value:function(e,t){return this.searchArchiveUnitsByCriteria({criteriaList:e,pageNumber:0,size:1,trackTotalHits:!0},t).pipe(Object(y.a)((function(e){return e.totalResults})),Object(te.a)((function(){return Object(ee.a)(-1)})))}},{key:"normalizeTitle",value:function(e){return(e=e.replace(/[&\/\\|.'":*?<> ]/g,"")).substring(0,218)}},{key:"getAccessContractById",value:function(e){var t=(new F.g).append("Content-Type","application/json");return this.accessContractApiService.getAccessContractById(e,t)}},{key:"openSnackBarForWorkflow",value:function(e,t){this.snackBar.openFromComponent(W,{panelClass:"vitamui-snack-bar",data:{type:"WorkflowSuccessSnackBar",message:e,serviceUrl:t},duration:1e5})}},{key:"downloadObjectFromUnit",value:function(e,t,i,a){return this.projectsApiService.downloadObjectFromUnit(e,t,i,a).subscribe((function(e){var t=null,i=e.headers.get("content-disposition");if(null!==i){var a=/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/.exec(i);null!=a&&a[1]&&(t=a[1].replace(/['"]/g,""))}Object(U.saveAs)(e.body,t)}))}},{key:"downloadFile",value:function(e){window.addEventListener("focus",(function t(){window.removeEventListener("focus",t,!1),URL.revokeObjectURL(e)}),!1),location.href=e}},{key:"validateTransaction",value:function(e){return this.projectsApiService.validateTransaction(e)}},{key:"sendTransaction",value:function(e){return this.projectsApiService.sendTransaction(e)}},{key:"getProjectById",value:function(e){return this.projectsApiService.getById(e)}},{key:"exportCsvSearchArchiveUnitsByCriteria",value:function(e,t){var i=this,a=(new F.g).append("Content-Type","application/json");return this.transactionApiService.exportCsvSearchArchiveUnitsByCriteria(e,t,a).subscribe((function(e){var t=document.createElement("a");t.href=window.URL.createObjectURL(e),t.download="export-archive-units.csv",t.style.visibility="hidden",document.body.appendChild(t),t.click(),document.body.removeChild(t)}),(function(e){413===e.status&&(console.log("Please update filter to reduce size of response"+e.message),i.snackBar.openFromComponent(W,{panelClass:"vitamui-snack-bar",data:{type:"exportCsvLimitReached"},duration:1e4}))}))}},{key:"loadFilingHoldingSchemeTree",value:function(e){var t=this,i=new F.g({"X-Tenant-Id":""+e});return this.searchUnitApiService.getFilingPlan(i).pipe(Object(te.a)((function(){return Object(ee.a)({$hits:null,$results:[]})})),Object(y.a)((function(e){return t.buildNestedTreeLevels(e.$results)})))}},{key:"getReferentialUnitDetails",value:function(e){var t=(new F.g).append("Content-Type","application/json");return this.searchUnitApiService.getById(e,t)}},{key:"getCollectUnitDetails",value:function(e){var t=(new F.g).append("Content-Type","application/json");return this.transactionApiService.getCollectUnitById(e,t)}},{key:"getObjectGroupDetailsById",value:function(e){var t=(new F.g).append("Content-Type","application/json");return this.transactionApiService.getObjectGroupDetailsById(e,t)}},{key:"buildNestedTreeLevels",value:function(e,t){var i=this,a=[];return e.forEach((function(c){if(t&&t.vitamId&&c["#unitups"]&&c["#unitups"][0]===t.vitamId||!t&&(!c["#unitups"]||!c["#unitups"].length||(n=c["#unitups"][0],!e.find((function(e){return e["#id"]===n}))))){var r=T.H.convertUnitToNode(c);r.children=i.buildNestedTreeLevels(e,r),a.push(r)}var n})),this.sortByTitle(a)}},{key:"updateUnitsAMetadata",value:function(e,t,i,a){var c=new F.g;return c=(c=(c=c.append("X-Tenant-Id",e)).append("Content-Type","application/octet-stream")).append("X-Original-Filename",i),this.transactionApiService.updateUnitsAMetadata(a,t,c)}},{key:"getExternalOntologiesList",value:function(){return this.transactionApiService.getExternalOntologiesList()}},{key:"selectUnitWithInheritedRules",value:function(e,t){var i=(new F.g).append("Content-Type","application/json");return this.transactionApiService.selectUnitWithInheritedRules(e,t,i)}},{key:"hasCollectRole",value:function(e,t){return this.securityService.hasRole("COLLECT_APP",t,e)}}],[{key:"fetchTitle",value:function(e,t){return e||(t&&t.fr?t.fr:t.en)}},{key:"fetchAuTitle",value:function(e){return Object(T.vb)(e,"Title")}},{key:"buildPagedResults",value:function(e){var t={results:e.$results,totalResults:e.$hits.total,pageNumbers:0!=+e.$hits.size?Math.floor(+e.$hits.total/+e.$hits.size)+(+e.$hits.total%+e.$hits.size==0?0:1):0};return t.facets=e.$facetResults,t}}]),t}(T.ab)).\u0275fac=function(e){return new(e||$)(D.ic(ie.a),D.ic(ae.a),D.ic(ce.d),D.ic(D.B),D.ic(k.b),D.ic(T.a),D.ic(T.bb))},$.\u0275prov=D.Tb({token:$,factory:$.\u0275fac,providedIn:"root"}),$);function ne(e,t){1&e&&(D.bc(0),D.Yb(1,"i",5),D.Vc(2," Un ou plusieurs versement(s) sont en cours "),D.Yb(3,"br"),D.dc(4,"span"),D.Vc(5," (Merci de ne pas \xe9teindre votre navigateur pendant le processus)"),D.cc(),D.ac())}function se(e,t){if(1&e&&(D.bc(0),D.Vc(1),D.qc(2,"translate"),D.dc(3,"strong"),D.Vc(4),D.cc(),D.Vc(5,'" '),D.ac()),2&e){var i=D.pc();D.Lb(1),D.Xc(" ",D.rc(2,2,"COLLECT.SEARCH_CRITERIA_SAVER.SAVED_WITH_SUCCESS"),' "'),D.Lb(3),D.Wc(null==i.data?null:i.data.name)}}function le(e,t){1&e&&(D.bc(0),D.dc(1,"span"),D.Vc(2),D.qc(3,"translate"),D.cc(),D.ac()),2&e&&(D.Lb(2),D.Xc(" ",D.rc(3,1,"COLLECT.EXPORT_CSV.EXPORT_CSV_LIMIT_REACHED")," "))}function oe(e,t){if(1&e&&(D.bc(0),D.Vc(1),D.qc(2,"translate"),D.dc(3,"strong"),D.Vc(4),D.cc(),D.Vc(5),D.qc(6,"translate"),D.ac()),2&e){var i=D.pc();D.Lb(1),D.Xc(" ",D.rc(2,3,"COLLECT.SEARCH_CRITERIA_SAVER.DELETED_WITH_SUCCESS_1"),' "'),D.Lb(3),D.Wc(null==i.data?null:i.data.name),D.Lb(1),D.Xc(' " ',D.rc(6,5,"COLLECT.SEARCH_CRITERIA_SAVER.DELETED_WITH_SUCCESS_2")," ")}}function ue(e,t){if(1&e){var i=D.ec();D.bc(0),D.dc(1,"span",6),D.Vc(2),D.cc(),D.dc(3,"button",7),D.lc("click",(function(){D.Kc(i);var e=D.pc();return e.goToLogbook(null==e.data?null:e.data.serviceUrl)})),D.Vc(4),D.qc(5,"translate"),D.cc(),D.ac()}if(2&e){var a=D.pc();D.Lb(2),D.Wc(null==a.data?null:a.data.message),D.Lb(2),D.Xc(" ",D.rc(5,2,"COLLECT.DIP.TO_OPERATION_APP")," ")}}function de(e,t){1&e&&(D.bc(0),D.Vc(1),D.qc(2,"translate"),D.ac()),2&e&&(D.Lb(1),D.Xc(" ",D.rc(2,1,"COLLECT.DIP.EXPORT_LIMITS")," "))}function he(e,t){1&e&&(D.bc(0),D.Vc(1),D.qc(2,"translate"),D.ac()),2&e&&(D.Lb(1),D.Xc(" ",D.rc(2,1,"COLLECT.ELIMINATION.THRESHOLD_EXCEEDED")," "))}function ve(e,t){1&e&&(D.bc(0),D.Vc(1),D.qc(2,"translate"),D.ac()),2&e&&(D.Lb(1),D.Xc(" ",D.rc(2,1,"COLLECT.UPDATE_UNITS_METADATA.WAIT_MESSAGE")," "))}function Ce(e,t){1&e&&(D.bc(0),D.Vc(1),D.qc(2,"translate"),D.ac()),2&e&&(D.Lb(1),D.Xc(" ",D.rc(2,1,"COLLECT.UPDATE_UNITS_METADATA.SUCCESS_MESSAGE")," "))}var Ee,Re,pe,fe=function(){var e=function(){function e(t,i){o(this,e),this.data=t,this.matSnackBarRef=i}return d(e,[{key:"close",value:function(){this.matSnackBarRef.dismiss()}},{key:"goToLogbook",value:function(e){window.location.href=e}}]),e}();return e.\u0275fac=function(t){return new(t||e)(D.Xb(k.a),D.Xb(k.f))},e.\u0275cmp=D.Rb({type:e,selectors:[["app-vitamui-snack-bar"]],decls:14,vars:10,consts:[[1,"vitamui-snack-bar-container"],[1,"vitamui-snack-bar-content",3,"ngSwitch"],[4,"ngSwitchCase"],[1,"close-btn",3,"click"],[1,"material-icons"],[1,"vitamui-icon","vitamui-icon-archive-ingest"],[1,"space-style"],["type","button",1,"btn","white",3,"click"]],template:function(e,t){1&e&&(D.dc(0,"div",0),D.dc(1,"span",1),D.Tc(2,ne,6,0,"ng-container",2),D.Tc(3,se,6,4,"ng-container",2),D.Tc(4,le,4,3,"ng-container",2),D.Tc(5,oe,7,7,"ng-container",2),D.Tc(6,ue,6,4,"ng-container",2),D.Tc(7,de,3,3,"ng-container",2),D.Tc(8,he,3,3,"ng-container",2),D.Tc(9,ve,3,3,"ng-container",2),D.Tc(10,Ce,3,3,"ng-container",2),D.cc(),D.dc(11,"button",3),D.lc("click",(function(){return t.close()})),D.dc(12,"i",4),D.Vc(13,"clear"),D.cc(),D.cc(),D.cc()),2&e&&(D.Lb(1),D.vc("ngSwitch",null==t.data?null:t.data.type),D.Lb(1),D.vc("ngSwitchCase","sipUploaded"),D.Lb(1),D.vc("ngSwitchCase","searchCriteriaHistoryCreated"),D.Lb(1),D.vc("ngSwitchCase","exportCsvLimitReached"),D.Lb(1),D.vc("ngSwitchCase","searchCriteriaHistoryDeleted"),D.Lb(1),D.vc("ngSwitchCase","WorkflowSuccessSnackBar"),D.Lb(1),D.vc("ngSwitchCase","exportDIPLimitReached"),D.Lb(1),D.vc("ngSwitchCase","thresholdExceeded"),D.Lb(1),D.vc("ngSwitchCase","waitMassUpdateUnitsMetadata"),D.Lb(1),D.vc("ngSwitchCase","massUpdateUnitsMetadata"))},directives:[l.r,l.s],pipes:[P.d],styles:["[_nghost-%COMP%]{display:flex;align-items:center;justify-content:space-between;height:100%;width:100%}.btn-link[_ngcontent-%COMP%]{color:#fff;font-weight:700;margin-left:10px}.space-style[_ngcontent-%COMP%]{margin-right:30px}"]}),e}(),Ie=new D.w("mat-snack-bar-default-options",{providedIn:"root",factory:function(){return new k.c}}),Te=((Ee=function(){function e(t,i,a,c,r,n){o(this,e),this._overlay=t,this._live=i,this._injector=a,this._breakpointObserver=c,this._parentSnackBar=r,this._defaultConfig=n,this._snackBarRefAtThisLevel=null}return d(e,[{key:"_openedSnackBarRef",get:function(){var e=this._parentSnackBar;return e?e._openedSnackBarRef:this._snackBarRefAtThisLevel},set:function(e){this._parentSnackBar?this._parentSnackBar._openedSnackBarRef=e:this._snackBarRefAtThisLevel=e}},{key:"openFromComponent",value:function(e,t){return this._attach(e,t)}},{key:"openFromTemplate",value:function(e,t){return this._attach(e,t)}},{key:"open",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2?arguments[2]:void 0,a=Object.assign(Object.assign({},this._defaultConfig),i);return a.data={message:e,action:t},a.announcementMessage=e,this.openFromComponent(k.g,a)}},{key:"dismiss",value:function(){this._openedSnackBarRef&&this._openedSnackBarRef.dismiss()}},{key:"_attachSnackBarContainer",value:function(e,t){var i=new X.g(t&&t.viewContainerRef&&t.viewContainerRef.injector||this._injector,new WeakMap([[k.c,t]])),a=new X.d(k.d,t.viewContainerRef,i),c=e.attach(a);return c.instance.snackBarConfig=t,c.instance}},{key:"_attach",value:function(e,t){var i=Object.assign(Object.assign(Object.assign({},new k.c),this._defaultConfig),t),a=this._createOverlay(i),c=this._attachSnackBarContainer(a,i),r=new k.f(c,a);if(e instanceof D.V){var n=new X.i(e,null,{$implicit:i.data,snackBarRef:r});r.instance=c.attachTemplatePortal(n)}else{var s=this._createInjector(i,r),l=new X.d(e,void 0,s),o=c.attachComponentPortal(l);r.instance=o.instance}return this._breakpointObserver.observe(j.b.Handset).pipe(Object(K.a)(a.detachments().pipe(Object(z.a)(1)))).subscribe((function(e){e.matches?a.overlayElement.classList.add("mat-snack-bar-handset"):a.overlayElement.classList.remove("mat-snack-bar-handset")})),this._animateSnackBar(r,i),this._openedSnackBarRef=r,this._openedSnackBarRef}},{key:"_animateSnackBar",value:function(e,t){var i=this;e.afterDismissed().subscribe((function(){i._openedSnackBarRef===e&&(i._openedSnackBarRef=null)})),this._openedSnackBarRef?(this._openedSnackBarRef.afterDismissed().subscribe((function(){e.containerInstance.enter()})),this._openedSnackBarRef.dismiss()):e.containerInstance.enter(),t.duration&&t.duration>0&&e.afterOpened().subscribe((function(){return e._dismissAfter(t.duration)})),t.announcementMessage&&this._live.announce(t.announcementMessage,t.politeness)}},{key:"_createOverlay",value:function(e){var t=new Y.d;t.direction=e.direction;var i=this._overlay.position().global(),a="rtl"===e.direction,c="left"===e.horizontalPosition||"start"===e.horizontalPosition&&!a||"end"===e.horizontalPosition&&a,r=!c&&"center"!==e.horizontalPosition;return c?i.left("0"):r?i.right("0"):i.centerHorizontally(),"top"===e.verticalPosition?i.top("0"):i.bottom("0"),t.width="100%",t.positionStrategy=i,this._overlay.create(t)}},{key:"_createInjector",value:function(e,t){return new X.g(e&&e.viewContainerRef&&e.viewContainerRef.injector||this._injector,new WeakMap([[k.f,t],[k.a,e.data]]))}}]),e}()).\u0275fac=function(e){return new(e||Ee)(D.ic(Y.c),D.ic(Z.k),D.ic(D.x),D.ic(j.a),D.ic(Ee,12),D.ic(Ie))},Ee.\u0275prov=D.Tb({token:Ee,factory:Ee.\u0275fac,providedIn:"root"}),Ee),ge=d((function e(){o(this,e)})),Le=((pe=function(){function e(){o(this,e),this.sourceNode=new m.a(new ge),this.filingHoldingNodesSubject=new m.a(null),this.targetNode=new m.a(""),this.facetsSubject=new m.a([]),this.totalResultsSubject=new m.a(null),this.toggleSubject=new m.a(!0),this.toggleReverseSubject=new m.a(!0),this.archiveUnitTpPreviewSubject=new m.a(null),this.toggleArchiveUnitSubject=new m.a(!0),this.lastSearchCriterias=new m.a(null),this.storedSearchCriteriaHistorySubject=new m.a(null),this.allSearchCriteriaHistorySubject=new m.a([]),this.simpleSearchCriteriaAddSubject=new m.a(null),this.appraisalSearchCriteriaAddSubject=new m.a(null),this.storageSearchCriteriaAddSubject=new m.a(null),this.accessSearchCriteriaAddSubject=new m.a(null),this.reuseSearchCriteriaAddSubject=new m.a(null),this.disseminationSearchCriteriaAddSubject=new m.a(null),this.searchAppraisalCriteriaActionFromMainSubject=new m.a(null),this.searchStorageCriteriaActionFromMainSubject=new m.a(null),this.searchAccessCriteriaActionFromMainSubject=new m.a(null),this.searchReuseCriteriaActionFromMainSubject=new m.a(null),this.searchDisseminationCriteriaActionFromMainSubject=new m.a(null),this.searchCriteriaRemoveFromChildSubject=new m.a(null),this.entireNodes=new m.a([]),this.auTitleSubject=new m.a(""),this.actionSubject=new m.a(""),this.ruleCategory=new m.a(""),this.currentNode=this.sourceNode.asObservable(),this.facetsObservable=this.facetsSubject.asObservable(),this.toggleObservable=this.toggleSubject.asObservable(),this.toggleReverseObservable=this.toggleReverseSubject.asObservable(),this.archiveUnitToPreviewObservable=this.archiveUnitTpPreviewSubject.asObservable(),this.toggleArchiveUnitObservable=this.toggleArchiveUnitSubject.asObservable(),this.storedSearchCriteriaHistoryObservable=this.storedSearchCriteriaHistorySubject.asObservable(),this.auTitleObservable=this.auTitleSubject.asObservable(),this.actionObservable=this.actionSubject.asObservable(),this.allSearchCriteriaHistoryObservable=this.allSearchCriteriaHistorySubject.asObservable(),this.simpleSearchCriteriaAddObservable=this.simpleSearchCriteriaAddSubject.asObservable(),this.appraisalFromMainSearchCriteriaObservable=this.searchAppraisalCriteriaActionFromMainSubject.asObservable(),this.storageFromMainSearchCriteriaObservable=this.searchStorageCriteriaActionFromMainSubject.asObservable(),this.accessFromMainSearchCriteriaObservable=this.searchAccessCriteriaActionFromMainSubject.asObservable(),this.reuseFromMainSearchCriteriaObservable=this.searchReuseCriteriaActionFromMainSubject.asObservable(),this.disseminationFromMainSearchCriteriaObservable=this.searchDisseminationCriteriaActionFromMainSubject.asObservable()}return d(e,[{key:"emitRuleCategory",value:function(e){this.ruleCategory.next(e)}},{key:"getRuleCategory",value:function(){return this.ruleCategory.asObservable()}},{key:"emitEntireNodes",value:function(e){this.entireNodes.next(e)}},{key:"getEntireNodes",value:function(){return this.entireNodes.asObservable()}},{key:"emitFilingHoldingNodes",value:function(e){this.filingHoldingNodesSubject.next(e)}},{key:"getFilingHoldingNodes",value:function(){return this.filingHoldingNodesSubject.asObservable()}},{key:"emitNode",value:function(e){this.sourceNode.next(e)}},{key:"getNodes",value:function(){return this.sourceNode.asObservable()}},{key:"emitNodeTarget",value:function(e){this.targetNode.next(e)}},{key:"getNodesTarget",value:function(){return this.targetNode.asObservable()}},{key:"emitFacets",value:function(e){this.facetsSubject.next(e)}},{key:"getFacets",value:function(){return this.facetsSubject.asObservable()}},{key:"emitTotalResults",value:function(e){this.totalResultsSubject.next(e)}},{key:"getTotalResults",value:function(){return this.totalResultsSubject.asObservable()}},{key:"emitToggle",value:function(e){this.toggleSubject.next(e)}},{key:"getToggle",value:function(){return this.toggleSubject.asObservable()}},{key:"emitSearchCriteriaHistory",value:function(e){this.storedSearchCriteriaHistorySubject.next(e)}},{key:"emitArchiveUnitTitle",value:function(e){this.auTitleSubject.next(e)}},{key:"emitActionChosen",value:function(e){this.auTitleSubject.next(e)}},{key:"getActionChosen",value:function(){return this.auTitleSubject.asObservable()}},{key:"getArchiveUnitTitle",value:function(){return this.auTitleSubject.asObservable()}},{key:"getSearchCriteriaHistoryShared",value:function(){return this.storedSearchCriteriaHistorySubject.asObservable()}},{key:"emitSearchCriterias",value:function(e){this.lastSearchCriterias.next(e)}},{key:"getSearchCriterias",value:function(){return this.lastSearchCriterias.asObservable()}},{key:"emitAllSearchCriteriaHistory",value:function(e){this.allSearchCriteriaHistorySubject.next(e)}},{key:"getAllSearchCriteriaHistoryShared",value:function(){return this.allSearchCriteriaHistorySubject.asObservable()}},{key:"nbFilters",value:function(e){var t=0;return e.searchCriteriaList.length>0&&e.searchCriteriaList.forEach((function(e){t+=e.values.length})),t}},{key:"sort",value:function(e,t){switch(e){case T.z.ASCENDANT:t.sort((function(e,t){return new Date(t.savingDate)-new Date(e.savingDate)}));break;case T.z.DESCENDANT:t.sort((function(e,t){return new Date(e.savingDate)-new Date(t.savingDate)}))}return t}},{key:"addSimpleSearchCriteriaSubject",value:function(e){this.simpleSearchCriteriaAddSubject.next(e)}},{key:"receiveSimpleSearchCriteriaSubject",value:function(){return this.simpleSearchCriteriaAddSubject.asObservable()}},{key:"addAppraisalSearchCriteriaSubject",value:function(e){this.appraisalSearchCriteriaAddSubject.next(e)}},{key:"receiveAppraisalSearchCriteriaSubject",value:function(){return this.appraisalSearchCriteriaAddSubject.asObservable()}},{key:"addStorageSearchCriteriaSubject",value:function(e){this.storageSearchCriteriaAddSubject.next(e)}},{key:"receiveStorageSearchCriteriaSubject",value:function(){return this.storageSearchCriteriaAddSubject.asObservable()}},{key:"addAccessSearchCriteriaSubject",value:function(e){this.accessSearchCriteriaAddSubject.next(e)}},{key:"receiveAccessSearchCriteriaSubject",value:function(){return this.accessSearchCriteriaAddSubject.asObservable()}},{key:"addDisseminationSearchCriteriaSubject",value:function(e){this.disseminationSearchCriteriaAddSubject.next(e)}},{key:"receiveDisseminationSearchCriteriaSubject",value:function(){return this.disseminationSearchCriteriaAddSubject.asObservable()}},{key:"addReuseSearchCriteriaSubject",value:function(e){this.reuseSearchCriteriaAddSubject.next(e)}},{key:"receiveReuseSearchCriteriaSubject",value:function(){return this.reuseSearchCriteriaAddSubject.asObservable()}},{key:"sendAppraisalFromMainSearchCriteriaAction",value:function(e){this.searchAppraisalCriteriaActionFromMainSubject.next(e)}},{key:"receiveAppraisalFromMainSearchCriteriaSubject",value:function(){return this.searchAppraisalCriteriaActionFromMainSubject.asObservable()}},{key:"sendStorageFromMainSearchCriteriaAction",value:function(e){this.searchStorageCriteriaActionFromMainSubject.next(e)}},{key:"receiveStorageFromMainSearchCriteriaSubject",value:function(){return this.searchStorageCriteriaActionFromMainSubject.asObservable()}},{key:"sendAccessFromMainSearchCriteriaAction",value:function(e){this.searchAccessCriteriaActionFromMainSubject.next(e)}},{key:"receiveAccessFromMainSearchCriteriaSubject",value:function(){return this.searchAccessCriteriaActionFromMainSubject.asObservable()}},{key:"sendReuseFromMainSearchCriteriaAction",value:function(e){this.searchReuseCriteriaActionFromMainSubject.next(e)}},{key:"receiveReuseFromMainSearchCriteriaSubject",value:function(){return this.searchReuseCriteriaActionFromMainSubject.asObservable()}},{key:"sendDisseminationFromMainSearchCriteriaAction",value:function(e){this.searchDisseminationCriteriaActionFromMainSubject.next(e)}},{key:"receiveDisseminationFromMainSearchCriteriaSubject",value:function(){return this.searchDisseminationCriteriaActionFromMainSubject.asObservable()}},{key:"sendRemoveFromChildSearchCriteriaAction",value:function(e){this.searchCriteriaRemoveFromChildSubject.next(e)}},{key:"receiveRemoveFromChildSearchCriteriaSubject",value:function(){return this.searchCriteriaRemoveFromChildSubject.asObservable()}}]),e}()).\u0275fac=function(e){return new(e||pe)},pe.\u0275prov=D.Tb({token:pe,factory:pe.\u0275fac,providedIn:"root"}),pe),be=((Re=function(e){function t(e){var i;return o(this,t),(i=r(this,t,[e,"ALL"])).projectsApiService=e,i}return s(t,e),d(t,[{key:"saveSearchCriteriaHistory",value:function(e){return this.projectsApiService.saveSearchCriteriaHistory(e)}},{key:"updateSearchCriteriaHistory",value:function(e){return this.projectsApiService.updateSearchCriteriaHistory(e)}},{key:"getSearchCriteriaHistory",value:function(){return this.projectsApiService.getSearchCriteriaHistory()}},{key:"deleteSearchCriteriaHistory",value:function(e){return this.projectsApiService.deleteSearchCriteriaHistory(e)}}]),t}(T.ab)).\u0275fac=function(e){return new(e||Re)(D.ic(ie.a))},Re.\u0275prov=D.Tb({token:Re,factory:Re.\u0275fac,providedIn:"root"}),Re),me=n("Y2X+"),Ae=n("Jb3d");function Se(e,t){if(1&e&&(D.dc(0,"div",8),D.dc(1,"div",9),D.dc(2,"button",10),D.Vc(3),D.cc(),D.cc(),D.cc()),2&e){var i=t.$implicit;D.Lb(2),D.vc("matTooltip",i.tooltip),D.Lb(1),D.Yc(" ",i.label,": ",i.value," ")}}function _e(e,t){if(1&e){var i=D.ec();D.dc(0,"div",20),D.dc(1,"button",21),D.lc("click",(function(){return D.Kc(i),D.pc(2).onSubmit()})),D.Vc(2," OK "),D.cc(),D.cc()}if(2&e){var a=D.pc(2);D.Lb(1),D.vc("disabled",""===a.nameControl||a.nameControl.length>a.maxlength)}}function Oe(e,t){1&e&&(D.dc(0,"div",22),D.dc(1,"span",23),D.dc(2,"i",24),D.Vc(3,"report_problem"),D.cc(),D.Vc(4),D.qc(5,"translate"),D.cc(),D.Yb(6,"br"),D.dc(7,"span",25),D.Vc(8),D.qc(9,"translate"),D.cc(),D.cc()),2&e&&(D.Lb(4),D.Xc(" ",D.rc(5,2,"COLLECT.SEARCH_CRITERIA_SAVER.SAVE_NOT_POSSIBLE_ALERT_NAME")," "),D.Lb(4),D.Xc(" ",D.rc(9,4,"COLLECT.SEARCH_CRITERIA_SAVER.SAVE_NOT_POSSIBLE_MESSAGE_NAME")," "))}function ye(e,t){if(1&e){var i=D.ec();D.dc(0,"div",11),D.Yb(1,"div",12),D.dc(2,"form",13),D.dc(3,"div",14),D.Vc(4),D.qc(5,"translate"),D.cc(),D.dc(6,"div",15),D.dc(7,"div",16),D.dc(8,"vitamui-common-input",17),D.lc("ngModelChange",(function(e){return D.Kc(i),D.pc().nameControl=e})),D.qc(9,"translate"),D.cc(),D.cc(),D.Tc(10,_e,3,1,"div",18),D.Tc(11,Oe,10,6,"div",19),D.cc(),D.cc(),D.cc()}if(2&e){var a=D.pc();D.Lb(2),D.vc("formGroup",a.searchCriteriaForm),D.Lb(2),D.Wc(D.rc(5,6,"COLLECT.SEARCH_CRITERIA_SAVER.NEW_SAVE_IN_POPUP")),D.Lb(4),D.wc("placeholder",D.rc(9,8,"COLLECT.SEARCH_CRITERIA_SAVER.NAME")),D.vc("ngModel",a.nameControl),D.Lb(2),D.vc("ngIf",null!==a.ToUpdate&&!a.ToUpdate),D.Lb(1),D.vc("ngIf",a.nameControl.length>a.maxlength)}}function Ne(e,t){if(1&e){var i=D.ec();D.dc(0,"div",33),D.lc("click",(function(e){D.Kc(i);var t=D.pc().$implicit;return D.pc(2).preUpdate(t,e)})),D.dc(1,"button",34),D.lc("click",(function(e){D.Kc(i);var t=D.pc().$implicit;return D.pc(2).preUpdate(t,e)})),D.dc(2,"i",35),D.Vc(3,"save"),D.cc(),D.bc(4,36),D.lc("click",(function(e){D.Kc(i);var t=D.pc().$implicit;return D.pc(2).preUpdate(t,e)})),D.dc(5,"span",37),D.Vc(6),D.qc(7,"truncate"),D.cc(),D.dc(8,"span",38),D.Vc(9),D.cc(),D.ac(),D.cc(),D.cc()}if(2&e){var a=D.pc().$implicit,c=D.pc(2);D.wc("matTooltip",a.name),D.vc("matTooltipShowDelay",300),D.Lb(6),D.Xc(" ",D.sc(7,4,a.name,30)," "),D.Lb(3),D.Xc(" - (",c.getNbFilters(a)," filtres) ")}}function Fe(e,t){if(1&e&&(D.dc(0,"div",31),D.Tc(1,Ne,10,7,"div",32),D.cc()),2&e){var i=t.$implicit,a=D.pc(2);D.Lb(1),D.vc("ngIf",i!==a.searchCriteriaHistory)}}function De(e,t){1&e&&(D.dc(0,"button",39),D.Vc(1),D.qc(2,"translate"),D.cc()),2&e&&(D.Lb(1),D.Xc(" ",D.rc(2,1,"COLLECT.SEARCH_CRITERIA_SAVER.NO_RESULTS")," "))}function Ue(e,t){1&e&&(D.dc(0,"div",22),D.dc(1,"span",23),D.dc(2,"i",24),D.Vc(3,"report_problem"),D.cc(),D.Vc(4),D.qc(5,"translate"),D.cc(),D.Yb(6,"br"),D.dc(7,"span"),D.Vc(8),D.qc(9,"translate"),D.cc(),D.cc()),2&e&&(D.Lb(4),D.Wc(D.rc(5,2,"COLLECT.SEARCH_CRITERIA_SAVER.SAVE_NOT_POSSIBLE_ALERT")),D.Lb(4),D.Wc(D.rc(9,4,"COLLECT.SEARCH_CRITERIA_SAVER.SAVE_NOT_POSSIBLE_MESSAGE")))}function ke(e,t){if(1&e){var i=D.ec();D.dc(0,"div",11),D.Yb(1,"div",12),D.dc(2,"div",26),D.Vc(3),D.qc(4,"translate"),D.cc(),D.dc(5,"strong",27),D.Vc(6),D.qc(7,"translate"),D.cc(),D.dc(8,"div",3),D.lc("mouseenter",(function(){return D.Kc(i),D.pc().over("scroll-results")}))("mouseleave",(function(){return D.Kc(i),D.pc().out("scroll-results")})),D.Tc(9,Fe,2,1,"div",28),D.Tc(10,De,3,3,"button",29),D.cc(),D.dc(11,"div",30),D.dc(12,"button",21),D.lc("click",(function(){return D.Kc(i),D.pc().createNewCriteria()})),D.Vc(13),D.qc(14,"translate"),D.cc(),D.cc(),D.Tc(15,Ue,10,6,"div",19),D.cc()}if(2&e){var a=D.pc();D.Lb(3),D.Wc(D.rc(4,8,"COLLECT.SEARCH_CRITERIA_SAVER.NEW_SAVE_LABEL")),D.Lb(3),D.Wc(D.rc(7,10,"COLLECT.SEARCH_CRITERIA_SAVER.NEW_SAVE_REPLACE_LABEL")),D.Lb(2),D.vc("ngClass",a.showScroll?"scroll-results":"no-scroll-results"),D.Lb(1),D.vc("ngForOf",a.searchCriteriaHistories),D.Lb(1),D.vc("ngIf",void 0!==a.searchCriteriaHistories&&0===a.searchCriteriaHistories.length),D.Lb(2),D.vc("disabled",""!==a.criteriaId||10==a.searchCriteriaHistories.length),D.Lb(1),D.Xc(" ",D.rc(14,12,"COLLECT.SEARCH_CRITERIA_SAVER.NEW_SAVE_BUTTON")," "),D.Lb(2),D.vc("ngIf",10===a.searchCriteriaHistories.length)}}function Pe(e,t){if(1&e){var i=D.ec();D.dc(0,"div",48),D.lc("click",(function(){return D.Kc(i),D.pc(2).onCancel()})),D.Vc(1),D.qc(2,"translate"),D.cc()}2&e&&(D.Lb(1),D.Xc(" ",D.rc(2,1,"COLLECT.SEARCH_CRITERIA_SAVER.NO_RESULTS")," "))}function xe(e,t){if(1&e){var i=D.ec();D.dc(0,"div",11),D.Yb(1,"div",12),D.dc(2,"div",26),D.Vc(3),D.qc(4,"translate"),D.cc(),D.dc(5,"div",40),D.dc(6,"div",41),D.dc(7,"button",42),D.dc(8,"i",35),D.Vc(9,"save"),D.cc(),D.bc(10),D.dc(11,"span",43),D.Vc(12),D.qc(13,"truncate"),D.cc(),D.dc(14,"span",38),D.Vc(15),D.cc(),D.ac(),D.cc(),D.cc(),D.cc(),D.Tc(16,Pe,3,3,"div",44),D.dc(17,"mat-dialog-actions",45),D.dc(18,"button",46),D.lc("click",(function(){return D.Kc(i),D.pc().update()})),D.bc(19),D.Vc(20),D.qc(21,"translate"),D.ac(),D.cc(),D.dc(22,"button",47),D.lc("click",(function(){return D.Kc(i),D.pc().cancel()})),D.bc(23),D.Vc(24),D.qc(25,"translate"),D.ac(),D.cc(),D.cc(),D.cc()}if(2&e){var a=D.pc();D.Lb(3),D.Wc(D.rc(4,8,"COLLECT.SEARCH_CRITERIA_SAVER.SAVE_REPLACE_CONFIRM_MESSAGE")),D.Lb(8),D.wc("matTooltip",a.criteriaToUpdate.name),D.vc("matTooltipShowDelay",300),D.Lb(1),D.Xc(" ",D.sc(13,10,a.criteriaToUpdate.name,30)," "),D.Lb(3),D.Xc(" - (",a.getNbFilters(a.criteriaToUpdate)," filtres) "),D.Lb(1),D.vc("ngIf",0==a.searchCriteriaHistories.length),D.Lb(4),D.Xc(" ",D.rc(21,13,"COLLECT.SEARCH_CRITERIA_SAVER.SAVE_REPLACE_CONFIRM_BUTTON")," "),D.Lb(4),D.Wc(D.rc(25,15,"COLLECT.SEARCH_CRITERIA_SAVER.SAVE_REPLACE_CANCEL_BUTTON"))}}var we,Me,Ve,He=((we=function(){function e(t,i,a,c,r,n,s,l,u){var d=this;o(this,e),this.data=t,this.dialogRef=i,this.formBuilder=a,this.searchCriteriaSaverService=c,this.archiveExchangeDataService=r,this.confirmDialogService=n,this.snackBar=s,this.datePipe=l,this.translatePipe=u,this.nbCriterias=0,this.ToUpdate=!0,this.noScroll=!1,this.showScrollFilter=!1,this.showScroll=!1,this.updateConfirm=!1,this.events=[],this.criteriaId="",this.maxlength=150,this.displaySearchCriterias=[],this.searchCriteriaForm=this.formBuilder.group({searchCriteriaForm:null,name:null}),this.criteria=t.criteria,this.searchCriteriaHistory=t.searchCriteriaHistory,this.nbCriterias=t.nbCriterias,this.searchCriterias=t.originalSearchCriteria,this.displaySearchCriterias=this.computeSearchCriterias(this.searchCriterias),this.subscriptionAllSearchCriteriaHistory=this.archiveExchangeDataService.getAllSearchCriteriaHistoryShared().subscribe((function(e){e&&(d.searchCriteriaHistories=e,d.archiveExchangeDataService.sort(T.z.ASCENDANT,d.searchCriteriaHistories))}))}return d(e,[{key:"ngOnDestroy",value:function(){var e,t;null===(e=this.updateSearchCriteriaHistorySubscription)||void 0===e||e.unsubscribe(),null===(t=this.saveSearchCriteriaHistorySubscription)||void 0===t||t.unsubscribe()}},{key:"ngOnInit",value:function(){this.nameControl=""}},{key:"onCancel",value:function(){this.searchCriteriaForm.dirty?this.confirmDialogService.confirmBeforeClosing(this.dialogRef):this.dialogRef.close()}},{key:"onSubmit",value:function(){var e=this;this.searchCriteriaHistory.name=this.searchCriteriaForm.value.name,this.saveSearchCriteriaHistorySubscription=this.searchCriteriaSaverService.saveSearchCriteriaHistory(this.searchCriteriaHistory).subscribe((function(t){e.searchCriteriaHistory.id=t.id,e.archiveExchangeDataService.emitSearchCriteriaHistory(e.searchCriteriaHistory),e.dialogRef.close(!0),e.snackBar.openFromComponent(fe,{panelClass:"vitamui-snack-bar",data:{type:"searchCriteriaHistoryCreated",name:t.name},duration:1e4})}),(function(t){e.dialogRef.close(!1),e.snackBar.open(t.error.message,null,{panelClass:"vitamui-snack-bar",duration:1e4})}))}},{key:"preUpdate",value:function(e,t){var i="dynamic-color";this.events.length>0?this.criteriaId===e.id?(t.target.classList.remove(i),this.events.pop(),this.criteriaId="",this.criteriaToUpdate=null):(this.events[0].target.classList.remove(i),this.events.pop(),t.target.classList.contains(i)?t.target.classList.remove(i):t.target.classList.add(i),this.criteriaId=e.id,this.criteriaToUpdate=e):this.criteriaToUpdate=e,this.events.push(t),this.criteriaToUpdate&&(this.ToUpdate=null,this.updateConfirm=!0,this.noScroll=!0,this.criteriaId="")}},{key:"createNewCriteria",value:function(){this.ToUpdate=!1}},{key:"cancel",value:function(){this.updateConfirm=!1,this.criteriaToUpdate=null,this.ToUpdate=!0}},{key:"update",value:function(){var e=this;this.criteriaToUpdate.searchCriteriaList=this.searchCriteriaHistory.searchCriteriaList,this.criteriaToUpdate.savingDate=(new Date).toISOString(),this.updateSearchCriteriaHistorySubscription=this.searchCriteriaSaverService.updateSearchCriteriaHistory(this.criteriaToUpdate).subscribe((function(){e.dialogRef.close(!0),e.snackBar.openFromComponent(fe,{panelClass:"vitamui-snack-bar",data:{type:"searchCriteriaHistoryCreated",name:e.criteriaToUpdate.name},duration:1e4})}),(function(t){e.snackBar.open(t.error.message,null,{panelClass:"vitamui-snack-bar",duration:1e4})}))}},{key:"getNbFilters",value:function(e){return this.archiveExchangeDataService.nbFilters(e)}},{key:"closeSaveCriteriaForm",value:function(){this.dialogRef.close(!0)}},{key:"over",value:function(e){switch(e){case"scroll-results":this.showScroll=!0,this.noScroll=!1;break;case"scroll-filters":this.showScrollFilter=!0,this.noScroll=!1}}},{key:"out",value:function(e){switch(e){case"scroll-results":this.showScroll=!1;break;case"scroll-filters":this.showScrollFilter=!1,this.noScroll=!1}}},{key:"getCategoryName",value:function(e){return T.Z[e]}},{key:"computeSearchCriterias",value:function(e){var t=this;return e?i(e.values()).map((function(e){var i=e.dataType,a=e.category,c=e.keyTranslated,r=e.key,n=e.values,s=t.getCategoryName(a),l=c?t.translatePipe.transform("COLLECT.SEARCH_CRITERIA_FILTER.".concat(s,".").concat(r)):r,o=l;return n.map((function(c){var r=null;switch(i){case"STRING":var n=t.getFirstTranslated(["COLLECT.SEARCH_CRITERIA_FILTER.".concat(s,".").concat(c.label),"COLLECT.SEARCH_CRITERIA_FILTER.".concat(s,".").concat(c.value.value),"COLLECT.SEARCH_CRITERIA_FILTER.".concat(s,".").concat(a)]),u=!!c.label;r=n||(u?c.label:t.translatePipe.transform("COLLECT.SEARCH_CRITERIA_SAVER.NO_VALUE_FOUND_TO_DISPLAY"));break;case"DATE":r=t.datePipe.transform(c.value.value,"dd/MM/yyyy");break;case"INTERVAL":var d=t.datePipe.transform(c.value.beginInterval,"dd/MM/yyyy"),h=t.datePipe.transform(c.value.endInterval,"dd/MM/yyyy"),v=t.translatePipe.transform("COLLECT.SEARCH_CRITERIA_BETWEEN"),C=t.translatePipe.transform("COLLECT.SEARCH_CRITERIA_AND"),E=t.translatePipe.transform("COLLECT.SEARCH_CRITERIA_GTE"),R=t.translatePipe.transform("COLLECT.SEARCH_CRITERIA_LTE");if(d&&h)r="".concat(v," ").concat(d," ").concat(C," ").concat(h);else if(d&&!h)r="".concat(E," ").concat(d);else{if(d||!h)throw new Error("Interval without beginDate and endDate");r="".concat(R," ").concat(h)}break;default:throw new Error("Data type not supported")}return{category:s,label:l,tooltip:o,type:i,value:r,searchCriteria:e}}))})).reduce((function(e,t){if(Array.isArray(t)){var a=t;return[].concat(i(e),i(a))}return[].concat(i(e),[t])}),[]):[]}},{key:"getFirstTranslated",value:function(e){var i,a=t(e);try{for(a.s();!(i=a.n()).done;){var c=i.value,r=this.translatePipe.transform(c);if(r!==c)return r}}catch(n){a.e(n)}finally{a.f()}return null}}]),e}()).\u0275fac=function(e){return new(e||we)(D.Xb(v.a),D.Xb(v.h),D.Xb(u.e),D.Xb(be),D.Xb(Le),D.Xb(T.t),D.Xb(k.b),D.Xb(l.e),D.Xb(P.d))},we.\u0275cmp=D.Rb({type:we,selectors:[["app-search-criteria-saver"]],features:[D.Kb([P.d])],decls:12,vars:9,consts:[[1,"row","pad"],[1,"col-5","rectangle"],[1,"row","actif-filters"],[3,"ngClass","mouseenter","mouseleave"],["class","separate-div",4,"ngFor","ngForOf"],["class","col-6 form-width",4,"ngIf"],[1,"col-1","btn","link","cancel"],[1,"vitamui-icon","vitamui-icon-close",3,"click"],[1,"separate-div"],[1,"row","pad-bottom"],["type","button","matTooltipClass","vitamui-tooltip","matTooltipShowDelay","300",1,"button-content","right-arround","left-arround","after-search-launched-button",3,"matTooltip"],[1,"col-6","form-width"],[1,"row","triangle"],[3,"formGroup"],[1,"sauvegarde-text"],[1,"row","input-width"],[1,"col-11"],["formControlName","name","maxlength","maxlength","required","",1,"input-text",3,"ngModel","placeholder","ngModelChange"],["class","col-1 btn-ok",4,"ngIf"],["class","warning",4,"ngIf"],[1,"col-1","btn-ok"],["type","submit",1,"btn","primary",3,"disabled","click"],[1,"warning"],[1,"ko-icon"],[1,"material-icons"],[1,"warning-message"],[1,"sauvegarde-text","pad5"],[1,"pad35"],["class","border-results",4,"ngFor","ngForOf"],["mat-menu-item","","class","btn-no-result",4,"ngIf"],[1,"btn-create"],[1,"border-results"],["class","pad-results hover-div","matTooltipClass","vitamui-tooltip",3,"matTooltip","matTooltipShowDelay","click",4,"ngIf"],["matTooltipClass","vitamui-tooltip",1,"pad-results","hover-div",3,"matTooltip","matTooltipShowDelay","click"],["mat-menu-item","",1,"boutton","btn-result-update",3,"click"],[1,"material-icons","save-icon"],[3,"click"],[1,"results-message"],[1,"results-nb-filters"],["mat-menu-item","",1,"btn-no-result"],[1,"div-update","no-scroll-results"],[1,"border-results","pink-color","pad-results","hover-div"],["mat-menu-item","",1,"boutton","btn-result-update"],["matTooltipClass","vitamui-tooltip",1,"results-message",3,"matTooltip","matTooltipShowDelay"],["class","no-results-center search-criterias",3,"click",4,"ngIf"],[1,"pad-actions"],[1,"btn","primary",3,"click"],[1,"btn","link","cancel-update",3,"click"],[1,"no-results-center","search-criterias",3,"click"]],template:function(e,t){1&e&&(D.dc(0,"div",0),D.dc(1,"div",1),D.dc(2,"div",2),D.Vc(3),D.qc(4,"translate"),D.cc(),D.dc(5,"div",3),D.lc("mouseenter",(function(){return t.over("scroll-filters")}))("mouseleave",(function(){return t.out("scroll-filters")})),D.Tc(6,Se,4,3,"div",4),D.cc(),D.cc(),D.Tc(7,ye,12,10,"div",5),D.Tc(8,ke,16,14,"div",5),D.Tc(9,xe,26,17,"div",5),D.dc(10,"button",6),D.dc(11,"i",7),D.lc("click",(function(){return t.closeSaveCriteriaForm()})),D.cc(),D.cc(),D.cc()),2&e&&(D.Lb(3),D.Yc("",D.rc(4,7,"COLLECT.SEARCH_CRITERIA_SAVER.ACTIVE_FILTERS")," (",t.nbCriterias,")"),D.Lb(2),D.vc("ngClass",t.showScrollFilter?"scroll-filters":"scroll-div"),D.Lb(1),D.vc("ngForOf",t.displaySearchCriterias),D.Lb(1),D.vc("ngIf",null!==t.ToUpdate&&!t.ToUpdate),D.Lb(1),D.vc("ngIf",t.ToUpdate),D.Lb(1),D.vc("ngIf",t.criteriaToUpdate&&t.updateConfirm))},directives:[l.n,l.o,l.p,me.a,u.x,u.q,u.i,T.Cb,u.p,u.h,u.k,u.v,Ae.a,v.c],pipes:[P.d,T.Yb],styles:[".button-content[_ngcontent-%COMP%]{border-radius:7px;padding-left:10px;padding-right:10px;max-width:400px;font-weight:700;height:60px}.no-results-center[_ngcontent-%COMP%]{text-align:center}.scroll[_ngcontent-%COMP%]{overflow-y:scroll;height:600px;width:600px}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar{width:12px}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f7ebfa}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:#9c31b5;border-radius:20px;border:3px solid #f7ebfa}.pad[_ngcontent-%COMP%]{padding:0;margin:auto;height:600px}.rectangle[_ngcontent-%COMP%]{background:#eee}.actif-filters[_ngcontent-%COMP%]{padding-top:40px;padding-left:14px;font-size:larger}.actif-filters[_ngcontent-%COMP%], .sauvegarde-text[_ngcontent-%COMP%]{padding-bottom:25px;font-weight:700}.sauvegarde-text[_ngcontent-%COMP%]{padding-left:20px;font-size:21px}.input-text[_ngcontent-%COMP%]{width:95%;padding-left:5%;padding-top:25px}.btn-ok[_ngcontent-%COMP%]{margin-top:30px}.input-width[_ngcontent-%COMP%]{width:475px}.pad5[_ngcontent-%COMP%]{padding-bottom:10px}.pad35[_ngcontent-%COMP%]{padding-left:20px;font-size:15px;font-weight:700}.border-results[_ngcontent-%COMP%]{left:0;right:0;top:0;bottom:0;background:#fff;border:1px solid #bdbdbd;box-sizing:border-box;border-radius:10px;margin-top:17px}.scroll-results[_ngcontent-%COMP%]{height:285px;width:107%;padding-left:25px;overflow-y:scroll;scrollbar-color:var(--vitamui-primary-light) #f7ebfa;scrollbar-width:thin}.scroll-results[_ngcontent-%COMP%]::-webkit-scrollbar{width:12px}.scroll-results[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#fff}.scroll-results[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:var(--vitamui-primary-light);border-radius:20px;border:3px solid #fff}.btn-create[_ngcontent-%COMP%]{padding:5px 0 0 140px}.pink-color[_ngcontent-%COMP%]{background:#f6f3fb}.boutton[_ngcontent-%COMP%]:focus{outline:none}.ko-icon[_ngcontent-%COMP%]{color:red;right:5px}.warning[_ngcontent-%COMP%]{padding-top:5px}.save-icon[_ngcontent-%COMP%]{color:#9d9d9d;font-size:35px}.pad-bottom[_ngcontent-%COMP%]{padding-bottom:10px;padding-left:5%}.triangle[_ngcontent-%COMP%]{position:relative;color:#fff;max-width:10%;top:134px;border:28px solid transparent;border-left-color:#eee}.scroll-filters[_ngcontent-%COMP%]{height:470px;overflow-y:scroll;overflow-x:hidden;scrollbar-color:var(--vitamui-primary-light) #f7ebfa;scrollbar-width:thin}.scroll-filters[_ngcontent-%COMP%]::-webkit-scrollbar{width:12px}.scroll-filters[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f7ebfa}.scroll-filters[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:var(--vitamui-primary-light);border-radius:20px;border:3px solid #f7ebfa}.results-message[_ngcontent-%COMP%]{font-weight:700;padding-left:5px;font-style:normal;font-size:16px;line-height:22px}.results-nb-filters[_ngcontent-%COMP%]{font-style:normal;font-weight:400;font-size:14px;line-height:22px;color:#616161}.div-update[_ngcontent-%COMP%]{padding-left:38px}.confirm-update[_ngcontent-%COMP%]{padding-left:35px;padding-top:10px}.cancel-update[_ngcontent-%COMP%]{padding-left:70px}.pad-actions[_ngcontent-%COMP%]{padding-left:30px}.pad-results[_ngcontent-%COMP%]{padding-top:12px;padding-bottom:12px}.hover-div[_ngcontent-%COMP%]:hover{border-radius:10px}.btn-result-update[_ngcontent-%COMP%]:hover, .hover-div[_ngcontent-%COMP%]:hover{background:#eceaf1}.btn-no-result[_ngcontent-%COMP%]{font-size:20px;padding-top:13px;color:var(--vitamui-grey-700)}.warning-message[_ngcontent-%COMP%]{font-family:Mulish;font-style:normal;font-weight:400;font-size:13px;line-height:16px;letter-spacing:-.2px;color:#000}.no-scroll-results[_ngcontent-%COMP%]{height:283px;width:107%;padding-left:25px;overflow-y:hidden}.scroll-div[_ngcontent-%COMP%]{height:470px;overflow-y:hidden;overflow-x:hidden}.form-width[_ngcontent-%COMP%]{width:730px}"]}),we),Ge=function(e){return e[e.RESULTS_MAX_NUMBER=1e4]="RESULTS_MAX_NUMBER",e[e.UPDATE_DEBOUNCE_TIME=200]="UPDATE_DEBOUNCE_TIME",e.BIG_RESULTS_FACETS_DEFAULT_TEXT="-",e}({}),qe=((Ve=function(){function e(){o(this,e),this.RULES_COMPUTED_NUMBER_PREFIX="RULES_COMPUTED_NUMBER_",this.FINAL_ACTION_COMPUTED_PREFIX="FINAL_ACTION_COMPUTED_",this.EXPIRED_RULES_COMPUTED_PREFIX="EXPIRED_RULES_COMPUTED_",this.UNEXPIRED_RULES_COMPUTED_PREFIX="UNEXPIRED_RULES_COMPUTED_",this.COUNT_WITHOUT_RULES_PREFIX="COUNT_WITHOUT_RULES_",this.COMPUTE_RULES_AU_NUMBER="COMPUTE_RULES_AU_NUMBER",this.COUNT_BY_NODE="COUNT_BY_NODE"}return d(e,[{key:"extractNodesFacetsResults",value:function(e){var i=[];if(e&&e.length>0){var a,c=t(e);try{for(c.s();!(a=c.n()).done;){var r=a.value;if(r.name===this.COUNT_BY_NODE){var n,s=t(r.buckets);try{for(s.s();!(n=s.n()).done;){var l=n.value;i.push({node:l.value,count:l.count})}}catch(o){s.e(o)}finally{s.f()}}}}catch(o){c.e(o)}finally{c.f()}}return i}},{key:"extractRulesFacetsResults",value:function(e){var t=new T.i;return e&&(t.appraisalRuleFacets=this.extractRulesFacetsResultsByCategory(e,T.X.APPRAISAL_RULE),t.accessRuleFacets=this.extractRulesFacetsResultsByCategory(e,T.X.ACCESS_RULE),t.disseminationRuleFacets=this.extractRulesFacetsResultsByCategory(e,T.X.DISSEMINATION_RULE),t.reuseRuleFacets=this.extractRulesFacetsResultsByCategory(e,T.X.REUSE_RULE),t.holdRuleFacets=this.extractRulesFacetsResultsByCategory(e,T.X.HOLD_RULE),t.classificationRuleFacets=this.extractRulesFacetsResultsByCategory(e,T.X.CLASSIFICATION_RULE),t.storageRuleFacets=this.extractRulesFacetsResultsByCategory(e,T.X.STORAGE_RULE)),t}},{key:"extractRulesFacetsResultsByCategory",value:function(e,i){var a=new T.W;if(e&&e.length>0){var c,r=t(e);try{for(r.s();!(c=r.n()).done;){var n=c.value;if(n.name===this.FINAL_ACTION_COMPUTED_PREFIX+i){var s,l=n.buckets,o=[],u=t(l);try{for(u.s();!(s=u.n()).done;){var d=s.value;o.push({node:d.value,count:d.count})}}catch(P){u.e(P)}finally{u.f()}a.finalActionsFacets=o}if(n.name===this.RULES_COMPUTED_NUMBER_PREFIX+i){var h,v=[],C=t(n.buckets);try{for(C.s();!(h=C.n()).done;){var E=h.value;v.push({node:E.value,count:E.count})}}catch(P){C.e(P)}finally{C.f()}a.rulesListFacets=v}if(n.name===this.EXPIRED_RULES_COMPUTED_PREFIX+i){var R,p=[],f=t(n.buckets);try{for(f.s();!(R=f.n()).done;){var I=R.value;p.push({node:I.value,count:I.count})}}catch(P){f.e(P)}finally{f.f()}a.expiredRulesListFacets=p}if(n.name===this.UNEXPIRED_RULES_COMPUTED_PREFIX+i){var g,L=[],b=t(n.buckets);try{for(b.s();!(g=b.n()).done;){var m=g.value;L.push({node:m.value,count:m.count})}}catch(P){b.e(P)}finally{b.f()}a.unexpiredRulesListFacets=L}if(n.name===this.COMPUTE_RULES_AU_NUMBER){var A,S=n.buckets,_=[],O=t(S);try{for(O.s();!(A=O.n()).done;){var y=A.value;_.push({node:y.value,count:y.count})}}catch(P){O.e(P)}finally{O.f()}a.waitingToRecalculateRulesListFacets=_}if(n.name===this.COUNT_WITHOUT_RULES_PREFIX+i){var N,F=n.buckets,D=[],U=t(F);try{for(U.s();!(N=U.n()).done;){var k=N.value;D.push({node:k.value,count:k.count})}}catch(P){U.e(P)}finally{U.f()}a.noRulesFacets=D}}}catch(P){r.e(P)}finally{r.f()}}return a}},{key:"getFacetTextByExactCountFlag",value:function(e,t,i){var a=e.toString();return e<0&&(a=Ge.BIG_RESULTS_FACETS_DEFAULT_TEXT),!t&&i>=Ge.RESULTS_MAX_NUMBER&&(a=Ge.BIG_RESULTS_FACETS_DEFAULT_TEXT),a}}]),e}()).\u0275fac=function(e){return new(e||Ve)},Ve.\u0275prov=D.Tb({token:Ve,factory:Ve.\u0275fac,providedIn:"root"}),Ve),Be=((Me=function(){function e(t){o(this,e),this.archiveExchangeDataService=t}return d(e,[{key:"addCriteria",value:function(e,t,i,a,c,r,n,s,l,o,u,d){if(a){if(c&&"ORIGIN_WAITING_RECALCULATE"===c.id)return this.addCriteria(e,t,i,"WAITING_RECALCULATE",{id:"WAITING_RECALCULATE",value:"true"},r,n,s,T.Z.FIELDS,o,u,d),l===T.Z.ACCESS_RULE&&this.archiveExchangeDataService.sendAppraisalFromMainSearchCriteriaAction({keyElt:a,valueElt:c,action:T.d.ADD}),l===T.Z.APPRAISAL_RULE&&this.archiveExchangeDataService.sendAccessFromMainSearchCriteriaAction({keyElt:a,valueElt:c,action:T.d.ADD}),l===T.Z.STORAGE_RULE&&this.archiveExchangeDataService.sendStorageFromMainSearchCriteriaAction({keyElt:a,valueElt:c,action:T.d.ADD}),l===T.Z.REUSE_RULE&&this.archiveExchangeDataService.sendReuseFromMainSearchCriteriaAction({keyElt:a,valueElt:c,action:T.d.ADD}),void(l===T.Z.DISSEMINATION_RULE&&this.archiveExchangeDataService.sendDisseminationFromMainSearchCriteriaAction({keyElt:a,valueElt:c,action:T.d.ADD}));if(e){var h;if(i++,e.has(a)){var v=(h=e.get(a)).values;v&&0!==v.length||(v=[]),c&&(0===v.filter((function(e){return h.dataType===T.u.STRING||h.dataType===T.u.DATE?e.value.value===(null==c?void 0:c.value):e.value.beginInterval===c.beginInterval&&e.value.endInterval===c.endInterval})).length&&v.push({value:c,label:r,valueShown:!0,status:T.Y.NOT_INCLUDED,keyTranslated:n,valueTranslated:o}),h.values=v,e.set(a,h))}else{-1===t.indexOf(a)&&(l===T.Z.NODES?t.unshift(a):t.push(a));var C=[];C.push({value:c,label:r,id:null==c?void 0:c.id,valueShown:!0,status:T.Y.NOT_INCLUDED,keyTranslated:n,valueTranslated:o}),e.set(a,{key:a,values:C,operator:s,category:l,keyTranslated:n,valueTranslated:o,dataType:u})}!0===d&&l===T.Z.APPRAISAL_RULE&&this.archiveExchangeDataService.sendAppraisalFromMainSearchCriteriaAction({keyElt:a,valueElt:c,action:T.d.ADD}),!0===d&&l===T.Z.ACCESS_RULE&&this.archiveExchangeDataService.sendAccessFromMainSearchCriteriaAction({keyElt:a,valueElt:c,action:T.d.ADD}),!0===d&&l===T.Z.STORAGE_RULE&&this.archiveExchangeDataService.sendStorageFromMainSearchCriteriaAction({keyElt:a,valueElt:c,action:T.d.ADD}),!0===d&&l===T.Z.REUSE_RULE&&this.archiveExchangeDataService.sendReuseFromMainSearchCriteriaAction({keyElt:a,valueElt:c,action:T.d.ADD}),!0===d&&l===T.Z.DISSEMINATION_RULE&&this.archiveExchangeDataService.sendDisseminationFromMainSearchCriteriaAction({keyElt:a,valueElt:c,action:T.d.ADD})}}}},{key:"prepareUAIdList",value:function(e,t,i,a,c){var r=[];return e&&e.length>0&&((a||c)&&e.forEach((function(e){r.push(e)})),t&&t.length>0&&r.push({criteria:"GUID",values:t,operator:T.v.EQ,category:T.Z[T.Z.FIELDS],dataType:T.u.STRING}),i&&i.length>0&&r.push({criteria:"GUID",values:i,operator:T.v.NOT_EQ,category:T.Z[T.Z.FIELDS],dataType:T.u.STRING})),r}},{key:"removeCriteria",value:function(e,t,i,a,c,r){var n=this;c&&c.size>0&&(t&&"WAITING_RECALCULATE"===t.id&&(t.id="ORIGIN_WAITING_RECALCULATE",t.value="ORIGIN_WAITING_RECALCULATE",!0===i&&(this.archiveExchangeDataService.sendAppraisalFromMainSearchCriteriaAction({keyElt:e,valueElt:t,action:T.d.REMOVE}),this.archiveExchangeDataService.sendAccessFromMainSearchCriteriaAction({keyElt:e,valueElt:t,action:T.d.REMOVE}),this.archiveExchangeDataService.sendStorageFromMainSearchCriteriaAction({keyElt:e,valueElt:t,action:T.d.REMOVE}),this.archiveExchangeDataService.sendReuseFromMainSearchCriteriaAction({keyElt:e,valueElt:t,action:T.d.REMOVE}),this.archiveExchangeDataService.sendDisseminationFromMainSearchCriteriaAction({keyElt:e,valueElt:t,action:T.d.REMOVE})),t.id="WAITING_RECALCULATE"),t&&"ORIGIN_WAITING_RECALCULATE"===t.id&&this.removeCriteria("WAITING_RECALCULATE",{id:"WAITING_RECALCULATE",value:t.value},i,a,c,r),c.forEach((function(s,l){if(l===e){var o=s.values;t&&(o=o.filter((function(e){return e.value.id!==t.id}))),0===o.length?(a.forEach((function(t,i){t===e&&a.splice(i,1)})),c.delete(e)):(s.values=o,c.set(e,s)),r--,!0!==i||"NODE"!==l&&l!==T.Q||n.archiveExchangeDataService.emitNodeTarget(t.value),!0===i&&s.category===T.Z.APPRAISAL_RULE&&n.archiveExchangeDataService.sendAppraisalFromMainSearchCriteriaAction({keyElt:e,valueElt:t,action:T.d.REMOVE}),!0===i&&s.category===T.Z.ACCESS_RULE&&n.archiveExchangeDataService.sendAccessFromMainSearchCriteriaAction({keyElt:e,valueElt:t,action:T.d.REMOVE}),!0===i&&s.category===T.Z.STORAGE_RULE&&n.archiveExchangeDataService.sendStorageFromMainSearchCriteriaAction({keyElt:e,valueElt:t,action:T.d.REMOVE}),!0===i&&s.category===T.Z.REUSE_RULE&&n.archiveExchangeDataService.sendReuseFromMainSearchCriteriaAction({keyElt:e,valueElt:t,action:T.d.REMOVE}),!0===i&&s.category===T.Z.DISSEMINATION_RULE&&n.archiveExchangeDataService.sendDisseminationFromMainSearchCriteriaAction({keyElt:e,valueElt:t,action:T.d.REMOVE}),!0===i&&s.category===T.Z.FIELDS&&"ALL_ARCHIVE_UNIT_TYPES"===s.key&&n.archiveExchangeDataService.sendRemoveFromChildSearchCriteriaAction({keyElt:e,valueElt:t,action:T.d.REMOVE})}})))}},{key:"updateCriteriaStatus",value:function(e,t,i){e.forEach((function(e){e.values.forEach((function(e){e.status===t&&(e.status=i)}))}))}},{key:"openSnackBarForWorkflow",value:function(e,t,i){e.openFromComponent(fe,{panelClass:"vitamui-snack-bar",data:{type:"WorkflowSuccessSnackBar",message:t,serviceUrl:i},duration:1e5})}},{key:"findDefaultFacetTabIndex",value:function(e){var i=100;if(e&&e.size>0){var a,c=t(e.values());try{for(c.s();!(a=c.n()).done;){var r=a.value;i>0&&this.isStorageRuleCriteria(r)&&(i=0),i>1&&this.isAppraisalRuleCriteria(r)&&(i=1),i>3&&this.isAccessRuleCriteria(r)&&(i=3),i>4&&this.isDisseminationRuleCriteria(r)&&(i=4),i>5&&this.isReuseRuleCriteria(r)&&(i=5),i>6&&this.isClassificationRuleCriteria(r)&&(i=6)}}catch(n){c.e(n)}finally{c.f()}}return 100===i&&(i=0),i}},{key:"checkIfRulesFacetsCanBeComputed",value:function(e){var i=!1;if(e&&e.size>0){var a,c=t(e.values());try{for(c.s();!(a=c.n()).done;){var r=a.value;(!i&&(this.isAppraisalRuleCriteria(r)||this.isAccessRuleCriteria(r)||this.isStorageRuleCriteria(r)||this.isReuseRuleCriteria(r)||this.isDisseminationRuleCriteria(r))||this.isWaitingToRecalculateCriteria(r.key)||this.isEliminationTenchnicalIdCriteria(r.key))&&(i=!0)}}catch(n){c.e(n)}finally{c.f()}}return i}},{key:"buildFieldsCriteriaListForQUery",value:function(e,t){var i=this;e.forEach((function(a){a.category===T.Z.FIELDS&&(i.updateCriteriaStatus(e,T.Y.NOT_INCLUDED,T.Y.IN_PROGRESS),t.push({criteria:a.key,values:a.values.map((function(e){return e.value})),operator:a.operator,category:T.Z[T.Z.FIELDS],dataType:a.dataType}))}))}},{key:"buildManagementRulesCriteriaListForQuery",value:function(e,t,i){var a=this;t.forEach((function(c){if(c.category.toString()===e){var r=[];c.values.forEach((function(e){r.push(e.value)}));var n=c.key.replace("_"+e,"");i.push({criteria:n,values:r,operator:c.operator,category:c.category,dataType:c.dataType}),a.updateCriteriaStatus(t,T.Y.NOT_INCLUDED,T.Y.IN_PROGRESS)}}))}},{key:"buildNodesListForQUery",value:function(e,t){var i=this;e.forEach((function(a){if(a.category===T.Z.NODES){var c=[];a.values.forEach((function(e){c.push(e.value)})),i.updateCriteriaStatus(e,T.Y.NOT_INCLUDED,T.Y.IN_PROGRESS),t.push({criteria:"NODE",values:c,operator:a.operator,category:T.Z[T.Z.NODES],dataType:a.dataType})}}))}},{key:"recursiveCheck",value:function(e,i){if(0!==e.length){var a,c=t(e);try{for(c.s();!(a=c.n()).done;){var r=a.value;r.hidden=!1,r.checked=i,r.count=null,this.recursiveCheck(r.children,i)}}catch(n){c.e(n)}finally{c.f()}}}},{key:"fillNodeTitle",value:function(e,t,i,a,c){var r=this;e.forEach((function(e){e.id===t?(e.checked=!0,e.hidden=!1,r.addCriteria(i,a,c,"NODE",{id:t,value:t},e.title,!0,T.v.EQ,T.Z.NODES,!1,T.u.STRING,!1)):e.children.length>0&&r.fillNodeTitle(e.children,t,i,a,c)}))}},{key:"isAppraisalRuleCriteria",value:function(e){return T.Z[e.category]===T.Z.APPRAISAL_RULE}},{key:"isAccessRuleCriteria",value:function(e){return T.Z[e.category]===T.Z.ACCESS_RULE}},{key:"isStorageRuleCriteria",value:function(e){return T.Z[e.category]===T.Z.STORAGE_RULE}},{key:"isClassificationRuleCriteria",value:function(e){return T.Z[e.category]===T.Z.CLASSIFICATION_RULE}},{key:"isDisseminationRuleCriteria",value:function(e){return T.Z[e.category]===T.Z.DISSEMINATION_RULE}},{key:"isReuseRuleCriteria",value:function(e){return T.Z[e.category]===T.Z.REUSE_RULE}},{key:"isWaitingToRecalculateCriteria",value:function(e){return"WAITING_RECALCULATE"===e||"ORIGIN_WAITING_RECALCULATE"===e}},{key:"isEliminationTenchnicalIdCriteria",value:function(e){return"ELIMINATION_TECHNICAL_ID_APPRAISAL_RULE"===e}}]),e}()).\u0275fac=function(e){return new(e||Me)(D.ic(Le))},Me.\u0275prov=D.Tb({token:Me,factory:Me.\u0275fac,providedIn:"root"}),Me),We=n("IrDo"),je=["confirmDeleteUpdateUnitsMetadataDialog"],Ye=["updateMetadataCSVFile"];function Xe(e,t){1&e&&D.Yb(0,"div")}function Ke(e,t){1&e&&(D.dc(0,"div",12),D.Yb(1,"mat-spinner",13),D.cc())}function ze(e,t){1&e&&(D.dc(0,"i",30),D.Vc(1,"check_circle"),D.cc())}function Ze(e,t){1&e&&(D.dc(0,"i",31),D.Vc(1,"cancel "),D.cc())}function $e(e,t){if(1&e&&(D.dc(0,"div",24),D.dc(1,"div",25),D.Vc(2),D.dc(3,"span",26),D.Vc(4),D.cc(),D.Tc(5,ze,2,0,"i",27),D.dc(6,"div"),D.dc(7,"span",28),D.Vc(8),D.cc(),D.Tc(9,Ze,2,0,"i",29),D.cc(),D.cc(),D.cc()),2&e){var i=D.pc(2);D.Lb(2),D.Xc(" ",i.fileName," "),D.Lb(2),D.Xc(" | ",i.fileSizeString," "),D.Lb(1),D.vc("ngIf",!i.hasError),D.Lb(3),D.Xc("",i.erroeMessage," "),D.Lb(1),D.vc("ngIf",i.hasError)}}var Qe=function(e){return{"on-over":e}};function Je(e,t){if(1&e){var i=D.ec();D.dc(0,"div",14),D.dc(1,"div",15),D.lc("fileToUploadEmitter",(function(e){return D.Kc(i),D.pc().onDropped(e)}))("fileDragOverEmitter",(function(e){return D.Kc(i),D.pc().onDragOver(e)}))("fileDragLeaveEmitter",(function(e){return D.Kc(i),D.pc().onDragLeave(e)})),D.Tc(2,$e,10,5,"div",16),D.dc(3,"input",17,18),D.lc("change",(function(e){return D.Kc(i),D.pc().handleFileInput(e.target.files)})),D.cc(),D.dc(5,"div",19),D.dc(6,"div",20),D.Vc(7),D.qc(8,"translate"),D.Yb(9,"br"),D.cc(),D.dc(10,"div",20),D.dc(11,"div",21),D.dc(12,"span",22),D.lc("click",(function(){return D.Kc(i),D.pc().addUpdateMetadataCSVFile()})),D.Vc(13),D.qc(14,"translate"),D.cc(),D.cc(),D.cc(),D.dc(15,"div",23),D.dc(16,"span"),D.Vc(17),D.qc(18,"translate"),D.cc(),D.cc(),D.cc(),D.cc(),D.cc()}if(2&e){var a=D.pc();D.Lb(1),D.vc("ngClass",D.Ac(11,Qe,a.hasDropZoneOver)),D.Lb(1),D.vc("ngIf",a.fileName&&a.fileSize>0&&a.fileSizeString),D.Lb(5),D.Wc(D.rc(8,5,"COLLECT.UPDATE_UNITS_METADATA.ADD_FILE")),D.Lb(6),D.Xc(" ",D.rc(14,7,"COLLECT.UPDATE_UNITS_METADATA.BROWSE"),""),D.Lb(4),D.Xc(" ",D.rc(18,9,"COLLECT.UPDATE_UNITS_METADATA.ACCEPTED_FORMAT"),"")}}function et(e,t){if(1&e){var i=D.ec();D.dc(0,"mat-dialog-content"),D.dc(1,"div",32),D.Vc(2),D.qc(3,"translate"),D.cc(),D.Yb(4,"br"),D.dc(5,"div",33),D.Vc(6),D.qc(7,"translate"),D.cc(),D.cc(),D.Yb(8,"br"),D.dc(9,"mat-dialog-actions"),D.dc(10,"button",34),D.lc("click",(function(){return D.Kc(i),D.pc().onConfirmAction()})),D.Vc(11),D.qc(12,"translate"),D.cc(),D.dc(13,"button",35),D.lc("click",(function(){return D.Kc(i),D.pc().onCloseAction()})),D.Vc(14),D.qc(15,"translate"),D.cc(),D.cc()}2&e&&(D.Lb(2),D.Wc(D.rc(3,4,"COLLECT.UPDATE_UNITS_METADATA.ACTION_TITLE")),D.Lb(4),D.Wc(D.rc(7,6,"COLLECT.UPDATE_UNITS_METADATA.CANCEL_UPDATE_TO_CONFIRM")),D.Lb(5),D.Xc(" ",D.rc(12,8,"COLLECT.UPDATE_UNITS_METADATA.CONFIRM")," "),D.Lb(3),D.Xc(" ",D.rc(15,10,"COLLECT.UPDATE_UNITS_METADATA.UPDATE_CANCEL")," "))}var tt,it=((tt=function(){function e(t,i,a,c,r,n,s,l){o(this,e),this.data=t,this.logger=i,this.dialog=a,this.snackBar=c,this.dialogRef=r,this.dialogRefToClose=n,this.translateService=s,this.archiveCollectService=l,this.stepIndex=0,this.stepCount=1,this.fileSize=0,this.hasDropZoneOver=!1,this.isAtrNotValid=!1,this.isDisabled=!0,this.hasFileSizeError=!1,this.hasError=!1,this.isLoadingData=!1,this.fileToUpload=null,this.transfertDetails={}}return d(e,[{key:"ngOnDestroy",value:function(){var e;null===(e=this.subscriptions)||void 0===e||e.unsubscribe()}},{key:"ngOnInit",value:function(){}},{key:"updateUAMetadatas",value:function(){this.stepIndex=this.stepIndex+1}},{key:"addUpdateMetadataCSVFile",value:function(){this.updateMetadataCSVFile.nativeElement.click()}},{key:"updateUnitsMetadata",value:function(){var e=this;this.isLoadingData=!0,this.snackBar.openFromComponent(fe,{panelClass:"vitamui-snack-bar",data:{type:"waitMassUpdateUnitsMetadata"},duration:1e5}),this.subscriptions=this.archiveCollectService.updateUnitsAMetadata(this.data.tenantIdentifier,this.fileToUpload,this.fileName,this.data.selectedTransaction.id).subscribe((function(t){e.isLoadingData=!1,t&&(e.dialogRef.close(!0),e.snackBar.openFromComponent(fe,{panelClass:"vitamui-snack-bar",data:{type:"massUpdateUnitsMetadata"},duration:1e5}))}),(function(t){e.isLoadingData=!1,e.dialogRef.close(!0),e.logger.error("Error message :",t)}))}},{key:"handleFileInput",value:function(e){this.handleFileList(e)}},{key:"onDragOver",value:function(e){this.hasDropZoneOver=e}},{key:"onDragLeave",value:function(e){this.hasDropZoneOver=e}},{key:"onDropped",value:function(e){this.hasDropZoneOver=!1,this.handleFile(e)}},{key:"checkFileExtension",value:function(e){return e.endsWith(".csv")}},{key:"initializeFileToUpload",value:function(e){e&&(this.fileToUpload=e[0],this.fileName=this.fileToUpload.name,this.fileSize=this.fileToUpload.size)}},{key:"initializeFileListToUpload",value:function(e){e&&(this.fileToUpload=e.item(0),this.fileName=this.fileToUpload.name,this.fileSize=this.fileToUpload.size)}},{key:"onCancel",value:function(){this.dialogRefToClose=this.dialog.open(this.confirmDeleteUpdateUnitsMetadataDialog,{panelClass:"vitamui-dialog"})}},{key:"onCloseAction",value:function(){this.dialogRefToClose.close(!0)}},{key:"onConfirmAction",value:function(){this.dialogRefToClose.close(!0),this.dialogRef.close(!0)}},{key:"initializeParameters",value:function(){this.isDisabled=!1,this.hasError=!1,this.hasFileSizeError=!1,this.erroeMessage=null,this.isAtrNotValid=!1}},{key:"handleFile",value:function(e){this.initializeParameters(),this.initializeFileToUpload(e);var t=new T.p(this.logger);if(this.fileSizeString=t.transform(this.fileSize),!this.checkFileExtension(this.fileName))return this.erroeMessage=this.translateService.instant("COLLECT.UPDATE_UNITS_METADATA.FILE_BAD_FORMAT"),void(this.hasError=!0)}},{key:"handleFileList",value:function(e){this.initializeParameters(),this.initializeFileListToUpload(e);var t=new T.p(this.logger);if(this.fileSizeString=t.transform(this.fileSize),!this.checkFileExtension(this.fileName))return this.erroeMessage=this.translateService.instant("COLLECT.UPDATE_UNITS_METADATA.FILE_BAD_FORMAT"),void(this.hasError=!0)}}]),e}()).\u0275fac=function(e){return new(e||tt)(D.Xb(v.a),D.Xb(T.O),D.Xb(v.b),D.Xb(k.b),D.Xb(v.h),D.Xb(v.h),D.Xb(P.e),D.Xb(re))},tt.\u0275cmp=D.Rb({type:tt,selectors:[["app-update-units-metadata"]],viewQuery:function(e,t){var i;1&e&&(D.Pc(je,!0),D.bd(Ye,!0)),2&e&&(D.Fc(i=D.mc())&&(t.confirmDeleteUpdateUnitsMetadataDialog=i.first),D.Fc(i=D.mc())&&(t.updateMetadataCSVFile=i.first))},decls:28,vars:23,consts:[[1,"header"],[3,"count","index"],[3,"selectedIndex","selectionChange"],[1,"content"],["matTooltipClass","vitamui-tooltip",1,"vitamui-icon","vitamui-icon-info",3,"matTooltip"],[4,"ngIf","ngIfThen","ngIfElse"],[1,"actions"],["type","button",1,"btn","primary",3,"disabled","click"],["type","button",1,"btn","link",3,"disabled","click"],["loadingMode",""],["dragAndDropArea",""],["confirmDeleteUpdateUnitsMetadataDialog",""],[1,"vitamui-min-content"],[1,"vitamui-spinner","large"],[1,"d-flex"],["vitamuiCommonDragAndDrop","",1,"drag-and-drop-area",3,"ngClass","fileToUploadEmitter","fileDragOverEmitter","fileDragLeaveEmitter"],["class","drag-container",4,"ngIf"],["type","file",1,"input-file",3,"change"],["updateMetadataCSVFile",""],[1,"drop-csv-file-area"],[1,"csv-drop"],[1,"upload"],[1,"url-select",3,"click"],[1,"csv-drop-small"],[1,"drag-container"],[1,"file-info-class"],[1,"text-grey"],["class","material-icons success-icon",4,"ngIf"],[1,"text-red"],["class","material-icons error-icon",4,"ngIf"],[1,"material-icons","success-icon"],[1,"material-icons","error-icon"],[1,"text-title"],[1,"text","large","bold"],[1,"btn","primary","btn-confirm-dialog","margin-btn",3,"click"],["type","button",1,"btn","cancel",3,"click"]],template:function(e,t){if(1&e&&(D.dc(0,"div",0),D.Yb(1,"vitamui-common-progress-bar",1),D.cc(),D.dc(2,"vitamui-common-stepper",2),D.lc("selectionChange",(function(e){return t.stepIndex=e.selectedIndex})),D.dc(3,"cdk-step"),D.dc(4,"div",3),D.dc(5,"h2"),D.Vc(6),D.qc(7,"translate"),D.cc(),D.dc(8,"div"),D.dc(9,"h4"),D.Vc(10),D.qc(11,"translate"),D.Yb(12,"i",4),D.qc(13,"translate"),D.cc(),D.cc(),D.Tc(14,Xe,1,0,"div",5),D.dc(15,"div",6),D.dc(16,"button",7),D.lc("click",(function(){return t.updateUnitsMetadata()})),D.Vc(17),D.qc(18,"translate"),D.cc(),D.dc(19,"button",8),D.lc("click",(function(){return t.onCancel()})),D.Vc(20),D.qc(21,"translate"),D.cc(),D.cc(),D.cc(),D.cc(),D.cc(),D.Tc(22,Ke,2,0,"ng-template",null,9,D.Uc),D.Tc(24,Je,19,13,"ng-template",null,10,D.Uc),D.Tc(26,et,16,12,"ng-template",null,11,D.Uc)),2&e){var i=D.Gc(23),a=D.Gc(25);D.Lb(1),D.vc("count",t.stepCount)("index",t.stepIndex),D.Lb(1),D.vc("selectedIndex",t.stepIndex),D.Lb(4),D.Wc(D.rc(7,13,"COLLECT.UPDATE_UNITS_METADATA.ACTION_TITLE")),D.Lb(4),D.Xc(" ",D.rc(11,15,"COLLECT.UPDATE_UNITS_METADATA.ACTION_SUB_TITLE")," "),D.Lb(2),D.xc("matTooltip"," ",D.rc(13,17,"COLLECT.UPDATE_UNITS_METADATA.ACTION_DESCRIPTION")," "),D.Lb(2),D.vc("ngIf",t.isLoadingData)("ngIfThen",i)("ngIfElse",a),D.Lb(2),D.vc("disabled",t.isDisabled||t.hasError||t.isLoadingData),D.Lb(1),D.Xc(" ",D.rc(18,19,"COLLECT.UPDATE_UNITS_METADATA.UPDATE_CONFIRM")," "),D.Lb(2),D.vc("disabled",t.isLoadingData),D.Lb(1),D.Xc(" ",D.rc(21,21,"COLLECT.UPDATE_UNITS_METADATA.UPDATE_CANCEL")," ")}},directives:[T.Lb,T.eb,We.a,me.a,l.p,E.b,T.A,l.n,v.f,v.c],pipes:[P.d],styles:["h2[_ngcontent-%COMP%]{font-size:23px;line-height:46px;margin-top:10px}h4[_ngcontent-%COMP%]{font-size:19px;line-height:26px;margin-top:7px;margin-bottom:7px}button.primary[_ngcontent-%COMP%]{margin-right:20px}.drag-and-drop-area[_ngcontent-%COMP%]{width:100%;height:300px;border:2px dashed var(--vitamui-primary);border-radius:6px;box-shadow:0 0 80px rgba(255,255,249,.3);background:#fff;overflow:hidden}.drag-and-drop-area[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{padding-top:20px}.drag-container[_ngcontent-%COMP%]{width:100%;height:160px;vertical-align:middle;text-align:center}.file-info-class[_ngcontent-%COMP%]{font-size:14px;line-height:20px;text-align:center;margin-top:50px;margin-bottom:10px;color:#000;font-style:normal;font-weight:700;font-size:18px}.file-info-class[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{color:#a5a5a5}.text-red[_ngcontent-%COMP%]{color:#c10000}.text-grey[_ngcontent-%COMP%]{color:#9d9d9d;font-size:13px}.success-icon[_ngcontent-%COMP%]{color:#27740a;font-size:50px}.error-icon[_ngcontent-%COMP%]{color:#ea0101;font-size:50px}.input-file[_ngcontent-%COMP%]{display:none}.drop-csv-file-area[_ngcontent-%COMP%]{text-align:center;height:156px}.on-over[_ngcontent-%COMP%]{border:2px solid var(--vitamui-secondary)}.on-over[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#fff}.on-over[_ngcontent-%COMP%]   .drop-csv-file-area[_ngcontent-%COMP%]{background:#5cbaa9;opacity:.9;color:#fff}.csv-drop[_ngcontent-%COMP%]{font-size:19px;line-height:26px;margin-top:7px;margin-bottom:7px}.csv-drop-small[_ngcontent-%COMP%]{margin-top:190px;margin-bottom:10px;color:var(--vitamui-primary);font-style:normal;font-weight:700;line-height:10px}.csv-drop-small[_ngcontent-%COMP%], .upload-text[_ngcontent-%COMP%]{text-align:center;font-size:15px}.upload-text[_ngcontent-%COMP%]{padding-top:5%;line-height:18px;color:#a5a5a5}.upload-text[_ngcontent-%COMP%]   .upload[_ngcontent-%COMP%]{color:var(--vitamui-secondary)}.url-select[_ngcontent-%COMP%]{cursor:pointer;font-size:30px;color:var(--vitamui-primary);letter-spacing:.1px;white-space:nowrap;transform-origin:left;transition:transform .15s ease-out}"]}),tt),at=n("seVz"),ct=d((function e(t,i){o(this,e),this.key=t,this.value=i}));function rt(e,t){1&e&&D.Yb(0,"mat-spinner",7)}function nt(e,t){if(1&e&&(D.dc(0,"span",17),D.Vc(1),D.qc(2,"number"),D.cc()),2&e){var i=D.pc(2).$implicit;D.Lb(1),D.Wc(D.sc(2,1,null==i?null:i.count,"1.0"))}}function st(e,t){if(1&e){var i=D.ec();D.dc(0,"div",14),D.dc(1,"div",1),D.dc(2,"vitamui-tree-node",15),D.lc("nodeToggle",(function(){D.Kc(i);var e=D.pc().$implicit;return D.pc(2).nestedTreeControlFull.toggle(e)}))("labelClick",(function(){D.Kc(i);var e=D.pc().$implicit;return D.pc(2).onShowNodeDetails(e.id)})),D.cc(),D.cc(),D.Tc(3,nt,3,4,"span",16),D.cc()}if(2&e){var a=D.pc().$implicit,c=D.pc(2);D.Lb(2),D.vc("node",a)("icon",c.getNodeUnitIcon(a)),D.Lb(1),D.vc("ngIf",c.hasMatchesInSearch&&null!=(null==a?null:a.count)&&(null==a?null:a.count)>0)}}function lt(e,t){if(1&e&&(D.dc(0,"mat-tree-node"),D.Tc(1,st,4,3,"div",13),D.cc()),2&e){var i=t.$implicit,a=D.pc(2);D.Lb(1),D.vc("ngIf",a.nodeHasMatchsOrShowAll(i))}}function ot(e,t){if(1&e&&(D.dc(0,"span",17),D.Vc(1),D.qc(2,"number"),D.cc()),2&e){var i=D.pc(2).$implicit;D.Lb(1),D.Xc(" ",D.sc(2,1,null==i?null:i.count,"1.0")," ")}}function ut(e,t){if(1&e){var i=D.ec();D.dc(0,"div",20),D.dc(1,"vitamui-tree-node",21),D.lc("nodeToggle",(function(){D.Kc(i);var e=D.pc().$implicit;return D.pc(2).nestedTreeControlFull.toggle(e)}))("labelClick",(function(){D.Kc(i);var e=D.pc().$implicit;return D.pc(2).onShowNodeDetails(e.id)})),D.cc(),D.Tc(2,ot,3,4,"span",16),D.cc()}if(2&e){var a=D.pc().$implicit,c=D.pc(2);D.Lb(1),D.vc("node",a)("icon",c.getNodeUnitIcon(a))("expanded",c.nestedTreeControlFull.isExpanded(a)),D.Lb(1),D.vc("ngIf",c.hasMatchesInSearch&&null!=(null==a?null:a.count)&&(null==a?null:a.count)>0)}}function dt(e,t){1&e&&D.Zb(0,24)}function ht(e,t){if(1&e&&(D.dc(0,"div",22),D.Tc(1,dt,1,0,"ng-container",23),D.cc()),2&e){var i=D.pc().$implicit,a=D.pc(2);D.Pb("filing-holding-scheme-tree-invisible",!a.nestedTreeControlFull.isExpanded(i)),D.Lb(1),D.vc("ngIf",a.nestedTreeControlFull.isExpanded(i))}}function vt(e,t){if(1&e&&(D.dc(0,"mat-nested-tree-node"),D.Tc(1,ut,3,4,"div",18),D.Tc(2,ht,2,3,"div",19),D.cc()),2&e){var i=t.$implicit,a=D.pc(2);D.Lb(1),D.vc("ngIf",a.nodeHasMatchsOrShowAll(i)),D.Lb(1),D.vc("ngIf",a.nodeHasMatchsOrShowAll(i))}}function Ct(e,t){1&e&&D.Yb(0,"mat-tree-node",25)}function Et(e,t){1&e&&(D.dc(0,"div",26),D.Vc(1),D.qc(2,"translate"),D.cc()),2&e&&(D.Lb(1),D.Xc(" ",D.rc(2,1,"COLLECT.FILING_SCHEMA.NO_TREES_NO_PLANS_FOR_ACCESS_CONTRACT")," "))}function Rt(e,t){if(1&e&&(D.dc(0,"div"),D.dc(1,"div",8),D.dc(2,"mat-tree",9),D.Tc(3,lt,2,1,"mat-tree-node",10),D.Tc(4,vt,3,2,"mat-nested-tree-node",10),D.Tc(5,Ct,1,0,"mat-tree-node",11),D.cc(),D.cc(),D.Tc(6,Et,3,3,"div",12),D.cc()),2&e){var i=D.pc();D.Lb(2),D.vc("dataSource",i.nestedDataSourceFull)("treeControl",i.nestedTreeControlFull),D.Lb(1),D.vc("matTreeNodeDefWhen",i.nodeHasNoChidren),D.Lb(1),D.vc("matTreeNodeDefWhen",i.nodeHasChidren),D.Lb(2),D.vc("ngIf",i.nestedDataSourceFull.data.length<=0)}}function pt(e,t){1&e&&(D.dc(0,"div"),D.Yb(1,"mat-spinner",27),D.cc())}var ft,It=((ft=function(){function e(){o(this,e),this.addToSearchCriteria=new D.p,this.showNodeDetail=new D.p,this.switchView=new D.p,this.closePanel=new D.p}return d(e,[{key:"addToSearchCriteriaList",value:function(e){this.addToSearchCriteria.emit(e)}},{key:"onShowNodeDetails",value:function(e){this.showNodeDetail.emit(new ct(e,!1))}},{key:"onViewSwitched",value:function(){this.switchView.emit()}},{key:"nodeHasChidren",value:function(e,t){return Object(T.wb)(t)}},{key:"nodeHasNoChidren",value:function(e,t){return!Object(T.wb)(t)}},{key:"nodeHasMatchsOrShowAll",value:function(e){return this.showEveryNodes||Object(T.xb)(e)}},{key:"onClosePanel",value:function(){this.closePanel.emit()}},{key:"getNodeUnitIcon",value:function(e){return Object(T.yb)(e)}}]),e}()).\u0275fac=function(e){return new(e||ft)},ft.\u0275cmp=D.Rb({type:ft,selectors:[["app-classification-tree"]],inputs:{loadingHolding:"loadingHolding",nestedDataSourceFull:"nestedDataSourceFull",nestedTreeControlFull:"nestedTreeControlFull",hasMatchesInSearch:"hasMatchesInSearch",showEveryNodes:"showEveryNodes",loadingNodeUnit:"loadingNodeUnit"},outputs:{addToSearchCriteria:"addToSearchCriteria",showNodeDetail:"showNodeDetail",switchView:"switchView",closePanel:"closePanel"},decls:11,vars:6,consts:[[1,"flex-row"],[1,"tree-text"],[1,"tree-title"],["diameter","20","color","accent",4,"ngIf"],[1,"btn","link","cancel"],[1,"vitamui-icon","vitamui-icon-close",3,"click"],[4,"ngIf"],["diameter","20","color","accent"],[1,"tree-filing-scheme"],[1,"filing-holding-scheme-tree",3,"dataSource","treeControl"],[4,"matTreeNodeDef","matTreeNodeDefWhen"],["class","hide",4,"matTreeNodeDef"],["class","area-show-tree",4,"ngIf"],["class","mat-tree-node filing-holding-scheme-tree-node flex-row",4,"ngIf"],[1,"mat-tree-node","filing-holding-scheme-tree-node","flex-row"],["disabled","",3,"node","icon","nodeToggle","labelClick"],["class","badge badge-secondary pad",4,"ngIf"],[1,"badge","badge-secondary","pad"],["class","mat-tree-node filing-holding-scheme-tree-node",4,"ngIf"],["class","flex-column childs",3,"filing-holding-scheme-tree-invisible",4,"ngIf"],[1,"mat-tree-node","filing-holding-scheme-tree-node"],[3,"node","icon","expanded","nodeToggle","labelClick"],[1,"flex-column","childs"],["matTreeNodeOutlet","",4,"ngIf"],["matTreeNodeOutlet",""],[1,"hide"],[1,"area-show-tree"],["diameter","50","color","accent"]],template:function(e,t){1&e&&(D.dc(0,"div",0),D.dc(1,"div",1),D.dc(2,"div",2),D.dc(3,"span"),D.Vc(4),D.qc(5,"translate"),D.cc(),D.Tc(6,rt,1,0,"mat-spinner",3),D.cc(),D.cc(),D.dc(7,"button",4),D.dc(8,"i",5),D.lc("click",(function(){return t.onClosePanel()})),D.cc(),D.cc(),D.cc(),D.Tc(9,Rt,7,5,"div",6),D.Tc(10,pt,2,0,"div",6)),2&e&&(D.Lb(4),D.Wc(D.rc(5,4,"COLLECT.FILING_SCHEMA.TREE_TITLE")),D.Lb(2),D.vc("ngIf",t.loadingNodeUnit),D.Lb(3),D.vc("ngIf",!t.loadingHolding),D.Lb(1),D.vc("ngIf",t.loadingHolding))},directives:[l.p,E.b,I.b,I.f,I.e,T.pb,I.a,I.g],pipes:[P.d,l.f],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%;background:#fff;margin:0;width:100%}[_nghost-%COMP%]   div[_ngcontent-%COMP%], [_nghost-%COMP%]   mat-nested-tree-node[_ngcontent-%COMP%], [_nghost-%COMP%]   mat-tree[_ngcontent-%COMP%], [_nghost-%COMP%]   mat-tree-node[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start;align-items:flex-start;width:100%}[_nghost-%COMP%]   .tree-text[_ngcontent-%COMP%]{flex:1;min-width:0}[_nghost-%COMP%]   .tree-text[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], [_nghost-%COMP%]   .tree-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}[_nghost-%COMP%]   .mat-tree-node[_ngcontent-%COMP%]{flex:1 1 auto;min-height:0}[_nghost-%COMP%]   mat-nested-tree-node[_ngcontent-%COMP%]   .childs[_ngcontent-%COMP%]{padding-left:27px}[_nghost-%COMP%]   .vitamui-sidepanel-resize-sidebar[_ngcontent-%COMP%]{border-top:4px solid #702382;height:0;padding:0;margin:0;cursor:ns-resize;flex:0 0 auto}[_nghost-%COMP%]   .vitamui-sidepanel-header[_ngcontent-%COMP%]{flex-grow:1;overflow:auto}[_nghost-%COMP%]   .tree-filing-scheme[_ngcontent-%COMP%]{flex:1;flex-direction:column;background-color:#fafafa}[_nghost-%COMP%]   .tree-filing-scheme[_ngcontent-%COMP%]   mat-nested-tree-node[_ngcontent-%COMP%], [_nghost-%COMP%]   .tree-filing-scheme[_ngcontent-%COMP%]   mat-tree-node[_ngcontent-%COMP%]{flex-direction:column}[_nghost-%COMP%]   .load-more-ua[_ngcontent-%COMP%]{cursor:pointer;color:#979797;text-decoration:underline}[_nghost-%COMP%]   .tree-title[_ngcontent-%COMP%]{flex-direction:row;justify-content:space-between;margin-top:15px;margin-bottom:15px}.filing-holding-scheme-tree-invisible[_ngcontent-%COMP%], .hide[_ngcontent-%COMP%]{display:none}.filing-holding-scheme-tree-node[_ngcontent-%COMP%]{position:relative;border-bottom:1px solid hsla(0,0%,59.2%,.3);color:var(--vitamui-secondary-dark-5);cursor:pointer}.filing-holding-scheme-tree-node[_ngcontent-%COMP%]:hover{background-color:#fafafa}.loader[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;top:0;left:0;right:0;bottom:0;background:hsla(0,0%,100%,.8)}.icon-greeny-blue[_ngcontent-%COMP%]{color:var(--vitamui-secondary)}.tree-show-link[_ngcontent-%COMP%]{cursor:pointer;color:#979797;text-decoration:underline}.badge[_ngcontent-%COMP%]{display:inline-block;padding:.25em 1.5em;font-size:100%;font-weight:700;line-height:1;position:absolute;top:14px;white-space:nowrap;vertical-align:baseline;border-radius:1.25rem;right:2px;width:54px;text-align:right}.badge-secondary[_ngcontent-%COMP%]{color:#2c76c9;background-color:#abcaed}.area-show-tree[_ngcontent-%COMP%]{padding-top:20px}.badge-parent[_ngcontent-%COMP%]{position:relative}"]}),ft);function Tt(e,t){1&e&&D.Yb(0,"mat-spinner",8)}function gt(e,t){if(1&e&&(D.dc(0,"span",14),D.Vc(1),D.qc(2,"number"),D.cc()),2&e){var i=D.pc(2).$implicit;D.Lb(1),D.Xc(" ",D.sc(2,1,i.count,"1.0")," ")}}function Lt(e,t){if(1&e){var i=D.ec();D.dc(0,"div",11),D.dc(1,"vitamui-tree-node",12),D.lc("labelClick",(function(){D.Kc(i);var e=D.pc().$implicit;return D.pc().onLabelClick(e)}))("checkboxClick",(function(){D.Kc(i);var e=D.pc().$implicit;return D.pc().addToSearchCriteriaList(e)}))("nodeToggle",(function(){D.Kc(i);var e=D.pc().$implicit;return D.pc().toggleLeave(e)})),D.cc(),D.Tc(2,gt,3,4,"span",13),D.cc()}if(2&e){var a=D.pc().$implicit,c=D.pc();D.Lb(1),D.vc("node",a)("icon",c.getNodeUnitIcon(a))("expanded",c.nestedTreeControlLeaves.isExpanded(a)),D.Lb(1),D.vc("ngIf",c.nodeHasPositiveCount(a))}}function bt(e,t){1&e&&D.Zb(0,18)}function mt(e,t){1&e&&(D.dc(0,"div"),D.Yb(1,"mat-spinner",8),D.cc())}function At(e,t){if(1&e){var i=D.ec();D.dc(0,"div"),D.dc(1,"a",19),D.lc("click",(function(){D.Kc(i);var e=D.pc(2).$implicit;return D.pc().toggleLoadMore(e)})),D.Vc(2),D.qc(3,"translate"),D.cc(),D.cc()}2&e&&(D.Lb(2),D.Xc(" ",D.rc(3,1,"COLLECT.FILING_SCHEMA.LOAD_MORE_UNITS")," "))}function St(e,t){if(1&e&&(D.dc(0,"div",15),D.Tc(1,bt,1,0,"ng-container",16),D.Tc(2,mt,2,0,"div",17),D.Tc(3,At,4,3,"div",17),D.cc()),2&e){var i=D.pc().$implicit,a=D.pc();D.Pb("filing-holding-scheme-tree-invisible",!a.nestedTreeControlLeaves.isExpanded(i)),D.Lb(1),D.vc("ngIf",a.nestedTreeControlLeaves.isExpanded(i)),D.Lb(1),D.vc("ngIf",i.isLoadingChildren),D.Lb(1),D.vc("ngIf",a.canLoadMoreUAForNode(i)&&a.nestedTreeControlLeaves.isExpanded(i))}}function _t(e,t){if(1&e&&(D.dc(0,"mat-nested-tree-node"),D.Tc(1,Lt,3,4,"div",9),D.Tc(2,St,4,5,"div",10),D.cc()),2&e){var i=t.$implicit,a=D.pc();D.Lb(1),D.vc("ngIf",a.nodeHasResultOrShowAll(i)),D.Lb(1),D.vc("ngIf",a.nodeHasResultOrShowAll(i))}}function Ot(e,t){if(1&e&&(D.dc(0,"span",14),D.Vc(1),D.qc(2,"number"),D.cc()),2&e){var i=D.pc(2).$implicit;D.Lb(1),D.Xc(" ",D.sc(2,1,i.count,"1.0")," ")}}function yt(e,t){if(1&e){var i=D.ec();D.dc(0,"div",11),D.dc(1,"div",1),D.dc(2,"vitamui-tree-node",20),D.lc("labelClick",(function(){D.Kc(i);var e=D.pc().$implicit;return D.pc().onLabelClick(e)}))("checkboxClick",(function(){D.Kc(i);var e=D.pc().$implicit;return D.pc().addToSearchCriteriaList(e)}))("nodeToggle",(function(){D.Kc(i);var e=D.pc().$implicit;return D.pc().nestedTreeControlLeaves.toggle(e)})),D.cc(),D.cc(),D.Tc(3,Ot,3,4,"span",13),D.cc()}if(2&e){var a=D.pc().$implicit,c=D.pc();D.Lb(2),D.vc("node",a)("icon",c.getNodeUnitIcon(a)),D.Lb(1),D.vc("ngIf",c.nodeHasPositiveCount(a))}}function Nt(e,t){if(1&e&&(D.dc(0,"mat-tree-node"),D.Tc(1,yt,4,3,"div",9),D.cc()),2&e){var i=t.$implicit,a=D.pc();D.Lb(1),D.vc("ngIf",a.nodeHasResultOrShowAll(i))}}function Ft(e,t){if(1&e&&(D.dc(0,"span",23),D.Vc(1),D.qc(2,"number"),D.cc()),2&e){var i=D.pc(2).$implicit;D.Lb(1),D.Xc(" ",D.sc(2,1,i.count,"1.0")," ")}}function Dt(e,t){if(1&e){var i=D.ec();D.dc(0,"div",11),D.dc(1,"vitamui-tree-node",21),D.lc("checkboxClick",(function(){D.Kc(i);var e=D.pc().$implicit;return D.pc().addToSearchCriteriaList(e)}))("nodeToggle",(function(){D.Kc(i);var e=D.pc().$implicit;return D.pc().toggleOrphansNode(e)})),D.cc(),D.Tc(2,Ft,3,4,"span",22),D.cc()}if(2&e){var a=D.pc().$implicit,c=D.pc();D.Lb(1),D.vc("node",a)("expanded",c.nestedTreeControlLeaves.isExpanded(a)),D.Lb(1),D.vc("ngIf",c.nodeHasPositiveCount(a))}}function Ut(e,t){1&e&&D.Zb(0,18)}function kt(e,t){1&e&&(D.dc(0,"div"),D.Yb(1,"mat-spinner",8),D.cc())}function Pt(e,t){if(1&e){var i=D.ec();D.dc(0,"div"),D.dc(1,"a",19),D.lc("click",(function(){D.Kc(i);var e=D.pc(2).$implicit;return D.pc().toggleLoadMoreOrphans(e)})),D.Vc(2),D.qc(3,"translate"),D.cc(),D.cc()}2&e&&(D.Lb(2),D.Xc(" ",D.rc(3,1,"ARCHIVE_SEARCH.FILING_SCHEMA.LOAD_MORE_UNITS")," "))}function xt(e,t){if(1&e&&(D.dc(0,"div",15),D.Tc(1,Ut,1,0,"ng-container",16),D.Tc(2,kt,2,0,"div",17),D.Tc(3,Pt,4,3,"div",17),D.cc()),2&e){var i=D.pc().$implicit,a=D.pc();D.Pb("filing-holding-scheme-tree-invisible",!a.nestedTreeControlLeaves.isExpanded(i)),D.Lb(1),D.vc("ngIf",a.nestedTreeControlLeaves.isExpanded(i)),D.Lb(1),D.vc("ngIf",i.isLoadingChildren),D.Lb(1),D.vc("ngIf",a.canLoadMoreUAForNode(i)&&a.nestedTreeControlLeaves.isExpanded(i))}}function wt(e,t){if(1&e&&(D.dc(0,"mat-nested-tree-node"),D.Tc(1,Dt,3,3,"div",9),D.Tc(2,xt,4,5,"div",10),D.cc()),2&e){var i=t.$implicit,a=D.pc();D.Lb(1),D.vc("ngIf",a.nodeHasResultOrShowAll(i)),D.Lb(1),D.vc("ngIf",a.nodeHasResultOrShowAll(i))}}function Mt(e,t){if(1&e&&(D.dc(0,"span",14),D.Vc(1),D.qc(2,"number"),D.cc()),2&e){var i=D.pc(2).$implicit;D.Lb(1),D.Xc(" ",D.sc(2,1,i.count,"1.0")," ")}}function Vt(e,t){if(1&e){var i=D.ec();D.dc(0,"div",25),D.dc(1,"vitamui-tree-node",12),D.lc("labelClick",(function(){D.Kc(i);var e=D.pc().$implicit;return D.pc().onLabelClick(e)}))("checkboxClick",(function(){D.Kc(i);var e=D.pc().$implicit;return D.pc().addToSearchCriteriaList(e)}))("nodeToggle",(function(){D.Kc(i);var e=D.pc().$implicit;return D.pc().toggleLeave(e)})),D.cc(),D.Tc(2,Mt,3,4,"span",13),D.cc()}if(2&e){var a=D.pc().$implicit,c=D.pc();D.Lb(1),D.vc("node",a)("icon",c.getNodeUnitIcon(a))("expanded",c.nestedTreeControlLeaves.isExpanded(a)),D.Lb(1),D.vc("ngIf",c.nodeHasPositiveCount(a))}}function Ht(e,t){1&e&&D.Zb(0,18)}function Gt(e,t){1&e&&(D.dc(0,"div"),D.Yb(1,"mat-spinner",8),D.cc())}function qt(e,t){if(1&e){var i=D.ec();D.dc(0,"div"),D.dc(1,"a",19),D.lc("click",(function(){D.Kc(i);var e=D.pc(2).$implicit;return D.pc().toggleLoadMore(e)})),D.Vc(2),D.qc(3,"translate"),D.cc(),D.cc()}2&e&&(D.Lb(2),D.Xc(" ",D.rc(3,1,"COLLECT.FILING_SCHEMA.LOAD_MORE_UNITS")," "))}function Bt(e,t){if(1&e&&(D.dc(0,"div",15),D.Tc(1,Ht,1,0,"ng-container",16),D.Tc(2,Gt,2,0,"div",17),D.Tc(3,qt,4,3,"div",17),D.cc()),2&e){var i=D.pc().$implicit,a=D.pc();D.Pb("filing-holding-scheme-tree-invisible",!a.nestedTreeControlLeaves.isExpanded(i)),D.Lb(1),D.vc("ngIf",!i.isLoadingChilds&&a.nestedTreeControlLeaves.isExpanded(i)),D.Lb(1),D.vc("ngIf",i.isLoadingChildren),D.Lb(1),D.vc("ngIf",a.canLoadMoreUAForNode(i)&&a.nestedTreeControlLeaves.isExpanded(i))}}function Wt(e,t){if(1&e&&(D.dc(0,"mat-nested-tree-node"),D.Tc(1,Vt,3,4,"div",24),D.Tc(2,Bt,4,5,"div",10),D.cc()),2&e){var i=t.$implicit,a=D.pc();D.Lb(1),D.vc("ngIf",a.nodeHasResultOrShowAll(i)),D.Lb(1),D.vc("ngIf",a.nodeHasResultOrShowAll(i))}}var jt,Yt=((jt=function(){function e(t,i){o(this,e),this.archiveSharedDataService=t,this.archiveCollectService=i,this.DEFAULT_UNIT_PAGE_SIZE=10,this.addToSearchCriteria=new D.p,this.showNodeDetail=new D.p,this.switchView=new D.p,this.nestedTreeControlLeaves=new at.j((function(e){return e.children})),this.showEveryNodes=!0,this.showFacetsCount=!0,this.subscriptions=new L.a,this.leavesTreeService=new T.N(this.archiveCollectService)}return d(e,[{key:"ngOnInit",value:function(){this.subscribeOnSearchCriteriasUpdate()}},{key:"ngOnChanges",value:function(e){(e.nestedDataSourceLeaves||e.searchRequestResultFacets)&&(this.nestedTreeControlLeaves.dataNodes=this.nestedDataSourceLeaves.data,this.searchCriterias&&this.loadNodesDetailsFromFacetsIdsAndAddThem(this.nestedDataSourceLeaves.data,this.searchRequestResultFacets),e.searchRequestResultFacets&&e.searchRequestResultFacets.currentValue.length>0&&this.leavesTreeService.setSearchRequestResultFacets(e.searchRequestResultFacets.currentValue),this.refreshTreeNodes()),e.transactionId&&this.leavesTreeService.setTransactionId(this.transactionId)}},{key:"ngOnDestroy",value:function(){this.subscriptions.unsubscribe()}},{key:"addToSearchCriteriaList",value:function(e){this.addToSearchCriteria.emit(e)}},{key:"searchUnderNode",value:function(e){var t=this;this.leavesTreeService.searchUnderNode(e).subscribe((function(e){t.refreshTreeNodes()}))}},{key:"searchUnderNodeWithSearchCriterias",value:function(e){var t=this;this.leavesTreeService.searchUnderNodeWithSearchCriterias(e).subscribe((function(e){t.refreshTreeNodes()}))}},{key:"searchAtNodeWithSearchCriterias",value:function(e){var t=this;this.leavesTreeService.searchAtNodeWithSearchCriterias(e).subscribe((function(e){t.refreshTreeNodes()}))}},{key:"searchOrphans",value:function(e){var t=this;this.leavesTreeService.searchOrphans(e).subscribe((function(e){t.refreshTreeNodes()}))}},{key:"searchOrphansWithSearchCriterias",value:function(e){var t=this;this.leavesTreeService.searchOrphansWithSearchCriterias(e).subscribe((function(e){t.refreshTreeNodes()}))}},{key:"loadNodesDetailsFromFacetsIdsAndAddThem",value:function(e,t){var i=this;this.leavesTreeService.loadNodesDetailsFromFacetsIdsAndAddThem(e,t).subscribe((function(e){i.refreshTreeNodes()}))}},{key:"refreshTreeNodes",value:function(){var e=this.nestedDataSourceLeaves.data;this.nestedDataSourceLeaves.data=null,this.nestedDataSourceLeaves.data=e}},{key:"firstToggle",value:function(e){return this.leavesTreeService.firstToggle(e)}},{key:"toggleOrphansNode",value:function(e){var t=this.nestedTreeControlLeaves.isExpanded(e);this.nestedTreeControlLeaves.toggle(e),t||this.firstToggle(e)&&(this.searchOrphans(e),this.searchOrphansWithSearchCriterias(e))}},{key:"toggleLeave",value:function(e){var t=this.nestedTreeControlLeaves.isExpanded(e);this.nestedTreeControlLeaves.toggle(e),t||this.firstToggle(e)&&(this.searchUnderNodeWithSearchCriterias(e),this.searchUnderNode(e),this.searchAtNodeWithSearchCriterias(e))}},{key:"toggleLoadMoreOrphans",value:function(e){this.nestedTreeControlLeaves.isExpanded(e)&&(this.searchOrphans(e),this.searchOrphansWithSearchCriterias(e))}},{key:"toggleLoadMore",value:function(e){this.nestedTreeControlLeaves.isExpanded(e)&&(this.searchUnderNodeWithSearchCriterias(e),this.searchUnderNode(e))}},{key:"canLoadMoreUAForNode",value:function(e){return!e.isLoadingChildren&&(this.showEveryNodes&&e.canLoadMoreChildren||!this.showEveryNodes&&e.canLoadMoreMatchingChildren)}},{key:"nodeIsUAWithChildren",value:function(e,t){return t.unitType===T.kb.INGEST&&t.descriptionLevel!==T.y.ITEM}},{key:"nodeIsUAWithoutChildren",value:function(e,t){return t.unitType===T.kb.INGEST&&t.descriptionLevel===T.y.ITEM}},{key:"nodeIsOrphansNode",value:function(e,t){return T.H.isOrphansNode(t)}},{key:"nodeHasPositiveCount",value:function(e){return e.count&&e.count>0}},{key:"nodeHasResultOrShowAll",value:function(e){return this.nodeHasPositiveCount(e)||this.showEveryNodes}},{key:"onLabelClick",value:function(e){this.showNodeDetail.emit(new ct(e.vitamId,e.id===e.vitamId))}},{key:"switchViewAllNodes",value:function(){this.showEveryNodes=!this.showEveryNodes}},{key:"getNodeUnitIcon",value:function(e){return Object(T.yb)(e)}},{key:"subscribeOnSearchCriteriasUpdate",value:function(){var e=this;this.subscriptions.add(this.archiveSharedDataService.getSearchCriterias().subscribe((function(t){e.leavesTreeService.setSearchCriterias(t),e.searchCriterias=t})))}}]),e}()).\u0275fac=function(e){return new(e||jt)(D.Xb(Le),D.Xb(re))},jt.\u0275cmp=D.Rb({type:jt,selectors:[["app-leaves-tree"]],inputs:{loadingNodeUnit:"loadingNodeUnit",transactionId:"transactionId",nestedDataSourceLeaves:"nestedDataSourceLeaves",searchRequestResultFacets:"searchRequestResultFacets",searchRequestTotalResults:"searchRequestTotalResults"},outputs:{addToSearchCriteria:"addToSearchCriteria",showNodeDetail:"showNodeDetail",switchView:"switchView"},features:[D.Jb],decls:13,vars:9,consts:[[1,"flex-row"],[1,"tree-text"],[1,"tree-title"],["diameter","20","color","accent",4,"ngIf"],[1,"tree-filing-scheme"],[1,"filing-holding-scheme-tree",3,"dataSource","treeControl"],[4,"matTreeNodeDef","matTreeNodeDefWhen"],[4,"matTreeNodeDef"],["diameter","20","color","accent"],["class","mat-tree-node filing-holding-scheme-tree-node flex-row",4,"ngIf"],["class","flex-column childs",3,"filing-holding-scheme-tree-invisible",4,"ngIf"],[1,"mat-tree-node","filing-holding-scheme-tree-node","flex-row"],[3,"node","icon","expanded","labelClick","checkboxClick","nodeToggle"],["class","badge badge-secondary pad",4,"ngIf"],[1,"badge","badge-secondary","pad"],[1,"flex-column","childs"],["matTreeNodeOutlet","",4,"ngIf"],[4,"ngIf"],["matTreeNodeOutlet",""],[1,"load-more-ua",3,"click"],["disabled","",3,"node","icon","labelClick","checkboxClick","nodeToggle"],[3,"node","expanded","checkboxClick","nodeToggle"],["class","badge badge-primary pad",4,"ngIf"],[1,"badge","badge-primary","pad"],["class","mat-tree-node filing-holding-scheme-tree-node",4,"ngIf"],[1,"mat-tree-node","filing-holding-scheme-tree-node"]],template:function(e,t){1&e&&(D.dc(0,"div",0),D.dc(1,"div",1),D.dc(2,"div",2),D.dc(3,"span"),D.Vc(4),D.qc(5,"translate"),D.cc(),D.Tc(6,Tt,1,0,"mat-spinner",3),D.cc(),D.cc(),D.cc(),D.dc(7,"div",4),D.dc(8,"mat-tree",5),D.Tc(9,_t,3,2,"mat-nested-tree-node",6),D.Tc(10,Nt,2,1,"mat-tree-node",6),D.Tc(11,wt,3,2,"mat-nested-tree-node",6),D.Tc(12,Wt,3,2,"mat-nested-tree-node",7),D.cc(),D.cc()),2&e&&(D.Lb(4),D.Wc(D.rc(5,7,"COLLECT.FILING_SCHEMA.TREE_LEAVES_TITLE")),D.Lb(2),D.vc("ngIf",0==t.nestedDataSourceLeaves.data.length),D.Lb(2),D.vc("dataSource",t.nestedDataSourceLeaves)("treeControl",t.nestedTreeControlLeaves),D.Lb(1),D.vc("matTreeNodeDefWhen",t.nodeIsUAWithChildren),D.Lb(1),D.vc("matTreeNodeDefWhen",t.nodeIsUAWithoutChildren),D.Lb(1),D.vc("matTreeNodeDefWhen",t.nodeIsOrphansNode))},directives:[l.p,I.b,I.f,E.b,I.a,T.pb,I.g,I.e],pipes:[P.d,l.f],styles:["[_nghost-%COMP%], [_nghost-%COMP%]   div[_ngcontent-%COMP%], [_nghost-%COMP%]   mat-nested-tree-node[_ngcontent-%COMP%], [_nghost-%COMP%]   mat-tree[_ngcontent-%COMP%], [_nghost-%COMP%]   mat-tree-node[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start;align-items:flex-start;width:100%}[_nghost-%COMP%]   .tree-text[_ngcontent-%COMP%]{flex:1;min-width:0}[_nghost-%COMP%]   .tree-text[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], [_nghost-%COMP%]   .tree-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}[_nghost-%COMP%]   .mat-tree-node[_ngcontent-%COMP%]{flex:1 1 auto;min-height:0}[_nghost-%COMP%]   mat-nested-tree-node[_ngcontent-%COMP%]   .childs[_ngcontent-%COMP%]{padding-left:27px}[_nghost-%COMP%]   .vitamui-sidepanel-resize-sidebar[_ngcontent-%COMP%]{border-top:4px solid #702382;height:0;padding:0;margin:0;cursor:ns-resize;flex:0 0 auto}[_nghost-%COMP%]   .vitamui-sidepanel-header[_ngcontent-%COMP%]{flex-grow:1;overflow:auto;position:relative}[_nghost-%COMP%]   .tree-filing-scheme[_ngcontent-%COMP%]{flex:1;flex-direction:column}[_nghost-%COMP%]   .tree-filing-scheme[_ngcontent-%COMP%]   mat-nested-tree-node[_ngcontent-%COMP%], [_nghost-%COMP%]   .tree-filing-scheme[_ngcontent-%COMP%]   mat-tree-node[_ngcontent-%COMP%]{flex-direction:column}[_nghost-%COMP%]   .load-more-ua[_ngcontent-%COMP%]{cursor:pointer;color:#205692;text-decoration:underline}[_nghost-%COMP%]   .tree-title[_ngcontent-%COMP%]{flex-direction:row;justify-content:space-between;margin-top:15px;margin-bottom:15px}.filing-holding-scheme-tree-invisible[_ngcontent-%COMP%]{display:none}.filing-holding-scheme-tree-node[_ngcontent-%COMP%]{position:relative;border-bottom:1px solid hsla(0,0%,59.2%,.3);color:var(--vitamui-secondary-dark-5);cursor:pointer}.filing-holding-scheme-tree-node[_ngcontent-%COMP%]:hover{background-color:#fafafa}.loader[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;top:0;left:0;right:0;bottom:0;background:hsla(0,0%,100%,.8)}.icon-greeny-blue[_ngcontent-%COMP%]{color:var(--vitamui-secondary)}.tree-show-link[_ngcontent-%COMP%]{cursor:pointer;color:#979797;text-decoration:underline}.badge[_ngcontent-%COMP%]{display:inline-block;padding:.25em 0;font-size:100%;font-weight:700;line-height:1;position:absolute;top:11px;right:2px;white-space:nowrap;vertical-align:baseline;border-radius:1.25rem;width:54px;text-align:center}.badge-primary[_ngcontent-%COMP%]{color:#9c31b5;background-color:#e6c3ef}.badge-secondary[_ngcontent-%COMP%]{color:#2c76c9;background-color:#abcaed}.area-show-tree[_ngcontent-%COMP%]{padding-top:20px}.badge-parent[_ngcontent-%COMP%]{position:relative}"]}),jt);function Xt(e,t){1&e&&D.Yb(0,"div",4)}function Kt(e,t){if(1&e){var i=D.ec();D.dc(0,"div",5),D.dc(1,"app-leaves-tree",6),D.lc("addToSearchCriteria",(function(e){return D.Kc(i),D.pc().addToSearchCriteria(e)}))("showNodeDetail",(function(e){return D.Kc(i),D.pc().fetchUaFromNodeAndShowDetails(e,"LEAVE")})),D.cc(),D.cc()}if(2&e){var a=D.pc();D.Lb(1),D.vc("transactionId",a.transactionId)("nestedDataSourceLeaves",a.nestedDataSourceLeaves)("searchRequestResultFacets",a.requestResultFacets)("searchRequestTotalResults",a.searchRequestTotalResults)}}var zt,Zt,$t,Qt=((zt=function(){function e(t,i,a,c){o(this,e),this.translateService=t,this.archiveService=i,this.startupService=a,this.archiveSharedDataService=c,this.searchHasMatches=!1,this.showArchiveUnitDetails=new D.p,this.switchView=new D.p,this.subscriptions=new L.a,this.nestedTreeControlFull=new at.j((function(e){return e.children})),this.nestedDataSourceFull=new I.d,this.nestedDataSourceLeaves=new I.d,this.attachmentNodes=[],this.loadingHolding=!0,this.fullNodes=[],this.showEveryNodes=!0,this.loadingArchiveUnit={TREE:!1,LEAVE:!1},this.filingPlanLoaded=!1,this.attachmentUnitsLoaded=!1,this.tenantIdentifier=this.startupService.getTenantIdentifier()}return d(e,[{key:"ngOnInit",value:function(){this.nestedDataSourceLeaves.data=[],this.subscribeOnTotalResultsChange(),this.subscribeOnNodeSelectionToSetCheck(),this.subscribeOnFacetsChanges(),this.loadFilingHoldingSchemeTree(),this.loadAttachementUnits()}},{key:"ngOnChanges",value:function(e){}},{key:"ngOnDestroy",value:function(){this.subscriptions.unsubscribe()}},{key:"subscribeOnNodeSelectionToSetCheck",value:function(){var e=this;this.subscriptions.add(this.archiveSharedDataService.getNodesTarget().subscribe((function(t){null==t?e.switchViewAllNodes():(T.H.foundNodeAndSetCheck(e.nestedDataSourceFull.data,!1,t),T.H.foundNodeAndSetCheck(e.nestedDataSourceLeaves.data,!1,t))})))}},{key:"subscribeOnFacetsChanges",value:function(){var e=this;this.subscriptions.add(this.archiveSharedDataService.getFacets().subscribe((function(t){e.requestResultFacets=t,e.filingPlanLoaded&&e.attachmentUnitsLoaded&&(e.nestedDataSourceLeaves.data=i(e.attachmentNodes),e.searchRequestTotalResults>0&&Object(N.b)(e.attachmentNodes)&&T.H.addOrphansNodeFromTree(e.nestedDataSourceLeaves.data,e.translateService.instant("ARCHIVE_SEARCH.FILING_SCHEMA.ORPHANS_NODE"),e.searchRequestTotalResults))})))}},{key:"addToSearchCriteria",value:function(e){this.nodeData={id:e.id,title:e.title,checked:e.checked,count:e.count},T.H.foundNodeAndSetCheck(this.nestedDataSourceFull.data,e.checked,e.id),T.H.foundNodeAndSetCheck(this.nestedDataSourceLeaves.data,e.checked,e.id),this.archiveSharedDataService.emitNode(this.nodeData)}},{key:"loadAttachementUnits",value:function(){var e=this,t={criteria:"Title",sorting:T.z.ASCENDANT},i={criteriaList:Array.of({criteria:"#management.UpdateOperation.SystemId",values:[{id:"true",value:"true"}],category:T.Z.FIELDS,operator:T.v.EXISTS,dataType:T.u.STRING}),pageNumber:0,size:100,sortingCriteria:t,trackTotalHits:!1,computeFacets:!1};this.archiveService.searchArchiveUnitsByCriteria(i,this.transactionId).subscribe((function(t){e.attachmentUnits=t.results,e.attachmentUnitsLoaded=!0,e.setAttachmentNodes()}))}},{key:"setAttachmentNodes",value:function(){if(!Object(N.b)(this.fullNodes)&&!Object(N.b)(this.attachmentUnits)){this.attachmentNodes=[];var e,i=t(this.attachmentUnits);try{for(i.s();!(e=i.n()).done;){var a=e.value,c=T.H.foundNode(this.fullNodes,a["#management"].UpdateOperation.SystemId),r=T.H.convertUnitToNode(a);r.vitamId=c.id,r.title=c.title,r.unitType=c.unitType,r.hasObject=c.hasObject,this.attachmentNodes.push(r)}}catch(n){i.e(n)}finally{i.f()}}}},{key:"loadFilingHoldingSchemeTree",value:function(){var e=this;this.loadingHolding=!0,this.archiveService.loadFilingHoldingSchemeTree(this.tenantIdentifier).subscribe((function(t){e.disableNodesRecursive(t),e.fullNodes=t,e.filingPlanLoaded=!0,e.nestedDataSourceFull.data=t,e.nestedTreeControlFull.dataNodes=t,e.archiveSharedDataService.emitFilingHoldingNodes(t),e.switchViewAllNodes(),e.setAttachmentNodes(),e.loadingHolding=!1}))}},{key:"disableNodesRecursive",value:function(e){var t=this;e.forEach((function(e){e.disabled=!0,e.children&&t.disableNodesRecursive(e.children)}))}},{key:"switchViewAllNodes",value:function(){this.showEveryNodes=!this.showEveryNodes}},{key:"emitClose",value:function(){this.archiveSharedDataService.emitToggle(!1)}},{key:"fetchUaFromNodeAndShowDetails",value:function(e,t){var i=this;this.loadingArchiveUnit[t]=!0,this.subscriptions.add(Boolean(e.value)?this.archiveService.getCollectUnitDetails(e.key.toString()).subscribe((function(e){i.showArchiveUnitDetails.emit(e),i.loadingArchiveUnit[""+t]=!1})):this.archiveService.getReferentialUnitDetails(e.key.toString()).subscribe((function(e){i.showArchiveUnitDetails.emit(e.$results[0]),i.loadingArchiveUnit[""+t]=!1})))}},{key:"subscribeOnTotalResultsChange",value:function(){var e=this;this.subscriptions.add(this.archiveSharedDataService.getTotalResults().subscribe((function(t){e.searchRequestTotalResults=t,1===e.nestedDataSourceLeaves.data.length&&e.nestedDataSourceLeaves.data[0].count+1!==t&&(e.nestedDataSourceLeaves.data[0].count=t)})))}}]),e}()).\u0275fac=function(e){return new(e||zt)(D.Xb(P.e),D.Xb(re),D.Xb(T.db),D.Xb(Le))},zt.\u0275cmp=D.Rb({type:zt,selectors:[["app-filing-holding-scheme"]],inputs:{transactionId:"transactionId",searchHasMatches:"searchHasMatches",searchRequestTotalResults:"searchRequestTotalResults"},outputs:{showArchiveUnitDetails:"showArchiveUnitDetails",switchView:"switchView"},features:[D.Jb],decls:4,vars:8,consts:[[1,"vitamui-sidepanel-header"],[3,"hasMatchesInSearch","loadingHolding","nestedDataSourceFull","nestedTreeControlFull","showEveryNodes","loadingNodeUnit","closePanel","showNodeDetail","switchView"],["vitamuiVerticalResizeSidebar","top",4,"ngIf"],["class","vitamui-sidepanel-header flex-column",4,"ngIf"],["vitamuiVerticalResizeSidebar","top"],[1,"vitamui-sidepanel-header","flex-column"],[3,"transactionId","nestedDataSourceLeaves","searchRequestResultFacets","searchRequestTotalResults","addToSearchCriteria","showNodeDetail"]],template:function(e,t){1&e&&(D.dc(0,"div",0),D.dc(1,"app-classification-tree",1),D.lc("closePanel",(function(){return t.emitClose()}))("showNodeDetail",(function(e){return t.fetchUaFromNodeAndShowDetails(e,"TREE")}))("switchView",(function(){return t.switchViewAllNodes()})),D.cc(),D.cc(),D.Tc(2,Xt,1,0,"div",2),D.Tc(3,Kt,2,4,"div",3)),2&e&&(D.Lb(1),D.vc("hasMatchesInSearch",!0)("loadingHolding",t.loadingHolding)("nestedDataSourceFull",t.nestedDataSourceFull)("nestedTreeControlFull",t.nestedTreeControlFull)("showEveryNodes",!0)("loadingNodeUnit",t.loadingArchiveUnit.TREE),D.Lb(1),D.vc("ngIf",t.searchHasMatches),D.Lb(1),D.vc("ngIf",t.searchHasMatches))},directives:[It,l.p,T.Pb,Yt],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%;background:#fff;margin:0;padding:72px 0 0}[_nghost-%COMP%]   div[_ngcontent-%COMP%], [_nghost-%COMP%]   mat-nested-tree-node[_ngcontent-%COMP%], [_nghost-%COMP%]   mat-tree[_ngcontent-%COMP%], [_nghost-%COMP%]   mat-tree-node[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start;align-items:flex-start;width:100%}[_nghost-%COMP%]   .tree-text[_ngcontent-%COMP%]{flex:1;min-width:0}[_nghost-%COMP%]   .tree-text[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], [_nghost-%COMP%]   .tree-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}[_nghost-%COMP%]   .mat-tree-node[_ngcontent-%COMP%]{flex:1 1 auto;min-height:0}[_nghost-%COMP%]   mat-nested-tree-node[_ngcontent-%COMP%]   .childs[_ngcontent-%COMP%]{padding-left:27px}[_nghost-%COMP%]   .vitamui-sidepanel-resize-sidebar[_ngcontent-%COMP%]{border-top:4px solid #702382;height:0;padding:0;margin:0;cursor:ns-resize;flex:0 0 auto}[_nghost-%COMP%]   .vitamui-sidepanel-header[_ngcontent-%COMP%]{flex-grow:1;overflow:auto}[_nghost-%COMP%]   .tree-filing-scheme[_ngcontent-%COMP%]{flex:1;flex-direction:column;background-color:#fafafa}[_nghost-%COMP%]   .tree-filing-scheme[_ngcontent-%COMP%]   mat-nested-tree-node[_ngcontent-%COMP%], [_nghost-%COMP%]   .tree-filing-scheme[_ngcontent-%COMP%]   mat-tree-node[_ngcontent-%COMP%]{flex-direction:column}[_nghost-%COMP%]   .load-more-ua[_ngcontent-%COMP%]{cursor:pointer;color:#979797;text-decoration:underline}.filing-holding-scheme-tree-invisible[_ngcontent-%COMP%], .hide[_ngcontent-%COMP%]{display:none}.filing-holding-scheme-tree-node[_ngcontent-%COMP%]{position:relative;border-bottom:1px solid hsla(0,0%,59.2%,.3);color:var(--vitamui-secondary-dark-5);cursor:pointer}.filing-holding-scheme-tree-node[_ngcontent-%COMP%]:hover{background-color:#fafafa}.loader[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;top:0;left:0;right:0;bottom:0;background:hsla(0,0%,100%,.8)}.icon-greeny-blue[_ngcontent-%COMP%]{color:var(--vitamui-secondary)}.tree-show-link[_ngcontent-%COMP%]{cursor:pointer;color:#979797;text-decoration:underline}.badge[_ngcontent-%COMP%]{display:inline-block;padding:.25em 1.5em;font-size:100%;font-weight:700;line-height:1;position:absolute;top:14px;white-space:nowrap;vertical-align:baseline;border-radius:1.25rem;right:2px;width:54px;text-align:right}.badge-secondary[_ngcontent-%COMP%]{color:#2c76c9;background-color:#abcaed}.area-show-tree[_ngcontent-%COMP%]{padding-top:20px}.badge-parent[_ngcontent-%COMP%]{position:relative}"]}),zt),Jt=n("D57K"),ei=n("TLy2"),ti=n("xVbo"),ii=(($t=function(e){function t(e,i){return o(this,t),r(this,t,[e,i])}return s(t,e),d(t,[{key:"asyncPartialUpdateArchiveUnits",value:function(e,t,i){return this.http.patch("".concat(this.apiUrl,"/archive-units/").concat(e),t,{headers:i})}},{key:"asyncPartialUpdateArchiveUnitByCommands",value:function(e,t,i){return this.http.patch("".concat(this.apiUrl,"/archive-units/").concat(e,"/update/single"),t,{headers:i})}},{key:"asyncPartialUpdateArchiveUnitsByCommands",value:function(e,t,i){return this.http.patch("".concat(this.apiUrl,"/archive-units/").concat(e,"/update/multiple"),t,{headers:i})}}]),t}(T.o)).\u0275fac=function(e){return new(e||$t)(D.ic(F.c),D.ic(T.n))},$t.\u0275prov=D.Tb({token:$t,factory:$t.\u0275fac,providedIn:"root"}),$t),ai=((Zt=function(){function e(t){o(this,e),this.archiveUnitApiService=t}return d(e,[{key:"asyncPartialUpdateArchiveUnits",value:function(e,t,i){return this.archiveUnitApiService.asyncPartialUpdateArchiveUnits(e,t,i)}},{key:"asyncPartialUpdateArchiveUnitByCommands",value:function(e,t,i){return this.archiveUnitApiService.asyncPartialUpdateArchiveUnitByCommands(e,t,i)}},{key:"asyncPartialUpdateArchiveUnitsByCommands",value:function(e,t,i){return this.archiveUnitApiService.asyncPartialUpdateArchiveUnitsByCommands(e,t,i)}}]),e}()).\u0275fac=function(e){return new(e||Zt)(D.ic(ii))},Zt.\u0275prov=D.Tb({token:Zt,factory:Zt.\u0275fac,providedIn:"root"}),Zt),ci=["savingOK"],ri=["updateDialog"],ni=["cancelDialog"];function si(e,t){if(1&e&&D.Yb(0,"vitamui-common-archive-unit-viewer",5),2&e){var i=D.pc();D.vc("data",i.archiveUnit)}}var li=function(){return{sedaVersion:"2.2"}};function oi(e,t){if(1&e){var i=D.ec();D.dc(0,"div"),D.dc(1,"vitamui-common-editor-banner",6),D.qc(2,"translate"),D.dc(3,"button",7),D.lc("click",(function(){return D.Kc(i),D.pc().onSave()})),D.Vc(4),D.qc(5,"translate"),D.cc(),D.dc(6,"button",8),D.lc("click",(function(){return D.Kc(i),D.pc().onCancel()})),D.Vc(7),D.qc(8,"translate"),D.cc(),D.cc(),D.Yb(9,"vitamui-common-archive-unit-editor",5),D.cc()}if(2&e){var a=D.pc();D.Lb(1),D.vc("title",D.sc(2,5,"ARCHIVE_UNIT.EDITOR_BANNER.TITLE",D.zc(12,li))),D.Lb(2),D.vc("disabled",!a.isModified()),D.Lb(1),D.Xc(" ",D.rc(5,8,"COMMON.SAVE")," "),D.Lb(3),D.Xc(" ",D.rc(8,10,"COMMON.UNDO")," "),D.Lb(2),D.vc("data",a.archiveUnit)}}function ui(e,t){if(1&e){var i=D.ec();D.dc(0,"div",9),D.dc(1,"span",10),D.Vc(2),D.qc(3,"translate"),D.cc(),D.dc(4,"button",11),D.lc("click",(function(){return D.Kc(i),D.pc().snackBarRef.dismiss()})),D.dc(5,"i",12),D.Vc(6,"clear"),D.cc(),D.cc(),D.cc()}2&e&&(D.Lb(2),D.Wc(D.rc(3,1,"ARCHIVE_UNIT.DIALOGS.SAVE.MESSAGES.SUCCESS")))}function di(e,t){if(1&e&&(D.dc(0,"mat-dialog-content"),D.dc(1,"div",13),D.Vc(2),D.qc(3,"translate"),D.cc(),D.dc(4,"div",14),D.Vc(5),D.qc(6,"translate"),D.cc(),D.cc(),D.Yb(7,"br"),D.dc(8,"mat-dialog-actions"),D.dc(9,"button",15),D.Vc(10),D.qc(11,"translate"),D.cc(),D.dc(12,"button",16),D.Vc(13),D.qc(14,"translate"),D.cc(),D.cc()),2&e){var i=D.pc();D.Lb(2),D.Xc(" ",D.rc(3,6,"ARCHIVE_UNIT.DIALOGS.SAVE.TITLE")," "),D.Lb(3),D.Xc(" ",D.rc(6,8,"ARCHIVE_UNIT.DIALOGS.SAVE.CONTENT")," "),D.Lb(4),D.vc("matDialogClose",!0)("disabled",!i.isModified()),D.Lb(1),D.Xc(" ",D.rc(11,10,"ARCHIVE_UNIT.DIALOGS.SAVE.BUTTONS.CONFIRM")," "),D.Lb(3),D.Wc(D.rc(14,12,"ARCHIVE_UNIT.DIALOGS.SAVE.BUTTONS.CANCEL"))}}function hi(e,t){if(1&e&&(D.dc(0,"mat-dialog-content"),D.dc(1,"div",13),D.Vc(2),D.qc(3,"translate"),D.cc(),D.dc(4,"div",14),D.Vc(5),D.qc(6,"translate"),D.cc(),D.cc(),D.Yb(7,"br"),D.dc(8,"mat-dialog-actions"),D.dc(9,"button",15),D.Vc(10),D.qc(11,"translate"),D.cc(),D.dc(12,"button",16),D.Vc(13),D.qc(14,"translate"),D.cc(),D.cc()),2&e){var i=D.pc();D.Lb(2),D.Xc(" ",D.rc(3,6,"ARCHIVE_UNIT.DIALOGS.CANCEL.TITLE")," "),D.Lb(3),D.Xc(" ",D.rc(6,8,"ARCHIVE_UNIT.DIALOGS.CANCEL.CONTENT")," "),D.Lb(4),D.vc("matDialogClose",!0)("disabled",!i.isModified()),D.Lb(1),D.Xc(" ",D.rc(11,10,"ARCHIVE_UNIT.DIALOGS.CANCEL.BUTTONS.CONFIRM")," "),D.Lb(3),D.Wc(D.rc(14,12,"ARCHIVE_UNIT.DIALOGS.CANCEL.BUTTONS.CANCEL"))}}var vi,Ci=((vi=function(){function t(e,i,a,c){o(this,t),this.dialog=e,this.archiveUnitService=i,this.snackBar=a,this.spinnerOverlayService=c,this.editMode=!1,this.editModeChange=new D.p,this.subscriptions=new L.a,this.dialogConfig={panelClass:"vitamui-dialog"},this.snackBarConfig={panelClass:"vitamui-snack-bar",duration:1e4}}return d(t,[{key:"ngOnDestroy",value:function(){this.subscriptions.unsubscribe()}},{key:"editor",set:function(e){var t,i=this;if(e){this.archiveUnitEditor=e;var a=null===(t=this.archiveUnitEditor)||void 0===t?void 0:t.editObject$.subscribe((function(e){i.editObject=e}));a&&this.subscriptions.add(a)}}},{key:"isModified",value:function(){var e,t;return this.editMode&&!(null===(t=null===(e=this.editObject)||void 0===e?void 0:e.control)||void 0===t?void 0:t.pristine)}},{key:"onCancel",value:function(){return Object(Jt.a)(this,void 0,void 0,e().mark((function t(){var i=this;return e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isModified()){e.next=5;break}return e.next=3,this.dialog.open(this.cancelDialog,this.dialogConfig).afterClosed().pipe(Object(y.a)((function(e){if(e)return i.archiveUnitEditor.getJsonPatch();throw new Error(e)})),Object(S.a)((function(){return i.spinnerOverlayService.open()})),Object(ei.a)((function(e){return i.archiveUnitService.asyncPartialUpdateArchiveUnitByCommands(i.transactionId,e)}))).toPromise().then((function(){return i.handleUpdateSuccess()})).catch((function(){return i.backToDisplayMode()}));case 3:e.next=6;break;case 5:this.backToDisplayMode();case 6:case"end":return e.stop()}}),t,this)})))}},{key:"onSave",value:function(){var e=this;this.subscriptions.add(this.dialog.open(this.updateDialog,this.dialogConfig).afterClosed().pipe(Object(ti.a)((function(e){return!!e})),Object(y.a)((function(){return e.archiveUnitEditor.getJsonPatch()})),Object(S.a)((function(){return e.spinnerOverlayService.open()})),Object(ei.a)((function(t){return e.archiveUnitService.asyncPartialUpdateArchiveUnitByCommands(e.transactionId,t)}))).subscribe((function(){return e.handleUpdateSuccess()}),(function(){return e.spinnerOverlayService.close()})))}},{key:"handleUpdateSuccess",value:function(){this.snackBarRef=this.snackBar.openFromTemplate(this.savingOK,this.snackBarConfig),this.patchUnit(this.archiveUnit,this.archiveUnitEditor.getJsonPatch().jsonPatch),this.backToDisplayMode()}},{key:"patchUnit",value:function(e,t){t.forEach((function(t){var i=t.path;switch(t.op){case"add":case"replace":e[i]=t.value;break;case"remove":delete e[i]}}))}},{key:"backToDisplayMode",value:function(){this.spinnerOverlayService.close(),this.editMode=!1,this.editModeChange.emit(this.editMode)}}]),t}()).\u0275fac=function(e){return new(e||vi)(D.Xb(v.b),D.Xb(ai),D.Xb(k.b),D.Xb(ce.e))},vi.\u0275cmp=D.Rb({type:vi,selectors:[["app-archive-unit-description-tab"]],viewQuery:function(e,t){var i;1&e&&(D.bd(ci,!0),D.bd(ri,!0),D.bd(ni,!0),D.bd(T.j,!0)),2&e&&(D.Fc(i=D.mc())&&(t.savingOK=i.first),D.Fc(i=D.mc())&&(t.updateDialog=i.first),D.Fc(i=D.mc())&&(t.cancelDialog=i.first),D.Fc(i=D.mc())&&(t.editor=i.first))},inputs:{archiveUnit:"archiveUnit",editMode:"editMode",transactionId:"transactionId"},outputs:{editModeChange:"editModeChange"},decls:8,vars:2,consts:[[3,"data",4,"ngIf"],[4,"ngIf"],["savingOK",""],["updateDialog",""],["cancelDialog",""],[3,"data"],[1,"editor-banner",3,"title"],[1,"btn","primary","save",3,"disabled","click"],[1,"btn","primary","cancel",3,"click"],[1,"vitamui-snack-bar-container"],[1,"vitamui-snack-bar-content"],[1,"close-btn",3,"click"],[1,"material-icons"],[1,"text-title"],[1,"text","large","bold"],[1,"btn","primary","btn-confirm-dialog","margin-btn",3,"matDialogClose","disabled"],["matDialogClose","",1,"btn","link","cancel","cancel-popup"]],template:function(e,t){1&e&&(D.Tc(0,si,1,1,"vitamui-common-archive-unit-viewer",0),D.Tc(1,oi,10,13,"div",1),D.Tc(2,ui,7,3,"ng-template",null,2,D.Uc),D.Tc(4,di,15,14,"ng-template",null,3,D.Uc),D.Tc(6,hi,15,14,"ng-template",null,4,D.Uc)),2&e&&(D.vc("ngIf",!t.editMode),D.Lb(1),D.vc("ngIf",t.editMode))},directives:[l.p,T.Hb,T.D,T.j,v.f,v.c,v.d],pipes:[P.d],styles:["button.save[_ngcontent-%COMP%]{background-color:#fff;color:var(--vitamui-primary)}button.cancel[_ngcontent-%COMP%]{background-color:transparent;color:#fff;box-shadow:none;border:none}.editor-banner[_ngcontent-%COMP%]{margin-left:-40px;margin-right:-40px;position:sticky;z-index:10;top:-20px}.margin-btn[_ngcontent-%COMP%]{margin-right:1rem}"]}),vi);function Ei(e,t){if(1&e&&(D.dc(0,"span"),D.Vc(1),D.qc(2,"async"),D.cc()),2&e){var i,a=D.pc();D.Lb(1),D.Wc(null==(i=D.rc(2,1,a.uaPath$))?null:i.resumePath)}}function Ri(e,t){if(1&e&&(D.dc(0,"span"),D.Vc(1),D.qc(2,"async"),D.cc()),2&e){var i,a=D.pc();D.Lb(1),D.Wc(null==(i=D.rc(2,1,a.uaPath$))?null:i.fullPath)}}var pi,fi=((pi=function(){function e(t){o(this,e),this.archiveService=t,this.showNormalPanel=new D.p,this.fullPath=!1}return d(e,[{key:"ngOnInit",value:function(){}},{key:"ngOnChanges",value:function(e){this.fullPath=!1}},{key:"onDownloadObjectFromUnit",value:function(e){return this.archiveService.downloadObjectFromUnit(e["#id"],this.archiveUnit["#object"])}},{key:"showArchiveUniteFullPath",value:function(){this.fullPath=!0}}]),e}()).\u0275fac=function(e){return new(e||pi)(D.Xb(re))},pi.\u0275cmp=D.Rb({type:pi,selectors:[["app-archive-unit-information-tab"]],inputs:{archiveUnit:"archiveUnit"},outputs:{showNormalPanel:"showNormalPanel"},features:[D.Jb],decls:99,vars:65,consts:[[1,"row"],[1,"col-12"],[1,"read-only-field"],[1,"read-only-field","text-justify"],[1,"col-6"],["type","button",1,"ml-2","btn-show-full-path",3,"click"],[4,"ngIf"],[1,"row","content","vitamui-form","margin_right"],[1,"btn","primary","download-btn",3,"disabled","click"],[1,"vitamui-icon","vitamui-icon-deposit"]],template:function(e,t){1&e&&(D.dc(0,"div",0),D.dc(1,"div",1),D.dc(2,"div",2),D.dc(3,"label"),D.Vc(4),D.qc(5,"translate"),D.cc(),D.dc(6,"div"),D.Vc(7),D.qc(8,"unitI18n"),D.cc(),D.cc(),D.cc(),D.cc(),D.dc(9,"div",0),D.dc(10,"div",1),D.dc(11,"div",2),D.dc(12,"label"),D.Vc(13),D.qc(14,"translate"),D.cc(),D.dc(15,"div"),D.Vc(16),D.cc(),D.cc(),D.cc(),D.cc(),D.dc(17,"div",0),D.dc(18,"div",1),D.dc(19,"div",2),D.dc(20,"label"),D.Vc(21),D.qc(22,"translate"),D.cc(),D.dc(23,"div"),D.Vc(24),D.cc(),D.cc(),D.cc(),D.cc(),D.dc(25,"div",0),D.dc(26,"div",1),D.dc(27,"div",3),D.dc(28,"label"),D.Vc(29),D.qc(30,"translate"),D.cc(),D.dc(31,"div"),D.Vc(32),D.qc(33,"unitI18n"),D.cc(),D.cc(),D.cc(),D.cc(),D.dc(34,"div",0),D.dc(35,"div",4),D.dc(36,"div",2),D.dc(37,"label"),D.Vc(38),D.qc(39,"translate"),D.cc(),D.Yb(40,"br"),D.dc(41,"label"),D.Vc(42),D.qc(43,"translate"),D.cc(),D.dc(44,"div"),D.Vc(45),D.cc(),D.cc(),D.cc(),D.dc(46,"div",4),D.dc(47,"div",2),D.Yb(48,"label"),D.Yb(49,"br"),D.dc(50,"label"),D.Vc(51),D.qc(52,"translate"),D.cc(),D.dc(53,"div"),D.Vc(54),D.cc(),D.cc(),D.cc(),D.cc(),D.dc(55,"div",0),D.dc(56,"div",4),D.dc(57,"div",2),D.dc(58,"label"),D.Vc(59),D.qc(60,"translate"),D.dc(61,"button",5),D.lc("click",(function(){return t.showArchiveUniteFullPath()})),D.Vc(62),D.qc(63,"translate"),D.cc(),D.cc(),D.dc(64,"div"),D.Tc(65,Ei,3,3,"span",6),D.Tc(66,Ri,3,3,"span",6),D.cc(),D.cc(),D.cc(),D.dc(67,"div",4),D.dc(68,"div",2),D.dc(69,"label"),D.Vc(70),D.qc(71,"translate"),D.cc(),D.dc(72,"div"),D.Vc(73),D.qc(74,"translate"),D.cc(),D.cc(),D.cc(),D.cc(),D.dc(75,"div",7),D.dc(76,"div",4),D.dc(77,"div",2),D.dc(78,"label"),D.Vc(79),D.qc(80,"translate"),D.cc(),D.dc(81,"div"),D.Vc(82),D.qc(83,"dateTime"),D.cc(),D.cc(),D.cc(),D.dc(84,"div",4),D.dc(85,"div",2),D.dc(86,"label"),D.Vc(87),D.qc(88,"translate"),D.cc(),D.dc(89,"div"),D.Vc(90),D.qc(91,"dateTime"),D.cc(),D.cc(),D.cc(),D.cc(),D.dc(92,"div",0),D.dc(93,"div",1),D.dc(94,"button",8),D.lc("click",(function(){return t.onDownloadObjectFromUnit(t.archiveUnit)})),D.dc(95,"span"),D.Vc(96),D.qc(97,"translate"),D.cc(),D.Yb(98,"i",9),D.cc(),D.cc(),D.cc()),2&e&&(D.Lb(4),D.Xc("",D.rc(5,25,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.NAME")," :"),D.Lb(3),D.Xc(" ",D.sc(8,27,t.archiveUnit,"Title")," "),D.Lb(6),D.Xc("",D.rc(14,30,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.GUID")," :"),D.Lb(3),D.Xc(" ",t.archiveUnit["#opi"]," "),D.Lb(5),D.Xc("",D.rc(22,32,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.UAID")," :"),D.Lb(3),D.Xc(" ",t.archiveUnit["#id"]," "),D.Lb(5),D.Xc("",D.rc(30,34,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.DESCRIPTION")," :"),D.Lb(3),D.Xc(" ",D.sc(33,36,t.archiveUnit,"Description")," "),D.Lb(6),D.Xc("",D.rc(39,39,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.SP")," :"),D.Lb(4),D.Xc("",D.rc(43,41,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.SP_CODE")," :"),D.Lb(3),D.Xc(" ",t.archiveUnit["#originating_agency"]," "),D.Lb(6),D.Xc("",D.rc(52,43,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.SP_LABEL")," :"),D.Lb(3),D.Xc(" ",null==t.archiveUnit?null:t.archiveUnit.originating_agencyName," "),D.Lb(5),D.Xc("",D.rc(60,45,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.PATH")," : "),D.Lb(3),D.Xc(" ",D.rc(63,47,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.BTN_SHOW_COMPLETE_PATH")," "),D.Lb(3),D.vc("ngIf",!t.fullPath),D.Lb(1),D.vc("ngIf",t.fullPath),D.Lb(4),D.Xc("",D.rc(71,49,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.DESCRIPTION_LEVEL")," :"),D.Lb(3),D.Xc(" ",D.rc(74,51,"UNIT_UPDATE."+t.archiveUnit.DescriptionLevel.toUpperCase())," "),D.Lb(6),D.Xc("",D.rc(80,53,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.START_DATE")," :"),D.Lb(3),D.Xc(" ",D.sc(83,55,null==t.archiveUnit?null:t.archiveUnit.StartDate,"dd/MM/yyyy")," "),D.Lb(5),D.Xc("",D.rc(88,58,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.END_DATE")," :"),D.Lb(3),D.Xc(" ",D.sc(91,60,null==t.archiveUnit?null:t.archiveUnit.EndDate,"dd/MM/yyyy")," "),D.Lb(4),D.vc("disabled",null==t.archiveUnit["#object"]),D.Lb(2),D.Wc(D.rc(97,63,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.DOWNLOAD_DOC")))},directives:[l.p],pipes:[P.d,T.jb,T.Vb,l.b],styles:[".download-btn[_ngcontent-%COMP%]{border-radius:100px;color:#fff;font-size:14px;font-weight:700;margin:20px 20px 20px 120px}.btn-show-full-path[_ngcontent-%COMP%]{border:1px solid var(--vitamui-grey);border-radius:10px;font-size:10px}.btn-show-full-path[_ngcontent-%COMP%]:hover{background-color:var(--vitamui-grey-400);cursor:pointer}.padding-style[_ngcontent-%COMP%]{padding-top:20px}.text-title[_ngcontent-%COMP%]{font-family:Mulish;font-style:normal;font-weight:400;font-size:16px;line-height:24px;display:flex;align-items:center;color:#757575}.cancel-popup[_ngcontent-%COMP%]{padding-left:40px}.margin_right[_ngcontent-%COMP%]{margin-right:0}.btn-size[_ngcontent-%COMP%]{background-color:#e24242;position:absolute;right:16px;bottom:16px;width:30px;height:30px;border:none}.close-color[_ngcontent-%COMP%]{color:#fff}"]}),pi),Ii=n("f7+R");function Ti(e,t){if(1&e&&(D.dc(0,"div",10),D.Vc(1),D.qc(2,"dateTime"),D.cc()),2&e){var i=D.pc();D.Lb(1),D.Wc(D.sc(2,1,i.getMaxEndDate(i.unitRuleDTO),"dd/MM/yyyy"))}}function gi(e,t){if(1&e&&(D.dc(0,"div",10),D.Vc(1),D.cc()),2&e){var i=D.pc();D.Lb(1),D.Wc(i.getFinalActionValue(i.propertiesList))}}function Li(e,t){1&e&&D.Yb(0,"div",11)}function bi(e,t){if(1&e){var i=D.ec();D.dc(0,"div",12),D.dc(1,"i",2),D.lc("click",(function(){return D.Kc(i),D.pc().showListOfPropertiesBloc()})),D.Vc(2),D.cc(),D.Vc(3),D.qc(4,"translate"),D.cc()}if(2&e){var a=D.pc();D.Lb(1),D.Qc("font-size",20,"px"),D.Lb(1),D.Xc(" ",a.listOfPropertiesCollapsed?"expand_less":"expand_more"," "),D.Lb(1),D.Xc(" ",D.rc(4,4,"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.PROPERTIES"),"\n")}}function mi(e,t){1&e&&(D.dc(0,"div",12),D.dc(1,"div",15),D.Vc(2),D.qc(3,"translate"),D.cc(),D.dc(4,"div",15),D.Vc(5),D.qc(6,"translate"),D.cc(),D.dc(7,"div",15),D.Vc(8),D.qc(9,"translate"),D.cc(),D.cc()),2&e&&(D.Lb(2),D.Wc(D.rc(3,3,"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.FINAL_ACTION.PROPERTY")),D.Lb(3),D.Wc(D.rc(6,5,"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.FINAL_ACTION.VALUE")),D.Lb(3),D.Wc(D.rc(9,7,"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.FINAL_ACTION.STATUS")))}function Ai(e,t){if(1&e&&(D.dc(0,"div",18),D.dc(1,"div",19),D.dc(2,"div",20),D.Vc(3),D.cc(),D.dc(4,"div",20),D.Vc(5),D.cc(),D.dc(6,"div",20),D.Vc(7),D.cc(),D.cc(),D.cc()),2&e){var i=t.$implicit,a=D.pc(3);D.Lb(3),D.Wc(a.getPropertyName(i.PropertyName)),D.Lb(2),D.Wc(a.getPropertyValue(i.PropertyValue)),D.Lb(2),D.Wc(a.getFinalActionStatus(i))}}function Si(e,t){if(1&e&&(D.dc(0,"div",16),D.Tc(1,Ai,8,3,"div",17),D.cc()),2&e){var i=D.pc(2);D.Lb(1),D.vc("ngForOf",i.propertiesList)}}function _i(e,t){if(1&e&&(D.dc(0,"div",13),D.Tc(1,mi,10,9,"div",6),D.Tc(2,Si,2,1,"div",14),D.cc()),2&e){var i=D.pc();D.vc("@collapse",i.listOfPropertiesCollapsed),D.Lb(1),D.vc("ngIf",i.categoryHasPropertiesList),D.Lb(1),D.vc("ngIf",i.categoryHasPropertiesList)}}function Oi(e,t){if(1&e){var i=D.ec();D.dc(0,"div",12),D.dc(1,"i",2),D.lc("click",(function(){return D.Kc(i),D.pc().showListOfPropertiesBloc()})),D.Vc(2),D.cc(),D.Vc(3),D.qc(4,"translate"),D.cc()}if(2&e){var a=D.pc();D.Lb(1),D.Qc("font-size",20,"px"),D.Lb(1),D.Xc(" ",a.listOfPropertiesCollapsed?"expand_less":"expand_more"," "),D.Lb(1),D.Xc(" ",D.rc(4,4,"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.PROPERTIES"),"\n")}}function yi(e,t){1&e&&(D.dc(0,"div",12),D.dc(1,"div",21),D.Vc(2),D.qc(3,"translate"),D.cc(),D.dc(4,"div",15),D.Vc(5),D.qc(6,"translate"),D.cc(),D.dc(7,"div",22),D.Vc(8),D.qc(9,"translate"),D.cc(),D.cc()),2&e&&(D.Lb(2),D.Wc(D.rc(3,3,"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.FINAL_ACTION.PROPERTY")),D.Lb(3),D.Wc(D.rc(6,5,"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.FINAL_ACTION.VALUE")),D.Lb(3),D.Wc(D.rc(9,7,"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.FINAL_ACTION.STATUS")))}function Ni(e,t){if(1&e&&(D.dc(0,"div",18),D.dc(1,"div",19),D.dc(2,"div",24),D.Vc(3),D.cc(),D.dc(4,"div",20),D.Vc(5),D.cc(),D.dc(6,"div",25),D.Vc(7),D.cc(),D.cc(),D.dc(8,"div",19),D.dc(9,"div",24),D.Vc(10),D.cc(),D.dc(11,"div",20),D.Vc(12),D.cc(),D.dc(13,"div",25),D.Vc(14),D.cc(),D.cc(),D.dc(15,"div",19),D.dc(16,"div",24),D.Vc(17),D.cc(),D.dc(18,"div",20),D.Vc(19),D.qc(20,"yesNo"),D.cc(),D.dc(21,"div",25),D.Vc(22),D.cc(),D.cc(),D.dc(23,"div",19),D.dc(24,"div",24),D.Vc(25),D.cc(),D.dc(26,"div",20),D.Vc(27),D.cc(),D.dc(28,"div",25),D.Vc(29),D.cc(),D.cc(),D.dc(30,"div",19),D.dc(31,"div",24),D.Vc(32),D.cc(),D.dc(33,"div",20),D.Vc(34),D.cc(),D.dc(35,"div",25),D.Vc(36),D.cc(),D.cc(),D.cc()),2&e){var i=D.pc(3);D.Lb(3),D.Wc(i.getHoldAndClassificationRulePropertyName("HoldReason")),D.Lb(2),D.Wc(null==i.holdRuleDetails?null:i.holdRuleDetails.HoldReason),D.Lb(2),D.Wc(i.holdRuleStatus),D.Lb(3),D.Wc(i.getHoldAndClassificationRulePropertyName("HoldOwner")),D.Lb(2),D.Wc(null==i.holdRuleDetails?null:i.holdRuleDetails.HoldOwner),D.Lb(2),D.Wc(i.holdRuleStatus),D.Lb(3),D.Wc(i.getHoldAndClassificationRulePropertyName("PreventRearrangement")),D.Lb(2),D.Wc(D.rc(20,15,null==i.holdRuleDetails?null:i.holdRuleDetails.PreventRearrangement)),D.Lb(3),D.Wc(i.holdRuleStatus),D.Lb(3),D.Wc(i.getHoldAndClassificationRulePropertyName("HoldReassessingDate")),D.Lb(2),D.Wc(null==i.holdRuleDetails?null:i.holdRuleDetails.HoldReassessingDate),D.Lb(2),D.Wc(i.holdRuleStatus),D.Lb(3),D.Wc(i.getHoldAndClassificationRulePropertyName("HoldEndDate")),D.Lb(2),D.Wc(null==i.holdRuleDetails?null:i.holdRuleDetails.HoldEndDate),D.Lb(2),D.Wc(i.holdRuleStatus)}}function Fi(e,t){if(1&e&&(D.dc(0,"div",16),D.Tc(1,Ni,37,17,"div",23),D.cc()),2&e){var i=D.pc(2);D.Lb(1),D.vc("ngIf",i.isShowHoldRuleDetails)}}function Di(e,t){if(1&e&&(D.dc(0,"div",13),D.Tc(1,yi,10,9,"div",6),D.Tc(2,Fi,2,1,"div",14),D.cc()),2&e){var i=D.pc();D.vc("@collapse",i.listOfPropertiesCollapsed),D.Lb(1),D.vc("ngIf",i.categoryHasPropertiesList),D.Lb(1),D.vc("ngIf",i.categoryHasPropertiesList)}}function Ui(e,t){if(1&e){var i=D.ec();D.dc(0,"div",12),D.dc(1,"i",2),D.lc("click",(function(){return D.Kc(i),D.pc().showListOfPropertiesBloc()})),D.Vc(2),D.cc(),D.Vc(3),D.qc(4,"translate"),D.cc()}if(2&e){var a=D.pc();D.Lb(1),D.Qc("font-size",20,"px"),D.Lb(1),D.Xc(" ",a.listOfPropertiesCollapsed?"expand_less":"expand_more"," "),D.Lb(1),D.Xc(" ",D.rc(4,4,"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.PROPERTIES"),"\n")}}function ki(e,t){1&e&&(D.dc(0,"div",12),D.dc(1,"div",15),D.Vc(2),D.qc(3,"translate"),D.cc(),D.dc(4,"div",15),D.Vc(5),D.qc(6,"translate"),D.cc(),D.dc(7,"div",15),D.Vc(8),D.qc(9,"translate"),D.cc(),D.cc()),2&e&&(D.Lb(2),D.Wc(D.rc(3,3,"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.FINAL_ACTION.PROPERTY")),D.Lb(3),D.Wc(D.rc(6,5,"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.FINAL_ACTION.VALUE")),D.Lb(3),D.Wc(D.rc(9,7,"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.FINAL_ACTION.STATUS")))}function Pi(e,t){if(1&e&&(D.dc(0,"div",18),D.dc(1,"div",19),D.dc(2,"div",20),D.Vc(3),D.cc(),D.dc(4,"div",20),D.Vc(5),D.qc(6,"yesNo"),D.cc(),D.dc(7,"div",20),D.Vc(8),D.cc(),D.cc(),D.cc()),2&e){var i=t.$implicit,a=D.pc(3);D.Lb(3),D.Wc(a.getHoldAndClassificationRulePropertyName(i.PropertyName)),D.Lb(2),D.Wc(D.rc(6,3,i.PropertyValue)),D.Lb(3),D.Wc(a.getClassificationRulePropertyStatus(i.PropertyName))}}function xi(e,t){if(1&e&&(D.dc(0,"div",16),D.Tc(1,Pi,9,5,"div",17),D.cc()),2&e){var i=D.pc(2);D.Lb(1),D.vc("ngForOf",i.propertiesList)}}function wi(e,t){if(1&e&&(D.dc(0,"div",13),D.Tc(1,ki,10,9,"div",6),D.Tc(2,xi,2,1,"div",14),D.cc()),2&e){var i=D.pc();D.vc("@collapse",i.listOfPropertiesCollapsed),D.Lb(1),D.vc("ngIf",i.categoryHasPropertiesList),D.Lb(1),D.vc("ngIf",i.categoryHasPropertiesList)}}function Mi(e,t){1&e&&(D.dc(0,"div",12),D.dc(1,"div",15),D.Vc(2),D.qc(3,"translate"),D.cc(),D.dc(4,"div",26),D.Vc(5),D.qc(6,"translate"),D.cc(),D.dc(7,"div",26),D.Vc(8),D.qc(9,"translate"),D.cc(),D.dc(10,"div",22),D.Vc(11),D.qc(12,"translate"),D.cc(),D.cc()),2&e&&(D.Lb(2),D.Wc(D.rc(3,4,"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.RULE.IDENTIFIER")),D.Lb(3),D.Wc(D.rc(6,6,"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.RULE.START_DATE")),D.Lb(3),D.Wc(D.rc(9,8,"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.RULE.END_DATE")),D.Lb(3),D.Wc(D.rc(12,10,"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.RULE.STATUS")))}function Vi(e,t){if(1&e){var i=D.ec();D.dc(0,"div",18),D.dc(1,"div",27),D.lc("click",(function(){D.Kc(i);var e=t.$implicit;return D.pc(3).getHoldRuleInformations(e)})),D.dc(2,"div",20),D.Vc(3),D.cc(),D.dc(4,"div",28),D.Vc(5),D.qc(6,"dateTime"),D.cc(),D.dc(7,"div",28),D.Vc(8),D.qc(9,"dateTime"),D.cc(),D.dc(10,"div",25),D.Vc(11),D.cc(),D.cc(),D.cc()}if(2&e){var a=t.$implicit,c=D.pc(3);D.Lb(1),D.vc("ngClass","HoldRule"===c.ruleCategory?"enabled-div clickable":"disabled-div"),D.Lb(2),D.Wc(a.Rule),D.Lb(2),D.Wc(D.sc(6,5,a.StartDate,"dd/MM/yyyy")),D.Lb(3),D.Wc(D.sc(9,8,a.EndDate,"dd/MM/yyyy")),D.Lb(3),D.Wc(c.getRuleStatus(a))}}function Hi(e,t){if(1&e&&(D.dc(0,"div",16),D.Tc(1,Vi,12,11,"div",17),D.cc()),2&e){var i=D.pc(2);D.Lb(1),D.vc("ngForOf",i.unitRuleDTO)}}function Gi(e,t){if(1&e&&(D.Tc(0,Mi,13,12,"div",6),D.Tc(1,Hi,2,1,"div",14)),2&e){var i=D.pc();D.vc("ngIf",i.isToShowRulesList||i.isToShowBlockedRulesList),D.Lb(1),D.vc("ngIf",i.isToShowRulesList)}}function qi(e,t){1&e&&(D.dc(0,"div",0),D.Vc(1),D.qc(2,"translate"),D.cc()),2&e&&(D.Lb(1),D.Wc(D.rc(2,1,"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.INHERITANCE_BLOCKED")))}var Bi,Wi,ji,Yi=((Wi=function(){function e(t,i){o(this,e),this.translateService=t,this.logger=i,this.isShowHoldRuleDetails=!1,this.listOfPropertiesCollapsed=!0,this.listOfRulesCollapsed=!1,this.isPreventInheritance=!1}return d(e,[{key:"ngOnChanges",value:function(e){this.initializeParameters(),e.archiveUnitRules&&(this.getInheritedRulesDetails(e.archiveUnitRules.currentValue),this.showListOfPropertiesBloc())}},{key:"getRuleCategoryName",value:function(e){if(e)return this.translateService.instant("COLLECT.ARCHIVE_UNIT_RULES_DETAILS.CATEGORY_NAME."+e.toUpperCase())}},{key:"ngOnInit",value:function(){}},{key:"getRuleStatus",value:function(e){return e&&e.status&&"BLOCKED"===e.status?this.translateService.instant("COLLECT.ARCHIVE_UNIT_RULES_DETAILS.RULE_STATUS.BLOCKED"):e&&e.Paths?this.translateService.instant(e.Paths[0].length>1?"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.RULE_STATUS.INHERITED":"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.RULE_STATUS.CARRIED"):void 0}},{key:"getMaxEndDate",value:function(e){var t;if(e){var i=e.filter((function(e){return null!=e.EndDate})).sort((function(e,t){return new Date(e.EndDate)<new Date(t.EndDate)?1:-1}));return i?null===(t=i[0])||void 0===t?void 0:t.EndDate:null}}},{key:"getFinalActionValue",value:function(e){if(e)return 0===e.filter((function(e){return"FinalAction"===e.PropertyName})).length?null:e.filter((function(e){return"FinalAction"===e.PropertyName})).length>1?this.translateService.instant("COLLECT.ARCHIVE_UNIT_RULES_DETAILS.RULES_FINAL_ACTION.CONFLICT"):this.translateService.instant("COLLECT.ARCHIVE_UNIT_RULES_DETAILS.RULES_FINAL_ACTION."+String(e.find((function(e){return"FinalAction"===e.PropertyName})).PropertyValue).toUpperCase())}},{key:"getPropertyName",value:function(e){if(e&&"FinalAction"===e)return this.translateService.instant("COLLECT.ARCHIVE_UNIT_RULES_DETAILS.FINAL_ACTION_VALUE")}},{key:"getPropertyValue",value:function(e){if(e)return this.translateService.instant("COLLECT.ARCHIVE_UNIT_RULES_DETAILS.RULES_FINAL_ACTION."+e.toUpperCase())}},{key:"getFinalActionStatus",value:function(e){if(e&&e.Paths){var t=[];return e.Paths.forEach((function(e){e.forEach((function(e){t.push(e)}))})),this.translateService.instant(t.length>1?"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.RULES_FINAL_ACTION.INHERITED":"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.RULES_FINAL_ACTION.CARRIED")}}},{key:"showlistOfRulesBloc",value:function(){this.listOfRulesCollapsed=!this.listOfRulesCollapsed}},{key:"showListOfPropertiesBloc",value:function(){this.listOfPropertiesCollapsed=!this.listOfPropertiesCollapsed}},{key:"getInheritedRulesDetails",value:function(e){var t=this;if(e&&e.InheritedRules)switch(this.ruleCategory){case"AppraisalRule":e.InheritedRules.AppraisalRule&&e.InheritedRules.AppraisalRule.Rules&&(this.unitRuleDTO=e.InheritedRules.AppraisalRule.Rules,this.isToShowRulesList=0!==e.InheritedRules.AppraisalRule.Rules.length),e.InheritedRules.AppraisalRule&&e.InheritedRules.AppraisalRule.Properties&&(this.propertiesList=e.InheritedRules.AppraisalRule.Properties,this.isToShowPropertiesList=!0,this.categoryHasPropertiesList=0!==e.InheritedRules.AppraisalRule.Properties.length);break;case"StorageRule":e.InheritedRules.StorageRule&&e.InheritedRules.StorageRule.Rules&&(this.unitRuleDTO=e.InheritedRules.StorageRule.Rules,this.isToShowRulesList=0!==e.InheritedRules.StorageRule.Rules.length),e.InheritedRules.StorageRule&&e.InheritedRules.StorageRule.Properties&&(this.propertiesList=e.InheritedRules.StorageRule.Properties,this.isToShowPropertiesList=!0,this.categoryHasPropertiesList=0!==e.InheritedRules.StorageRule.Properties.length);break;case"AccessRule":e.InheritedRules.AccessRule&&e.InheritedRules.AccessRule.Rules&&(this.unitRuleDTO=e.InheritedRules.AccessRule.Rules,this.isToShowRulesList=0!==e.InheritedRules.AccessRule.Rules.length),this.isToShowPropertiesList=!1;break;case"ReuseRule":e.InheritedRules.ReuseRule&&e.InheritedRules.ReuseRule.Rules&&(this.unitRuleDTO=e.InheritedRules.ReuseRule.Rules,this.isToShowRulesList=0!==e.InheritedRules.ReuseRule.Rules.length),this.isToShowPropertiesList=!1;break;case"DisseminationRule":e.InheritedRules.DisseminationRule&&e.InheritedRules.DisseminationRule.Rules&&(this.unitRuleDTO=e.InheritedRules.DisseminationRule.Rules,this.isToShowRulesList=0!==e.InheritedRules.DisseminationRule.Rules.length),this.isToShowPropertiesList=!1;break;case"HoldRule":e.InheritedRules.HoldRule&&e.InheritedRules.HoldRule.Rules&&(this.unitRuleDTO=e.InheritedRules.HoldRule.Rules,this.isToShowRulesList=0!==e.InheritedRules.HoldRule.Rules.length),this.categoryHasPropertiesList=!0,this.isToShowPropertiesList=!0;break;case"ClassificationRule":e.InheritedRules.ClassificationRule&&e.InheritedRules.ClassificationRule.Rules&&(this.unitRuleDTO=e.InheritedRules.ClassificationRule.Rules,this.isToShowRulesList=0!==e.InheritedRules.ClassificationRule.Rules.length),e.InheritedRules.ClassificationRule&&e.InheritedRules.ClassificationRule.Properties&&(this.propertiesList=e.InheritedRules.ClassificationRule.Properties,this.isToShowPropertiesList=!0,this.categoryHasPropertiesList=0!==e.InheritedRules.ClassificationRule.Properties.length);break;default:this.logger.warn("No Category with name ",this.ruleCategory,"found")}if(e&&e["#management"])switch(this.ruleCategory){case"AppraisalRule":if(e["#management"].AppraisalRule&&e["#management"].AppraisalRule.Inheritance&&(this.isPreventInheritance=e["#management"].AppraisalRule.Inheritance.PreventInheritance,e["#management"].AppraisalRule.Inheritance.PreventRulesId)){this.isToShowBlockedRulesList=0!==e["#management"].AppraisalRule.Inheritance.PreventRulesId.length;var i=e["#management"].AppraisalRule.Inheritance.PreventRulesId;i&&i.forEach((function(e){t.unitRuleDTO.push({Rule:e,status:"BLOCKED"})}))}break;case"StorageRule":if(e["#management"].StorageRule&&e["#management"].StorageRule.Inheritance&&(this.isPreventInheritance=e["#management"].StorageRule.Inheritance.PreventInheritance,e["#management"].StorageRule.Inheritance.PreventRulesId)){var a=e["#management"].StorageRule.Inheritance.PreventRulesId;this.isToShowBlockedRulesList=0!==e["#management"].StorageRule.Inheritance.PreventRulesId.length,a&&a.forEach((function(e){t.unitRuleDTO.push({Rule:e,status:"BLOCKED"})}))}break;case"AccessRule":if(e["#management"].AccessRule&&e["#management"].AccessRule.Inheritance&&(this.isPreventInheritance=e["#management"].AccessRule.Inheritance.PreventInheritance,e["#management"].AccessRule.Inheritance.PreventRulesId)){this.isToShowBlockedRulesList=0!==e["#management"].AccessRule.Inheritance.PreventRulesId.length;var c=e["#management"].AccessRule.Inheritance.PreventRulesId;c&&c.forEach((function(e){t.unitRuleDTO.push({Rule:e,status:"BLOCKED"})}))}break;case"ReuseRule":if(e["#management"].ReuseRule&&e["#management"].ReuseRule.Inheritance&&(this.isPreventInheritance=e["#management"].ReuseRule.Inheritance.PreventInheritance,e["#management"].ReuseRule.Inheritance.PreventRulesId)){this.isToShowBlockedRulesList=0!==e["#management"].ReuseRule.Inheritance.PreventRulesId.length;var r=e["#management"].ReuseRule.Inheritance.PreventRulesId;r&&r.forEach((function(e){t.unitRuleDTO.push({Rule:e,status:"BLOCKED"})}))}break;case"DisseminationRule":if(e["#management"].DisseminationRule&&e["#management"].DisseminationRule.Inheritance&&(this.isPreventInheritance=e["#management"].DisseminationRule.Inheritance.PreventInheritance,e["#management"].DisseminationRule.Inheritance.PreventRulesId)){this.isToShowBlockedRulesList=0!==e["#management"].DisseminationRule.Inheritance.PreventRulesId.length;var n=e["#management"].DisseminationRule.Inheritance.PreventRulesId;n&&n.forEach((function(e){t.unitRuleDTO.push({Rule:e,status:"BLOCKED"})}))}break;case"HoldRule":if(e["#management"].HoldRule&&e["#management"].HoldRule.Inheritance&&(this.isPreventInheritance=e["#management"].HoldRule.Inheritance.PreventInheritance,e["#management"].HoldRule.Inheritance.PreventRulesId)){this.isToShowBlockedRulesList=0!==e["#management"].HoldRule.Inheritance.PreventRulesId.length;var s=e["#management"].HoldRule.Inheritance.PreventRulesId;s&&s.forEach((function(e){t.unitRuleDTO.push({Rule:e,status:"BLOCKED"})}))}break;case"ClassificationRule":if(e["#management"].ClassificationRule&&e["#management"].ClassificationRule.Inheritance&&(this.isPreventInheritance=e["#management"].ClassificationRule.Inheritance.PreventInheritance,e["#management"].ClassificationRule.Inheritance.PreventRulesId)){this.isToShowBlockedRulesList=0!==e["#management"].ClassificationRule.Inheritance.PreventRulesId.length;var l=e["#management"].ClassificationRule.Inheritance.PreventRulesId;l&&l.forEach((function(e){t.unitRuleDTO.push({Rule:e,status:"BLOCKED"})}))}}}},{key:"getClassificationRulePropertyName",value:function(e){if(e)return this.translateService.instant("COLLECT.ARCHIVE_UNIT_RULES_DETAILS.CLASSIFICATION_RULE_PROPERTIES."+e.toUpperCase())}},{key:"getHoldRulePropertyName",value:function(e){if(e)return this.translateService.instant("COLLECT.ARCHIVE_UNIT_RULES_DETAILS.HOLD_RULE_PROPERTIES."+e.toUpperCase())}},{key:"getHoldAndClassificationRulePropertyName",value:function(e){switch(this.ruleCategory){case"ClassificationRule":if(e)return this.translateService.instant("COLLECT.ARCHIVE_UNIT_RULES_DETAILS.CLASSIFICATION_RULE_PROPERTIES."+e.toUpperCase());break;case"HoldRule":if(e)return this.translateService.instant("COLLECT.ARCHIVE_UNIT_RULES_DETAILS.HOLD_RULE_PROPERTIES."+e.toUpperCase());break;default:this.logger.warn("No property found")}}},{key:"getClassificationRulePropertyStatus",value:function(e){if(this.archiveUnitRules["#management"]&&this.archiveUnitRules["#management"].ClassificationRule)switch(e){case"ClassificationAudience":return this.translateService.instant(this.archiveUnitRules["#management"].ClassificationRule.ClassificationAudience?"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.RULE_STATUS.CARRIED":"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.RULE_STATUS.INHERITED");case"ClassificationLevel":return this.translateService.instant(this.archiveUnitRules["#management"].ClassificationRule.ClassificationLevel?"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.RULE_STATUS.CARRIED":"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.RULE_STATUS.INHERITED");case"NeedReassessingAuthorization":return this.translateService.instant(this.archiveUnitRules["#management"].ClassificationRule.NeedReassessingAuthorization?"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.RULE_STATUS.CARRIED":"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.RULE_STATUS.INHERITED");case"ClassificationReassessingDate":return this.translateService.instant(this.archiveUnitRules["#management"].ClassificationRule.ClassificationReassessingDate?"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.RULE_STATUS.CARRIED":"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.RULE_STATUS.INHERITED");case"ClassificationOwner":return this.translateService.instant(this.archiveUnitRules["#management"].ClassificationRule.ClassificationOwner?"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.RULE_STATUS.CARRIED":"COLLECT.ARCHIVE_UNIT_RULES_DETAILS.RULE_STATUS.INHERITED");default:this.logger.warn("No property found")}}},{key:"getHoldRuleInformations",value:function(e){this.listOfPropertiesCollapsed=!1,this.archiveUnitRules&&this.archiveUnitRules.InheritedRules&&this.archiveUnitRules.InheritedRules.HoldRule&&(this.holdRuleDetails=this.archiveUnitRules.InheritedRules.HoldRule.Rules.find((function(t){return t.Rule===e.Rule})),this.holdRuleStatus=this.getRuleStatus(e),this.isShowHoldRuleDetails=!(this.holdRuleDetails&&null===this.holdRuleDetails.PreventRearrangement&&null===this.holdRuleDetails.HoldReassessingDate&&null===this.holdRuleDetails.HoldReason&&null===this.holdRuleDetails.HoldOwner&&null===this.holdRuleDetails.HoldEndDate))}},{key:"initializeParameters",value:function(){this.unitRuleDTO=null,this.propertiesList=null,this.isPreventInheritance=!1,this.holdRuleDetails=null,this.isShowHoldRuleDetails=!1,this.listOfPropertiesCollapsed=!1}}]),e}()).\u0275fac=function(e){return new(e||Wi)(D.Xb(P.e),D.Xb(T.O))},Wi.\u0275cmp=D.Rb({type:Wi,selectors:[["app-archive-unit-rules-informations-tab"]],inputs:{archiveUnitRules:"archiveUnitRules",ruleCategory:"ruleCategory"},features:[D.Jb],decls:19,vars:16,consts:[[1,"vitamui-table-head","text-color"],[1,"col-5"],[1,"clickable","material-icons","mat-icon-rtl-mirror","arrow-icon",3,"click"],["class","col",4,"ngIf"],[1,"collapsible"],["class","vitamui-table",4,"ngIf","ngIfThen","ngIfElse"],["class","vitamui-table-head",4,"ngIf"],["class","vitamui-table collapsible",4,"ngIf"],["resultsFound",""],["noResults",""],[1,"col"],[1,"vitamui-table"],[1,"vitamui-table-head"],[1,"vitamui-table","collapsible"],["class","vitamui-table-body",4,"ngIf"],[1,"col-4"],[1,"vitamui-table-body"],["class","vitamui-table-rows",4,"ngFor","ngForOf"],[1,"vitamui-table-rows"],[1,"vitamui-row","d-flex","align-items-center"],[1,"col-4","text"],[1,"col-6"],[1,"col-2"],["class","vitamui-table-rows",4,"ngIf"],[1,"col-6","text"],[1,"col-2","text"],[1,"col-3"],[1,"vitamui-row","d-flex","align-items-center",3,"ngClass","click"],[1,"col-3","text"]],template:function(e,t){if(1&e&&(D.dc(0,"div",0),D.dc(1,"div",1),D.dc(2,"i",2),D.lc("click",(function(){return t.showlistOfRulesBloc()})),D.Vc(3),D.cc(),D.Vc(4),D.cc(),D.Tc(5,Ti,3,4,"div",3),D.Tc(6,gi,2,1,"div",3),D.cc(),D.dc(7,"div",4),D.Tc(8,Li,1,0,"div",5),D.cc(),D.Tc(9,bi,5,6,"div",6),D.Tc(10,_i,3,3,"div",7),D.Tc(11,Oi,5,6,"div",6),D.Tc(12,Di,3,3,"div",7),D.Tc(13,Ui,5,6,"div",6),D.Tc(14,wi,3,3,"div",7),D.Tc(15,Gi,2,2,"ng-template",null,8,D.Uc),D.Tc(17,qi,3,3,"ng-template",null,9,D.Uc)),2&e){var i=D.Gc(16),a=D.Gc(18);D.Lb(2),D.Qc("font-size",20,"px"),D.Lb(1),D.Xc(" ",t.listOfRulesCollapsed?"expand_less":"expand_more"," "),D.Lb(1),D.Xc(" ",t.getRuleCategoryName(t.ruleCategory)," "),D.Lb(1),D.vc("ngIf",!t.isPreventInheritance),D.Lb(1),D.vc("ngIf",!t.isPreventInheritance),D.Lb(1),D.vc("@collapse",t.listOfRulesCollapsed),D.Lb(1),D.vc("ngIf",t.isPreventInheritance)("ngIfThen",a)("ngIfElse",i),D.Lb(1),D.vc("ngIf",t.isToShowPropertiesList&&"ClassificationRule"!==t.ruleCategory&&"HoldRule"!==t.ruleCategory),D.Lb(1),D.vc("ngIf",t.isToShowPropertiesList&&"ClassificationRule"!==t.ruleCategory&&"HoldRule"!==t.ruleCategory),D.Lb(1),D.vc("ngIf",t.isToShowPropertiesList&&"HoldRule"===t.ruleCategory),D.Lb(1),D.vc("ngIf",t.isToShowPropertiesList&&"HoldRule"===t.ruleCategory),D.Lb(1),D.vc("ngIf",t.isToShowPropertiesList&&"ClassificationRule"===t.ruleCategory),D.Lb(1),D.vc("ngIf",t.isToShowPropertiesList&&"ClassificationRule"===t.ruleCategory)}},directives:[l.p,l.o,l.n],pipes:[T.Vb,P.d,T.Zb],styles:[".text-color[_ngcontent-%COMP%]{color:var(--vitamui-primary)}.disabled-div[_ngcontent-%COMP%]{pointer-events:none}.enabled-div[_ngcontent-%COMP%]{pointer-events:painted}"],data:{animation:[Object(Ii.o)("collapse",[Object(Ii.l)("false",Object(Ii.m)({height:Ii.a,visibility:Ii.a})),Object(Ii.l)("true",Object(Ii.m)({height:"0",visibility:"hidden"})),Object(Ii.n)("false => true",Object(Ii.e)("300ms ease-in")),Object(Ii.n)("true => false",Object(Ii.e)("300ms ease-out"))])]}}),Wi),Xi=((Bi=function(){function e(t,i){o(this,e),this.collectService=t,this.translateService=i,this.listOfCriteriaSearch=[]}return d(e,[{key:"ngOnChanges",value:function(e){e.archiveUnit&&this.archiveUnit["#opi"]&&this.selectUnitWithInheritedRules(e.archiveUnit.currentValue)}},{key:"ngOnInit",value:function(){}},{key:"ngOnDestroy",value:function(){var e;null===(e=this.selectUnitWithInheritedRulesSubscription)||void 0===e||e.unsubscribe()}},{key:"selectUnitWithInheritedRules",value:function(e){var t=this;this.listOfCriteriaSearch.push({criteria:"GUID",values:[{value:e["#id"],id:e["#id"]}],operator:T.v.EQ,category:T.Z.FIELDS,dataType:T.u.STRING}),e["#opi"]&&(this.selectUnitWithInheritedRulesSubscription=this.collectService.selectUnitWithInheritedRules(e["#opi"],{criteriaList:this.listOfCriteriaSearch,pageNumber:0,size:10,language:this.translateService.currentLang}).subscribe((function(e){t.archiveUnitRules=e,t.listOfCriteriaSearch=[]})))}}]),e}()).\u0275fac=function(e){return new(e||Bi)(D.Xb(re),D.Xb(P.e))},Bi.\u0275cmp=D.Rb({type:Bi,selectors:[["app-archive-unit-rules-details-tab"]],inputs:{archiveUnit:"archiveUnit"},features:[D.Jb],decls:24,vars:14,consts:[[1,"row"],[1,"col-6"],[1,"col"],[3,"ruleCategory","archiveUnitRules"]],template:function(e,t){1&e&&(D.dc(0,"div",0),D.dc(1,"div",1),D.dc(2,"div",0),D.dc(3,"div",2),D.Yb(4,"app-archive-unit-rules-informations-tab",3),D.cc(),D.cc(),D.dc(5,"div",0),D.dc(6,"div",2),D.Yb(7,"app-archive-unit-rules-informations-tab",3),D.cc(),D.cc(),D.dc(8,"div",0),D.dc(9,"div",2),D.Yb(10,"app-archive-unit-rules-informations-tab",3),D.cc(),D.cc(),D.dc(11,"div",0),D.dc(12,"div",2),D.Yb(13,"app-archive-unit-rules-informations-tab",3),D.cc(),D.cc(),D.cc(),D.dc(14,"div",1),D.dc(15,"div",0),D.dc(16,"div",2),D.Yb(17,"app-archive-unit-rules-informations-tab",3),D.cc(),D.cc(),D.dc(18,"div",0),D.dc(19,"div",2),D.Yb(20,"app-archive-unit-rules-informations-tab",3),D.cc(),D.cc(),D.dc(21,"div",0),D.dc(22,"div",2),D.Yb(23,"app-archive-unit-rules-informations-tab",3),D.cc(),D.cc(),D.cc(),D.cc()),2&e&&(D.Lb(4),D.vc("ruleCategory","AppraisalRule")("archiveUnitRules",t.archiveUnitRules),D.Lb(3),D.vc("ruleCategory","HoldRule")("archiveUnitRules",t.archiveUnitRules),D.Lb(3),D.vc("ruleCategory","DisseminationRule")("archiveUnitRules",t.archiveUnitRules),D.Lb(3),D.vc("ruleCategory","ClassificationRule")("archiveUnitRules",t.archiveUnitRules),D.Lb(4),D.vc("ruleCategory","StorageRule")("archiveUnitRules",t.archiveUnitRules),D.Lb(3),D.vc("ruleCategory","AccessRule")("archiveUnitRules",t.archiveUnitRules),D.Lb(3),D.vc("ruleCategory","ReuseRule")("archiveUnitRules",t.archiveUnitRules))},directives:[Yi],encapsulation:2,data:{animation:[Object(Ii.o)("collapse",[Object(Ii.l)("false",Object(Ii.m)({height:Ii.a,visibility:Ii.a})),Object(Ii.l)("true",Object(Ii.m)({height:"0",visibility:"hidden"})),Object(Ii.n)("false => true",Object(Ii.e)("300ms ease-in")),Object(Ii.n)("true => false",Object(Ii.e)("300ms ease-out"))])]}}),Bi),Ki=function(){function e(t,i){o(this,e),this._document=i;var a=this._textarea=this._document.createElement("textarea"),c=a.style;c.position="fixed",c.top=c.opacity="0",c.left="-999em",a.setAttribute("aria-hidden","true"),a.value=t,this._document.body.appendChild(a)}return d(e,[{key:"copy",value:function(){var e=this._textarea,t=!1;try{if(e){var i=this._document.activeElement;e.select(),e.setSelectionRange(0,e.value.length),t=this._document.execCommand("copy"),i&&i.focus()}}catch(a){}return t}},{key:"destroy",value:function(){var e=this._textarea;e&&(e.parentNode&&e.parentNode.removeChild(e),this._textarea=void 0)}}]),e}(),zi=((ji=function(){function e(t){o(this,e),this._document=t}return d(e,[{key:"copy",value:function(e){var t=this.beginCopy(e),i=t.copy();return t.destroy(),i}},{key:"beginCopy",value:function(e){return new Ki(e,this._document)}}]),e}()).\u0275fac=function(e){return new(e||ji)(D.ic(l.d))},ji.\u0275prov=Object(D.Tb)({factory:function(){return new ji(Object(D.ic)(l.d))},token:ji,providedIn:"root"}),ji);function Zi(e,t){if(1&e&&(D.dc(0,"div",2),D.dc(1,"div",3),D.dc(2,"div",4),D.Vc(3),D.qc(4,"translate"),D.cc(),D.cc(),D.dc(5,"div",3),D.dc(6,"div",5),D.dc(7,"div",6),D.dc(8,"label"),D.Vc(9),D.qc(10,"translate"),D.cc(),D.dc(11,"div"),D.Vc(12),D.cc(),D.cc(),D.cc(),D.cc(),D.dc(13,"div",3),D.dc(14,"div",5),D.dc(15,"div",6),D.dc(16,"label"),D.Vc(17),D.qc(18,"translate"),D.cc(),D.dc(19,"div"),D.Vc(20),D.cc(),D.cc(),D.dc(21,"div",6),D.dc(22,"label"),D.Vc(23),D.qc(24,"translate"),D.cc(),D.dc(25,"div"),D.Vc(26),D.cc(),D.cc(),D.cc(),D.cc(),D.cc()),2&e){var i=D.pc();D.Lb(3),D.Xc(" ",D.rc(4,7,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.TECHNICAL_OBJECT_GROUP")," "),D.Lb(6),D.Wc(D.rc(10,9,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.OBJECT_GROUP_ID")),D.Lb(3),D.Wc(i.unitObject["#id"]),D.Lb(5),D.Wc(D.rc(18,11,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.CREATION_DATE")),D.Lb(3),D.Wc(i.unitObject["#approximate_creation_date"]),D.Lb(3),D.Wc(D.rc(24,13,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.LAST_MODIFIED_DATE")),D.Lb(3),D.Wc(i.unitObject["#approximate_update_date"])}}function $i(e,t){if(1&e&&D.Yb(0,"vitamui-common-physical-archive-viewer",11),2&e){var i=D.pc().$implicit;D.vc("archive",i)}}var Qi=function(e){return{opened:e}};function Ji(e,t){if(1&e){var i=D.ec();D.dc(0,"div",12),D.lc("click",(function(){D.Kc(i);var e=D.pc().$implicit;return D.pc().openClose(e)})),D.dc(1,"div",13),D.dc(2,"div",14),D.Yb(3,"i"),D.cc(),D.dc(4,"div",15),D.Vc(5),D.qc(6,"translate"),D.cc(),D.dc(7,"div",16),D.Vc(8),D.qc(9,"bytes"),D.cc(),D.cc(),D.dc(10,"div",13),D.dc(11,"div",17),D.Vc(12),D.cc(),D.dc(13,"button",18),D.lc("click",(function(e){D.Kc(i);var t=D.pc().$implicit;return D.pc().onClickDownloadObject(e,t)})),D.Yb(14,"i",19),D.cc(),D.cc(),D.cc()}if(2&e){var a=D.pc().$implicit,c=D.pc();D.vc("ngClass",D.Ac(12,Qi,a.opened)),D.Lb(3),D.Ob("vitamui-icon ",a.opened?"vitamui-icon-chevron-down":"vitamui-icon-chevron-right",""),D.Lb(2),D.Xc(" ",D.rc(6,8,"COLLECT.UNIT_OBJECT_QUALIFIER_TYPE."+(null==a?null:a.qualifier))+" ("+(null==a?null:a.version)+")"," "),D.Lb(3),D.Wc(D.rc(9,10,a.Size)),D.Lb(4),D.Xc(" ",c.getFormatLitteral(null==a?null:a.FormatIdentification)," "),D.Lb(1),D.vc("disabled",0===(null==a?null:a.Size))}}function ea(e,t){if(1&e&&(D.dc(0,"div",3),D.dc(1,"div",5),D.dc(2,"div",6),D.dc(3,"label"),D.Vc(4),D.qc(5,"translate"),D.cc(),D.dc(6,"div"),D.Vc(7),D.cc(),D.cc(),D.cc(),D.cc()),2&e){var i=t.$implicit;D.Lb(4),D.Wc(D.rc(5,2,"ARCHIVE_SEARCH.ARCHIVE_UNIT_PREVIEW.FIELDS.PERSISTENT_IDENTIFIER_CONTENT")),D.Lb(3),D.Wc(i.PersistentIdentifierContent)}}function ta(e,t){if(1&e&&(D.dc(0,"div",36),D.dc(1,"div",37),D.Vc(2),D.qc(3,"translate"),D.cc(),D.Tc(4,ea,8,4,"div",38),D.Yb(5,"div",22),D.cc()),2&e){var i=D.pc(2).$implicit;D.Lb(2),D.Wc(D.rc(3,2,"ARCHIVE_SEARCH.ARCHIVE_UNIT_PREVIEW.FIELDS.PERSISTENT_IDENTIFIER")),D.Lb(2),D.vc("ngForOf",i.PersistentIdentifier)}}function ia(e,t){1&e&&(D.dc(0,"label"),D.Vc(1),D.qc(2,"translate"),D.cc()),2&e&&(D.Lb(1),D.Xc(" ",D.rc(2,1,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.FILE_ENCODING")," "))}function aa(e,t){1&e&&(D.dc(0,"label"),D.Vc(1),D.qc(2,"translate"),D.cc()),2&e&&(D.Lb(1),D.Xc(" ",D.rc(2,1,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.CREATING_APPLICATION_NAME")," "))}function ca(e,t){1&e&&(D.dc(0,"label"),D.Vc(1),D.qc(2,"translate"),D.cc()),2&e&&(D.Lb(1),D.Xc(" ",D.rc(2,1,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.CREATING_OS")," "))}function ra(e,t){1&e&&(D.dc(0,"label"),D.Vc(1),D.qc(2,"translate"),D.cc()),2&e&&(D.Lb(1),D.Xc(" ",D.rc(2,1,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.CREATING_APPLICATION_VERSION")," "))}function na(e,t){if(1&e&&(D.dc(0,"div",3),D.dc(1,"div",5),D.dc(2,"div",6),D.Tc(3,ca,3,3,"label",26),D.dc(4,"div"),D.Vc(5),D.cc(),D.cc(),D.cc(),D.dc(6,"div",5),D.dc(7,"div",6),D.Tc(8,ra,3,3,"label",26),D.dc(9,"div"),D.Vc(10),D.cc(),D.cc(),D.cc(),D.cc()),2&e){var i=D.pc(2).$implicit,a=D.pc();D.Lb(3),D.vc("ngIf",a.getCreatingOs(null==i?null:i.FileInfo)),D.Lb(2),D.Wc(a.getCreatingOs(null==i?null:i.FileInfo)),D.Lb(3),D.vc("ngIf",a.getCreatingApplicationVersion(null==i?null:i.FileInfo)),D.Lb(2),D.Wc(a.getCreatingApplicationVersion(null==i?null:i.FileInfo))}}function sa(e,t){1&e&&(D.dc(0,"label"),D.Vc(1),D.qc(2,"translate"),D.cc()),2&e&&(D.Lb(1),D.Xc(" ",D.rc(2,1,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.CREATING_OS_VERSION")," "))}function la(e,t){1&e&&(D.dc(0,"label"),D.Vc(1),D.qc(2,"translate"),D.cc()),2&e&&(D.Lb(1),D.Xc(" ",D.rc(2,1,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.CREATED_APPLICATION_DATE")," "))}function oa(e,t){if(1&e&&(D.dc(0,"div",3),D.dc(1,"div",5),D.dc(2,"div",6),D.Tc(3,sa,3,3,"label",26),D.dc(4,"div"),D.Vc(5),D.cc(),D.cc(),D.cc(),D.dc(6,"div",5),D.dc(7,"div",6),D.Tc(8,la,3,3,"label",26),D.dc(9,"div"),D.Vc(10),D.cc(),D.cc(),D.cc(),D.cc()),2&e){var i=D.pc(2).$implicit,a=D.pc();D.Lb(3),D.vc("ngIf",a.getCreatingOsVersion(null==i?null:i.FileInfo)),D.Lb(2),D.Wc(a.getCreatingOsVersion(null==i?null:i.FileInfo)),D.Lb(3),D.vc("ngIf",a.getDateCreatedByApplication(null==i?null:i.FileInfo)),D.Lb(2),D.Wc(a.getDateCreatedByApplication(null==i?null:i.FileInfo))}}function ua(e,t){if(1&e){var i=D.ec();D.dc(0,"div",20),D.dc(1,"div",2),D.Yb(2,"div",21),D.dc(3,"div",3),D.dc(4,"div",5),D.dc(5,"div",6),D.dc(6,"label"),D.Vc(7),D.qc(8,"translate"),D.cc(),D.dc(9,"div"),D.Vc(10),D.cc(),D.cc(),D.cc(),D.dc(11,"div",5),D.dc(12,"div",6),D.dc(13,"label"),D.Vc(14),D.qc(15,"translate"),D.cc(),D.dc(16,"div"),D.Vc(17),D.cc(),D.cc(),D.cc(),D.cc(),D.dc(18,"div",3),D.dc(19,"div",5),D.dc(20,"div",6),D.dc(21,"label"),D.Vc(22),D.qc(23,"translate"),D.cc(),D.dc(24,"div"),D.Vc(25),D.cc(),D.cc(),D.cc(),D.dc(26,"div",5),D.dc(27,"div",6),D.dc(28,"label"),D.Vc(29),D.qc(30,"translate"),D.cc(),D.dc(31,"div"),D.Vc(32),D.cc(),D.cc(),D.cc(),D.cc(),D.Yb(33,"div",22),D.cc(),D.Tc(34,ta,6,4,"div",23),D.dc(35,"div",24),D.dc(36,"div",25),D.Vc(37),D.qc(38,"translate"),D.cc(),D.dc(39,"div",3),D.dc(40,"div",5),D.dc(41,"div",6),D.dc(42,"label"),D.Vc(43),D.qc(44,"translate"),D.cc(),D.dc(45,"div"),D.Vc(46),D.cc(),D.cc(),D.cc(),D.dc(47,"div",5),D.dc(48,"div",6),D.dc(49,"label"),D.Vc(50),D.qc(51,"translate"),D.cc(),D.dc(52,"div"),D.Vc(53),D.cc(),D.cc(),D.cc(),D.cc(),D.dc(54,"div",3),D.dc(55,"div",5),D.dc(56,"div",6),D.dc(57,"label"),D.Vc(58),D.qc(59,"translate"),D.cc(),D.dc(60,"div"),D.Vc(61),D.cc(),D.cc(),D.cc(),D.dc(62,"div",5),D.dc(63,"div",6),D.Tc(64,ia,3,3,"label",26),D.dc(65,"div"),D.Vc(66),D.cc(),D.cc(),D.cc(),D.cc(),D.Yb(67,"div",22),D.cc(),D.dc(68,"div",27),D.dc(69,"div",25),D.Vc(70),D.qc(71,"translate"),D.cc(),D.dc(72,"div",3),D.dc(73,"div",5),D.dc(74,"div",6),D.dc(75,"label"),D.Vc(76),D.qc(77,"translate"),D.cc(),D.dc(78,"div"),D.Vc(79),D.cc(),D.cc(),D.cc(),D.dc(80,"div",5),D.dc(81,"div",6),D.dc(82,"label"),D.Vc(83),D.qc(84,"translate"),D.cc(),D.dc(85,"div"),D.Vc(86),D.cc(),D.cc(),D.cc(),D.cc(),D.dc(87,"div",3),D.dc(88,"div",5),D.dc(89,"div",6),D.dc(90,"label"),D.Vc(91),D.qc(92,"translate"),D.cc(),D.dc(93,"div"),D.Vc(94),D.cc(),D.cc(),D.cc(),D.dc(95,"div",5),D.dc(96,"div",6),D.dc(97,"label"),D.Vc(98),D.qc(99,"translate"),D.cc(),D.dc(100,"div",28),D.dc(101,"div",29),D.Vc(102),D.cc(),D.dc(103,"div",30),D.lc("click",(function(){D.Kc(i);var e=D.pc().$implicit;return D.pc().copyToClipboard(null==e?null:e.MessageDigest)})),D.qc(104,"translate"),D.Yb(105,"i",31),D.cc(),D.cc(),D.cc(),D.cc(),D.cc(),D.dc(106,"div",3),D.dc(107,"div",5),D.dc(108,"div",6),D.dc(109,"label"),D.Vc(110),D.qc(111,"translate"),D.cc(),D.dc(112,"div"),D.Vc(113),D.cc(),D.cc(),D.cc(),D.dc(114,"div",5),D.dc(115,"div",6),D.Tc(116,aa,3,3,"label",26),D.dc(117,"div"),D.Vc(118),D.cc(),D.cc(),D.cc(),D.cc(),D.Tc(119,na,11,4,"div",32),D.Tc(120,oa,11,4,"div",32),D.Yb(121,"div",22),D.cc(),D.dc(122,"div",33),D.dc(123,"div",25),D.Vc(124),D.qc(125,"translate"),D.cc(),D.dc(126,"div",3),D.dc(127,"div",5),D.dc(128,"div",6),D.dc(129,"label"),D.Vc(130),D.qc(131,"translate"),D.cc(),D.dc(132,"div"),D.Vc(133),D.cc(),D.cc(),D.cc(),D.cc(),D.Yb(134,"div",22),D.cc(),D.dc(135,"div",34),D.dc(136,"button",35),D.lc("click",(function(e){D.Kc(i);var t=D.pc().$implicit;return D.pc().onClickDownloadObject(e,t)})),D.Yb(137,"i",19),D.dc(138,"span"),D.Vc(139),D.qc(140,"translate"),D.cc(),D.cc(),D.cc(),D.cc()}if(2&e){var a=D.pc().$implicit,c=D.pc();D.Lb(7),D.Wc(D.rc(8,40,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.OBJECT_ID")),D.Lb(3),D.Wc(a["#id"]),D.Lb(4),D.Wc(D.rc(15,42,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.OPERATION_ID")),D.Lb(3),D.Wc(a["#opi"]),D.Lb(5),D.Wc(D.rc(23,44,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.USAGE")),D.Lb(3),D.Wc(null==a?null:a.qualifier),D.Lb(4),D.Wc(D.rc(30,46,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.USAGE_VERSION")),D.Lb(3),D.Wc(a.version),D.Lb(2),D.vc("ngIf",a.PersistentIdentifier),D.Lb(3),D.Wc(D.rc(38,48,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.FORMAT")),D.Lb(6),D.Wc(D.rc(44,50,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.FORMAT_PUID")),D.Lb(3),D.Wc(c.getFormatId(null==a?null:a.FormatIdentification)),D.Lb(4),D.Wc(D.rc(51,52,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.FORMAT_NAME")),D.Lb(3),D.Wc(c.getFormatLitteral(null==a?null:a.FormatIdentification)),D.Lb(5),D.Wc(D.rc(59,54,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.MIME_TYPE")),D.Lb(3),D.Wc(c.getMimeType(null==a?null:a.FormatIdentification)),D.Lb(3),D.vc("ngIf",c.getEncoding(null==a?null:a.FormatIdentification)),D.Lb(2),D.Wc(c.getEncoding(null==a?null:a.FormatIdentification)),D.Lb(4),D.Wc(D.rc(71,56,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.FILE")),D.Lb(6),D.Wc(D.rc(77,58,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.FILE_NAME")),D.Lb(3),D.Wc(c.getFileName(null==a?null:a.FileInfo)),D.Lb(4),D.Wc(D.rc(84,60,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.URI")),D.Lb(3),D.Wc(null==a?null:a.Uri),D.Lb(5),D.Wc(D.rc(92,62,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.OCTET_SIZE")),D.Lb(3),D.Wc(null==a?null:a.Size),D.Lb(4),D.Xc(" ",D.rc(99,64,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.ALGORITHM")+a.Algorithm," "),D.Lb(4),D.Wc(null==a?null:a.MessageDigest),D.Lb(1),D.wc("matTooltip",D.rc(104,66,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.COPY")),D.vc("matTooltipShowDelay",300),D.Lb(7),D.Wc(D.rc(111,68,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.LAST_MODIFIED_DATE")),D.Lb(3),D.Wc(c.getLastModified(null==a?null:a.FileInfo)),D.Lb(3),D.vc("ngIf",c.getCreatingApplicationName(null==a?null:a.FileInfo)),D.Lb(2),D.Wc(c.getCreatingApplicationName(null==a?null:a.FileInfo)),D.Lb(1),D.vc("ngIf",c.getCreatingOs(null==a?null:a.FileInfo)&&c.getCreatingApplicationVersion(null==a?null:a.FileInfo)),D.Lb(1),D.vc("ngIf",c.getCreatingOsVersion(null==a?null:a.FileInfo)&&c.getDateCreatedByApplication(null==a?null:a.FileInfo)),D.Lb(4),D.Wc(D.rc(125,70,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.STOCKAGE")),D.Lb(6),D.Wc(D.rc(131,72,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.STOCKAGE_STRATEGY_ID")),D.Lb(3),D.Wc(null==a["#storage"]?null:a["#storage"].strategyId),D.Lb(3),D.vc("disabled",0===(null==a?null:a.Size)),D.Lb(3),D.Wc(D.rc(140,74,"COLLECT.ARCHIVE_UNIT_PREVIEW.FIELDS.DOWNLOAD_DOC"))}}function da(e,t){if(1&e&&(D.dc(0,"div",7),D.Tc(1,$i,1,1,"vitamui-common-physical-archive-viewer",8),D.Tc(2,Ji,15,14,"div",9),D.Tc(3,ua,141,76,"div",10),D.cc()),2&e){var i=t.$implicit;D.Lb(1),D.vc("ngIf","PhysicalMaster"===i.qualifier),D.Lb(1),D.vc("ngIf","PhysicalMaster"!==i.qualifier),D.Lb(1),D.vc("ngIf","PhysicalMaster"!==i.qualifier&&i.opened)}}var ha,va,Ca,Ea=((ha=function(){function e(t,i){o(this,e),this.archiveCollectService=t,this.clipboard=i}return d(e,[{key:"ngOnInit",value:function(){}},{key:"ngOnChanges",value:function(e){e.archiveUnit&&(this.unitObject=null,this.versionsWithQualifiersOrdered=null,this.unitHasObject()&&this.getObjectGroupDetailsById(this.archiveUnit))}},{key:"unitHasObject",value:function(){return this.archiveUnit.DescriptionLevel===T.y.ITEM&&!!this.archiveUnit["#object"]}},{key:"onClickDownloadObject",value:function(e,t){return e.stopPropagation(),this.archiveCollectService.downloadObjectFromUnit(this.archiveUnit["#id"],this.archiveUnit["#object"],t.qualifier,t.version)}},{key:"copyToClipboard",value:function(e){this.clipboard.copy(e)}},{key:"getObjectGroupDetailsById",value:function(e){var t=this;this.archiveCollectService.getObjectGroupDetailsById(e["#object"]).subscribe((function(e){t.unitObject=e,t.versionsWithQualifiersOrdered=Object(T.zb)(t.unitObject["#qualifiers"]),t.setFirstVersionWithQualifierOpen()}))}},{key:"setFirstVersionWithQualifierOpen",value:function(){this.versionsWithQualifiersOrdered&&this.versionsWithQualifiersOrdered.length>0&&(this.versionsWithQualifiersOrdered[0].opened=!0)}},{key:"openClose",value:function(e){e.opened=!e.opened}},{key:"getFormatLitteral",value:function(e){return e?e.FormatLitteral:null}},{key:"getMimeType",value:function(e){return e?e.MimeType:null}},{key:"getFormatId",value:function(e){return e?e.FormatId:null}},{key:"getEncoding",value:function(e){return e?e.Encoding:null}},{key:"getFileName",value:function(e){return e?e.Filename:null}},{key:"getLastModified",value:function(e){return e?e.LastModified:null}},{key:"getDateCreatedByApplication",value:function(e){return e?e.DateCreatedByApplication:null}},{key:"getCreatingOsVersion",value:function(e){return e?e.CreatingOsVersion:null}},{key:"getCreatingOs",value:function(e){return e?e.CreatingOs:null}},{key:"getCreatingApplicationVersion",value:function(e){return e?e.CreatingApplicationVersion:null}},{key:"getCreatingApplicationName",value:function(e){return e?e.CreatingApplicationName:null}}]),e}()).\u0275fac=function(e){return new(e||ha)(D.Xb(re),D.Xb(zi))},ha.\u0275cmp=D.Rb({type:ha,selectors:[["app-collect-object-group-details-tab"]],inputs:{archiveUnit:"archiveUnit"},features:[D.Jb],decls:2,vars:2,consts:[["class","object-details-group IDS",4,"ngIf"],["class","object-container",4,"ngFor","ngForOf"],[1,"object-details-group","IDS"],[1,"row"],[1,"col","title"],[1,"col"],[1,"read-only-field"],[1,"object-container"],[3,"archive",4,"ngIf"],["class","object-menu",3,"ngClass","click",4,"ngIf"],["class","object-details",4,"ngIf"],[3,"archive"],[1,"object-menu",3,"ngClass","click"],[1,"line","split"],[1,"line","open-close-icon"],[1,"line","shrink","object-name"],[1,"line","object-size"],[1,"line","shrink","object-type"],[1,"download-button",3,"disabled","click"],[1,"vitamui-icon","vitamui-icon-telecharger"],[1,"object-details"],[1,"row","no-title"],[1,"row-separator"],["class","object-details-group",4,"ngIf"],[1,"object-details-group","FORMAT"],[1,"row","title"],[4,"ngIf"],[1,"object-details-group","FILE"],[1,"line"],[1,"shrink"],["matTooltipClass","vitamui-tooltip",1,"button-copy",3,"matTooltip","matTooltipShowDelay","click"],[1,"vitamui-icon","vitamui-icon-content-copy"],["class","row",4,"ngIf"],[1,"object-details-group","STOCKAGE"],[1,"object-details-group","download-object"],[1,"btn","primary","download-btn",3,"disabled","click"],[1,"object-details-group"],[1,"row","title","text","uppercase"],["class","row",4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(D.Tc(0,Zi,27,15,"div",0),D.Tc(1,da,4,3,"div",1)),2&e&&(D.vc("ngIf",t.unitObject),D.Lb(1),D.vc("ngForOf",t.versionsWithQualifiersOrdered))},directives:[l.p,l.o,T.Fb,l.n,me.a],pipes:[P.d,T.p],styles:["[_nghost-%COMP%]{flex-direction:column}.col[_ngcontent-%COMP%], [_nghost-%COMP%]{display:flex}.col[_ngcontent-%COMP%]{flex-shrink:1;overflow:hidden}.line[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}.shrink[_ngcontent-%COMP%]{display:flex;flex-grow:1;flex-shrink:1;overflow:hidden;text-overflow:ellipsis}.object-details-group[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{padding:5px 14px;font-size:12px;font-weight:700;color:var(--vitamui-primary)}.object-details-group[_ngcontent-%COMP%]   .no-title[_ngcontent-%COMP%]{height:10px}.object-details-group[_ngcontent-%COMP%]   .read-only-field[_ngcontent-%COMP%]{min-height:51px;margin-bottom:0}.object-details-group[_ngcontent-%COMP%]   .read-only-field[_ngcontent-%COMP%]   .button-copy[_ngcontent-%COMP%]{padding:0 10px;cursor:pointer}.object-details-group[_ngcontent-%COMP%]   .read-only-field[_ngcontent-%COMP%]   .button-copy[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:hover{color:var(--vitamui-secondary)}.object-details-group[_ngcontent-%COMP%]   .read-only-field[_ngcontent-%COMP%]   .button-copy[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:active{color:var(--vitamui-primary-100)}.object-details-group[_ngcontent-%COMP%]   .read-only-field[_ngcontent-%COMP%]   .button-copy[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:focus{color:var(--vitamui-primary)}.object-details-group[_ngcontent-%COMP%]   .read-only-field[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;flex-direction:row}.object-details-group[_ngcontent-%COMP%]   .row-separator[_ngcontent-%COMP%]{border-bottom:1px solid #e0e0e0;margin-bottom:5px;margin-top:5px}.object-details-group.download-object[_ngcontent-%COMP%]{padding:15px 0 15px 20px}.object-container[_ngcontent-%COMP%]   .object-menu[_ngcontent-%COMP%]{height:50px;margin-top:20px;padding:0 5px;border-radius:5px;display:flex;background-color:#fff;flex-direction:row;font-size:16px;font-weight:700;line-height:22px;cursor:pointer}.object-container[_ngcontent-%COMP%]   .object-menu.opened[_ngcontent-%COMP%]{border-left:5px solid var(--vitamui-primary);padding-left:0;color:var(--vitamui-primary)}.object-container[_ngcontent-%COMP%]   .object-menu[_ngcontent-%COMP%]   .split[_ngcontent-%COMP%]{padding:0 10px;width:50%}.object-container[_ngcontent-%COMP%]   .object-menu[_ngcontent-%COMP%]   .open-close-icon[_ngcontent-%COMP%]{padding-right:5px}.object-container[_ngcontent-%COMP%]   .object-menu[_ngcontent-%COMP%]   .download-button[_ngcontent-%COMP%]{border:none;border-radius:50%;background-color:var(--vitamui-primary);width:30px;height:30px;font-size:medium;color:var(--vitamui-primary-font);cursor:pointer}.object-container[_ngcontent-%COMP%]   .object-menu[_ngcontent-%COMP%]   .download-button[_ngcontent-%COMP%]:hover{background-color:var(--vitamui-primary-800)}.object-container[_ngcontent-%COMP%]   .object-details[_ngcontent-%COMP%]{padding:0 15px;margin-top:5px;background-color:#fff}"],data:{animation:[Object(Ii.o)("collapse",[Object(Ii.l)("false",Object(Ii.m)({height:Ii.a,visibility:Ii.a})),Object(Ii.l)("true",Object(Ii.m)({height:"0",visibility:"hidden"})),Object(Ii.n)("false => true",Object(Ii.e)("300ms ease-in")),Object(Ii.n)("true => false",Object(Ii.e)("300ms ease-out"))])]}}),ha),Ra=["tabs"],pa=["descriptionTab"],fa=((Ca=function(){function t(e){o(this,t),this.translateService=e,this.backToNormalLateralPanel=new D.p,this.previewClose=new D.p,this.showExtendedLateralPanel=new D.p,this.isPanelextended=!1,this.selectedIndex=0,this.updateStarted=!1,this.hasAccessContractManagementPermissionsMessage=this.translateService.instant("UNIT_UPDATE.NO_PERMISSION")}return d(t,[{key:"ngAfterViewInit",value:function(){this.tabs._handleClick=this.interceptTabChange.bind(this)}},{key:"emitClose",value:function(){return Object(Jt.a)(this,void 0,void 0,e().mark((function t(){return e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.descriptionTab.isModified(),!e.t0){e.next=4;break}return e.next=4,this.checkBeforeExit();case 4:this.previewClose.emit(),this.isPanelextended=!1,this.backToNormalLateralPanel.emit(),this.selectedIndex=0;case 8:case"end":return e.stop()}}),t,this)})))}},{key:"checkBeforeExit",value:function(){return Object(Jt.a)(this,void 0,void 0,e().mark((function t(){return e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.descriptionTab.onCancel();case 2:case"end":return e.stop()}}),t,this)})))}},{key:"selectedTabChangeEvent",value:function(e){switch(e.index){case 0:this.isPanelextended=!1,this.backToNormalLateralPanel.emit();break;case 1:case 2:this.isPanelextended=!0,this.showExtendedLateralPanel.emit()}this.selectedIndex=e.index}},{key:"beforeunloadHandler",value:function(t){return Object(Jt.a)(this,void 0,void 0,e().mark((function i(){return e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.descriptionTab.isModified(),!e.t0){e.next=5;break}return t.preventDefault(),e.next=5,this.checkBeforeExit();case 5:case"end":return e.stop()}}),i,this)})))}},{key:"interceptTabChange",value:function(t,i,a){return Object(Jt.a)(this,void 0,void 0,e().mark((function c(){return e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.descriptionTab.isModified(),!e.t0){e.next=4;break}return e.next=4,this.checkBeforeExit();case 4:return this.updateStarted=!1,e.abrupt("return",f.b.prototype._handleClick.apply(this.tabs,[t,i,a]));case 6:case"end":return e.stop()}}),c,this)})))}},{key:"showNormalPanel",value:function(){this.updateStarted=!1,this.selectedTabChangeEvent({index:this.selectedIndex,tab:null})}},{key:"updateMetadataDesc",value:function(){this.selectedIndex=1,this.isPanelextended=!0,this.showExtendedLateralPanel.emit(),this.updateStarted=!0}},{key:"ngOnChanges",value:function(t){var i;return Object(Jt.a)(this,void 0,void 0,e().mark((function a(){var c=this;return e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.archiveUnit,!e.t0){e.next=8;break}if(e.t1=null===(i=this.descriptionTab)||void 0===i?void 0:i.isModified(),!e.t1){e.next=7;break}return this.archiveUnit=t.archiveUnit.previousValue,e.next=7,this.checkBeforeExit().then((function(){c.archiveUnit=t.archiveUnit.currentValue}));case 7:this.showNormalPanel();case 8:case"end":return e.stop()}}),a,this)})))}},{key:"getArchiveUnitIcon",value:function(e){return Object(T.Bb)(e)}}]),t}()).\u0275fac=function(e){return new(e||Ca)(D.Xb(P.e))},Ca.\u0275cmp=D.Rb({type:Ca,selectors:[["app-archive-preview"]],viewQuery:function(e,t){var i;1&e&&(D.bd(Ra,!0),D.bd(pa,!0)),2&e&&(D.Fc(i=D.mc())&&(t.tabs=i.first),D.Fc(i=D.mc())&&(t.descriptionTab=i.first))},hostBindings:function(e,t){1&e&&D.lc("beforeunload",(function(e){return t.beforeunloadHandler(e)}),!1,D.Jc)},inputs:{archiveUnit:"archiveUnit",isPopup:"isPopup",accessContractAllowUpdating:"accessContractAllowUpdating",hasUpdateDescriptiveUnitMetadataRole:"hasUpdateDescriptiveUnitMetadataRole",transactionId:"transactionId"},outputs:{backToNormalLateralPanel:"backToNormalLateralPanel",previewClose:"previewClose",showExtendedLateralPanel:"showExtendedLateralPanel"},features:[D.Jb],decls:24,vars:43,consts:[[3,"extended","title","icon","hasToolTipOnTitle","toolTipTitleText","toolTipTitleDuration","onclose"],[3,"overlayPos","icon"],["mat-menu-item","","matTooltipClass","vitamui-tooltip",3,"matTooltip","matTooltipShowDelay","disabled","click"],[1,"vitamui-sidepanel-body"],[3,"selectedIndex","ngClass","selectedTabChange"],["tabs",""],[3,"label"],[3,"archiveUnit","showNormalPanel"],[3,"archiveUnit","editMode","transactionId","editModeChange"],["descriptionTab",""],[3,"archiveUnit"]],template:function(e,t){1&e&&(D.dc(0,"vitamui-common-sidenav-header",0),D.lc("onclose",(function(){return t.emitClose()})),D.qc(1,"truncate"),D.qc(2,"unitI18n"),D.qc(3,"unitI18n"),D.dc(4,"vitamui-common-menu-button",1),D.dc(5,"button",2),D.lc("click",(function(){return t.updateMetadataDesc()})),D.Vc(6),D.qc(7,"translate"),D.cc(),D.cc(),D.cc(),D.dc(8,"div",3),D.dc(9,"mat-tab-group",4,5),D.lc("selectedTabChange",(function(e){return t.selectedTabChangeEvent(e)})),D.dc(11,"mat-tab",6),D.qc(12,"translate"),D.dc(13,"app-archive-unit-information-tab",7),D.lc("showNormalPanel",(function(){return t.showNormalPanel()})),D.cc(),D.cc(),D.dc(14,"mat-tab",6),D.qc(15,"translate"),D.dc(16,"app-archive-unit-description-tab",8,9),D.lc("editModeChange",(function(e){return t.updateStarted=e})),D.cc(),D.cc(),D.dc(18,"mat-tab",6),D.qc(19,"translate"),D.Yb(20,"app-archive-unit-rules-details-tab",10),D.cc(),D.dc(21,"mat-tab",6),D.qc(22,"translate"),D.Yb(23,"app-collect-object-group-details-tab",10),D.cc(),D.cc(),D.cc()),2&e&&(D.vc("extended",t.isPanelextended)("title",D.sc(1,24,D.sc(2,27,t.archiveUnit,"Title"),29))("icon",t.getArchiveUnitIcon(t.archiveUnit))("hasToolTipOnTitle",!0)("toolTipTitleText",D.sc(3,30,t.archiveUnit,"Title"))("toolTipTitleDuration",300),D.Lb(4),D.vc("overlayPos","end")("icon","vitamui-icon-more-horiz"),D.Lb(1),D.wc("matTooltip",t.accessContractAllowUpdating?"":t.hasAccessContractManagementPermissionsMessage),D.vc("matTooltipShowDelay",300)("disabled",t.updateStarted||!t.accessContractAllowUpdating||!t.hasUpdateDescriptiveUnitMetadataRole),D.Lb(1),D.Xc(" ",D.rc(7,33,"UNIT_UPDATE.UPDATE_DESC_METADATA")," "),D.Lb(3),D.vc("selectedIndex",t.selectedIndex)("ngClass",t.isPanelextended?"extended-preview-tab-group":"preview-tab-group"),D.Lb(2),D.wc("label",D.rc(12,35,"COLLECT.ARCHIVE_UNIT_PREVIEW.TABS.INFORMATIONS")),D.Lb(2),D.vc("archiveUnit",t.archiveUnit),D.Lb(1),D.wc("label",D.rc(15,37,"TAB.DESCRIPTION")),D.Lb(2),D.vc("archiveUnit",t.archiveUnit)("editMode",t.updateStarted)("transactionId",t.transactionId),D.Lb(2),D.wc("label",D.rc(19,39,"COLLECT.ARCHIVE_UNIT_PREVIEW.TABS.RULES")),D.Lb(2),D.vc("archiveUnit",t.archiveUnit),D.Lb(1),D.wc("label",D.rc(22,41,"COLLECT.ARCHIVE_UNIT_PREVIEW.TABS.OBJECTS")),D.Lb(2),D.vc("archiveUnit",t.archiveUnit))},directives:[T.Ub,T.Eb,Ae.a,me.a,f.b,l.n,f.a,fi,Ci,Xi,Ea],pipes:[T.Yb,T.jb,P.d],styles:[".download-btn[_ngcontent-%COMP%]{border-radius:100px;color:#fff;font-size:14px;font-weight:700;margin:20px 20px 20px 120px}.btn-show-full-path[_ngcontent-%COMP%]{border:1px solid var(--vitamui-grey);border-radius:10px;font-size:10px}.btn-show-full-path[_ngcontent-%COMP%]:hover{background-color:var(--vitamui-grey-400);cursor:pointer}.margin-btn[_ngcontent-%COMP%]{margin-right:300px}"]}),Ca),Ia=((va=function(){function e(t,i,a){var c=this;o(this,e),this.formBuilder=t,this.archiveExchangeDataService=i,this.dialog=a,this.emptyTitleDescriptionCriteriaForm={archiveCriteria:""},this.previousTitleDescriptionCriteriaValue={archiveCriteria:""},this.quickSearchCriteriaForm=this.formBuilder.group({archiveCriteria:["",[]]}),Object(A.a)(this.quickSearchCriteriaForm.statusChanges,this.quickSearchCriteriaForm.valueChanges).pipe(Object(O.a)(Ge.UPDATE_DEBOUNCE_TIME),Object(ti.a)((function(){return c.quickSearchCriteriaForm.valid})),Object(y.a)((function(){return c.quickSearchCriteriaForm.value})),Object(y.a)((function(){return Object(T.sb)(c.quickSearchCriteriaForm.value,c.previousTitleDescriptionCriteriaValue)})),Object(ti.a)((function(e){return c.isEmpty(e)}))).subscribe((function(){c.resetSimpleCriteriaForm()}))}return d(e,[{key:"isEmpty",value:function(e){return!!e&&!!e.archiveCriteria&&(this.addCriteria("TITLE_OR_DESCRIPTION",{value:e.archiveCriteria.trim(),id:e.archiveCriteria.trim()},e.archiveCriteria.trim(),!0,T.v.EQ,!1),!0)}},{key:"resetSimpleCriteriaForm",value:function(){this.quickSearchCriteriaForm.reset(this.emptyTitleDescriptionCriteriaForm)}},{key:"ngOnInit",value:function(){}},{key:"addCriteria",value:function(e,t,i,a,c,r){e&&t&&this.archiveExchangeDataService.addSimpleSearchCriteriaSubject({keyElt:e,valueElt:t,labelElt:i,keyTranslated:a,operator:c,category:T.Z.FIELDS,valueTranslated:r,dataType:T.u.STRING})}},{key:"archiveCriteria",get:function(){return this.quickSearchCriteriaForm.controls.archiveCriteria}}]),e}()).\u0275fac=function(e){return new(e||va)(D.Xb(u.e),D.Xb(Le),D.Xb(v.b))},va.\u0275cmp=D.Rb({type:va,selectors:[["app-title-and-description-criteria-search-collect"]],decls:3,vars:5,consts:[[3,"formGroup"],["formControlName","archiveCriteria",3,"validator","label"]],template:function(e,t){if(1&e&&(D.dc(0,"form",0),D.Yb(1,"vitamui-common-editable-input",1),D.qc(2,"translate"),D.cc()),2&e){var i=null;D.vc("formGroup",t.quickSearchCriteriaForm),D.Lb(1),D.wc("label",D.rc(2,3,"COLLECT.TITLE_SEARCH_AREA")),D.vc("validator",null==t.quickSearchCriteriaForm||null==(i=t.quickSearchCriteriaForm.get("archiveCriteria"))?null:i.validator)}},directives:[u.x,u.q,u.i,T.C,u.p,u.h],pipes:[P.d],encapsulation:2}),va);function Ta(e,t){if(1&e&&(D.dc(0,"vitamui-common-confirm-dialog",1),D.qc(1,"translate"),D.dc(2,"h5"),D.Vc(3),D.qc(4,"translate"),D.cc(),D.dc(5,"strong"),D.Vc(6),D.qc(7,"date"),D.cc(),D.cc()),2&e){var i=D.pc();D.yc("dialogTitle","",D.rc(1,5,"COLLECT.SEARCH_CRITERIA_SAVER.SAVE_DELETE_CRITERIA_LABEL")," ",i.objectType,""),D.Lb(3),D.Wc(D.rc(4,7,"COLLECT.SEARCH_CRITERIA_SAVER.SAVE_DELETE_CRITERIA_MESSGE")),D.Lb(3),D.Yc(" ",i.objectName," - ",D.sc(7,9,i.objectDate,"dd/MM/yyyy"),"")}}var ga,La=((ga=function(){function e(){o(this,e),this.dialogType="delete"}return d(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||ga)},ga.\u0275cmp=D.Rb({type:ga,selectors:[["vitamui-confirm-action"]],inputs:{dialogType:"dialogType",objectName:"objectName",objectType:"objectType",objectDate:"objectDate"},decls:3,vars:5,consts:[["confirmLabel","CONFIRMER","cancelLabel","ANNULER",3,"dialogTitle",4,"ngIf"],["confirmLabel","CONFIRMER","cancelLabel","ANNULER",3,"dialogTitle"]],template:function(e,t){1&e&&(D.Vc(0),D.qc(1,"date"),D.Tc(2,Ta,8,12,"vitamui-common-confirm-dialog",0)),2&e&&(D.Xc("",D.sc(1,2,t.objectDate,"dd/MM/yyyy"),"\n"),D.Lb(2),D.vc("ngIf","delete"===t.dialogType))},directives:[l.p,T.r],pipes:[l.e,P.d],encapsulation:2}),ga);function ba(e,t){if(1&e){var i=D.ec();D.bc(0),D.dc(1,"button",4),D.lc("click",(function(){D.Kc(i);var e=t.$implicit;return D.pc().storedSearchCriteriaHistory.emit(e)})),D.dc(2,"div",5),D.dc(3,"div",6),D.dc(4,"span",7),D.Vc(5),D.qc(6,"truncate"),D.cc(),D.Vc(7," - "),D.dc(8,"span",8),D.Vc(9),D.qc(10,"dateTime"),D.cc(),D.cc(),D.dc(11,"div"),D.dc(12,"i",9),D.lc("click",(function(){D.Kc(i);var e=t.$implicit;return D.pc().deleteSearchCriteriaHistory(e)})),D.Vc(13,"delete"),D.cc(),D.cc(),D.cc(),D.cc(),D.ac()}if(2&e){var a=t.$implicit;D.Lb(1),D.wc("matTooltip",a.name),D.vc("matTooltipShowDelay",300),D.Lb(4),D.Wc(D.sc(6,4,a.name,30)),D.Lb(4),D.Wc(D.sc(10,7,a.savingDate,"dd/MM/yyyy"))}}function ma(e,t){1&e&&(D.dc(0,"button",10),D.Vc(1),D.qc(2,"translate"),D.cc()),2&e&&(D.Lb(1),D.Xc(" ",D.rc(2,1,"COLLECT.SEARCH_CRITERIA_SAVER.NO_RESULTS")," "))}function Aa(e,t){1&e&&(D.dc(0,"div",11),D.Yb(1,"mat-spinner",12),D.cc())}var Sa,_a,Oa=((_a=function(){function e(t,i,a,c,r){o(this,e),this.searchCriteriaSaverService=t,this.archiveSharedDataService=i,this.dialog=a,this.snackBar=c,this.translateService=r,this.storedSearchCriteriaHistory=new D.p,this.orderChange=new b.a,this.direction=T.z.ASCENDANT,this.pending=!1}return d(e,[{key:"ngOnInit",value:function(){var e=this;this.subscriptionSearchCriteriaHistory=this.archiveSharedDataService.getSearchCriteriaHistoryShared().subscribe((function(t){t&&(e.searchCriteriaHistory.push(t),e.archiveSharedDataService.sort(T.z.ASCENDANT,e.searchCriteriaHistory))})),this.getSearchCriteriaHistory(),this.direction=T.z.ASCENDANT}},{key:"emitOrderChange",value:function(){this.orderChange.next()}},{key:"getSearchCriteriaHistory",value:function(){var e=this;this.pending=!0,this.searchCriteriaSaverService.getSearchCriteriaHistory().subscribe((function(t){e.searchCriteriaHistory=t,e.archiveSharedDataService.sort(T.z.ASCENDANT,e.searchCriteriaHistory),e.archiveSharedDataService.emitAllSearchCriteriaHistory(t),e.pending=!1}))}},{key:"deleteSearchCriteriaHistory",value:function(e){var t=this,i=this.dialog.open(La,{panelClass:"vitamui-confirm-dialog"});i.componentInstance.objectType=this.translateService.instant("COLLECT.SEARCH_CRITERIA_SAVER.OBJECT_TYPE"),i.componentInstance.objectName=e.name,i.componentInstance.objectDate=e.savingDate,i.afterClosed().pipe(Object(ti.a)((function(e){return!!e}))).subscribe((function(){t.searchCriteriaSaverService.deleteSearchCriteriaHistory(e.id).subscribe((function(){t.clearElement(e.id),t.snackBar.openFromComponent(fe,{panelClass:"vitamui-snack-bar",data:{type:"searchCriteriaHistoryDeleted",name:e.name},duration:1e4})}))}))}},{key:"clearElement",value:function(e){for(var t=0;t<this.searchCriteriaHistory.length;t++)this.searchCriteriaHistory[t].id===e&&this.searchCriteriaHistory.splice(t,1)}}]),e}()).\u0275fac=function(e){return new(e||_a)(D.Xb(be),D.Xb(Le),D.Xb(v.b),D.Xb(Te),D.Xb(P.e))},_a.\u0275cmp=D.Rb({type:_a,selectors:[["app-search-criteria-list"]],outputs:{storedSearchCriteriaHistory:"storedSearchCriteriaHistory"},decls:4,vars:3,consts:[[1,"list-div"],[4,"ngFor","ngForOf"],["mat-menu-item","",4,"ngIf"],["class","center-spinner",4,"ngIf"],["mat-menu-item","","matTooltipClass","vitamui-tooltip",3,"matTooltip","matTooltipShowDelay","click"],[1,"grid-container"],[1,"criteria-name-date"],[1,"criteria-name"],[1,"criteria-date"],[1,"material-icons","btn-delete",3,"click"],["mat-menu-item",""],[1,"center-spinner"],["diameter","50","color","accent"]],template:function(e,t){1&e&&(D.dc(0,"div",0),D.Tc(1,ba,14,10,"ng-container",1),D.Tc(2,ma,3,3,"button",2),D.Tc(3,Aa,2,0,"div",3),D.cc()),2&e&&(D.Lb(1),D.vc("ngForOf",t.searchCriteriaHistory),D.Lb(1),D.vc("ngIf",void 0!==t.searchCriteriaHistory&&0===t.searchCriteriaHistory.length),D.Lb(1),D.vc("ngIf",t.pending))},directives:[l.o,l.p,Ae.a,me.a,E.b],pipes:[T.Yb,T.Vb,P.d],styles:[".center-spinner[_ngcontent-%COMP%]{text-align:-webkit-center}.btn-delete[_ngcontent-%COMP%]{color:#bdbdbd;float:right;padding-top:9px;font-size:30px}.btn-delete[_ngcontent-%COMP%]:hover{color:#9c31b5}.list-div[_ngcontent-%COMP%]{max-width:380px}.grid-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;grid-gap:1px}.criteria-name-date[_ngcontent-%COMP%]{width:320px}.criteria-date[_ngcontent-%COMP%]{font-size:13px;line-height:16px;align-items:center;letter-spacing:-.2px;color:#757575}.criteria-name[_ngcontent-%COMP%]{font-family:Mulish;font-style:normal;font-weight:400;font-size:15px;line-height:22px;align-items:center;letter-spacing:.1px;color:#212121}"]}),_a),ya=((Sa=function(){function e(t){o(this,e),this.ruleApiService=t,this.accessContract=new m.a(""),this.selectedItems=new m.a(0),this.criteriaSearchListToSave=new m.a([]),this.criteriaSearchDSLQuery=new m.a(null),this.ruleActions=new m.a([]),this.ruleCategory=new m.a(""),this.managementRules=new m.a([]),this.hasExactCount=new m.a(!1),this.selectedItem=this.selectedItems.asObservable(),this.allCriteriaSearchListToSave=this.criteriaSearchListToSave.asObservable(),this.allCriteriaSearchDSLQuery=this.criteriaSearchDSLQuery.asObservable(),this.allRuleActions=this.ruleActions.asObservable(),this.allManagementRules=this.managementRules.asObservable(),this.hasExactCounts=this.hasExactCount.asObservable()}return d(e,[{key:"emitRuleCategory",value:function(e){this.ruleCategory.next(e)}},{key:"getRuleCategory",value:function(){return this.ruleCategory.asObservable()}},{key:"emitAccessContract",value:function(e){this.accessContract.next(e)}},{key:"getAccessContract",value:function(){return this.accessContract.asObservable()}},{key:"emitselectedItems",value:function(e){this.selectedItems.next(e)}},{key:"getselectedItems",value:function(){return this.selectedItems.asObservable()}},{key:"emitCriteriaSearchListToSave",value:function(e){this.criteriaSearchListToSave.next(e)}},{key:"getCriteriaSearchListToSave",value:function(){return this.criteriaSearchListToSave.asObservable()}},{key:"emitCriteriaSearchDSLQuery",value:function(e){this.criteriaSearchDSLQuery.next(e)}},{key:"getCriteriaSearchDSLQuery",value:function(){return this.criteriaSearchDSLQuery.asObservable()}},{key:"emitRuleActions",value:function(e){this.ruleActions.next(e)}},{key:"getRuleActions",value:function(){return this.ruleActions.asObservable()}},{key:"emitManagementRules",value:function(e){this.managementRules.next(e)}},{key:"getManagementRules",value:function(){return this.managementRules.asObservable()}},{key:"emitHasExactCount",value:function(e){this.hasExactCount.next(e)}},{key:"getHasExactCount",value:function(){return this.hasExactCount.asObservable()}},{key:"existsProperties",value:function(e){var t=new F.g,i={};return e.ruleId&&(i.ruleId=e.ruleId),e.ruleType&&(i.ruleType=e.ruleType),this.ruleApiService.check(i,t)}}]),e}()).\u0275fac=function(e){return new(e||Sa)(D.ic(T.V))},Sa.\u0275prov=D.Tb({token:Sa,factory:Sa.\u0275fac,providedIn:"root"}),Sa),Na=n("mFH5");function Fa(e,t){if(1&e){var i=D.ec();D.dc(0,"span",35),D.lc("click",(function(){return D.Kc(i),D.pc(),D.Gc(32).open()})),D.Vc(1),D.qc(2,"translate"),D.cc()}2&e&&(D.Lb(1),D.Wc(D.rc(2,1,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.START_DATE_SEARCH")))}function Da(e,t){if(1&e){var i=D.ec();D.dc(0,"span",36),D.lc("click",(function(){return D.Kc(i),D.pc(),D.Gc(32).open()})),D.Vc(1),D.qc(2,"dateTime"),D.cc()}if(2&e){var a=D.pc();D.Lb(1),D.Xc("",D.sc(2,1,a.simpleCriteriaForm.get("beginDt").value,"dd/MM/yyyy")," ")}}function Ua(e,t){if(1&e){var i=D.ec();D.dc(0,"span",35),D.lc("click",(function(){return D.Kc(i),D.pc(),D.Gc(40).open()})),D.Vc(1),D.qc(2,"translate"),D.cc()}2&e&&(D.Lb(1),D.Wc(D.rc(2,1,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.END_DATE_SEARCH")))}function ka(e,t){if(1&e){var i=D.ec();D.dc(0,"span",36),D.lc("click",(function(){return D.Kc(i),D.pc(),D.Gc(40).open()})),D.Vc(1),D.qc(2,"dateTime"),D.cc()}if(2&e){var a=D.pc();D.Lb(1),D.Xc("",D.sc(2,1,a.simpleCriteriaForm.get("endDt").value,"dd/MM/yyyy")," ")}}function Pa(e,t){if(1&e&&(D.bc(0),D.dc(1,"mat-option",37),D.Vc(2),D.cc(),D.ac()),2&e){var i=t.$implicit;D.Lb(1),D.wc("value",i.ApiField),D.wc("matTooltip",i.ShortName),D.vc("matTooltipShowDelay",300),D.Lb(1),D.Xc("",i.Identifier," ")}}function xa(e,t){if(1&e&&D.Yb(0,"vitamui-common-editable-input",38),2&e){var i=D.pc(),a=null;D.wc("label",i.selectedValueOntolonogy),D.vc("validator",null==i.simpleCriteriaForm||null==(a=i.simpleCriteriaForm.get("otherCriteriaValue"))?null:a.validator)}}function wa(e,t){if(1&e){var i=D.ec();D.dc(0,"span",35),D.lc("click",(function(){return D.Kc(i),D.pc(),D.Gc(6).open()})),D.Vc(1),D.cc()}if(2&e){var a=D.pc(2);D.Lb(1),D.Wc(a.selectedValueOntolonogy)}}function Ma(e,t){if(1&e){var i=D.ec();D.dc(0,"span",36),D.lc("click",(function(){return D.Kc(i),D.pc(),D.Gc(6).open()})),D.Vc(1),D.qc(2,"dateTime"),D.cc()}if(2&e){var a=D.pc(2);D.Lb(1),D.Xc("",D.sc(2,1,a.simpleCriteriaForm.get("otherCriteriaValue").value,"dd/MM/yyyy")," ")}}function Va(e,t){if(1&e){var i=D.ec();D.dc(0,"div",13),D.lc("click",(function(){return D.Kc(i),D.Gc(6).open()})),D.Tc(1,wa,2,1,"span",14),D.Tc(2,Ma,3,4,"ng-template",null,39,D.Uc),D.Yb(4,"input",40),D.Yb(5,"mat-datepicker",null,41),D.cc()}if(2&e){var a=D.Gc(3),c=D.Gc(6),r=D.pc();D.Lb(1),D.vc("ngIf",!r.simpleCriteriaForm.get("otherCriteriaValue").value)("ngIfElse",a),D.Lb(3),D.vc("matDatepicker",c)("min",r.simpleCriteriaForm.get("otherCriteriaValue").value)}}var Ha,Ga=function(){return{"margin-right":"50%"}},qa=function(){return{"margin-top":"10px"}},Ba=((Ha=function(){function e(t,a,c,r,n,s,l){var d=this;o(this,e),this.formBuilder=t,this.archiveCollectService=a,this.archiveExchangeDataService=c,this.dialog=r,this.managementRulesSharedDataService=n,this.translateService=s,this.ontologyService=l,this.otherCriteriaValueEnabled=!1,this.otherCriteriaValueType="DATE",this.ontologies=[],this.criteriaSearchListToSave=[],this.emptySimpleCriteriaForm={title:"",identifier:"",description:"",guid:"",beginDt:"",endDt:"",serviceProdLabel:"",serviceProdCode:"",otherCriteria:"",otherCriteriaValue:""},this.archiveUnitTypesCriteria=new Map([["ARCHIVE_UNIT_WITH_OBJECTS",!0],["ARCHIVE_UNIT_WITHOUT_OBJECTS",!0]]),this.ontologyService.getInternalOntologyFieldsList().subscribe((function(e){var t;(t=d.ontologies).push.apply(t,i(e)),d.ontologies.sort((function(e,t){var i=e.Identifier,a=t.Identifier;return i<a?-1:i>a?1:0}))})),this.archiveCollectService.getExternalOntologiesList().subscribe((function(e){var t;(t=d.ontologies).push.apply(t,i(e))})),this.translateService.onLangChange.subscribe((function(){d.archiveUnitTypesCriteria.get("ARCHIVE_UNIT_WITH_OBJECTS")&&d.manageUnitObjectUnitCriteria("ARCHIVE_UNIT_WITH_OBJECTS"),d.archiveUnitTypesCriteria.get("ARCHIVE_UNIT_WITHOUT_OBJECTS")&&d.manageUnitObjectUnitCriteria("ARCHIVE_UNIT_WITHOUT_OBJECTS")})),this.previousSimpleCriteriaValue={title:"",identifier:"",description:"",guid:"",beginDt:"",endDt:"",serviceProdLabel:"",serviceProdCode:"",otherCriteria:"",otherCriteriaValue:""},this.simpleCriteriaForm=this.formBuilder.group({title:["",[]],description:["",[]],guid:["",[u.w.pattern("^[a-z0-9_, ]+")]],beginDt:["",[]],endDt:["",[]],serviceProdLabel:["",[]],serviceProdCode:["",[]],otherCriteria:["",[]],otherCriteriaValue:["",[]]}),Object(A.a)(this.simpleCriteriaForm.statusChanges,this.simpleCriteriaForm.valueChanges).pipe(Object(O.a)(Ge.UPDATE_DEBOUNCE_TIME),Object(ti.a)((function(){return d.simpleCriteriaForm.valid})),Object(y.a)((function(){return d.simpleCriteriaForm.value})),Object(y.a)((function(){return Object(T.sb)(d.simpleCriteriaForm.value,d.previousSimpleCriteriaValue)})),Object(ti.a)((function(e){return d.isEmpty(e)}))).subscribe((function(){d.resetSimpleCriteriaForm()})),this.archiveExchangeDataService.receiveRemoveFromChildSearchCriteriaSubject().subscribe((function(e){e&&(e.action===T.d.ADD?d.archiveUnitTypesCriteria.set(e.valueElt.id,!0):e.action===T.d.REMOVE&&d.archiveUnitTypesCriteria.set(e.valueElt.id,!1))}))}return d(e,[{key:"isEmpty",value:function(e){var t=this;if(e){if(e.title)return this.addCriteria("TITLE",{value:e.title.trim(),id:e.title.trim()},e.title.trim(),!0,T.v.EQ,!1,T.u.STRING),!0;if(e.description)return this.addCriteria("DESCRIPTION",{value:e.description.trim(),id:e.description.trim()},e.description.trim(),!0,T.v.EQ,!1,T.u.STRING),!0;if(e.beginDt)return this.addCriteria("START_DATE",{value:this.simpleCriteriaForm.value.beginDt,id:this.simpleCriteriaForm.value.beginDt},this.simpleCriteriaForm.value.beginDt,!0,T.v.GTE,!1,T.u.DATE),!0;if(e.endDt)return this.addCriteria("END_DATE",{value:this.simpleCriteriaForm.value.endDt,id:this.simpleCriteriaForm.value.endDt},this.simpleCriteriaForm.value.endDt,!0,T.v.LTE,!1,T.u.DATE),!0;if(e.serviceProdCode)return this.addCriteria("SP_CODE",{value:e.serviceProdCode.trim(),id:e.serviceProdCode.trim()},e.serviceProdCode.trim(),!0,T.v.EQ,!1,T.u.STRING),!0;if(e.serviceProdLabel)return this.addCriteria("SP_LABEL",{value:e.serviceProdLabel.trim(),id:e.serviceProdLabel.trim()},e.serviceProdLabel.trim(),!0,T.v.EQ,!1,T.u.STRING),!0;if(e.guid)return e.guid.split(",").forEach((function(e){e&&""!==e.trim()&&t.addCriteria("GUID",{value:e.trim(),id:e.trim()},e.trim(),!0,T.v.EQ,!1,T.u.STRING)})),!0;if(e.otherCriteriaValue){var i=this.ontologies.find((function(t){return t.ApiField===e.otherCriteria}));return this.otherCriteriaValueType===T.u.DATE?this.addCriteria(i.ApiField,{value:this.simpleCriteriaForm.value.otherCriteriaValue,id:this.simpleCriteriaForm.value.otherCriteriaValue},this.simpleCriteriaForm.value.otherCriteriaValue,!1,T.v.EQ,!1,T.u.DATE):this.addCriteria(i.ApiField,{value:e.otherCriteriaValue.trim(),id:e.otherCriteriaValue.trim()},e.otherCriteriaValue.trim(),!1,T.v.EQ,!1,T.u.STRING),!0}return!1}return!1}},{key:"resetSimpleCriteriaForm",value:function(){this.simpleCriteriaForm.reset(this.emptySimpleCriteriaForm)}},{key:"isValueTranslated",value:function(e){return"FINAL_ACTION_TYPE"===e||"ALL_ARCHIVE_UNIT_TYPES"===e}},{key:"ngOnInit",value:function(){var e=this;this.managementRulesSharedDataService.getCriteriaSearchListToSave().subscribe((function(t){e.criteriaSearchListToSave=t})),this.criteriaSearchListToSave.forEach((function(t){"ALL_ARCHIVE_UNIT_TYPES"===t.criteria&&t.values.forEach((function(t){e.archiveUnitTypesCriteria.set(t.id,!0)})),t.values.forEach((function(i){e.addCriteria(t.criteria,i,i.id,!0,t.operator,e.isValueTranslated(t.criteria),t.dataType,t.category)}))})),0===this.criteriaSearchListToSave.length&&(this.addCriteria("ALL_ARCHIVE_UNIT_TYPES",{value:"ARCHIVE_UNIT_WITH_OBJECTS",id:"ARCHIVE_UNIT_WITH_OBJECTS"},this.translateService.instant("COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.UNIT_TYPE.ARCHIVE_UNIT_WITH_OBJECTS"),!0,T.v.EQ,!1,T.u.STRING,T.Z.FIELDS),this.addCriteria("ALL_ARCHIVE_UNIT_TYPES",{value:"ARCHIVE_UNIT_WITHOUT_OBJECTS",id:"ARCHIVE_UNIT_WITHOUT_OBJECTS"},this.translateService.instant("COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.UNIT_TYPE.ARCHIVE_UNIT_WITHOUT_OBJECTS"),!0,T.v.EQ,!1,T.u.STRING,T.Z.FIELDS))}},{key:"onSelectOtherCriteria",value:function(){var e=this;this.simpleCriteriaForm.get("otherCriteria").valueChanges.subscribe((function(t){if(""===t)e.otherCriteriaValueEnabled=!1,e.selectedValueOntolonogy=null;else{e.simpleCriteriaForm.controls.otherCriteriaValue.setValue(""),e.otherCriteriaValueEnabled=!0;var i=e.simpleCriteriaForm.get("otherCriteria").value,a=e.ontologies.find((function(e){return e.ApiField===i}));a&&(e.selectedValueOntolonogy=a.Identifier,e.otherCriteriaValueType=a.Type)}}))}},{key:"addCriteria",value:function(e,t,i,a,c,r,n,s){e&&t&&this.archiveExchangeDataService.addSimpleSearchCriteriaSubject({keyElt:e,valueElt:t,labelElt:i,keyTranslated:a,operator:c,category:s||T.Z.FIELDS,valueTranslated:r,dataType:n})}},{key:"addArchiveUnitTypeCriteria",value:function(e,t){var i=t.target.checked;switch(this.archiveUnitTypesCriteria.set(e,i),e){case"ARCHIVE_UNIT_WITH_OBJECTS":i?this.addCriteria("ALL_ARCHIVE_UNIT_TYPES",{value:"ARCHIVE_UNIT_WITH_OBJECTS",id:"ARCHIVE_UNIT_WITH_OBJECTS"},this.translateService.instant("COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.UNIT_TYPE.ARCHIVE_UNIT_WITH_OBJECTS"),!0,T.v.EQ,!1,T.u.STRING,T.Z.FIELDS):this.emitRemoveCriteriaEvent("ALL_ARCHIVE_UNIT_TYPES",{value:"ARCHIVE_UNIT_WITH_OBJECTS",id:"ARCHIVE_UNIT_WITH_OBJECTS"});break;case"ARCHIVE_UNIT_WITHOUT_OBJECTS":i?this.addCriteria("ALL_ARCHIVE_UNIT_TYPES",{value:"ARCHIVE_UNIT_WITHOUT_OBJECTS",id:"ARCHIVE_UNIT_WITHOUT_OBJECTS"},this.translateService.instant("COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.UNIT_TYPE.ARCHIVE_UNIT_WITHOUT_OBJECTS"),!0,T.v.EQ,!1,T.u.STRING,T.Z.FIELDS):this.emitRemoveCriteriaEvent("ALL_ARCHIVE_UNIT_TYPES",{value:"ARCHIVE_UNIT_WITHOUT_OBJECTS",id:"ARCHIVE_UNIT_WITHOUT_OBJECTS"})}}},{key:"emitRemoveCriteriaEvent",value:function(e,t){this.archiveExchangeDataService.sendRemoveFromChildSearchCriteriaAction({keyElt:e,valueElt:t,action:T.d.REMOVE})}},{key:"manageUnitObjectUnitCriteria",value:function(e){this.emitRemoveCriteriaEvent("ALL_ARCHIVE_UNIT_TYPES",{value:e,id:e}),this.addCriteria("ALL_ARCHIVE_UNIT_TYPES",{value:e,id:e},this.translateService.instant("COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.UNIT_TYPE."+e),!0,T.v.EQ,!1,T.u.STRING,T.Z.FIELDS),this.archiveUnitTypesCriteria.set(e,!0)}},{key:"guid",get:function(){return this.simpleCriteriaForm.controls.guid}},{key:"archiveCriteria",get:function(){return this.simpleCriteriaForm.controls.archiveCriteria}},{key:"title",get:function(){return this.simpleCriteriaForm.controls.title}},{key:"description",get:function(){return this.simpleCriteriaForm.controls.description}},{key:"beginDt",get:function(){return this.simpleCriteriaForm.controls.beginDt}},{key:"endDt",get:function(){return this.simpleCriteriaForm.controls.endDt}},{key:"serviceProdLabel",get:function(){return this.simpleCriteriaForm.controls.serviceProdLabel}},{key:"serviceProdCode",get:function(){return this.simpleCriteriaForm.controls.serviceProdCode}},{key:"otherCriteria",get:function(){return this.simpleCriteriaForm.controls.otherCriteria}},{key:"otherCriteriaValue",get:function(){return this.simpleCriteriaForm.controls.otherCriteriaValue}}]),e}()).\u0275fac=function(e){return new(e||Ha)(D.Xb(u.e),D.Xb(re),D.Xb(Le),D.Xb(v.b),D.Xb(ya),D.Xb(P.e),D.Xb(T.R))},Ha.\u0275cmp=D.Rb({type:Ha,selectors:[["app-simple-criteria-search"]],decls:87,vars:55,consts:[[1,"container"],[3,"formGroup"],[1,"row"],[1,"col-11"],[1,"row","justify-content-around","margin-row"],[1,"col-6","form-control"],["formControlName","title",3,"validator","label"],["formControlName","description",3,"validator","label"],[1,"col-6","form-control",3,"ngStyle"],["formControlName","guid",3,"validator","label"],["matTooltipClass","vitamui-tooltip",1,"vitamui-icon","vitamui-icon-info-circle","vitamui-row-icon","icon-information",3,"matTooltip","matTooltipShowDelay"],[1,"title-text"],[1,"row","justify-content-around","margin-row","margin-bottom"],[1,"vitamui-input",3,"click"],["class","search-date-label",3,"click",4,"ngIf","ngIfElse"],["showBeginDt",""],["size","0","formControlName","beginDt",1,"hidden",3,"matDatepicker","min"],["pickerBegin",""],["showEndDt",""],["size","0","formControlName","endDt",1,"hidden",3,"matDatepicker","min"],["pickerEnd",""],[1,"row","padding-row"],[1,"criteria-checkbox-choice"],["type","checkbox",3,"checked","click"],[1,"vitamui-icon","vitamui-icon-file","vitamui-row-icon","status-badge","icon-large"],[1,"vitamui-icon","vitamui-icon-folder","vitamui-row-icon","status-badge","icon-large"],[1,"vitamui-mat-select","search-input-criteria"],["formControlName","otherCriteria",2,"font-size","14px","font-weight","700","color","var(--vitamui-primary)",3,"placeholder","valueChange"],["value","",2,"font-size","14px","font-weight","700","color","var(--vitamui-primary)"],[4,"ngFor","ngForOf"],[1,"select-arrow"],[1,"vitamui-icon","vitamui-icon-search","vitamui-row-icon"],[1,"material-icons"],["formControlName","otherCriteriaValue",3,"validator","label",4,"ngIf"],["class","vitamui-input",3,"click",4,"ngIf"],[1,"search-date-label",3,"click"],[3,"click"],["matTooltipClass","vitamui-tooltip",2,"font-size","14px","font-weight","700","color","var(--vitamui-primary)",3,"value","matTooltip","matTooltipShowDelay"],["formControlName","otherCriteriaValue",3,"validator","label"],["showOtherCriteria",""],["size","0","formControlName","otherCriteriaValue",1,"hidden",3,"matDatepicker","min"],["pickerOtherCriteria",""]],template:function(e,t){if(1&e){var i=D.ec();D.dc(0,"div",0),D.dc(1,"form",1),D.dc(2,"div",2),D.dc(3,"div",3),D.dc(4,"div",4),D.dc(5,"div",5),D.Yb(6,"vitamui-common-editable-input",6),D.qc(7,"translate"),D.cc(),D.dc(8,"div",5),D.Yb(9,"vitamui-common-editable-input",7),D.qc(10,"translate"),D.cc(),D.cc(),D.dc(11,"div",4),D.dc(12,"div",8),D.Yb(13,"vitamui-common-editable-input",9),D.qc(14,"translate"),D.Yb(15,"i",10),D.qc(16,"translate"),D.cc(),D.Yb(17,"div",5),D.cc(),D.dc(18,"div",4),D.dc(19,"div",5),D.dc(20,"p",11),D.Vc(21),D.qc(22,"translate"),D.cc(),D.cc(),D.Yb(23,"div",5),D.cc(),D.dc(24,"div",12),D.dc(25,"div",5),D.dc(26,"div",13),D.lc("click",(function(){return D.Kc(i),D.Gc(32).open()})),D.Tc(27,Fa,3,3,"span",14),D.Tc(28,Da,3,4,"ng-template",null,15,D.Uc),D.Yb(30,"input",16),D.Yb(31,"mat-datepicker",null,17),D.cc(),D.cc(),D.dc(33,"div",5),D.dc(34,"div",13),D.lc("click",(function(){return D.Kc(i),D.Gc(40).open()})),D.Tc(35,Ua,3,3,"span",14),D.Tc(36,ka,3,4,"ng-template",null,18,D.Uc),D.Yb(38,"input",19),D.Yb(39,"mat-datepicker",null,20),D.cc(),D.cc(),D.cc(),D.dc(41,"div",4),D.dc(42,"div",5),D.dc(43,"p",11),D.Vc(44),D.qc(45,"translate"),D.cc(),D.cc(),D.dc(46,"div",5),D.dc(47,"p",11),D.Vc(48),D.qc(49,"translate"),D.cc(),D.cc(),D.cc(),D.dc(50,"div",4),D.dc(51,"div",5),D.dc(52,"div",21),D.dc(53,"label",22),D.dc(54,"input",23),D.lc("click",(function(e){return t.addArchiveUnitTypeCriteria("ARCHIVE_UNIT_WITH_OBJECTS",e)})),D.cc(),D.dc(55,"span"),D.Vc(56),D.qc(57,"translate"),D.cc(),D.cc(),D.Yb(58,"i",24),D.cc(),D.dc(59,"div",21),D.dc(60,"label",22),D.dc(61,"input",23),D.lc("click",(function(e){return t.addArchiveUnitTypeCriteria("ARCHIVE_UNIT_WITHOUT_OBJECTS",e)})),D.cc(),D.dc(62,"span"),D.Vc(63),D.qc(64,"translate"),D.cc(),D.cc(),D.Yb(65,"i",25),D.cc(),D.cc(),D.dc(66,"div",5),D.dc(67,"mat-form-field",26),D.dc(68,"mat-select",27),D.lc("valueChange",(function(){return t.onSelectOtherCriteria()})),D.qc(69,"translate"),D.dc(70,"mat-option",28),D.Vc(71),D.qc(72,"translate"),D.cc(),D.Tc(73,Pa,3,4,"ng-container",29),D.cc(),D.dc(74,"div",30),D.Yb(75,"i",31),D.cc(),D.dc(76,"div",30),D.dc(77,"i",32),D.Vc(78,"keyboard_arrow_up"),D.cc(),D.dc(79,"i",32),D.Vc(80,"keyboard_arrow_down"),D.cc(),D.cc(),D.cc(),D.Yb(81,"br"),D.cc(),D.cc(),D.dc(82,"div",4),D.dc(83,"div",8),D.Tc(84,xa,1,2,"vitamui-common-editable-input",33),D.Tc(85,Va,7,4,"div",34),D.cc(),D.cc(),D.Yb(86,"br"),D.cc(),D.cc(),D.cc(),D.cc()}if(2&e){var a=D.Gc(29),c=D.Gc(32),r=D.Gc(37),n=D.Gc(40),s=null,l=null,o=null;D.Lb(1),D.vc("formGroup",t.simpleCriteriaForm),D.Lb(5),D.wc("label",D.rc(7,31,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.TITLE")),D.vc("validator",null==t.simpleCriteriaForm||null==(s=t.simpleCriteriaForm.get("title"))?null:s.validator),D.Lb(3),D.wc("label",D.rc(10,33,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.DESCRIPTION")),D.vc("validator",null==t.simpleCriteriaForm||null==(l=t.simpleCriteriaForm.get("description"))?null:l.validator),D.Lb(3),D.vc("ngStyle",D.zc(53,Ga)),D.Lb(1),D.wc("label",D.rc(14,35,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.UAID")),D.vc("validator",null==t.simpleCriteriaForm||null==(o=t.simpleCriteriaForm.get("guid"))?null:o.validator),D.Lb(2),D.vc("matTooltip",D.rc(16,37,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.GUIDS_SEPARATED"))("matTooltipShowDelay",300),D.Lb(6),D.Wc(D.rc(22,39,"COLLECT.SEARCH_CRITERIA_FILTER.DATES")),D.Lb(6),D.vc("ngIf",!t.simpleCriteriaForm.get("beginDt").value)("ngIfElse",a),D.Lb(3),D.vc("matDatepicker",c)("min",t.simpleCriteriaForm.get("beginDt").value),D.Lb(5),D.vc("ngIf",!t.simpleCriteriaForm.get("endDt").value)("ngIfElse",r),D.Lb(3),D.vc("matDatepicker",n)("min",t.simpleCriteriaForm.get("endDt").value),D.Lb(6),D.Wc(D.rc(45,41,"COLLECT.SEARCH_CRITERIA_FILTER.UA_TYPE")),D.Lb(4),D.Wc(D.rc(49,43,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.OTHER_FIELD")),D.Lb(6),D.vc("checked",t.archiveUnitTypesCriteria.get("ARCHIVE_UNIT_WITH_OBJECTS")),D.Lb(2),D.Wc(D.rc(57,45,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.UNIT_TYPE.ARCHIVE_UNIT_WITH_OBJECTS")),D.Lb(5),D.vc("checked",t.archiveUnitTypesCriteria.get("ARCHIVE_UNIT_WITHOUT_OBJECTS")),D.Lb(2),D.Wc(D.rc(64,47,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.UNIT_TYPE.ARCHIVE_UNIT_WITHOUT_OBJECTS")),D.Lb(5),D.wc("placeholder",D.rc(69,49,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.OTHER_FIELD")),D.Lb(3),D.Xc(" ",D.rc(72,51,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.SELECT_OTHER_FIELD")," "),D.Lb(2),D.vc("ngForOf",t.ontologies),D.Lb(10),D.vc("ngStyle",D.zc(54,qa)),D.Lb(1),D.vc("ngIf",t.otherCriteriaValueEnabled&&("KEYWORD"===t.otherCriteriaValueType||"TEXT"===t.otherCriteriaValueType||"LONG"===t.otherCriteriaValueType||"DOUBLE"===t.otherCriteriaValueType||"BOOLEAN"===t.otherCriteriaValueType)),D.Lb(1),D.vc("ngIf",t.otherCriteriaValueEnabled&&"DATE"===t.otherCriteriaValueType)}},directives:[u.x,u.q,u.i,T.C,u.p,u.h,l.q,me.a,l.p,u.c,h.b,h.a,C.b,R.a,Na.n,l.o],pipes:[P.d,T.Vb],styles:[".icon-information[_ngcontent-%COMP%]{position:absolute;float:right;top:15px;right:-45px;width:30px;height:31px;font-size:26px;font-weight:700}.title-text[_ngcontent-%COMP%]{font-style:normal;font-weight:700;font-size:16px;color:var(--vitamui-primary)!important}.margin-row[_ngcontent-%COMP%]{margin-left:10px}.margin-bottom[_ngcontent-%COMP%]{margin-bottom:15px}.padding-row[_ngcontent-%COMP%]{padding-left:13px}.icon-large[_ngcontent-%COMP%]{font-size:larger}"]}),Ha);function Wa(e,t){if(1&e&&(D.bc(0),D.Vc(1),D.qc(2,"translate"),D.ac()),2&e){var i=D.pc().$implicit,a=D.pc(3);D.Lb(1),D.Xc(" ",(i.keyTranslated?D.rc(2,1,"COLLECT.SEARCH_CRITERIA_FILTER."+a.getCategoryName(a.criteriaVal.category)+"."+a.criteriaVal.key):a.criteriaVal.key)+" : "," ")}}var ja=function(e,t){return[e,t]};function Ya(e,t){if(1&e){var i=D.ec();D.dc(0,"div",8),D.lc("click",(function(){D.Kc(i);var e=D.pc().$implicit,t=D.pc(3);return t.removeCriteria(t.criteriaKey,e.value)})),D.Yb(1,"i",9),D.cc()}if(2&e){var a=D.pc();D.vc("ngClass",D.Bc(1,ja,a.last?"right-arround":"right-button","INCLUDED"===a.$implicit.status?"after-search-launched-button":"before-search-launched-button"))}}function Xa(e,t){if(1&e&&(D.dc(0,"div",10),D.Yb(1,"i",11),D.cc()),2&e){var i=D.pc();D.vc("ngClass",D.Bc(1,ja,i.last?"right-arround":"right-button","INCLUDED"===i.$implicit.status?"after-search-launched-button":"before-search-launched-button"))}}var Ka=function(e){return[e]};function za(e,t){if(1&e&&(D.bc(0),D.dc(1,"div",12),D.Vc(2),D.qc(3,"translate"),D.cc(),D.ac()),2&e){var i=D.pc().$implicit;D.Lb(1),D.vc("ngClass",D.Ac(4,Ka,"INCLUDED"===i.status?"after-search-launched-button":"before-search-launched-button")),D.Lb(1),D.Xc(" ",D.rc(3,2,"COLLECT.SEARCH_CRITERIA_OR")," ")}}function Za(e,t){if(1&e&&(D.bc(0),D.dc(1,"div",5),D.qc(2,"translate"),D.qc(3,"date"),D.qc(4,"translate"),D.Tc(5,Wa,3,3,"ng-container",0),D.Vc(6),D.qc(7,"date"),D.cc(),D.Tc(8,Ya,2,4,"div",6),D.Tc(9,Xa,2,4,"div",7),D.Tc(10,za,4,6,"ng-container",0),D.ac()),2&e){var i=t.$implicit,a=t.first,c=t.last,r=D.pc(3);D.Lb(1),D.yc("matTooltip","",i.keyTranslated?D.rc(2,9,"COLLECT.SEARCH_CRITERIA_FILTER."+r.getCategoryName(r.criteriaVal.category)+"."+r.criteriaVal.key):r.criteriaVal.key,":","DATE"===r.criteriaVal.dataType?D.sc(3,11,i.value.value,"dd/MM/yyyy"):i.valueTranslated?D.rc(4,14,"COLLECT.SEARCH_CRITERIA_FILTER."+r.getCategoryName(r.criteriaVal.category)+"."+i.label):i.label,""),D.vc("matTooltipShowDelay",300)("ngClass",D.Bc(19,ja,a?"left-arround":"left-not-arround","INCLUDED"===i.status?"after-search-launched-button":"before-search-launched-button")),D.Lb(4),D.vc("ngIf",a),D.Lb(1),D.Xc(" ",D.sc(7,16,i.value.value,"dd/MM/yyyy")," "),D.Lb(2),D.vc("ngIf","IN_PROGRESS"!==i.status),D.Lb(1),D.vc("ngIf","IN_PROGRESS"===i.status),D.Lb(1),D.vc("ngIf",!c)}}function $a(e,t){if(1&e&&(D.bc(0),D.Tc(1,Za,11,22,"ng-container",4),D.ac()),2&e){var i=D.pc(2);D.Lb(1),D.vc("ngForOf",i.criteriaVal.values)}}function Qa(e,t){if(1&e&&(D.bc(0),D.Vc(1),D.qc(2,"translate"),D.ac()),2&e){var i=D.pc().$implicit,a=D.pc(3);D.Lb(1),D.Xc(" ",(i.keyTranslated?D.rc(2,1,"COLLECT.SEARCH_CRITERIA_FILTER."+a.getCategoryName(a.criteriaVal.category)+"."+a.criteriaVal.key):a.criteriaVal.key)+" : "," ")}}function Ja(e,t){if(1&e&&(D.bc(0),D.Vc(1),D.qc(2,"translate"),D.qc(3,"date"),D.qc(4,"translate"),D.qc(5,"date"),D.ac()),2&e){var i=D.pc().$implicit;D.Lb(1),D.ad(" ",D.rc(2,4,"COLLECT.SEARCH_CRITERIA_BETWEEN")," ",D.sc(3,6,i.value.beginInterval,"dd/MM/yyyy")," ",D.rc(4,9,"COLLECT.SEARCH_CRITERIA_AND")," ",D.sc(5,11,i.value.endInterval,"dd/MM/yyyy")," ")}}function ec(e,t){if(1&e&&(D.bc(0),D.Vc(1),D.qc(2,"translate"),D.qc(3,"date"),D.ac()),2&e){var i=D.pc().$implicit;D.Lb(1),D.Yc(" ",D.rc(2,2,"COLLECT.SEARCH_CRITERIA_GTE")," ",D.sc(3,4,i.value.beginInterval,"dd/MM/yyyy")," ")}}function tc(e,t){if(1&e&&(D.bc(0),D.Vc(1),D.qc(2,"translate"),D.qc(3,"date"),D.ac()),2&e){var i=D.pc().$implicit;D.Lb(1),D.Yc(" ",D.rc(2,2,"COLLECT.SEARCH_CRITERIA_LTE")," ",D.sc(3,4,i.value.endInterval,"dd/MM/yyyy")," ")}}function ic(e,t){if(1&e){var i=D.ec();D.dc(0,"div",8),D.lc("click",(function(){D.Kc(i);var e=D.pc().$implicit,t=D.pc(3);return t.removeCriteria(t.criteriaKey,e.value)})),D.Yb(1,"i",9),D.cc()}if(2&e){var a=D.pc();D.vc("ngClass",D.Bc(1,ja,a.last?"right-arround":"right-button","INCLUDED"===a.$implicit.status?"after-search-launched-button":"before-search-launched-button"))}}function ac(e,t){if(1&e&&(D.dc(0,"div",10),D.Yb(1,"i",11),D.cc()),2&e){var i=D.pc();D.vc("ngClass",D.Bc(1,ja,i.last?"right-arround":"right-button","INCLUDED"===i.$implicit.status?"after-search-launched-button":"before-search-launched-button"))}}function cc(e,t){if(1&e&&(D.bc(0),D.dc(1,"div",12),D.Vc(2),D.qc(3,"translate"),D.cc(),D.ac()),2&e){var i=D.pc().$implicit;D.Lb(1),D.vc("ngClass",D.Ac(4,Ka,"INCLUDED"===i.status?"after-search-launched-button":"before-search-launched-button")),D.Lb(1),D.Xc(" ",D.rc(3,2,"COLLECT.SEARCH_CRITERIA_OR")," ")}}function rc(e,t){if(1&e&&(D.bc(0),D.dc(1,"div",5),D.qc(2,"translate"),D.Tc(3,Qa,3,3,"ng-container",0),D.Tc(4,Ja,6,14,"ng-container",0),D.Tc(5,ec,4,7,"ng-container",0),D.Tc(6,tc,4,7,"ng-container",0),D.cc(),D.Tc(7,ic,2,4,"div",6),D.Tc(8,ac,2,4,"div",7),D.Tc(9,cc,4,6,"ng-container",0),D.ac()),2&e){var i=t.$implicit,a=t.first,c=t.last,r=D.pc(3);D.Lb(1),D.wc("matTooltip",i.keyTranslated?D.rc(2,10,"COLLECT.SEARCH_CRITERIA_FILTER."+r.getCategoryName(r.criteriaVal.category)+"."+r.criteriaVal.key):r.criteriaVal.key),D.vc("matTooltipShowDelay",300)("ngClass",D.Bc(12,ja,a?"left-arround":"left-not-arround","INCLUDED"===i.status?"after-search-launched-button":"before-search-launched-button")),D.Lb(2),D.vc("ngIf",a),D.Lb(1),D.vc("ngIf",i.value.beginInterval&&i.value.endInterval),D.Lb(1),D.vc("ngIf",i.value.beginInterval&&!i.value.endInterval),D.Lb(1),D.vc("ngIf",!i.value.beginInterval&&i.value.endInterval),D.Lb(1),D.vc("ngIf","IN_PROGRESS"!==i.status),D.Lb(1),D.vc("ngIf","IN_PROGRESS"===i.status),D.Lb(1),D.vc("ngIf",!c)}}function nc(e,t){if(1&e&&(D.bc(0),D.Tc(1,rc,10,15,"ng-container",4),D.ac()),2&e){var i=D.pc(2);D.Lb(1),D.vc("ngForOf",i.criteriaVal.values)}}function sc(e,t){if(1&e&&(D.bc(0),D.dc(1,"div",5),D.qc(2,"translate"),D.qc(3,"translate"),D.Vc(4),D.qc(5,"translate"),D.qc(6,"translate"),D.cc(),D.ac()),2&e){var i=D.pc(4);D.Lb(1),D.vc("matTooltip",("EQ"===i.criteriaVal.operator?D.rc(2,4,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.GUID_TO_INCLUDE"):D.rc(3,6,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.GUID_TO_EXCLUDE"))+" : "+i.criteriaVal.values[0].label)("matTooltipShowDelay",300)("ngClass",D.Bc(12,ja,i.isFirst?"left-arround":"left-not-arround","INCLUDED"===i.criteriaVal.values[i.criteriaVal.values.length-1].status?"after-search-launched-button":"before-search-launched-button")),D.Lb(3),D.Xc(" ",("EQ"===i.criteriaVal.operator?D.rc(5,8,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.GUID_TO_INCLUDE"):D.rc(6,10,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.GUID_TO_EXCLUDE"))+" : "+i.criteriaVal.values[i.criteriaVal.values.length-1].label," ")}}function lc(e,t){if(1&e&&(D.bc(0),D.dc(1,"div",5),D.qc(2,"translate"),D.qc(3,"translate"),D.Vc(4),D.qc(5,"translate"),D.qc(6,"translate"),D.cc(),D.ac()),2&e){var i=D.pc(4);D.Lb(1),D.vc("matTooltip",("EQ"===i.criteriaVal.operator?D.rc(2,4,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.GUIDS_TO_INCLUDE"):D.rc(3,6,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.GUIDS_TO_EXCLUDE"))+" : "+i.criteriaVal.values.length)("matTooltipShowDelay",300)("ngClass",D.Bc(12,ja,i.isFirst?"left-arround":"left-not-arround","INCLUDED"===i.criteriaVal.values[i.criteriaVal.values.length-1].status?"after-search-launched-button":"before-search-launched-button")),D.Lb(3),D.Xc(" ",("EQ"===i.criteriaVal.operator?D.rc(5,8,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.GUIDS_TO_INCLUDE"):D.rc(6,10,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.GUIDS_TO_EXCLUDE"))+" : "+i.criteriaVal.values.length," ")}}function oc(e,t){if(1&e){var i=D.ec();D.dc(0,"div",8),D.lc("click",(function(){D.Kc(i);var e=D.pc(4);return e.removeCriteriaAllValues(e.criteriaKey)})),D.Yb(1,"i",9),D.cc()}if(2&e){var a=D.pc(4);D.vc("ngClass",D.Bc(1,ja,a.isLast?"right-arround":"right-button","INCLUDED"===a.criteriaVal.values[a.criteriaVal.values.length-1].status?"after-search-launched-button":"before-search-launched-button"))}}function uc(e,t){if(1&e&&(D.dc(0,"div",10),D.Yb(1,"i",11),D.cc()),2&e){var i=D.pc(4);D.vc("ngClass",D.Bc(1,ja,i.isLast?"right-arround":"right-button","INCLUDED"===i.criteriaVal.values[i.criteriaVal.values.length-1].status?"after-search-launched-button":"before-search-launched-button"))}}function dc(e,t){if(1&e&&(D.bc(0),D.Tc(1,sc,7,15,"ng-container",0),D.Tc(2,lc,7,15,"ng-container",0),D.Tc(3,oc,2,4,"div",6),D.Tc(4,uc,2,4,"div",7),D.ac()),2&e){var i=D.pc(3);D.Lb(1),D.vc("ngIf",1===i.criteriaVal.values.length),D.Lb(1),D.vc("ngIf",i.criteriaVal.values.length>1),D.Lb(1),D.vc("ngIf","IN_PROGRESS"!==i.criteriaVal.values[i.criteriaVal.values.length-1].status),D.Lb(1),D.vc("ngIf","IN_PROGRESS"===i.criteriaVal.values[i.criteriaVal.values.length-1].status)}}function hc(e,t){1&e&&D.Yb(0,"i",15)}function vc(e,t){if(1&e&&(D.bc(0),D.Tc(1,hc,1,0,"i",14),D.Vc(2),D.qc(3,"translate"),D.ac()),2&e){var i=D.pc().$implicit,a=D.pc(4);D.Lb(1),D.vc("ngIf","NODE"===a.criteriaKey),D.Lb(1),D.Xc(" ",(i.keyTranslated?D.rc(3,2,"COLLECT.SEARCH_CRITERIA_FILTER."+a.getCategoryName(a.criteriaVal.category)+"."+a.criteriaVal.key):a.criteriaVal.key)+" : "," ")}}function Cc(e,t){if(1&e){var i=D.ec();D.dc(0,"div",8),D.lc("click",(function(){D.Kc(i);var e=D.pc().$implicit,t=D.pc(4);return t.removeCriteria(t.criteriaKey,e.value)})),D.Yb(1,"i",9),D.cc()}if(2&e){var a=D.pc();D.vc("ngClass",D.Bc(1,ja,a.last?"right-arround":"right-button","INCLUDED"===a.$implicit.status?"after-search-launched-button":"before-search-launched-button"))}}function Ec(e,t){if(1&e&&(D.dc(0,"div",10),D.Yb(1,"i",11),D.cc()),2&e){var i=D.pc();D.vc("ngClass",D.Bc(1,ja,i.last?"right-arround":"right-button","INCLUDED"===i.$implicit.status?"after-search-launched-button":"before-search-launched-button"))}}function Rc(e,t){if(1&e&&(D.dc(0,"div",12),D.Vc(1),D.qc(2,"translate"),D.cc()),2&e){var i=D.pc().$implicit;D.vc("ngClass",D.Ac(4,Ka,"INCLUDED"===i.status?"after-search-launched-button":"before-search-launched-button")),D.Lb(1),D.Xc(" ",D.rc(2,2,"COLLECT.SEARCH_CRITERIA_OR")," ")}}function pc(e,t){if(1&e&&(D.bc(0),D.dc(1,"div",5),D.qc(2,"translate"),D.qc(3,"translate"),D.Tc(4,vc,4,4,"ng-container",0),D.Vc(5),D.qc(6,"translate"),D.qc(7,"truncate"),D.cc(),D.Tc(8,Cc,2,4,"div",6),D.Tc(9,Ec,2,4,"div",7),D.Tc(10,Rc,3,6,"div",13),D.ac()),2&e){var i=t.$implicit,a=t.first,c=t.last,r=D.pc(4);D.Lb(1),D.yc("matTooltip","",i.keyTranslated?D.rc(2,9,"COLLECT.SEARCH_CRITERIA_FILTER."+r.getCategoryName(r.criteriaVal.category)+"."+r.criteriaVal.key):r.criteriaVal.key,":",i.valueTranslated?D.rc(3,11,"COLLECT.SEARCH_CRITERIA_FILTER."+r.getCategoryName(r.criteriaVal.category)+"."+i.label):i.label,""),D.vc("matTooltipShowDelay",300)("ngClass",D.Bc(18,ja,a?"left-arround":"left-not-arround","INCLUDED"===i.status?"after-search-launched-button":"before-search-launched-button")),D.Lb(3),D.vc("ngIf",a),D.Lb(1),D.Xc(" ",i.valueTranslated?D.rc(6,13,"COLLECT.SEARCH_CRITERIA_FILTER."+r.getCategoryName(r.criteriaVal.category)+"."+i.label):D.sc(7,15,i.label,50)," "),D.Lb(3),D.vc("ngIf","IN_PROGRESS"!==i.status),D.Lb(1),D.vc("ngIf","IN_PROGRESS"===i.status),D.Lb(1),D.vc("ngIf",!c)}}function fc(e,t){if(1&e&&(D.bc(0),D.Tc(1,pc,11,21,"ng-container",4),D.ac()),2&e){var i=D.pc(3);D.Lb(1),D.vc("ngForOf",i.criteriaVal.values)}}function Ic(e,t){if(1&e&&(D.bc(0),D.Tc(1,dc,5,4,"ng-container",0),D.Tc(2,fc,2,1,"ng-container",0),D.ac()),2&e){var i=D.pc(2);D.Lb(1),D.vc("ngIf","GUID"===i.criteriaVal.key),D.Lb(1),D.vc("ngIf","GUID"!==i.criteriaVal.key)}}function Tc(e,t){if(1&e&&(D.bc(0),D.dc(1,"div",1),D.dc(2,"ul",2),D.dc(3,"li",3),D.Tc(4,$a,2,1,"ng-container",0),D.Tc(5,nc,2,1,"ng-container",0),D.Tc(6,Ic,3,2,"ng-container",0),D.cc(),D.cc(),D.cc(),D.ac()),2&e){var i=D.pc();D.Lb(4),D.vc("ngIf","DATE"===i.criteriaVal.dataType),D.Lb(1),D.vc("ngIf","INTERVAL"===i.criteriaVal.dataType),D.Lb(1),D.vc("ngIf","STRING"===i.criteriaVal.dataType)}}var gc,Lc,bc,mc,Ac,Sc,_c=((Sc=function(){function e(){o(this,e),this.criteriaRemoveEvent=new D.p}return d(e,[{key:"ngOnInit",value:function(){}},{key:"removeCriteria",value:function(e,t){this.criteriaRemoveEvent.emit({keyElt:e,valueElt:t})}},{key:"getCategoryName",value:function(e){return T.Z[e]}},{key:"removeCriteriaAllValues",value:function(e){var t=this;this.criteriaVal.values.forEach((function(i){t.removeCriteria(e,i.value)}))}}]),e}()).\u0275fac=function(e){return new(e||Sc)},Sc.\u0275cmp=D.Rb({type:Sc,selectors:[["app-criteria-search"]],inputs:{criteriaKey:"criteriaKey",criteriaVal:"criteriaVal"},outputs:{criteriaRemoveEvent:"criteriaRemoveEvent"},decls:1,vars:1,consts:[[4,"ngIf"],["id","chip"],[1,"vitamui-search-criteria-list"],[1,"vitamui-search-criteria"],[4,"ngFor","ngForOf"],["matTooltipClass","vitamui-tooltip",1,"button-content","right-button",3,"matTooltip","matTooltipShowDelay","ngClass"],["class","vitamui-remove-search-criteria",3,"ngClass","click",4,"ngIf"],["class","vitamui-remove-search-criteria",3,"ngClass",4,"ngIf"],[1,"vitamui-remove-search-criteria",3,"ngClass","click"],[1,"vitamui-icon","vitamui-icon-cross","vitamui-row-icon"],[1,"vitamui-remove-search-criteria",3,"ngClass"],[1,"vitamui-icon","vitamui-icon-loop2","vitamui-row-icon"],[1,"button-or","left-not-arround","right-button",3,"ngClass"],["class","button-or left-not-arround right-button",3,"ngClass",4,"ngIf"],["class","vitamui-icon vitamui-icon-radio-checked vitamui-row-icon",4,"ngIf"],[1,"vitamui-icon","vitamui-icon-radio-checked","vitamui-row-icon"]],template:function(e,t){1&e&&D.Tc(0,Tc,7,3,"ng-container",0),2&e&&D.vc("ngIf",t.criteriaKey&&t.criteriaVal)},directives:[l.p,l.o,me.a,l.n],pipes:[P.d,l.e,T.Yb],styles:[".after-search-launched-button[_ngcontent-%COMP%]{color:#fff;background-color:#2c76c9;border:1px solid #9d9d9d;box-sizing:border-box;border-top-left-radius:0;border-bottom-left-radius:0}.before-search-launched-button[_ngcontent-%COMP%]{box-sizing:border-box;border:1px solid #9d9d9d;border-left:0}.criteria-group[_ngcontent-%COMP%]{padding:10px}.left-arround[_ngcontent-%COMP%]{border-top-left-radius:5px;border-bottom-left-radius:5px;border:1px solid #9d9d9d}.left-not-arround[_ngcontent-%COMP%]{border:1px solid #9d9d9d}.left-not-arround[_ngcontent-%COMP%], .right-arround[_ngcontent-%COMP%]{border-top-left-radius:0;border-bottom-left-radius:0}.right-arround[_ngcontent-%COMP%]{border-top-right-radius:5px;border-bottom-right-radius:5px;border:1px solid #9d9d9d;border-left:0}.right-button[_ngcontent-%COMP%]{border-top-right-radius:0;border-bottom-right-radius:0;border:1px solid #9d9d9d;border-left:0}.button-or[_ngcontent-%COMP%]{border-right-width:0;border-left-width:0}.button-content[_ngcontent-%COMP%], .button-or[_ngcontent-%COMP%]{padding-left:10px;padding-right:10px;height:60px;font-weight:700;padding-top:18px}.button-content[_ngcontent-%COMP%]{max-width:680px;border:1px solid #9d9d9d}.vitamui-chip-list[_ngcontent-%COMP%]   .button-criteria[_ngcontent-%COMP%]{background:#fff!important;border:solid #bdbdbd!important}.button-remove[_ngcontent-%COMP%]{padding-left:4px;padding-right:0;border:1px solid #9d9d9d}.hide-ink[_ngcontent-%COMP%]{cursor:pointer;color:#702382;text-decoration:underline;font-weight:700;margin-top:10px;margin-bottom:10px;padding-left:30px}.launch-search-btn[_ngcontent-%COMP%]{width:218px;height:50px;background:#702382;border-radius:100px;color:#fff;font-size:14px;font-weight:700;letter-spacing:.1px;-webkit-text-decoration-line:underline;text-decoration-line:underline}.button-remove[_ngcontent-%COMP%]{border-left-width:0;padding-left:10px;padding-right:10px;max-width:400px;font-weight:700;height:60px}.hide-area-search[_ngcontent-%COMP%]{margin-bottom:10px}.area-criteria[_ngcontent-%COMP%]{padding-top:20px;display:flex;flex-direction:row;justify-content:flex-start;flex-wrap:wrap}.area-download[_ngcontent-%COMP%]{text-align:right;right:5px}.icon-download[_ngcontent-%COMP%]{color:var(--vitamui-primary);padding-right:10px;padding-left:10px;font-size:22px}.search-criterias[_ngcontent-%COMP%]{font-size:large;font-weight:700;margin-top:50px}.left-margin[_ngcontent-%COMP%]{margin-left:30%}.show-panel[_ngcontent-%COMP%]{display:none}.hide-panel[_ngcontent-%COMP%]{display:block}  .my-menu{max-width:380px}.circle[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;align-items:center;padding:13px;position:static;width:50px;height:50px;left:0;top:0;background:var(--vitamui-secondary);border-radius:50px;flex:none;order:0;flex-grow:0;border:none}.circle[_ngcontent-%COMP%]:focus{border:none;outline:0 auto -webkit-focus-ring-color;outline-color:-webkit-focus-ring-color;outline-style:auto;outline-width:0}.primary-save-icon[_ngcontent-%COMP%]{color:#fff}.mat-boutton[_ngcontent-%COMP%], .mat-boutton[_ngcontent-%COMP%]:focus, .mat-boutton[_ngcontent-%COMP%]:hover   .mat-boutton[_ngcontent-%COMP%]:focus{border:none;background:#f5f7fc}.mat-boutton[_ngcontent-%COMP%]:focus{outline:0 auto -webkit-focus-ring-color;outline-color:-webkit-focus-ring-color;outline-style:auto;outline-width:0}.mat-boutton[_ngcontent-%COMP%]:active{background:#f5f7fc;border:none}.div-btn-delete[_ngcontent-%COMP%]{width:78px}.btn-add[_ngcontent-%COMP%]{color:#757575;font-size:37x}.btn-new-save[_ngcontent-%COMP%]{font-size:16px}.button-space[_ngcontent-%COMP%]{margin-left:-20px;padding-left:30px}.vitamui-search-criteria-list[_ngcontent-%COMP%]{display:initial;flex-wrap:wrap;align-items:flex-start;height:60px}.vitamui-search-criteria-list[_ngcontent-%COMP%]   .vitamui-search-criteria[_ngcontent-%COMP%]{display:flex;align-items:stretch;font-size:13px;cursor:pointer;min-width:100px}.vitamui-search-criteria-list[_ngcontent-%COMP%]   .vitamui-search-criteria[_ngcontent-%COMP%]:not(:last-child){margin-right:10px;margin-bottom:10px}.vitamui-search-criteria-list[_ngcontent-%COMP%]   .vitamui-search-criteria[_ngcontent-%COMP%]   .vitamui-search-criteria-content[_ngcontent-%COMP%]{padding:6px 10px;flex-grow:1}.vitamui-search-criteria-list[_ngcontent-%COMP%]   .vitamui-search-criteria[_ngcontent-%COMP%]   .vitamui-remove-search-criteria[_ngcontent-%COMP%]{display:flex;align-items:center;border-top:1px solid #9d9d9d;border-right:solid #9d9d9d;border-bottom:1px solid #9d9d9d;padding:6px}.vitamui-search-criteria-list[_ngcontent-%COMP%]   .vitamui-search-criteria[_ngcontent-%COMP%]   .vitamui-remove-search-criteria[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:14px}.vitamui-search-criteria-list[_ngcontent-%COMP%]   .vitamui-search-criteria[_ngcontent-%COMP%]   .vitamui-or-search-criteria[_ngcontent-%COMP%]{display:flex;align-items:center;border-top:1px solid #9d9d9d;border-right:1px solid #9d9d9d;border-bottom:1px solid #9d9d9d;padding:6px}.vitamui-search-criteria-list[_ngcontent-%COMP%]   .vitamui-search-criteria[_ngcontent-%COMP%]   .vitamui-or-search-criteria[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:14px}.vitamui-search-criteria[_ngcontent-%COMP%]{background-color:#fff;border:1px solid #f0f0f0;border-radius:5px;color:var(--vitamui-grey-900);font-size:12px;font-weight:700}"]}),Sc),Oc=((Ac=function(){function e(t,i,a){o(this,e),this.facetsService=t,this.translateService=i,this.datePipe=a,this.rulesFacetDetails=[],this.expiredRulesFacetDetails=[],this.finalActionFacetDetails=[],this.archiveUnitsCountFacetDetails=[]}return d(e,[{key:"ngOnInit",value:function(){}},{key:"ngOnChanges",value:function(){this.finalActionsFacetsValues=new Map,this.rulesFacetDetails=[],this.expiredRulesFacetDetails=[],this.finalActionFacetDetails=[],this.archiveUnitsCountFacetDetails=[];var e=0;this.storageRuleFacets&&(e=this.handleWaitingToRecalculateRulesFacets(),this.handleFinalActionsRulesFacets(),this.handleRulesDisctinctsFacets(),this.handleRulesExpirationFacets(e))}},{key:"handleRulesExpirationFacets",value:function(e){var t=this,i=0;this.dateFilterValue=this.datePipe.transform(new Date,"dd-MM-yyyy"),this.storageRuleFacets.expiredRulesListFacets&&this.storageRuleFacets.expiredRulesListFacets.length>0&&this.storageRuleFacets.expiredRulesListFacets.forEach((function(e){e&&e.node&&e.node.length>10&&(t.dateFilterValue=" "+e.node.substring(e.node.length-10,e.node.length),i=e.count?e.count:0)})),this.expiredRulesFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.STORAGE_RULE.EXPIRED"),totalResults:this.facetsService.getFacetTextByExactCountFlag(i,this.exactCount,this.totalResults),clickable:!1,color:T.q.GRAY,filter:">"+this.dateFilterValue,backgroundColor:T.q.DISABLED}),this.expiredRulesFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.STORAGE_RULE.NOT_EXPIRED"),totalResults:this.facetsService.getFacetTextByExactCountFlag(e-i,this.exactCount,this.totalResults),clickable:!1,color:T.q.GRAY,filter:"<"+this.dateFilterValue,backgroundColor:T.q.DISABLED})}},{key:"handleRulesDisctinctsFacets",value:function(){this.rulesFacetDetails.push(this.storageRuleFacets.rulesListFacets&&this.storageRuleFacets.rulesListFacets.length>0?{title:this.translateService.instant("COLLECT.FACETS.STORAGE_RULE.DISTINCT_RULES"),totalResults:this.facetsService.getFacetTextByExactCountFlag(this.storageRuleFacets.rulesListFacets.length,this.exactCount,this.totalResults),clickable:!1,color:T.q.GRAY,backgroundColor:T.q.DISABLED}:{title:this.translateService.instant("COLLECT.FACETS.STORAGE_RULE.DISTINCT_RULES"),totalResults:this.facetsService.getFacetTextByExactCountFlag(0,this.exactCount,this.totalResults),clickable:!1,color:T.q.GRAY,backgroundColor:T.q.DISABLED})}},{key:"handleFinalActionsRulesFacets",value:function(){var e=this;this.finalActionsFacetsValues.set("COPY",0),this.finalActionsFacetsValues.set("TRANSFER",0),this.finalActionsFacetsValues.set("RESTRICTACCESS",0),this.storageRuleFacets.finalActionsFacets&&this.storageRuleFacets.finalActionsFacets.forEach((function(t){e.finalActionsFacetsValues.set(t.node.toUpperCase(),t.count?t.count:0)})),this.finalActionFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.STORAGE_RULE.COPY"),totalResults:this.facetsService.getFacetTextByExactCountFlag(this.finalActionsFacetsValues.get("COPY"),this.exactCount,this.totalResults),clickable:!1,color:T.q.GRAY,backgroundColor:T.q.DISABLED}),this.finalActionFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.STORAGE_RULE.TRANSFER"),totalResults:this.facetsService.getFacetTextByExactCountFlag(this.finalActionsFacetsValues.get("TRANSFER"),this.exactCount,this.totalResults),clickable:!1,color:T.q.GRAY,backgroundColor:T.q.DISABLED}),this.finalActionFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.STORAGE_RULE.RESTRICT_ACCESS"),totalResults:this.facetsService.getFacetTextByExactCountFlag(this.finalActionsFacetsValues.get("RESTRICTACCESS"),this.exactCount,this.totalResults),clickable:!1,color:T.q.GRAY,backgroundColor:T.q.DISABLED})}},{key:"handleWaitingToRecalculateRulesFacets",value:function(){var e=this,t=0;if(this.storageRuleFacets.waitingToRecalculateRulesListFacets&&this.storageRuleFacets.waitingToRecalculateRulesListFacets.length>0){var i,a,c=this.storageRuleFacets.waitingToRecalculateRulesListFacets.filter((function(e){return"true"===e.node}));i=c.length>0&&c[0].count?c[0].count:0,a=!this.exactCount&&(this.totalResults>=Ge.RESULTS_MAX_NUMBER||i>=Ge.RESULTS_MAX_NUMBER)?Ge.BIG_RESULTS_FACETS_DEFAULT_TEXT:(this.totalResults-i).toString(),this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.STORAGE_RULE.WAITING_TO_RECALCULATE"),totalResults:a,clickable:!1,color:"0"===a?T.q.GRAY:T.q.ORANGE,backgroundColor:T.q.DISABLED}),this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.STORAGE_RULE.CALCULATED"),totalResults:this.facetsService.getFacetTextByExactCountFlag(i,this.exactCount,this.totalResults),clickable:!1,color:T.q.GRAY,backgroundColor:T.q.DISABLED}),t=i}else this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.STORAGE_RULE.WAITING_TO_RECALCULATE"),totalResults:this.facetsService.getFacetTextByExactCountFlag(this.totalResults,this.exactCount,this.totalResults),clickable:!1,color:0===this.totalResults?T.q.GRAY:T.q.ORANGE,backgroundColor:T.q.DISABLED}),this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.STORAGE_RULE.CALCULATED"),totalResults:this.facetsService.getFacetTextByExactCountFlag(0,this.exactCount,this.totalResults),clickable:!1,color:T.q.GRAY,backgroundColor:T.q.DISABLED});return this.storageRuleFacets.noRulesFacets&&this.storageRuleFacets.noRulesFacets.length>0?this.storageRuleFacets.noRulesFacets.forEach((function(i){e.archiveUnitsCountFacetDetails.push({title:e.translateService.instant("COLLECT.FACETS.STORAGE_RULE.WITHOUT_RULES"),totalResults:e.facetsService.getFacetTextByExactCountFlag(i.count,e.exactCount,e.totalResults),clickable:!1,color:T.q.GRAY,backgroundColor:T.q.DISABLED}),t-=i.count?i.count:0})):this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.STORAGE_RULE.WITHOUT_RULES"),totalResults:this.facetsService.getFacetTextByExactCountFlag(0,this.exactCount,this.totalResults),clickable:!1,color:T.q.GRAY,backgroundColor:T.q.DISABLED}),t}}]),e}()).\u0275fac=function(e){return new(e||Ac)(D.Xb(qe),D.Xb(P.e),D.Xb(l.e))},Ac.\u0275cmp=D.Rb({type:Ac,selectors:[["app-search-storage-rules-facets"]],inputs:{storageRuleFacets:"storageRuleFacets",totalResults:"totalResults",exactCount:"exactCount"},features:[D.Jb],decls:14,vars:19,consts:[["id","facet-row"],["id","count-facet-details"],[3,"facetDetails","facetTitle"],["id","rules-facet-details"],["id","expired-rules-facet-details"],[3,"facetDetails","facetSubTitle","facetTitle"],["id","final-action-facetDetails"]],template:function(e,t){1&e&&(D.dc(0,"div",0),D.dc(1,"div",1),D.Yb(2,"app-vitamui-facet",2),D.qc(3,"translate"),D.cc(),D.dc(4,"div",3),D.Yb(5,"app-vitamui-facet",2),D.qc(6,"translate"),D.cc(),D.dc(7,"div",4),D.Yb(8,"app-vitamui-facet",5),D.qc(9,"translate"),D.qc(10,"translate"),D.cc(),D.dc(11,"div",6),D.Yb(12,"app-vitamui-facet",2),D.qc(13,"translate"),D.cc(),D.cc()),2&e&&(D.Lb(2),D.vc("facetDetails",t.archiveUnitsCountFacetDetails)("facetTitle",D.rc(3,9,"COLLECT.FACETS.STORAGE_RULE.ARCHIVE_UNITS_COUNT")),D.Lb(3),D.vc("facetDetails",t.rulesFacetDetails)("facetTitle",D.rc(6,11,"COLLECT.FACETS.STORAGE_RULE.RULES_COUNT")),D.Lb(3),D.vc("facetDetails",t.expiredRulesFacetDetails)("facetSubTitle",D.rc(9,13,"COLLECT.FACETS.STORAGE_RULE.FROM_DATE")+" "+t.dateFilterValue)("facetTitle",D.rc(10,15,"COLLECT.FACETS.STORAGE_RULE.EXPIRED_RULES")),D.Lb(4),D.vc("facetDetails",t.finalActionFacetDetails)("facetTitle",D.rc(13,17,"COLLECT.FACETS.STORAGE_RULE.FINAL_ACTIONS")))},directives:[T.Tb],pipes:[P.d],styles:["#facet-row[_ngcontent-%COMP%]{display:flex;width:100%;align-items:flex-start;justify-content:space-between}#count-facet-details[_ngcontent-%COMP%]{width:35%}#rules-facet-details[_ngcontent-%COMP%]{width:13%}#expired-rules-facet-details[_ngcontent-%COMP%]{width:21%}#final-action-facetDetails[_ngcontent-%COMP%]{width:27%}"]}),Ac),yc=((mc=function(){function e(t,i,a){o(this,e),this.facetsService=t,this.translateService=i,this.datePipe=a,this.rulesFacetDetails=[],this.expiredRulesFacetDetails=[],this.finalActionFacetDetails=[],this.archiveUnitsCountFacetDetails=[]}return d(e,[{key:"ngOnInit",value:function(){}},{key:"ngOnChanges",value:function(){this.finalActionsFacetsValues=new Map,this.rulesFacetDetails=[],this.expiredRulesFacetDetails=[],this.finalActionFacetDetails=[],this.archiveUnitsCountFacetDetails=[];var e=0;this.appraisalRuleFacets&&(e=this.handleWaitingToRecalculateRulesFacets(),this.handleFinalActionsRulesFacets(),this.handleRulesDisctinctsFacets(),this.handleRulesExpirationFacets(e))}},{key:"getFacetTextByExactCountFlag",value:function(e,t){var i=e.toString();return!t&&this.totalResults>=Ge.RESULTS_MAX_NUMBER&&(i=Ge.BIG_RESULTS_FACETS_DEFAULT_TEXT),i}},{key:"handleRulesExpirationFacets",value:function(e){var t=this,i=0;this.dateFilterValue=this.datePipe.transform(new Date,"dd-MM-yyyy"),this.appraisalRuleFacets.expiredRulesListFacets&&this.appraisalRuleFacets.expiredRulesListFacets.length>0&&this.appraisalRuleFacets.expiredRulesListFacets.forEach((function(e){e&&e.node&&e.node.length>10&&(t.dateFilterValue=" "+e.node.substring(e.node.length-10,e.node.length),i=e.count?e.count:0)})),this.expiredRulesFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.APPRAISAL_RULE.EXPIRED"),totalResults:this.facetsService.getFacetTextByExactCountFlag(i,this.exactCount,this.totalResults),clickable:!1,color:T.q.GRAY,filter:">"+this.dateFilterValue,backgroundColor:T.q.DISABLED}),this.expiredRulesFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.APPRAISAL_RULE.NOT_EXPIRED"),totalResults:this.facetsService.getFacetTextByExactCountFlag(e-i,this.exactCount,this.totalResults),clickable:!1,color:T.q.GRAY,filter:"<"+this.dateFilterValue,backgroundColor:T.q.DISABLED})}},{key:"handleRulesDisctinctsFacets",value:function(){this.rulesFacetDetails.push(this.appraisalRuleFacets.rulesListFacets&&this.appraisalRuleFacets.rulesListFacets.length>0?{title:this.translateService.instant("COLLECT.FACETS.APPRAISAL_RULE.DISTINCT_RULES"),totalResults:this.facetsService.getFacetTextByExactCountFlag(this.appraisalRuleFacets.rulesListFacets.length,this.exactCount,this.totalResults),clickable:!1,color:T.q.GRAY,backgroundColor:T.q.DISABLED}:{title:this.translateService.instant("COLLECT.FACETS.APPRAISAL_RULE.DISTINCT_RULES"),totalResults:this.facetsService.getFacetTextByExactCountFlag(0,this.exactCount,this.totalResults),clickable:!1,color:T.q.GRAY,backgroundColor:T.q.DISABLED})}},{key:"handleFinalActionsRulesFacets",value:function(){var e=this;this.finalActionsFacetsValues.set("KEEP",0),this.finalActionsFacetsValues.set("DESTROY",0),this.finalActionsFacetsValues.set("CONFLICT",0),this.appraisalRuleFacets.finalActionsFacets&&this.appraisalRuleFacets.finalActionsFacets.forEach((function(t){e.finalActionsFacetsValues.set(t.node.toUpperCase(),t.count?t.count:0)})),this.finalActionFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.APPRAISAL_RULE.KEEP"),totalResults:this.facetsService.getFacetTextByExactCountFlag(this.finalActionsFacetsValues.get("KEEP"),this.exactCount,this.totalResults),clickable:!1,color:T.q.GREEN,filter:"KEEP",backgroundColor:T.q.DISABLED}),this.finalActionFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.APPRAISAL_RULE.DESTROY"),totalResults:this.facetsService.getFacetTextByExactCountFlag(this.finalActionsFacetsValues.get("DESTROY"),this.exactCount,this.totalResults),clickable:!1,color:T.q.ORANGE,filter:"DESTROY",backgroundColor:T.q.DISABLED}),this.finalActionFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.APPRAISAL_RULE.CONFLICT"),totalResults:this.facetsService.getFacetTextByExactCountFlag(this.finalActionsFacetsValues.get("CONFLICT"),this.exactCount,this.totalResults),clickable:!1,color:T.q.RED,filter:"CONFLICT",backgroundColor:T.q.DISABLED})}},{key:"handleWaitingToRecalculateRulesFacets",value:function(){var e=this,t=0;if(this.appraisalRuleFacets.waitingToRecalculateRulesListFacets&&this.appraisalRuleFacets.waitingToRecalculateRulesListFacets.length>0){var i,a,c=this.appraisalRuleFacets.waitingToRecalculateRulesListFacets.filter((function(e){return"true"===e.node}));i=c.length>0&&c[0].count?c[0].count:0,a=!this.exactCount&&(this.totalResults>=Ge.RESULTS_MAX_NUMBER||i>=Ge.RESULTS_MAX_NUMBER)?Ge.BIG_RESULTS_FACETS_DEFAULT_TEXT:(this.totalResults-i).toString(),this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.APPRAISAL_RULE.WAITING_TO_RECALCULATE"),totalResults:a,clickable:!1,color:"0"===a?T.q.GRAY:T.q.ORANGE,backgroundColor:T.q.DISABLED}),this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.APPRAISAL_RULE.CALCULATED"),totalResults:this.facetsService.getFacetTextByExactCountFlag(i,this.exactCount,this.totalResults),clickable:!1,color:T.q.GRAY,backgroundColor:T.q.DISABLED}),t=i}else this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.APPRAISAL_RULE.WAITING_TO_RECALCULATE"),totalResults:this.facetsService.getFacetTextByExactCountFlag(this.totalResults,this.exactCount,this.totalResults),clickable:!1,color:0===this.totalResults?T.q.GRAY:T.q.ORANGE,backgroundColor:T.q.DISABLED}),this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.APPRAISAL_RULE.CALCULATED"),totalResults:this.facetsService.getFacetTextByExactCountFlag(0,this.exactCount,this.totalResults),clickable:!1,color:T.q.GRAY,backgroundColor:T.q.DISABLED});return this.appraisalRuleFacets.noRulesFacets&&this.appraisalRuleFacets.noRulesFacets.length>0?this.appraisalRuleFacets.noRulesFacets.forEach((function(i){e.archiveUnitsCountFacetDetails.push({title:e.translateService.instant("COLLECT.FACETS.APPRAISAL_RULE.WITHOUT_RULES"),totalResults:e.facetsService.getFacetTextByExactCountFlag(i.count,e.exactCount,e.totalResults),clickable:!1,color:T.q.GRAY,backgroundColor:T.q.DISABLED}),t-=i.count?i.count:0})):this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.APPRAISAL_RULE.WITHOUT_RULES"),totalResults:this.facetsService.getFacetTextByExactCountFlag(0,this.exactCount,this.totalResults),clickable:!1,color:T.q.GRAY,backgroundColor:T.q.DISABLED}),t}}]),e}()).\u0275fac=function(e){return new(e||mc)(D.Xb(qe),D.Xb(P.e),D.Xb(l.e))},mc.\u0275cmp=D.Rb({type:mc,selectors:[["app-search-appraisal-rules-facets"]],inputs:{appraisalRuleFacets:"appraisalRuleFacets",totalResults:"totalResults",exactCount:"exactCount"},features:[D.Jb],decls:14,vars:19,consts:[["id","facet-row"],["id","count-facet-details"],[3,"facetDetails","facetTitle"],["id","rules-facet-details"],["id","expired-rules-facet-details"],[3,"facetDetails","facetSubTitle","facetTitle"],["id","final-action-facetDetails"]],template:function(e,t){1&e&&(D.dc(0,"div",0),D.dc(1,"div",1),D.Yb(2,"app-vitamui-facet",2),D.qc(3,"translate"),D.cc(),D.dc(4,"div",3),D.Yb(5,"app-vitamui-facet",2),D.qc(6,"translate"),D.cc(),D.dc(7,"div",4),D.Yb(8,"app-vitamui-facet",5),D.qc(9,"translate"),D.qc(10,"translate"),D.cc(),D.dc(11,"div",6),D.Yb(12,"app-vitamui-facet",2),D.qc(13,"translate"),D.cc(),D.cc()),2&e&&(D.Lb(2),D.vc("facetDetails",t.archiveUnitsCountFacetDetails)("facetTitle",D.rc(3,9,"COLLECT.FACETS.APPRAISAL_RULE.ARCHIVE_UNITS_COUNT")),D.Lb(3),D.vc("facetDetails",t.rulesFacetDetails)("facetTitle",D.rc(6,11,"COLLECT.FACETS.APPRAISAL_RULE.RULES_COUNT")),D.Lb(3),D.vc("facetDetails",t.expiredRulesFacetDetails)("facetSubTitle",D.rc(9,13,"COLLECT.FACETS.APPRAISAL_RULE.FROM_DATE")+" "+t.dateFilterValue)("facetTitle",D.rc(10,15,"COLLECT.FACETS.APPRAISAL_RULE.EXPIRED_RULES")),D.Lb(4),D.vc("facetDetails",t.finalActionFacetDetails)("facetTitle",D.rc(13,17,"COLLECT.FACETS.APPRAISAL_RULE.FINAL_ACTIONS")))},directives:[T.Tb],pipes:[P.d],styles:["#facet-row[_ngcontent-%COMP%]{display:flex;width:100%;align-items:flex-start;justify-content:space-between}#count-facet-details[_ngcontent-%COMP%]{width:35%}#rules-facet-details[_ngcontent-%COMP%]{width:13%}#expired-rules-facet-details[_ngcontent-%COMP%]{width:21%}#final-action-facetDetails[_ngcontent-%COMP%]{width:27%}"]}),mc),Nc=((bc=function(){function e(t,i,a){o(this,e),this.facetsService=t,this.translateService=i,this.datePipe=a,this.rulesFacetDetails=[],this.expiredRulesFacetDetails=[],this.finalActionFacetDetails=[],this.archiveUnitsCountFacetDetails=[]}return d(e,[{key:"ngOnInit",value:function(){}},{key:"ngOnChanges",value:function(){this.finalActionsFacetsValues=new Map,this.rulesFacetDetails=[],this.expiredRulesFacetDetails=[],this.finalActionFacetDetails=[],this.archiveUnitsCountFacetDetails=[];var e=0;this.accessRuleFacets&&(e=this.handleWaitingToRecalculateRulesFacets(),this.handleRulesDisctinctsFacets(),this.handleRulesExpirationFacets(e))}},{key:"handleRulesExpirationFacets",value:function(e){var t=this,i=0;this.dateFilterValue=this.datePipe.transform(new Date,"dd-MM-yyyy"),this.accessRuleFacets.expiredRulesListFacets&&this.accessRuleFacets.expiredRulesListFacets.length>0&&this.accessRuleFacets.expiredRulesListFacets.forEach((function(e){e&&e.node&&e.node.length>10&&(t.dateFilterValue=" "+e.node.substring(e.node.length-10,e.node.length),i=e.count?e.count:0)})),this.expiredRulesFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.ACCESS_RULE.EXPIRED"),totalResults:this.facetsService.getFacetTextByExactCountFlag(i,this.exactCount,this.totalResults),clickable:!1,color:T.q.GRAY,filter:">"+this.dateFilterValue,backgroundColor:T.q.DISABLED}),this.expiredRulesFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.ACCESS_RULE.NOT_EXPIRED"),totalResults:this.facetsService.getFacetTextByExactCountFlag(e-i,this.exactCount,this.totalResults),clickable:!1,color:T.q.GRAY,filter:"<"+this.dateFilterValue,backgroundColor:T.q.DISABLED})}},{key:"handleRulesDisctinctsFacets",value:function(){this.rulesFacetDetails.push(this.accessRuleFacets.rulesListFacets&&this.accessRuleFacets.rulesListFacets.length>0?{title:this.translateService.instant("COLLECT.FACETS.ACCESS_RULE.DISTINCT_RULES"),totalResults:this.facetsService.getFacetTextByExactCountFlag(this.accessRuleFacets.rulesListFacets.length,this.exactCount,this.totalResults),clickable:!1,color:T.q.GRAY,backgroundColor:T.q.DISABLED}:{title:this.translateService.instant("COLLECT.FACETS.ACCESS_RULE.DISTINCT_RULES"),totalResults:this.facetsService.getFacetTextByExactCountFlag(0,this.exactCount,this.totalResults),clickable:!1,color:T.q.GRAY,backgroundColor:T.q.DISABLED})}},{key:"handleWaitingToRecalculateRulesFacets",value:function(){var e=this,t=0;if(this.accessRuleFacets.waitingToRecalculateRulesListFacets&&this.accessRuleFacets.waitingToRecalculateRulesListFacets.length>0){var i,a,c=this.accessRuleFacets.waitingToRecalculateRulesListFacets.filter((function(e){return"true"===e.node}));i=c.length>0&&c[0].count?c[0].count:0,a=!this.exactCount&&(this.totalResults>=Ge.RESULTS_MAX_NUMBER||i>=Ge.RESULTS_MAX_NUMBER)?Ge.BIG_RESULTS_FACETS_DEFAULT_TEXT:(this.totalResults-i).toString(),this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.ACCESS_RULE.WAITING_TO_RECALCULATE"),totalResults:a,clickable:!1,color:"0"===a?T.q.GRAY:T.q.ORANGE,backgroundColor:T.q.DISABLED}),this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.ACCESS_RULE.CALCULATED"),totalResults:this.facetsService.getFacetTextByExactCountFlag(i,this.exactCount,this.totalResults),clickable:!1,color:T.q.GRAY,backgroundColor:T.q.DISABLED}),t=i}else this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.APPRAISAL_RULE.WAITING_TO_RECALCULATE"),totalResults:this.facetsService.getFacetTextByExactCountFlag(this.totalResults,this.exactCount,this.totalResults),clickable:!1,color:0===this.totalResults?T.q.GRAY:T.q.ORANGE,backgroundColor:T.q.DISABLED}),this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.APPRAISAL_RULE.CALCULATED"),totalResults:this.facetsService.getFacetTextByExactCountFlag(0,this.exactCount,this.totalResults),clickable:!1,color:T.q.GRAY,backgroundColor:T.q.DISABLED});return this.accessRuleFacets.noRulesFacets&&this.accessRuleFacets.noRulesFacets.length>0?this.accessRuleFacets.noRulesFacets.forEach((function(i){e.archiveUnitsCountFacetDetails.push({title:e.translateService.instant("COLLECT.FACETS.APPRAISAL_RULE.WITHOUT_RULES"),totalResults:e.facetsService.getFacetTextByExactCountFlag(i.count,e.exactCount,e.totalResults),clickable:!1,color:T.q.GRAY,backgroundColor:T.q.DISABLED}),t-=i.count?i.count:0})):this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.APPRAISAL_RULE.WITHOUT_RULES"),totalResults:this.facetsService.getFacetTextByExactCountFlag(0,this.exactCount,this.totalResults),clickable:!1,color:T.q.GRAY,backgroundColor:T.q.DISABLED}),t}}]),e}()).\u0275fac=function(e){return new(e||bc)(D.Xb(qe),D.Xb(P.e),D.Xb(l.e))},bc.\u0275cmp=D.Rb({type:bc,selectors:[["app-search-access-rules-facets"]],inputs:{accessRuleFacets:"accessRuleFacets",totalResults:"totalResults",exactCount:"exactCount"},features:[D.Jb],decls:11,vars:15,consts:[["id","facet-row"],["id","count-facet-details"],[3,"facetDetails","facetTitle"],["id","rules-facet-details"],["id","expired-rules-facet-details"],[3,"facetDetails","facetSubTitle","facetTitle"]],template:function(e,t){1&e&&(D.dc(0,"div",0),D.dc(1,"div",1),D.Yb(2,"app-vitamui-facet",2),D.qc(3,"translate"),D.cc(),D.dc(4,"div",3),D.Yb(5,"app-vitamui-facet",2),D.qc(6,"translate"),D.cc(),D.dc(7,"div",4),D.Yb(8,"app-vitamui-facet",5),D.qc(9,"translate"),D.qc(10,"translate"),D.cc(),D.cc()),2&e&&(D.Lb(2),D.vc("facetDetails",t.archiveUnitsCountFacetDetails)("facetTitle",D.rc(3,7,"COLLECT.FACETS.ACCESS_RULE.ARCHIVE_UNITS_COUNT")),D.Lb(3),D.vc("facetDetails",t.rulesFacetDetails)("facetTitle",D.rc(6,9,"COLLECT.FACETS.ACCESS_RULE.RULES_COUNT")),D.Lb(3),D.vc("facetDetails",t.expiredRulesFacetDetails)("facetSubTitle",D.rc(9,11,"COLLECT.FACETS.ACCESS_RULE.FROM_DATE")+" "+t.dateFilterValue)("facetTitle",D.rc(10,13,"COLLECT.FACETS.ACCESS_RULE.EXPIRED_RULES")))},directives:[T.Tb],pipes:[P.d],styles:["#facet-row[_ngcontent-%COMP%]{display:flex;width:100%;align-items:flex-start;justify-content:first baseline}#count-facet-details[_ngcontent-%COMP%]{width:35%}#rules-facet-details[_ngcontent-%COMP%]{width:13%}#expired-rules-facet-details[_ngcontent-%COMP%]{width:21%}"]}),bc),Fc=((Lc=function(){function e(t,i,a){o(this,e),this.facetsService=t,this.translateService=i,this.datePipe=a,this.rulesFacetDetails=[],this.expiredRulesFacetDetails=[],this.finalActionFacetDetails=[],this.archiveUnitsCountFacetDetails=[]}return d(e,[{key:"ngOnInit",value:function(){}},{key:"ngOnChanges",value:function(){this.finalActionsFacetsValues=new Map,this.rulesFacetDetails=[],this.expiredRulesFacetDetails=[],this.finalActionFacetDetails=[],this.archiveUnitsCountFacetDetails=[];var e=0;this.disseminationRuleFacets&&(e=this.handleWaitingToRecalculateRulesFacets(),this.handleRulesDisctinctsFacets(),this.handleRulesExpirationFacets(e))}},{key:"getFacetTextByExactCountFlag",value:function(e,t){var i=e.toString();return!t&&this.totalResults>=Ge.RESULTS_MAX_NUMBER&&(i=Ge.BIG_RESULTS_FACETS_DEFAULT_TEXT),i}},{key:"handleRulesExpirationFacets",value:function(e){var t=this,i=0;this.dateFilterValue=this.datePipe.transform(new Date,"dd-MM-yyyy"),this.disseminationRuleFacets.expiredRulesListFacets&&this.disseminationRuleFacets.expiredRulesListFacets.length>0&&this.disseminationRuleFacets.expiredRulesListFacets.forEach((function(e){e&&e.node&&e.node.length>10&&(t.dateFilterValue=" "+e.node.substring(e.node.length-10,e.node.length),i=e.count?e.count:0)})),this.expiredRulesFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.DISSEMINATION_RULE.EXPIRED"),totalResults:this.facetsService.getFacetTextByExactCountFlag(i,this.exactCount,this.totalResults),clickable:!1,color:T.q.GRAY,filter:">"+this.dateFilterValue,backgroundColor:T.q.DISABLED}),this.expiredRulesFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.DISSEMINATION_RULE.NOT_EXPIRED"),totalResults:this.facetsService.getFacetTextByExactCountFlag(e-i,this.exactCount,this.totalResults),clickable:!1,color:T.q.GRAY,filter:"<"+this.dateFilterValue,backgroundColor:T.q.DISABLED})}},{key:"handleRulesDisctinctsFacets",value:function(){this.rulesFacetDetails.push(this.disseminationRuleFacets.rulesListFacets&&this.disseminationRuleFacets.rulesListFacets.length>0?{title:this.translateService.instant("COLLECT.FACETS.DISSEMINATION_RULE.DISTINCT_RULES"),totalResults:this.facetsService.getFacetTextByExactCountFlag(this.disseminationRuleFacets.rulesListFacets.length,this.exactCount,this.totalResults),clickable:!1,color:T.q.GRAY,backgroundColor:T.q.DISABLED}:{title:this.translateService.instant("COLLECT.FACETS.DISSEMINATION_RULE.DISTINCT_RULES"),totalResults:this.facetsService.getFacetTextByExactCountFlag(0,this.exactCount,this.totalResults),clickable:!1,color:T.q.GRAY,backgroundColor:T.q.DISABLED})}},{key:"handleWaitingToRecalculateRulesFacets",value:function(){var e=this,t=0;if(this.disseminationRuleFacets.waitingToRecalculateRulesListFacets&&this.disseminationRuleFacets.waitingToRecalculateRulesListFacets.length>0){var i,a,c=this.disseminationRuleFacets.waitingToRecalculateRulesListFacets.filter((function(e){return"true"===e.node}));i=c.length>0&&c[0].count?c[0].count:0,a=!this.exactCount&&(this.totalResults>=Ge.RESULTS_MAX_NUMBER||i>=Ge.RESULTS_MAX_NUMBER)?Ge.BIG_RESULTS_FACETS_DEFAULT_TEXT:(this.totalResults-i).toString(),this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.DISSEMINATION_RULE.WAITING_TO_RECALCULATE"),totalResults:a,clickable:!1,color:"0"===a?T.q.GRAY:T.q.ORANGE,backgroundColor:T.q.DISABLED}),this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.DISSEMINATION_RULE.CALCULATED"),totalResults:this.facetsService.getFacetTextByExactCountFlag(i,this.exactCount,this.totalResults),clickable:!1,color:T.q.GRAY,backgroundColor:T.q.DISABLED}),t=i}else this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.DISSEMINATION_RULE.WAITING_TO_RECALCULATE"),totalResults:this.facetsService.getFacetTextByExactCountFlag(this.totalResults,this.exactCount,this.totalResults),clickable:!1,color:0===this.totalResults?T.q.GRAY:T.q.ORANGE,backgroundColor:T.q.DISABLED}),this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.DISSEMINATION_RULE.CALCULATED"),totalResults:this.facetsService.getFacetTextByExactCountFlag(0,this.exactCount,this.totalResults),clickable:!1,color:T.q.GRAY,backgroundColor:T.q.DISABLED});return this.disseminationRuleFacets.noRulesFacets&&this.disseminationRuleFacets.noRulesFacets.length>0?this.disseminationRuleFacets.noRulesFacets.forEach((function(i){e.archiveUnitsCountFacetDetails.push({title:e.translateService.instant("COLLECT.FACETS.DISSEMINATION_RULE.WITHOUT_RULES"),totalResults:e.facetsService.getFacetTextByExactCountFlag(i.count,e.exactCount,e.totalResults),clickable:!1,color:T.q.GRAY,backgroundColor:T.q.DISABLED}),t-=i.count?i.count:0})):this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.DISSEMINATION_RULE.WITHOUT_RULES"),totalResults:this.facetsService.getFacetTextByExactCountFlag(0,this.exactCount,this.totalResults),clickable:!1,color:T.q.GRAY,backgroundColor:T.q.DISABLED}),t}}]),e}()).\u0275fac=function(e){return new(e||Lc)(D.Xb(qe),D.Xb(P.e),D.Xb(l.e))},Lc.\u0275cmp=D.Rb({type:Lc,selectors:[["app-search-dissemination-rules-facets"]],inputs:{disseminationRuleFacets:"disseminationRuleFacets",totalResults:"totalResults",exactCount:"exactCount"},features:[D.Jb],decls:11,vars:15,consts:[["id","facet-row"],["id","count-facet-details"],[3,"facetDetails","facetTitle"],["id","rules-facet-details"],["id","expired-rules-facet-details"],[3,"facetDetails","facetSubTitle","facetTitle"]],template:function(e,t){1&e&&(D.dc(0,"div",0),D.dc(1,"div",1),D.Yb(2,"app-vitamui-facet",2),D.qc(3,"translate"),D.cc(),D.dc(4,"div",3),D.Yb(5,"app-vitamui-facet",2),D.qc(6,"translate"),D.cc(),D.dc(7,"div",4),D.Yb(8,"app-vitamui-facet",5),D.qc(9,"translate"),D.qc(10,"translate"),D.cc(),D.cc()),2&e&&(D.Lb(2),D.vc("facetDetails",t.archiveUnitsCountFacetDetails)("facetTitle",D.rc(3,7,"COLLECT.FACETS.DISSEMINATION_RULE.ARCHIVE_UNITS_COUNT")),D.Lb(3),D.vc("facetDetails",t.rulesFacetDetails)("facetTitle",D.rc(6,9,"COLLECT.FACETS.DISSEMINATION_RULE.RULES_COUNT")),D.Lb(3),D.vc("facetDetails",t.expiredRulesFacetDetails)("facetSubTitle",D.rc(9,11,"COLLECT.FACETS.DISSEMINATION_RULE.FROM_DATE")+" "+t.dateFilterValue)("facetTitle",D.rc(10,13,"COLLECT.FACETS.DISSEMINATION_RULE.EXPIRED_RULES")))},directives:[T.Tb],pipes:[P.d],styles:["#facet-row[_ngcontent-%COMP%]{display:flex;width:100%;align-items:flex-start;justify-content:first baseline}#count-facet-details[_ngcontent-%COMP%]{width:35%}#rules-facet-details[_ngcontent-%COMP%]{width:13%}#expired-rules-facet-details[_ngcontent-%COMP%]{width:21%}"]}),Lc),Dc=((gc=function(){function e(t,i,a){o(this,e),this.facetsService=t,this.translateService=i,this.datePipe=a,this.rulesFacetDetails=[],this.expiredRulesFacetDetails=[],this.finalActionFacetDetails=[],this.archiveUnitsCountFacetDetails=[]}return d(e,[{key:"ngOnInit",value:function(){}},{key:"ngOnChanges",value:function(){this.finalActionsFacetsValues=new Map,this.rulesFacetDetails=[],this.expiredRulesFacetDetails=[],this.finalActionFacetDetails=[],this.archiveUnitsCountFacetDetails=[];var e=0;this.reuseRuleFacets&&(e=this.handleWaitingToRecalculateRulesFacets(),this.handleRulesDisctinctsFacets(),this.handleRulesExpirationFacets(e))}},{key:"getFacetTextByExactCountFlag",value:function(e,t){var i=e.toString();return!t&&this.totalResults>=Ge.RESULTS_MAX_NUMBER&&(i=Ge.BIG_RESULTS_FACETS_DEFAULT_TEXT),i}},{key:"handleRulesExpirationFacets",value:function(e){var t=this,i=0;this.dateFilterValue=this.datePipe.transform(new Date,"dd-MM-yyyy"),this.reuseRuleFacets.expiredRulesListFacets&&this.reuseRuleFacets.expiredRulesListFacets.length>0&&this.reuseRuleFacets.expiredRulesListFacets.forEach((function(e){e&&e.node&&e.node.length>10&&(t.dateFilterValue=" "+e.node.substring(e.node.length-10,e.node.length),i=e.count?e.count:0)})),this.expiredRulesFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.REUSE_RULE.EXPIRED"),totalResults:this.facetsService.getFacetTextByExactCountFlag(i,this.exactCount,this.totalResults),clickable:!1,color:T.q.GRAY,filter:">"+this.dateFilterValue,backgroundColor:T.q.DISABLED}),this.expiredRulesFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.REUSE_RULE.NOT_EXPIRED"),totalResults:this.facetsService.getFacetTextByExactCountFlag(e-i,this.exactCount,this.totalResults),clickable:!1,color:T.q.GRAY,filter:"<"+this.dateFilterValue,backgroundColor:T.q.DISABLED})}},{key:"handleRulesDisctinctsFacets",value:function(){this.rulesFacetDetails.push(this.reuseRuleFacets.rulesListFacets&&this.reuseRuleFacets.rulesListFacets.length>0?{title:this.translateService.instant("COLLECT.FACETS.REUSE_RULE.DISTINCT_RULES"),totalResults:this.facetsService.getFacetTextByExactCountFlag(this.reuseRuleFacets.rulesListFacets.length,this.exactCount,this.totalResults),clickable:!1,color:T.q.GRAY,backgroundColor:T.q.DISABLED}:{title:this.translateService.instant("COLLECT.FACETS.REUSE_RULE.DISTINCT_RULES"),totalResults:this.facetsService.getFacetTextByExactCountFlag(0,this.exactCount,this.totalResults),clickable:!1,color:T.q.GRAY,backgroundColor:T.q.DISABLED})}},{key:"handleWaitingToRecalculateRulesFacets",value:function(){var e=this,t=0;if(this.reuseRuleFacets.waitingToRecalculateRulesListFacets&&this.reuseRuleFacets.waitingToRecalculateRulesListFacets.length>0){var i,a,c=this.reuseRuleFacets.waitingToRecalculateRulesListFacets.filter((function(e){return"true"===e.node}));i=c.length>0&&c[0].count?c[0].count:0,a=!this.exactCount&&(this.totalResults>=Ge.RESULTS_MAX_NUMBER||i>=Ge.RESULTS_MAX_NUMBER)?Ge.BIG_RESULTS_FACETS_DEFAULT_TEXT:(this.totalResults-i).toString(),this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.REUSE_RULE.WAITING_TO_RECALCULATE"),totalResults:a,clickable:!1,color:"0"===a?T.q.GRAY:T.q.ORANGE,backgroundColor:T.q.DISABLED}),this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.REUSE_RULE.CALCULATED"),totalResults:this.facetsService.getFacetTextByExactCountFlag(i,this.exactCount,this.totalResults),clickable:!1,color:T.q.GRAY,backgroundColor:T.q.DISABLED}),t=i}else this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.REUSE_RULE.WAITING_TO_RECALCULATE"),totalResults:this.facetsService.getFacetTextByExactCountFlag(this.totalResults,this.exactCount,this.totalResults),clickable:!1,color:0===this.totalResults?T.q.GRAY:T.q.ORANGE,backgroundColor:T.q.DISABLED}),this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.REUSE_RULE.CALCULATED"),totalResults:this.facetsService.getFacetTextByExactCountFlag(0,this.exactCount,this.totalResults),clickable:!1,color:T.q.GRAY,backgroundColor:T.q.DISABLED});return this.reuseRuleFacets.noRulesFacets&&this.reuseRuleFacets.noRulesFacets.length>0?this.reuseRuleFacets.noRulesFacets.forEach((function(i){e.archiveUnitsCountFacetDetails.push({title:e.translateService.instant("COLLECT.FACETS.REUSE_RULE.WITHOUT_RULES"),totalResults:e.facetsService.getFacetTextByExactCountFlag(i.count,e.exactCount,e.totalResults),clickable:!1,color:T.q.GRAY,backgroundColor:T.q.DISABLED}),t-=i.count?i.count:0})):this.archiveUnitsCountFacetDetails.push({title:this.translateService.instant("COLLECT.FACETS.REUSE_RULE.WITHOUT_RULES"),totalResults:this.facetsService.getFacetTextByExactCountFlag(0,this.exactCount,this.totalResults),clickable:!1,color:T.q.GRAY,backgroundColor:T.q.DISABLED}),t}}]),e}()).\u0275fac=function(e){return new(e||gc)(D.Xb(qe),D.Xb(P.e),D.Xb(l.e))},gc.\u0275cmp=D.Rb({type:gc,selectors:[["app-search-reuse-rules-facets"]],inputs:{reuseRuleFacets:"reuseRuleFacets",totalResults:"totalResults",exactCount:"exactCount"},features:[D.Jb],decls:11,vars:15,consts:[["id","facet-row"],["id","count-facet-details"],[3,"facetDetails","facetTitle"],["id","rules-facet-details"],["id","expired-rules-facet-details"],[3,"facetDetails","facetSubTitle","facetTitle"]],template:function(e,t){1&e&&(D.dc(0,"div",0),D.dc(1,"div",1),D.Yb(2,"app-vitamui-facet",2),D.qc(3,"translate"),D.cc(),D.dc(4,"div",3),D.Yb(5,"app-vitamui-facet",2),D.qc(6,"translate"),D.cc(),D.dc(7,"div",4),D.Yb(8,"app-vitamui-facet",5),D.qc(9,"translate"),D.qc(10,"translate"),D.cc(),D.cc()),2&e&&(D.Lb(2),D.vc("facetDetails",t.archiveUnitsCountFacetDetails)("facetTitle",D.rc(3,7,"COLLECT.FACETS.REUSE_RULE.ARCHIVE_UNITS_COUNT")),D.Lb(3),D.vc("facetDetails",t.rulesFacetDetails)("facetTitle",D.rc(6,9,"COLLECT.FACETS.REUSE_RULE.RULES_COUNT")),D.Lb(3),D.vc("facetDetails",t.expiredRulesFacetDetails)("facetSubTitle",D.rc(9,11,"COLLECT.FACETS.REUSE_RULE.FROM_DATE")+" "+t.dateFilterValue)("facetTitle",D.rc(10,13,"COLLECT.FACETS.REUSE_RULE.EXPIRED_RULES")))},directives:[T.Tb],pipes:[P.d],styles:["#facet-row[_ngcontent-%COMP%]{display:flex;width:100%;align-items:flex-start;justify-content:first baseline}#count-facet-details[_ngcontent-%COMP%]{width:35%}#rules-facet-details[_ngcontent-%COMP%]{width:13%}#expired-rules-facet-details[_ngcontent-%COMP%]{width:21%}"]}),gc);function Uc(e,t){if(1&e){var i=D.ec();D.dc(0,"span",3),D.lc("click",(function(){return D.Kc(i),D.pc().showHideFacets(!0)})),D.Vc(1),D.qc(2,"translate"),D.cc()}2&e&&(D.Lb(1),D.Xc(" ",D.rc(2,1,"COLLECT.CRITERIA_CATEGORY.STORAGE_RULE")," "))}function kc(e,t){if(1&e&&(D.dc(0,"div",4),D.Yb(1,"app-search-storage-rules-facets",5),D.cc()),2&e){var i=D.pc();D.Lb(1),D.vc("totalResults",i.totalResults)("exactCount",i.exactCount)("storageRuleFacets",i.storageRuleFacets)}}function Pc(e,t){if(1&e){var i=D.ec();D.dc(0,"span",3),D.lc("click",(function(){return D.Kc(i),D.pc().showHideFacets(!0)})),D.Vc(1),D.qc(2,"translate"),D.cc()}2&e&&(D.Lb(1),D.Xc(" ",D.rc(2,1,"COLLECT.CRITERIA_CATEGORY.APPRAISAL_RULE")," "))}function xc(e,t){if(1&e&&(D.dc(0,"div",4),D.Yb(1,"app-search-appraisal-rules-facets",6),D.cc()),2&e){var i=D.pc();D.Lb(1),D.vc("totalResults",i.totalResults)("exactCount",i.exactCount)("appraisalRuleFacets",i.appraisalRuleFacets)}}function wc(e,t){if(1&e){var i=D.ec();D.dc(0,"span",3),D.lc("click",(function(){return D.Kc(i),D.pc().showHideFacets(!0)})),D.Vc(1),D.qc(2,"translate"),D.cc()}2&e&&(D.Lb(1),D.Xc(" ",D.rc(2,1,"COLLECT.CRITERIA_CATEGORY.ACCESS_RULE")," "))}function Mc(e,t){if(1&e&&(D.dc(0,"div",4),D.Yb(1,"app-search-access-rules-facets",7),D.cc()),2&e){var i=D.pc();D.Lb(1),D.vc("exactCount",i.exactCount)("totalResults",i.totalResults)("accessRuleFacets",i.accessRuleFacets)}}function Vc(e,t){if(1&e){var i=D.ec();D.dc(0,"span",3),D.lc("click",(function(){return D.Kc(i),D.pc().showHideFacets(!0)})),D.Vc(1),D.qc(2,"translate"),D.cc()}2&e&&(D.Lb(1),D.Xc(" ",D.rc(2,1,"COLLECT.CRITERIA_CATEGORY.DISSEMINATION")," "))}function Hc(e,t){if(1&e&&(D.dc(0,"div",4),D.Yb(1,"app-search-dissemination-rules-facets",8),D.cc()),2&e){var i=D.pc();D.Lb(1),D.vc("totalResults",i.totalResults)("exactCount",i.exactCount)("disseminationRuleFacets",i.disseminationRuleFacets)}}function Gc(e,t){if(1&e){var i=D.ec();D.dc(0,"span",3),D.lc("click",(function(){return D.Kc(i),D.pc().showHideFacets(!0)})),D.Vc(1),D.qc(2,"translate"),D.cc()}2&e&&(D.Lb(1),D.Xc(" ",D.rc(2,1,"COLLECT.CRITERIA_CATEGORY.REUSE")," "))}function qc(e,t){if(1&e&&(D.dc(0,"div",4),D.Yb(1,"app-search-reuse-rules-facets",9),D.cc()),2&e){var i=D.pc();D.Lb(1),D.vc("exactCount",i.exactCount)("totalResults",i.totalResults)("reuseRuleFacets",i.reuseRuleFacets)}}var Bc,Wc,jc=((Bc=function(){function e(){o(this,e),this.facetsVisibles=!0}return d(e,[{key:"showHideFacets",value:function(e){this.facetsVisibles=e}},{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Bc)},Bc.\u0275cmp=D.Rb({type:Bc,selectors:[["app-archive-search-rules-facets"]],inputs:{totalResults:"totalResults",appraisalRuleFacets:"appraisalRuleFacets",accessRuleFacets:"accessRuleFacets",storageRuleFacets:"storageRuleFacets",disseminationRuleFacets:"disseminationRuleFacets",reuseRuleFacets:"reuseRuleFacets",classificationRuleFacets:"classificationRuleFacets",holdRuleFacets:"holdRuleFacets",tenantIdentifier:"tenantIdentifier",exactCount:"exactCount",defaultFacetTabIndex:"defaultFacetTabIndex"},decls:16,vars:6,consts:[[3,"selectedIndex"],["mat-tab-label",""],["id","facet-content",4,"ngIf"],[3,"click"],["id","facet-content"],[3,"totalResults","exactCount","storageRuleFacets"],[3,"totalResults","exactCount","appraisalRuleFacets"],[3,"exactCount","totalResults","accessRuleFacets"],[3,"totalResults","exactCount","disseminationRuleFacets"],[3,"exactCount","totalResults","reuseRuleFacets"]],template:function(e,t){1&e&&(D.dc(0,"mat-tab-group",0),D.dc(1,"mat-tab"),D.Tc(2,Uc,3,3,"ng-template",1),D.Tc(3,kc,2,3,"div",2),D.cc(),D.dc(4,"mat-tab"),D.Tc(5,Pc,3,3,"ng-template",1),D.Tc(6,xc,2,3,"div",2),D.cc(),D.dc(7,"mat-tab"),D.Tc(8,wc,3,3,"ng-template",1),D.Tc(9,Mc,2,3,"div",2),D.cc(),D.dc(10,"mat-tab"),D.Tc(11,Vc,3,3,"ng-template",1),D.Tc(12,Hc,2,3,"div",2),D.cc(),D.dc(13,"mat-tab"),D.Tc(14,Gc,3,3,"ng-template",1),D.Tc(15,qc,2,3,"div",2),D.cc(),D.cc()),2&e&&(D.vc("selectedIndex",t.defaultFacetTabIndex),D.Lb(3),D.vc("ngIf",t.facetsVisibles),D.Lb(3),D.vc("ngIf",t.facetsVisibles),D.Lb(3),D.vc("ngIf",t.facetsVisibles),D.Lb(3),D.vc("ngIf",t.facetsVisibles),D.Lb(3),D.vc("ngIf",t.facetsVisibles))},directives:[f.b,f.a,f.c,l.p,Oc,yc,Nc,Fc,Dc],pipes:[P.d],styles:["#show-hide-facet-button[_ngcontent-%COMP%]{position:relative;float:right;cursor:pointer;width:40px;border:1px solid #bdbdbd;box-sizing:border-box;border-radius:20px;padding:10px;font-size:large;font-weight:700}#facet-content[_ngcontent-%COMP%]{margin:0 5px;padding:0 5px}"]}),Bc),Yc=n("8lHc"),Xc=((Wc=function(){function e(t,i){o(this,e),this.managementRulesSharedDataService=t,this.archiveSharedDataService=i,this.debounceTime=400}return d(e,[{key:"uniqueRuleId",value:function(e){return this.uniqueFields("ruleId","ruleIdExists",e)}},{key:"getRuleType",value:function(e){switch(e){case"APPRAISAL_RULE":return"AppraisalRule";case"STORAGE_RULE":return"StorageRule";case"ACCESS_RULE":return"AccessRule";case"REUSE_RULE":return"ReuseRule";case"CLASSIFICATION_RULE":return"ClassificationRule";case"HOLD_RULE":return"HoldRule";case"DISSEMINATION_RULE":return"DisseminationRule";default:return null}}},{key:"uniqueFields",value:function(e,t,i){var a=this;return this.archiveSharedDataService.getRuleCategory().subscribe((function(e){a.ruleCategorySelected=e})),function(c){var r={};if(c.value){r[e]=c.value,r.ruleType=a.getRuleType(a.ruleCategorySelected);var n={};return n[t]=!0,Object(Yc.a)(a.debounceTime).pipe(Object(ei.a)((function(){return c.value!==i?a.managementRulesSharedDataService.existsProperties(r):Object(ee.a)(!1)})),Object(z.a)(1),Object(y.a)((function(e){return e?null:n})))}return Object(ee.a)(!1)}}}]),e}()).\u0275fac=function(e){return new(e||Wc)(D.ic(ya),D.ic(Le))},Wc.\u0275prov=D.Tb({token:Wc,factory:Wc.\u0275fac,providedIn:"root"}),Wc),Kc=n("PBFl");function zc(e,t){if(1&e){var i=D.ec();D.dc(0,"span",35),D.lc("click",(function(){return D.Kc(i),D.pc(),D.Gc(38).open()})),D.Vc(1),D.qc(2,"translate"),D.cc()}if(2&e){var a=D.pc();D.Lb(1),D.Wc(D.rc(2,1,a.endDateInterval?"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.END_DATE_DUA_BEGIN":"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.END_DATE_DUA_EQUAL"))}}function Zc(e,t){if(1&e){var i=D.ec();D.dc(0,"span",36),D.lc("click",(function(){return D.Kc(i),D.pc(),D.Gc(38).open()})),D.Vc(1),D.qc(2,"date"),D.cc()}if(2&e){var a=D.pc();D.Lb(1),D.Xc("",D.sc(2,1,a.storageRuleCriteriaForm.get("storageRuleStartDate").value,"dd/MM/yyyy")," ")}}function $c(e,t){if(1&e){var i=D.ec();D.dc(0,"button",37),D.lc("click",(function(){return D.Kc(i),D.pc().addBeginDtDucCriteria()})),D.dc(1,"i",38),D.Vc(2,"check"),D.cc(),D.cc()}}function Qc(e,t){if(1&e){var i=D.ec();D.dc(0,"p",39),D.lc("click",(function(){return D.Kc(i),D.pc().updateEndDateInterval(!0)})),D.Vc(1),D.qc(2,"translate"),D.cc()}2&e&&(D.Lb(1),D.Xc(" ",D.rc(2,1,"COLLECT.SEARCH_CRITERIA_FILTER.STORAGE_RULE.CREATE_INTERVAL")," "))}function Jc(e,t){if(1&e){var i=D.ec();D.dc(0,"span",35),D.lc("click",(function(){return D.Kc(i),D.pc(),D.Gc(6).open()})),D.Vc(1),D.qc(2,"translate"),D.cc()}2&e&&(D.Lb(1),D.Wc(D.rc(2,1,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.END_DATE_DUA_END")))}function er(e,t){if(1&e){var i=D.ec();D.dc(0,"span",36),D.lc("click",(function(){return D.Kc(i),D.pc(),D.Gc(6).open()})),D.Vc(1),D.qc(2,"date"),D.cc()}if(2&e){var a=D.pc(2);D.Lb(1),D.Xc("",D.sc(2,1,a.storageRuleCriteriaForm.get("storageRuleEndDate").value,"dd/MM/yyyy")," ")}}function tr(e,t){if(1&e){var i=D.ec();D.dc(0,"div",13),D.lc("click",(function(){return D.Kc(i),D.Gc(6).open()})),D.Tc(1,Jc,3,3,"span",14),D.Tc(2,er,3,4,"ng-template",null,40,D.Uc),D.Yb(4,"input",41),D.Yb(5,"mat-datepicker",null,42),D.cc()}if(2&e){var a=D.Gc(3),c=D.Gc(6),r=D.pc();D.Lb(1),D.vc("ngIf",!r.storageRuleCriteriaForm.get("storageRuleEndDate").value)("ngIfElse",a),D.Lb(3),D.vc("matDatepicker",c)("min",r.storageRuleCriteriaForm.get("storageRuleStartDate").value)}}function ir(e,t){if(1&e){var i=D.ec();D.dc(0,"button",43),D.lc("click",(function(){return D.Kc(i),D.pc().addIntervalDtDucCriteria()})),D.dc(1,"i",38),D.Vc(2,"check"),D.cc(),D.cc()}}function ar(e,t){if(1&e){var i=D.ec();D.dc(0,"p",39),D.lc("click",(function(){return D.Kc(i),D.pc().updateEndDateInterval(!1)})),D.Vc(1),D.qc(2,"translate"),D.cc()}2&e&&(D.Lb(1),D.Xc(" ",D.rc(2,1,"COLLECT.SEARCH_CRITERIA_FILTER.STORAGE_RULE.DELETE_INTERVAL")," "))}var cr,rr=((cr=function(){function e(t,i,a,c){var r=this;o(this,e),this.formBuilder=t,this.dialog=i,this.archiveExchangeDataService=a,this.ruleValidator=c,this.storageCriteriaList=[],this.storageAdditionalCriteria=new Map,this.endDateInterval=!1,this.emptyStorageCriteriaForm={storageRuleIdentifier:"",storageRuleTitle:"",storageRuleStartDate:"",storageRuleEndDate:"",storageRuleOriginInheriteAtLeastOne:!0,storageRuleOriginHasAtLeastOne:!0,storageRuleOriginHasNoOne:!1,storageRuleOriginWaitingRecalculate:!1,copyFinalActionType:!1,transferFinalActionType:!1,storageRuleFinalActionHasFinalAction:!1,storageRuleFinalActionInheriteFinalAction:!1,restrictAccessFinalActionType:!1},this.showUnitPreviewBlock=!1,this.storageRuleCriteriaForm=this.formBuilder.group({storageRuleIdentifier:[null,[ce.c.ruleIdPattern],this.ruleValidator.uniqueRuleId()],storageRuleTitle:["",[]],storageRuleStartDate:["",[]],storageRuleEndDate:["",[]],storageRuleEliminationIdentifier:["",[]]}),Object(A.a)(this.storageRuleCriteriaForm.statusChanges,this.storageRuleCriteriaForm.valueChanges).pipe(Object(O.a)(Ge.UPDATE_DEBOUNCE_TIME),Object(y.a)((function(){return r.storageRuleCriteriaForm.value})),Object(y.a)((function(){return Object(T.sb)(r.storageRuleCriteriaForm.value,r.previousStorageCriteriaValue)})),Object(ti.a)((function(e){return r.isEmpty(e)}))).subscribe((function(){r.resetStorageRuleCriteriaForm()})),this.storageRuleCriteriaForm.get("storageRuleTitle").valueChanges.subscribe((function(e){null!==r.storageRuleCriteriaForm.get("storageRuleTitle").value&&""!==r.storageRuleCriteriaForm.get("storageRuleTitle").value&&(r.addCriteria("RULE_TITLE_STORAGE_RULE",{id:e,value:e},e,!0,T.v.EQ,!1,T.u.STRING,T.Z.STORAGE_RULE),r.resetStorageRuleCriteriaForm())})),this.subscriptionStorageFromMainSearchCriteria=this.archiveExchangeDataService.storageFromMainSearchCriteriaObservable.subscribe((function(e){e&&(e.action===T.d.ADD?r.storageAdditionalCriteria.set(e.valueElt.value,!0):e.action===T.d.REMOVE&&r.storageAdditionalCriteria&&r.storageAdditionalCriteria.has(e.valueElt.value)&&r.storageAdditionalCriteria.set(e.valueElt.value,!1))}))}return d(e,[{key:"ngOnInit",value:function(){this.storageAdditionalCriteria=new Map,this.storageAdditionalCriteria.set("ORIGIN_WAITING_RECALCULATE",!0===this.hasWaitingToRecalculateCriteria),this.storageAdditionalCriteria.set("FINAL_ACTION_TYPE_COPY",!1),this.storageAdditionalCriteria.set("FINAL_ACTION_TYPE_TRANSFER",!1),this.storageAdditionalCriteria.set("ORIGIN_HAS_NO_ONE",!1),this.storageAdditionalCriteria.set("ORIGIN_HAS_AT_LEAST_ONE",!1),this.storageAdditionalCriteria.set("FINAL_ACTION_HAS_FINAL_ACTION",!1),this.previousStorageCriteriaValue={storageRuleIdentifier:"",storageRuleTitle:"",storageRuleStartDate:"",storageRuleEndDate:"",storageRuleOriginInheriteAtLeastOne:!0,storageRuleOriginHasAtLeastOne:!0,storageRuleOriginHasNoOne:!1,storageRuleOriginWaitingRecalculate:this.hasWaitingToRecalculateCriteria,copyFinalActionType:!1,transferFinalActionType:!1,storageRuleFinalActionHasFinalAction:!1,storageRuleFinalActionInheriteFinalAction:!1,restrictAccessFinalActionType:!1},this.addCriteria("RULE_ORIGIN_STORAGE_RULE",{value:"ORIGIN_HAS_AT_LEAST_ONE",id:"ORIGIN_HAS_AT_LEAST_ONE"},"ORIGIN_HAS_AT_LEAST_ONE",!0,T.v.EXISTS,!0,T.u.STRING,T.Z.STORAGE_RULE),this.storageAdditionalCriteria.set("ORIGIN_HAS_AT_LEAST_ONE",!0)}},{key:"checkBoxChange",value:function(e,t){var i=t.target.checked;switch(this.storageAdditionalCriteria.set(e,i),e){case"ORIGIN_HAS_NO_ONE":i?this.addCriteria("RULE_ORIGIN_STORAGE_RULE",{id:"ORIGIN_HAS_NO_ONE",value:"ORIGIN_HAS_NO_ONE"},"ORIGIN_HAS_NO_ONE",!0,T.v.MISSING,!0,T.u.STRING,T.Z.STORAGE_RULE):this.emitRemoveCriteriaEvent("RULE_ORIGIN_STORAGE_RULE",{id:"ORIGIN_HAS_NO_ONE",value:"ORIGIN_HAS_NO_ONE"}),this.previousStorageCriteriaValue.storageRuleOriginHasNoOne=i;break;case"ORIGIN_WAITING_RECALCULATE":i?this.addCriteria("RULE_ORIGIN_STORAGE_RULE",{id:"ORIGIN_WAITING_RECALCULATE",value:"ORIGIN_WAITING_RECALCULATE"},"ORIGIN_WAITING_RECALCULATE",!0,T.v.EQ,!0,T.u.STRING,T.Z.STORAGE_RULE):this.emitRemoveCriteriaEvent("RULE_ORIGIN_STORAGE_RULE",{id:"ORIGIN_WAITING_RECALCULATE",value:"ORIGIN_WAITING_RECALCULATE"}),this.previousStorageCriteriaValue.storageRuleOriginWaitingRecalculate=i;break;case"ORIGIN_HAS_AT_LEAST_ONE":i?this.addCriteria("RULE_ORIGIN_STORAGE_RULE",{id:"ORIGIN_HAS_AT_LEAST_ONE",value:"ORIGIN_HAS_AT_LEAST_ONE"},"ORIGIN_HAS_AT_LEAST_ONE",!0,T.v.EXISTS,!0,T.u.STRING,T.Z.STORAGE_RULE):this.emitRemoveCriteriaEvent("RULE_ORIGIN_STORAGE_RULE",{id:"ORIGIN_HAS_AT_LEAST_ONE",value:"ORIGIN_HAS_AT_LEAST_ONE"}),this.previousStorageCriteriaValue.storageRuleOriginHasAtLeastOne=i;break;case"FINAL_ACTION_TYPE_COPY":i?this.addCriteria("FINAL_ACTION_TYPE_STORAGE_RULE",{id:"FINAL_ACTION_TYPE_COPY",value:"FINAL_ACTION_TYPE_COPY"},"FINAL_ACTION_TYPE_COPY",!0,T.v.EQ,!0,T.u.STRING,T.Z.STORAGE_RULE):this.emitRemoveCriteriaEvent("FINAL_ACTION_TYPE_STORAGE_RULE",{id:"FINAL_ACTION_TYPE_COPY",value:"FINAL_ACTION_TYPE_COPY"}),this.previousStorageCriteriaValue.copyFinalActionType=i;break;case"FINAL_ACTION_TYPE_TRANSFER":i?this.addCriteria("FINAL_ACTION_TYPE_STORAGE_RULE",{id:"FINAL_ACTION_TYPE_TRANSFER",value:"FINAL_ACTION_TYPE_TRANSFER"},"FINAL_ACTION_TYPE_TRANSFER",!0,T.v.EQ,!0,T.u.STRING,T.Z.STORAGE_RULE):this.emitRemoveCriteriaEvent("FINAL_ACTION_TYPE_STORAGE_RULE",{id:"FINAL_ACTION_TYPE_TRANSFER",value:"FINAL_ACTION_TYPE_TRANSFER"}),this.previousStorageCriteriaValue.transferFinalActionType=i;break;case"FINAL_ACTION_TYPE_RESTRICT_ACCESS":i?this.addCriteria("FINAL_ACTION_TYPE_STORAGE_RULE",{id:"FINAL_ACTION_TYPE_RESTRICT_ACCESS",value:"FINAL_ACTION_TYPE_RESTRICT_ACCESS"},"FINAL_ACTION_TYPE_RESTRICT_ACCESS",!0,T.v.EQ,!0,T.u.STRING,T.Z.STORAGE_RULE):this.emitRemoveCriteriaEvent("FINAL_ACTION_TYPE_STORAGE_RULE",{id:"FINAL_ACTION_TYPE_RESTRICT_ACCESS",value:"FINAL_ACTION_TYPE_RESTRICT_ACCESS"}),this.previousStorageCriteriaValue.restrictAccessFinalActionType=i;break;case"FINAL_ACTION_HAS_FINAL_ACTION":i?this.addCriteria("FINAL_ACTION_STORAGE_RULE",{id:"FINAL_ACTION_HAS_FINAL_ACTION",value:"FINAL_ACTION_HAS_FINAL_ACTION"},"FINAL_ACTION_HAS_FINAL_ACTION",!0,T.v.EQ,!0,T.u.STRING,T.Z.STORAGE_RULE):this.emitRemoveCriteriaEvent("FINAL_ACTION_STORAGE_RULE",{id:"FINAL_ACTION_HAS_FINAL_ACTION",value:"FINAL_ACTION_HAS_FINAL_ACTION"}),this.previousStorageCriteriaValue.storageRuleFinalActionHasFinalAction=i}}},{key:"addBeginDtDucCriteria",value:function(){this.storageRuleCriteriaForm.value.storageRuleStartDate&&(this.addCriteria("RULE_END_DATE_STORAGE_RULE",{id:this.storageRuleCriteriaForm.value.storageRuleStartDate+"-",beginInterval:"",endInterval:this.storageRuleCriteriaForm.value.storageRuleStartDate},this.storageRuleCriteriaForm.value.storageRuleStartDate,!0,T.v.LTE,!1,T.u.INTERVAL,T.Z.STORAGE_RULE),this.storageRuleCriteriaForm.controls.storageRuleStartDate.setValue(null))}},{key:"addCriteriaRulePostCheck",value:function(){this.storageRuleCriteriaForm.value.storageRuleIdentifier&&(this.addCriteria("RULE_IDENTIFIER_STORAGE_RULE",{id:this.storageRuleCriteriaForm.value.storageRuleIdentifier.trim(),value:this.storageRuleCriteriaForm.value.storageRuleIdentifier.trim()},this.storageRuleCriteriaForm.value.storageRuleIdentifier.trim(),!0,T.v.EQ,!1,T.u.STRING,T.Z.STORAGE_RULE),this.storageRuleCriteriaForm.controls.storageRuleIdentifier.setValue(null))}},{key:"addIntervalDtDucCriteria",value:function(){this.storageRuleCriteriaForm.value.storageRuleStartDate&&this.storageRuleCriteriaForm.value.storageRuleEndDate&&(this.addCriteria("RULE_END_DATE_STORAGE_RULE",{id:this.storageRuleCriteriaForm.value.storageRuleStartDate+"-"+this.storageRuleCriteriaForm.value.storageRuleEndDate,beginInterval:this.storageRuleCriteriaForm.value.storageRuleStartDate,endInterval:this.storageRuleCriteriaForm.value.storageRuleEndDate},this.storageRuleCriteriaForm.value.storageRuleStartDate,!0,T.v.BETWEEN,!1,T.u.INTERVAL,T.Z.STORAGE_RULE),this.storageRuleCriteriaForm.controls.storageRuleStartDate.setValue(null),this.storageRuleCriteriaForm.controls.storageRuleEndDate.setValue(null))}},{key:"isEmpty",value:function(e){return!!e&&(e.storageRuleIdentifier?(this.addCriteria("RULE_IDENTIFIER_STORAGE_RULE",{id:e.storageRuleIdentifier.trim(),value:e.storageRuleIdentifier.trim()},e.storageRuleIdentifier.trim(),!0,T.v.EQ,!1,T.u.STRING,T.Z.STORAGE_RULE),this.resetStorageRuleCriteriaForm(),!0):e.storageRuleTitle?(this.addCriteria("RULE_TITLE_STORAGE_RULE",{id:e.storageRuleTitle.trim(),value:e.storageRuleTitle.trim()},e.storageRuleTitle.trim(),!0,T.v.EQ,!1,T.u.STRING,T.Z.STORAGE_RULE),!0):void 0)}},{key:"updateEndDateInterval",value:function(e){this.endDateInterval=e}},{key:"resetStorageRuleCriteriaForm",value:function(){this.storageRuleCriteriaForm.reset(this.previousStorageCriteriaValue)}},{key:"emitRemoveCriteriaEvent",value:function(e,t){this.archiveExchangeDataService.sendRemoveFromChildSearchCriteriaAction({keyElt:e,valueElt:t,action:"REMOVE"})}},{key:"addCriteria",value:function(e,t,i,a,c,r,n,s){e&&t&&this.archiveExchangeDataService.addSimpleSearchCriteriaSubject({keyElt:e,valueElt:t,labelElt:i,keyTranslated:a,operator:c,category:s,valueTranslated:r,dataType:n})}},{key:"ngOnDestroy",value:function(){this.subscriptionStorageFromMainSearchCriteria.unsubscribe()}},{key:"storageRuleIdentifier",get:function(){return this.storageRuleCriteriaForm.controls.storageRuleIdentifier}},{key:"storageRuleTitle",get:function(){return this.storageRuleCriteriaForm.controls.storageRuleTitle}},{key:"storageRuleStartDate",get:function(){return this.storageRuleCriteriaForm.controls.storageRuleStartDate}},{key:"storageRuleEndDate",get:function(){return this.storageRuleCriteriaForm.controls.storageRuleEndDate}},{key:"storageRuleEliminationIdentifier",get:function(){return this.storageRuleCriteriaForm.controls.storageRuleEliminationIdentifier}}]),e}()).\u0275fac=function(e){return new(e||cr)(D.Xb(u.e),D.Xb(v.b),D.Xb(Le),D.Xb(Xc))},cr.\u0275cmp=D.Rb({type:cr,selectors:[["app-storage-rule-search"]],inputs:{hasWaitingToRecalculateCriteria:"hasWaitingToRecalculateCriteria"},decls:106,vars:71,consts:[[1,"container"],[3,"formGroup"],[1,"row","justify-content-start"],[1,"form-control"],[1,"title-text"],[1,"col-5","form-control"],["formControlName","storageRuleIdentifier","minlength","1",3,"validator","asyncValidator","label"],["errorKey","required"],["errorKey","ruleIdPattern"],["errorKey","ruleIdExists"],[1,"col-1","form-control"],["formControlName","storageRuleTitle",3,"validator","label"],[1,"col-11","form-control"],[1,"vitamui-input",3,"click"],["class","search-date-label",3,"click",4,"ngIf","ngIfElse"],["showBeginDtDuc",""],["size","0","formControlName","storageRuleStartDate",1,"hidden",3,"matDatepicker","max"],["pickerBeginDuc",""],["class","validate-action-button","type","button","mat-mini-fab","",3,"click",4,"ngIf"],[1,"col-4","form-control"],["class","title-text text-clicable-uppercase",3,"click",4,"ngIf"],["class","vitamui-input",3,"click",4,"ngIf"],["class","validate-date-small-button","type","button","mat-mini-fab","",3,"click",4,"ngIf"],[1,"row","justify-content-around"],[1,"row","criteria-choice"],[1,"row"],[1,"criteria-checkbox-choice"],["type","checkbox","id","HAS_AT_LEAST_ONE_RULE_ORIGIN",3,"checked","click"],["id","HAS_NO_RULE_ORIGIN","type","checkbox",3,"checked","click"],["id","WAITING_TO_RE_CALCULATE_RULE_ORIGIN","type","checkbox",3,"checked","click"],["id","HAS_FINAL_ACTION_TYPE","type","checkbox",3,"checked","click"],[1,"col-3","form-control"],["type","checkbox","id","COPY_FINAL_ACTION",3,"checked","click"],["type","checkbox","id","TRANSFER_FINAL_ACTION",3,"checked","click"],["type","checkbox","id","RESTRICT_ACCESS_FINAL_ACTION",3,"checked","click"],[1,"search-date-label",3,"click"],[3,"click"],["type","button","mat-mini-fab","",1,"validate-action-button",3,"click"],[1,"material-icons"],[1,"title-text","text-clicable-uppercase",3,"click"],["showEndDtDuc",""],["size","0","formControlName","storageRuleEndDate",1,"hidden",3,"matDatepicker","min"],["pickerEndDuc",""],["type","button","mat-mini-fab","",1,"validate-date-small-button",3,"click"]],template:function(e,t){if(1&e){var i=D.ec();D.dc(0,"div",0),D.dc(1,"form",1),D.dc(2,"div",2),D.dc(3,"div",3),D.dc(4,"p",4),D.Vc(5),D.qc(6,"translate"),D.cc(),D.cc(),D.cc(),D.dc(7,"div",2),D.dc(8,"div",5),D.dc(9,"vitamui-common-editable-input",6),D.qc(10,"translate"),D.dc(11,"vitamui-common-field-error",7),D.Vc(12),D.qc(13,"translate"),D.cc(),D.dc(14,"vitamui-common-field-error",8),D.Vc(15),D.qc(16,"translate"),D.cc(),D.dc(17,"vitamui-common-field-error",9),D.Vc(18),D.qc(19,"translate"),D.cc(),D.cc(),D.cc(),D.Yb(20,"div",10),D.dc(21,"div",5),D.Yb(22,"vitamui-common-editable-input",11),D.qc(23,"translate"),D.cc(),D.Yb(24,"div",10),D.cc(),D.dc(25,"div",2),D.dc(26,"div",12),D.dc(27,"p",4),D.Vc(28),D.qc(29,"translate"),D.cc(),D.cc(),D.cc(),D.dc(30,"div",2),D.dc(31,"div",5),D.dc(32,"div",13),D.lc("click",(function(){return D.Kc(i),D.Gc(38).open()})),D.Tc(33,zc,3,3,"span",14),D.Tc(34,Zc,3,4,"ng-template",null,15,D.Uc),D.Yb(36,"input",16),D.Yb(37,"mat-datepicker",null,17),D.cc(),D.cc(),D.dc(39,"div",10),D.Tc(40,$c,3,0,"button",18),D.cc(),D.dc(41,"div",19),D.Tc(42,Qc,3,3,"p",20),D.Tc(43,tr,7,4,"div",21),D.cc(),D.dc(44,"div",10),D.Tc(45,ir,3,0,"button",22),D.cc(),D.dc(46,"div",10),D.Tc(47,ar,3,3,"p",20),D.cc(),D.cc(),D.dc(48,"div",23),D.dc(49,"div",19),D.dc(50,"div",24),D.dc(51,"p",4),D.Vc(52),D.qc(53,"translate"),D.cc(),D.cc(),D.dc(54,"div",25),D.dc(55,"label",26),D.dc(56,"input",27),D.lc("click",(function(e){return t.checkBoxChange("ORIGIN_HAS_AT_LEAST_ONE",e)})),D.cc(),D.dc(57,"span"),D.Vc(58),D.qc(59,"translate"),D.cc(),D.cc(),D.cc(),D.dc(60,"div",25),D.dc(61,"label",26),D.dc(62,"input",28),D.lc("click",(function(e){return t.checkBoxChange("ORIGIN_HAS_NO_ONE",e)})),D.cc(),D.dc(63,"span"),D.Vc(64),D.qc(65,"translate"),D.cc(),D.cc(),D.cc(),D.dc(66,"div",25),D.dc(67,"label",26),D.dc(68,"input",29),D.lc("click",(function(e){return t.checkBoxChange("ORIGIN_WAITING_RECALCULATE",e)})),D.cc(),D.dc(69,"span"),D.Vc(70),D.qc(71,"translate"),D.cc(),D.cc(),D.cc(),D.cc(),D.dc(72,"div",19),D.dc(73,"div",24),D.dc(74,"p",4),D.Vc(75),D.qc(76,"translate"),D.cc(),D.cc(),D.dc(77,"div",25),D.dc(78,"label",26),D.dc(79,"input",30),D.lc("click",(function(e){return t.checkBoxChange("FINAL_ACTION_HAS_FINAL_ACTION",e)})),D.cc(),D.dc(80,"span"),D.Vc(81),D.qc(82,"translate"),D.cc(),D.cc(),D.cc(),D.cc(),D.dc(83,"div",31),D.dc(84,"div",24),D.dc(85,"p",4),D.Vc(86),D.qc(87,"translate"),D.cc(),D.cc(),D.dc(88,"div",25),D.dc(89,"label",26),D.dc(90,"input",32),D.lc("click",(function(e){return t.checkBoxChange("FINAL_ACTION_TYPE_COPY",e)})),D.cc(),D.dc(91,"span"),D.Vc(92),D.qc(93,"translate"),D.cc(),D.cc(),D.cc(),D.dc(94,"div",25),D.dc(95,"label",26),D.dc(96,"input",33),D.lc("click",(function(e){return t.checkBoxChange("FINAL_ACTION_TYPE_TRANSFER",e)})),D.cc(),D.dc(97,"span"),D.Vc(98),D.qc(99,"translate"),D.cc(),D.cc(),D.cc(),D.dc(100,"div",25),D.dc(101,"label",26),D.dc(102,"input",34),D.lc("click",(function(e){return t.checkBoxChange("FINAL_ACTION_TYPE_RESTRICT_ACCESS",e)})),D.cc(),D.dc(103,"span"),D.Vc(104),D.qc(105,"translate"),D.cc(),D.cc(),D.cc(),D.cc(),D.cc(),D.cc(),D.cc()}if(2&e){var a=D.Gc(35),c=D.Gc(38),r=null,n=null,s=null;D.Lb(1),D.vc("formGroup",t.storageRuleCriteriaForm),D.Lb(4),D.Wc(D.rc(6,37,"COLLECT.SEARCH_CRITERIA_FILTER.STORAGE_TITLE")),D.Lb(4),D.wc("label",D.rc(10,39,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.ID_DUA")),D.vc("validator",null==t.storageRuleCriteriaForm||null==(r=t.storageRuleCriteriaForm.get("storageRuleIdentifier"))?null:r.validator)("asyncValidator",null==t.storageRuleCriteriaForm||null==(n=t.storageRuleCriteriaForm.get("storageRuleIdentifier"))?null:n.asyncValidator),D.Lb(3),D.Xc("",D.rc(13,41,"COMMON.REQUIRED")," "),D.Lb(3),D.Xc("",D.rc(16,43,"COLLECT.RULE.WRONG_FORMAT")," "),D.Lb(3),D.Xc("",D.rc(19,45,"COLLECT.RULE.CODE_NOT_EXIST")," "),D.Lb(4),D.wc("label",D.rc(23,47,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.TITLE_DUA")),D.vc("validator",null==t.storageRuleCriteriaForm||null==(s=t.storageRuleCriteriaForm.get("storageRuleTitle"))?null:s.validator),D.Lb(6),D.Wc(D.rc(29,49,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.END_DATE_DUA")),D.Lb(5),D.vc("ngIf",!t.storageRuleCriteriaForm.get("storageRuleStartDate").value)("ngIfElse",a),D.Lb(3),D.vc("matDatepicker",c)("max",t.storageRuleCriteriaForm.get("storageRuleEndDate").value),D.Lb(4),D.vc("ngIf",!t.endDateInterval&&t.storageRuleCriteriaForm.get("storageRuleStartDate").value),D.Lb(2),D.vc("ngIf",!t.endDateInterval),D.Lb(1),D.vc("ngIf",t.endDateInterval),D.Lb(2),D.vc("ngIf",t.endDateInterval&&t.storageRuleCriteriaForm.get("storageRuleStartDate").value&&t.storageRuleCriteriaForm.get("storageRuleEndDate").value),D.Lb(2),D.vc("ngIf",t.endDateInterval),D.Lb(5),D.Xc(" ",D.rc(53,51,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.ORIGIN.TITLE")," "),D.Lb(4),D.vc("checked",t.storageAdditionalCriteria.get("ORIGIN_HAS_AT_LEAST_ONE")),D.Lb(2),D.Wc(D.rc(59,53,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.ORIGIN.HAS_AT_LEAST_ONE_STORAGE_RULE")),D.Lb(4),D.vc("checked",t.storageAdditionalCriteria.get("ORIGIN_HAS_NO_ONE")),D.Lb(2),D.Wc(D.rc(65,55,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.ORIGIN.HAS_NO_STORAGE_RULE")),D.Lb(4),D.vc("checked",t.storageAdditionalCriteria.get("ORIGIN_WAITING_RECALCULATE")),D.Lb(2),D.Wc(D.rc(71,57,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.ORIGIN.WAITING_TO_RE_CALCULATE_STORAGE_RULE")),D.Lb(5),D.Xc(" ",D.rc(76,59,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.FINAL_ACTION_TYPE.TITLE")," "),D.Lb(4),D.vc("checked",t.storageAdditionalCriteria.get("FINAL_ACTION_HAS_FINAL_ACTION")),D.Lb(2),D.Wc(D.rc(82,61,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.FINAL_ACTION_TYPE.HAS_STORAGE_RULE")),D.Lb(5),D.Xc(" ",D.rc(87,63,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.FINAL_ACTION.TITLE")," "),D.Lb(4),D.vc("checked",t.storageAdditionalCriteria.get("FINAL_ACTION_TYPE_COPY")),D.Lb(2),D.Wc(D.rc(93,65,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.FINAL_ACTION.COPY_STORAGE_RULE")),D.Lb(4),D.vc("checked",t.storageAdditionalCriteria.get("FINAL_ACTION_TYPE_TRANSFER")),D.Lb(2),D.Wc(D.rc(99,67,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.FINAL_ACTION.TRANSFER_STORAGE_RULE")),D.Lb(4),D.vc("checked",t.storageAdditionalCriteria.get("FINAL_ACTION_TYPE_RESTRICT_ACCESS")),D.Lb(2),D.Wc(D.rc(105,69,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.FINAL_ACTION.RESTRICT_ACCESS_STORAGE_RULE"))}},directives:[u.x,u.q,u.i,T.C,u.p,u.h,u.l,T.mb,l.p,u.c,h.b,h.a,Kc.a],pipes:[P.d,l.e],styles:['.check-rule[_ngcontent-%COMP%]{margin-right:25%;margin-left:-15%;margin-top:5px}.title-text[_ngcontent-%COMP%]{font-style:normal;font-weight:700;font-size:16px;color:var(--vitamui-primary)!important}.validate-action-button[_ngcontent-%COMP%]{background-color:"green";width:"30";height:"30"}']}),cr);function nr(e,t){if(1&e){var i=D.ec();D.dc(0,"span",35),D.lc("click",(function(){return D.Kc(i),D.pc(),D.Gc(38).open()})),D.Vc(1),D.qc(2,"translate"),D.cc()}if(2&e){var a=D.pc();D.Lb(1),D.Wc(D.rc(2,1,a.endDateInterval?"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.END_DATE_DUA_BEGIN":"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.END_DATE_DUA_EQUAL"))}}function sr(e,t){if(1&e){var i=D.ec();D.dc(0,"span",36),D.lc("click",(function(){return D.Kc(i),D.pc(),D.Gc(38).open()})),D.Vc(1),D.qc(2,"dateTime"),D.cc()}if(2&e){var a=D.pc();D.Lb(1),D.Xc("",D.sc(2,1,a.appraisalRuleCriteriaForm.get("appraisalRuleStartDate").value,"dd/MM/yyyy")," ")}}function lr(e,t){if(1&e){var i=D.ec();D.dc(0,"button",37),D.lc("click",(function(){return D.Kc(i),D.pc().addBeginDtDuaCriteria()})),D.dc(1,"i",38),D.Vc(2,"check"),D.cc(),D.cc()}}function or(e,t){if(1&e){var i=D.ec();D.dc(0,"p",39),D.lc("click",(function(){return D.Kc(i),D.pc().updateEndDateInterval(!0)})),D.Vc(1),D.qc(2,"translate"),D.cc()}2&e&&(D.Lb(1),D.Xc(" ",D.rc(2,1,"COLLECT.SEARCH_CRITERIA_FILTER.APPRAISAL_RULE.CREATE_INTERVAL")," "))}function ur(e,t){if(1&e){var i=D.ec();D.dc(0,"span",35),D.lc("click",(function(){return D.Kc(i),D.pc(),D.Gc(6).open()})),D.Vc(1),D.qc(2,"translate"),D.cc()}2&e&&(D.Lb(1),D.Wc(D.rc(2,1,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.END_DATE_DUA_END")))}function dr(e,t){if(1&e){var i=D.ec();D.dc(0,"span",36),D.lc("click",(function(){return D.Kc(i),D.pc(),D.Gc(6).open()})),D.Vc(1),D.qc(2,"dateTime"),D.cc()}if(2&e){var a=D.pc(2);D.Lb(1),D.Xc("",D.sc(2,1,a.appraisalRuleCriteriaForm.get("appraisalRuleEndDate").value,"dd/MM/yyyy")," ")}}function hr(e,t){if(1&e){var i=D.ec();D.dc(0,"div",13),D.lc("click",(function(){return D.Kc(i),D.Gc(6).open()})),D.Tc(1,ur,3,3,"span",14),D.Tc(2,dr,3,4,"ng-template",null,40,D.Uc),D.Yb(4,"input",41),D.Yb(5,"mat-datepicker",null,42),D.cc()}if(2&e){var a=D.Gc(3),c=D.Gc(6),r=D.pc();D.Lb(1),D.vc("ngIf",!r.appraisalRuleCriteriaForm.get("appraisalRuleEndDate").value)("ngIfElse",a),D.Lb(3),D.vc("matDatepicker",c)("min",r.appraisalRuleCriteriaForm.get("appraisalRuleStartDate").value)}}function vr(e,t){if(1&e){var i=D.ec();D.dc(0,"button",37),D.lc("click",(function(){return D.Kc(i),D.pc().addIntervalDtDuaCriteria()})),D.dc(1,"i",38),D.Vc(2,"check"),D.cc(),D.cc()}}function Cr(e,t){if(1&e){var i=D.ec();D.dc(0,"p",39),D.lc("click",(function(){return D.Kc(i),D.pc().updateEndDateInterval(!1)})),D.Vc(1),D.qc(2,"translate"),D.cc()}2&e&&(D.Lb(1),D.Xc(" ",D.rc(2,1,"COLLECT.SEARCH_CRITERIA_FILTER.APPRAISAL_RULE.DELETE_INTERVAL")," "))}var Er,Rr=((Er=function(){function e(t,i,a,c){var r=this;o(this,e),this.formBuilder=t,this.dialog=i,this.archiveExchangeDataService=a,this.ruleValidator=c,this.appraisalCriteriaList=[],this.appraisalAdditionalCriteria=new Map,this.endDateInterval=!1,this.emptyAppraisalCriteriaForm={appraisalRuleIdentifier:"",appraisalRuleTitle:"",appraisalRuleStartDate:"",appraisalRuleEndDate:"",appraisalRuleOriginInheriteAtLeastOne:!0,appraisalRuleOriginHasAtLeastOne:!0,appraisalRuleOriginHasNoOne:!1,appraisalRuleOriginWaitingRecalculate:!1,eliminationFinalActionType:!1,keepFinalActionType:!1,appraisalRuleFinalActionHasFinalAction:!1,appraisalRuleFinalActionInheriteFinalAction:!1,appraisalRuleEliminationIdentifier:""},this.showUnitPreviewBlock=!1,this.appraisalRuleCriteriaForm=this.formBuilder.group({appraisalRuleIdentifier:[null,[ce.c.ruleIdPattern],this.ruleValidator.uniqueRuleId()],appraisalRuleTitle:["",[]],appraisalRuleStartDate:["",[]],appraisalRuleEndDate:["",[]],appraisalRuleEliminationIdentifier:["",[]]}),Object(A.a)(this.appraisalRuleCriteriaForm.statusChanges,this.appraisalRuleCriteriaForm.valueChanges).pipe(Object(O.a)(Ge.UPDATE_DEBOUNCE_TIME),Object(y.a)((function(){return r.appraisalRuleCriteriaForm.value})),Object(y.a)((function(){return Object(T.sb)(r.appraisalRuleCriteriaForm.value,r.previousAppraisalCriteriaValue)})),Object(ti.a)((function(e){return r.isEmpty(e)}))).subscribe((function(){r.resetAppraisalRuleCriteriaForm()})),this.appraisalRuleCriteriaForm.get("appraisalRuleTitle").valueChanges.subscribe((function(e){null!==r.appraisalRuleCriteriaForm.get("appraisalRuleTitle").value&&""!==r.appraisalRuleCriteriaForm.get("appraisalRuleTitle").value&&(r.addCriteria("RULE_TITLE_APPRAISAL_RULE",{id:e,value:e},e,!0,T.v.EQ,!1,T.u.STRING,T.Z.APPRAISAL_RULE),r.resetAppraisalRuleCriteriaForm())})),this.subscriptionAppraisalFromMainSearchCriteria=this.archiveExchangeDataService.appraisalFromMainSearchCriteriaObservable.subscribe((function(e){e&&(e.action===T.d.ADD?r.appraisalAdditionalCriteria.set(e.valueElt.value,!0):e.action===T.d.REMOVE&&r.appraisalAdditionalCriteria&&r.appraisalAdditionalCriteria.has(e.valueElt.value)&&r.appraisalAdditionalCriteria.set(e.valueElt.value,!1))}))}return d(e,[{key:"checkBoxChange",value:function(e,t){var i=t.target.checked;switch(this.appraisalAdditionalCriteria.set(e,i),e){case"ORIGIN_HAS_NO_ONE":i?this.addCriteria("RULE_ORIGIN_APPRAISAL_RULE",{id:"ORIGIN_HAS_NO_ONE",value:"ORIGIN_HAS_NO_ONE"},"ORIGIN_HAS_NO_ONE",!0,T.v.MISSING,!0,T.u.STRING,T.Z.APPRAISAL_RULE):this.emitRemoveCriteriaEvent("RULE_ORIGIN_APPRAISAL_RULE",{id:"ORIGIN_HAS_NO_ONE",value:"ORIGIN_HAS_NO_ONE"}),this.previousAppraisalCriteriaValue.appraisalRuleOriginHasNoOne=i;break;case"ORIGIN_WAITING_RECALCULATE":i?this.addCriteria("RULE_ORIGIN_APPRAISAL_RULE",{id:"ORIGIN_WAITING_RECALCULATE",value:"ORIGIN_WAITING_RECALCULATE"},"ORIGIN_WAITING_RECALCULATE",!0,T.v.EQ,!0,T.u.STRING,T.Z.APPRAISAL_RULE):this.emitRemoveCriteriaEvent("RULE_ORIGIN_APPRAISAL_RULE",{id:"ORIGIN_WAITING_RECALCULATE",value:"ORIGIN_WAITING_RECALCULATE"}),this.previousAppraisalCriteriaValue.appraisalRuleOriginWaitingRecalculate=i;break;case"ORIGIN_HAS_AT_LEAST_ONE":i?this.addCriteria("RULE_ORIGIN_APPRAISAL_RULE",{id:"ORIGIN_HAS_AT_LEAST_ONE",value:"ORIGIN_HAS_AT_LEAST_ONE"},"ORIGIN_HAS_AT_LEAST_ONE",!0,T.v.EXISTS,!0,T.u.STRING,T.Z.APPRAISAL_RULE):this.emitRemoveCriteriaEvent("RULE_ORIGIN_APPRAISAL_RULE",{id:"ORIGIN_HAS_AT_LEAST_ONE",value:"ORIGIN_HAS_AT_LEAST_ONE"}),this.previousAppraisalCriteriaValue.appraisalRuleOriginHasAtLeastOne=i;break;case"FINAL_ACTION_TYPE_ELIMINATION":i?this.addCriteria("FINAL_ACTION_TYPE_APPRAISAL_RULE",{id:"FINAL_ACTION_TYPE_ELIMINATION",value:"FINAL_ACTION_TYPE_ELIMINATION"},"FINAL_ACTION_TYPE_ELIMINATION",!0,T.v.EQ,!0,T.u.STRING,T.Z.APPRAISAL_RULE):this.emitRemoveCriteriaEvent("FINAL_ACTION_TYPE_APPRAISAL_RULE",{id:"FINAL_ACTION_TYPE_ELIMINATION",value:"FINAL_ACTION_TYPE_ELIMINATION"}),this.previousAppraisalCriteriaValue.eliminationFinalActionType=i;break;case"FINAL_ACTION_TYPE_KEEP":i?this.addCriteria("FINAL_ACTION_TYPE_APPRAISAL_RULE",{id:"FINAL_ACTION_TYPE_KEEP",value:"FINAL_ACTION_TYPE_KEEP"},"FINAL_ACTION_TYPE_KEEP",!0,T.v.EQ,!0,T.u.STRING,T.Z.APPRAISAL_RULE):this.emitRemoveCriteriaEvent("FINAL_ACTION_TYPE_APPRAISAL_RULE",{id:"FINAL_ACTION_TYPE_KEEP",value:"FINAL_ACTION_TYPE_KEEP"}),this.previousAppraisalCriteriaValue.keepFinalActionType=i;break;case"FINAL_ACTION_HAS_FINAL_ACTION":i?this.addCriteria("FINAL_ACTION_APPRAISAL_RULE",{id:"FINAL_ACTION_HAS_FINAL_ACTION",value:"FINAL_ACTION_HAS_FINAL_ACTION"},"FINAL_ACTION_HAS_FINAL_ACTION",!0,T.v.EQ,!0,T.u.STRING,T.Z.APPRAISAL_RULE):this.emitRemoveCriteriaEvent("FINAL_ACTION_APPRAISAL_RULE",{id:"FINAL_ACTION_HAS_FINAL_ACTION",value:"FINAL_ACTION_HAS_FINAL_ACTION"}),this.previousAppraisalCriteriaValue.appraisalRuleFinalActionHasFinalAction=i}}},{key:"addBeginDtDuaCriteria",value:function(){this.appraisalRuleCriteriaForm.value.appraisalRuleStartDate&&(this.addCriteria("RULE_END_DATE_APPRAISAL_RULE",{id:this.appraisalRuleCriteriaForm.value.appraisalRuleStartDate+"-",beginInterval:"",endInterval:this.appraisalRuleCriteriaForm.value.appraisalRuleStartDate},this.appraisalRuleCriteriaForm.value.appraisalRuleStartDate,!0,T.v.LTE,!1,T.u.INTERVAL,T.Z.APPRAISAL_RULE),this.appraisalRuleCriteriaForm.controls.appraisalRuleStartDate.setValue(null))}},{key:"addCriteriaRulePostCheck",value:function(){this.appraisalRuleCriteriaForm.value.appraisalRuleIdentifier&&(this.addCriteria("RULE_IDENTIFIER_APPRAISAL_RULE",{id:this.appraisalRuleCriteriaForm.value.appraisalRuleIdentifier.trim(),value:this.appraisalRuleCriteriaForm.value.appraisalRuleIdentifier.trim()},this.appraisalRuleCriteriaForm.value.appraisalRuleIdentifier.trim(),!0,T.v.EQ,!1,T.u.STRING,T.Z.APPRAISAL_RULE),this.appraisalRuleCriteriaForm.controls.appraisalRuleIdentifier.setValue(null))}},{key:"addIntervalDtDuaCriteria",value:function(){this.appraisalRuleCriteriaForm.value.appraisalRuleStartDate&&this.appraisalRuleCriteriaForm.value.appraisalRuleEndDate&&(this.addCriteria("RULE_END_DATE_APPRAISAL_RULE",{id:this.appraisalRuleCriteriaForm.value.appraisalRuleStartDate+"-"+this.appraisalRuleCriteriaForm.value.appraisalRuleEndDate,beginInterval:this.appraisalRuleCriteriaForm.value.appraisalRuleStartDate,endInterval:this.appraisalRuleCriteriaForm.value.appraisalRuleEndDate},this.appraisalRuleCriteriaForm.value.appraisalRuleStartDate,!0,T.v.BETWEEN,!1,T.u.INTERVAL,T.Z.APPRAISAL_RULE),this.appraisalRuleCriteriaForm.controls.appraisalRuleStartDate.setValue(null),this.appraisalRuleCriteriaForm.controls.appraisalRuleEndDate.setValue(null))}},{key:"isEmpty",value:function(e){return!!e&&(e.appraisalRuleIdentifier?(this.addCriteria("RULE_IDENTIFIER_APPRAISAL_RULE",{id:e.appraisalRuleIdentifier.trim(),value:e.appraisalRuleIdentifier.trim()},e.appraisalRuleIdentifier.trim(),!0,T.v.EQ,!1,T.u.STRING,T.Z.APPRAISAL_RULE),this.resetAppraisalRuleCriteriaForm(),!0):e.appraisalRuleTitle?(this.addCriteria("RULE_TITLE_APPRAISAL_RULE",{id:e.appraisalRuleTitle.trim(),value:e.appraisalRuleTitle.trim()},e.appraisalRuleTitle.trim(),!0,T.v.EQ,!1,T.u.STRING,T.Z.APPRAISAL_RULE),!0):e.appraisalRuleEliminationIdentifier?(this.addCriteria("ELIMINATION_TECHNICAL_ID_APPRAISAL_RULE",{id:e.appraisalRuleEliminationIdentifier.trim(),value:e.appraisalRuleEliminationIdentifier.trim()},e.appraisalRuleEliminationIdentifier.trim(),!0,T.v.EQ,!1,T.u.STRING,T.Z.FIELDS),!0):void 0)}},{key:"updateEndDateInterval",value:function(e){this.endDateInterval=e}},{key:"resetAppraisalRuleCriteriaForm",value:function(){this.appraisalRuleCriteriaForm.reset(this.previousAppraisalCriteriaValue)}},{key:"ngOnInit",value:function(){this.appraisalAdditionalCriteria=new Map,this.appraisalAdditionalCriteria.set("ORIGIN_WAITING_RECALCULATE",!0===this.hasWaitingToRecalculateCriteria),this.appraisalAdditionalCriteria.set("FINAL_ACTION_TYPE_ELIMINATION",!1),this.appraisalAdditionalCriteria.set("FINAL_ACTION_TYPE_KEEP",!1),this.appraisalAdditionalCriteria.set("ORIGIN_HAS_NO_ONE",!1),this.appraisalAdditionalCriteria.set("ORIGIN_HAS_AT_LEAST_ONE",!1),this.appraisalAdditionalCriteria.set("FINAL_ACTION_HAS_FINAL_ACTION",!1),this.previousAppraisalCriteriaValue={appraisalRuleIdentifier:"",appraisalRuleTitle:"",appraisalRuleStartDate:"",appraisalRuleEndDate:"",appraisalRuleOriginInheriteAtLeastOne:!0,appraisalRuleOriginHasAtLeastOne:!0,appraisalRuleOriginHasNoOne:!1,appraisalRuleOriginWaitingRecalculate:this.hasWaitingToRecalculateCriteria,eliminationFinalActionType:!1,keepFinalActionType:!1,appraisalRuleFinalActionHasFinalAction:!1,appraisalRuleFinalActionInheriteFinalAction:!1,appraisalRuleEliminationIdentifier:""},this.addCriteria("RULE_ORIGIN_APPRAISAL_RULE",{value:"ORIGIN_HAS_AT_LEAST_ONE",id:"ORIGIN_HAS_AT_LEAST_ONE"},"ORIGIN_HAS_AT_LEAST_ONE",!0,T.v.EXISTS,!0,T.u.STRING,T.Z.APPRAISAL_RULE),this.appraisalAdditionalCriteria.set("ORIGIN_HAS_AT_LEAST_ONE",!0)}},{key:"emitRemoveCriteriaEvent",value:function(e,t){this.archiveExchangeDataService.sendRemoveFromChildSearchCriteriaAction({keyElt:e,valueElt:t,action:"REMOVE"})}},{key:"addCriteria",value:function(e,t,i,a,c,r,n,s){e&&t&&this.archiveExchangeDataService.addSimpleSearchCriteriaSubject({keyElt:e,valueElt:t,labelElt:i,keyTranslated:a,operator:c,category:s,valueTranslated:r,dataType:n})}},{key:"ngOnDestroy",value:function(){this.subscriptionAppraisalFromMainSearchCriteria.unsubscribe()}},{key:"appraisalRuleIdentifier",get:function(){return this.appraisalRuleCriteriaForm.controls.appraisalRuleIdentifier}},{key:"appraisalRuleTitle",get:function(){return this.appraisalRuleCriteriaForm.controls.appraisalRuleTitle}},{key:"appraisalRuleStartDate",get:function(){return this.appraisalRuleCriteriaForm.controls.appraisalRuleStartDate}},{key:"appraisalRuleEndDate",get:function(){return this.appraisalRuleCriteriaForm.controls.appraisalRuleEndDate}},{key:"appraisalRuleEliminationIdentifier",get:function(){return this.appraisalRuleCriteriaForm.controls.appraisalRuleEliminationIdentifier}}]),e}()).\u0275fac=function(e){return new(e||Er)(D.Xb(u.e),D.Xb(v.b),D.Xb(Le),D.Xb(Xc))},Er.\u0275cmp=D.Rb({type:Er,selectors:[["app-appraisal-rule-search"]],inputs:{hasWaitingToRecalculateCriteria:"hasWaitingToRecalculateCriteria"},decls:105,vars:71,consts:[[1,"container"],[3,"formGroup"],[1,"row","justify-content-start"],[1,"form-control"],[1,"title-text"],[1,"col-5","form-control"],["formControlName","appraisalRuleIdentifier","minlength","1",3,"validator","asyncValidator","label"],["errorKey","required"],["errorKey","ruleIdPattern"],["errorKey","ruleIdExists"],[1,"col-1","form-control"],["formControlName","appraisalRuleTitle",3,"validator","label"],[1,"col-11","form-control"],[1,"vitamui-input",3,"click"],["class","search-date-label",3,"click",4,"ngIf","ngIfElse"],["showBeginDtDua",""],["size","0","formControlName","appraisalRuleStartDate",1,"hidden",3,"matDatepicker","max"],["pickerBeginDua",""],["class","validate-date-small-button","type","button","mat-mini-fab","",3,"click",4,"ngIf"],[1,"col-4","form-control"],["class","title-text text-clicable-uppercase",3,"click",4,"ngIf"],["class","vitamui-input",3,"click",4,"ngIf"],[1,"row","justify-content-around"],[1,"row","criteria-choice"],[1,"row"],[1,"criteria-checkbox-choice"],["type","checkbox","id","HAS_AT_LEAST_ONE_RULE_ORIGIN",3,"checked","click"],["id","HAS_NO_RULE_ORIGIN","type","checkbox",3,"checked","click"],["id","WAITING_TO_RE_CALCULATE_RULE_ORIGIN","type","checkbox",3,"checked","click"],["id","HAS_FINAL_ACTION_TYPE","type","checkbox",3,"checked","click"],[1,"col-3","form-control"],["type","checkbox","id","ELIMINATION_FINAL_ACTION",3,"checked","click"],["type","checkbox","id","KEEP_FINAL_ACTION","type","checkbox",3,"checked","click"],["formControlName","appraisalRuleEliminationIdentifier",3,"validator","label"],[1,"col-7","form-control"],[1,"search-date-label",3,"click"],[3,"click"],["type","button","mat-mini-fab","",1,"validate-date-small-button",3,"click"],[1,"material-icons"],[1,"title-text","text-clicable-uppercase",3,"click"],["showEndDtDua",""],["size","0","formControlName","appraisalRuleEndDate",1,"hidden",3,"matDatepicker","min"],["pickerEndDua",""]],template:function(e,t){if(1&e){var i=D.ec();D.dc(0,"div",0),D.dc(1,"form",1),D.dc(2,"div",2),D.dc(3,"div",3),D.dc(4,"p",4),D.Vc(5),D.qc(6,"translate"),D.cc(),D.cc(),D.cc(),D.dc(7,"div",2),D.dc(8,"div",5),D.dc(9,"vitamui-common-editable-input",6),D.qc(10,"translate"),D.dc(11,"vitamui-common-field-error",7),D.Vc(12),D.qc(13,"translate"),D.cc(),D.dc(14,"vitamui-common-field-error",8),D.Vc(15),D.qc(16,"translate"),D.cc(),D.dc(17,"vitamui-common-field-error",9),D.Vc(18),D.qc(19,"translate"),D.cc(),D.cc(),D.cc(),D.Yb(20,"div",10),D.dc(21,"div",5),D.Yb(22,"vitamui-common-editable-input",11),D.qc(23,"translate"),D.cc(),D.Yb(24,"div",10),D.cc(),D.dc(25,"div",2),D.dc(26,"div",12),D.dc(27,"p",4),D.Vc(28),D.qc(29,"translate"),D.cc(),D.cc(),D.cc(),D.dc(30,"div",2),D.dc(31,"div",5),D.dc(32,"div",13),D.lc("click",(function(){return D.Kc(i),D.Gc(38).open()})),D.Tc(33,nr,3,3,"span",14),D.Tc(34,sr,3,4,"ng-template",null,15,D.Uc),D.Yb(36,"input",16),D.Yb(37,"mat-datepicker",null,17),D.cc(),D.cc(),D.dc(39,"div",10),D.Tc(40,lr,3,0,"button",18),D.cc(),D.dc(41,"div",19),D.Tc(42,or,3,3,"p",20),D.Tc(43,hr,7,4,"div",21),D.cc(),D.dc(44,"div",10),D.Tc(45,vr,3,0,"button",18),D.cc(),D.dc(46,"div",10),D.Tc(47,Cr,3,3,"p",20),D.cc(),D.cc(),D.dc(48,"div",22),D.dc(49,"div",19),D.dc(50,"div",23),D.dc(51,"p",4),D.Vc(52),D.qc(53,"translate"),D.cc(),D.cc(),D.dc(54,"div",24),D.dc(55,"label",25),D.dc(56,"input",26),D.lc("click",(function(e){return t.checkBoxChange("ORIGIN_HAS_AT_LEAST_ONE",e)})),D.cc(),D.dc(57,"span"),D.Vc(58),D.qc(59,"translate"),D.cc(),D.cc(),D.cc(),D.dc(60,"div",24),D.dc(61,"label",25),D.dc(62,"input",27),D.lc("click",(function(e){return t.checkBoxChange("ORIGIN_HAS_NO_ONE",e)})),D.cc(),D.dc(63,"span"),D.Vc(64),D.qc(65,"translate"),D.cc(),D.cc(),D.cc(),D.dc(66,"div",24),D.dc(67,"label",25),D.dc(68,"input",28),D.lc("click",(function(e){return t.checkBoxChange("ORIGIN_WAITING_RECALCULATE",e)})),D.cc(),D.dc(69,"span"),D.Vc(70),D.qc(71,"translate"),D.cc(),D.cc(),D.cc(),D.cc(),D.dc(72,"div",19),D.dc(73,"div",23),D.dc(74,"p",4),D.Vc(75),D.qc(76,"translate"),D.cc(),D.cc(),D.dc(77,"div",24),D.dc(78,"label",25),D.dc(79,"input",29),D.lc("click",(function(e){return t.checkBoxChange("FINAL_ACTION_HAS_FINAL_ACTION",e)})),D.cc(),D.dc(80,"span"),D.Vc(81),D.qc(82,"translate"),D.cc(),D.cc(),D.cc(),D.cc(),D.dc(83,"div",30),D.dc(84,"div",23),D.dc(85,"p",4),D.Vc(86),D.qc(87,"translate"),D.cc(),D.cc(),D.dc(88,"div",24),D.dc(89,"label",25),D.dc(90,"input",31),D.lc("click",(function(e){return t.checkBoxChange("FINAL_ACTION_TYPE_ELIMINATION",e)})),D.cc(),D.dc(91,"span"),D.Vc(92),D.qc(93,"translate"),D.cc(),D.cc(),D.cc(),D.dc(94,"div",24),D.dc(95,"label",25),D.dc(96,"input",32),D.lc("click",(function(e){return t.checkBoxChange("FINAL_ACTION_TYPE_KEEP",e)})),D.cc(),D.dc(97,"span"),D.Vc(98),D.qc(99,"translate"),D.cc(),D.cc(),D.cc(),D.cc(),D.cc(),D.dc(100,"div",2),D.dc(101,"div",19),D.Yb(102,"vitamui-common-editable-input",33),D.qc(103,"translate"),D.cc(),D.Yb(104,"div",34),D.cc(),D.cc(),D.cc()}if(2&e){var a=D.Gc(35),c=D.Gc(38),r=null,n=null,s=null,l=null;D.Lb(1),D.vc("formGroup",t.appraisalRuleCriteriaForm),D.Lb(4),D.Wc(D.rc(6,37,"COLLECT.SEARCH_CRITERIA_FILTER.DUA_TITLE")),D.Lb(4),D.wc("label",D.rc(10,39,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.ID_DUA")),D.vc("validator",null==t.appraisalRuleCriteriaForm||null==(r=t.appraisalRuleCriteriaForm.get("appraisalRuleIdentifier"))?null:r.validator)("asyncValidator",null==t.appraisalRuleCriteriaForm||null==(n=t.appraisalRuleCriteriaForm.get("appraisalRuleIdentifier"))?null:n.asyncValidator),D.Lb(3),D.Xc("",D.rc(13,41,"COMMON.REQUIRED")," "),D.Lb(3),D.Xc("",D.rc(16,43,"COLLECT.RULE.WRONG_FORMAT")," "),D.Lb(3),D.Xc("",D.rc(19,45,"COLLECT.RULE.CODE_NOT_EXIST")," "),D.Lb(4),D.wc("label",D.rc(23,47,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.TITLE_DUA")),D.vc("validator",null==t.appraisalRuleCriteriaForm||null==(s=t.appraisalRuleCriteriaForm.get("appraisalRuleTitle"))?null:s.validator),D.Lb(6),D.Wc(D.rc(29,49,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.END_DATE_DUA")),D.Lb(5),D.vc("ngIf",!t.appraisalRuleCriteriaForm.get("appraisalRuleStartDate").value)("ngIfElse",a),D.Lb(3),D.vc("matDatepicker",c)("max",t.appraisalRuleCriteriaForm.get("appraisalRuleEndDate").value),D.Lb(4),D.vc("ngIf",!t.endDateInterval&&t.appraisalRuleCriteriaForm.get("appraisalRuleStartDate").value),D.Lb(2),D.vc("ngIf",!t.endDateInterval),D.Lb(1),D.vc("ngIf",t.endDateInterval),D.Lb(2),D.vc("ngIf",t.endDateInterval&&t.appraisalRuleCriteriaForm.get("appraisalRuleStartDate").value&&t.appraisalRuleCriteriaForm.get("appraisalRuleEndDate").value),D.Lb(2),D.vc("ngIf",t.endDateInterval),D.Lb(5),D.Xc(" ",D.rc(53,51,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.ORIGIN.TITLE")," "),D.Lb(4),D.vc("checked",t.appraisalAdditionalCriteria.get("ORIGIN_HAS_AT_LEAST_ONE")),D.Lb(2),D.Wc(D.rc(59,53,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.ORIGIN.HAS_AT_LEAST_ONE_APPRAISAL_RULE")),D.Lb(4),D.vc("checked",t.appraisalAdditionalCriteria.get("ORIGIN_HAS_NO_ONE")),D.Lb(2),D.Wc(D.rc(65,55,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.ORIGIN.HAS_NO_APPRAISAL_RULE")),D.Lb(4),D.vc("checked",t.appraisalAdditionalCriteria.get("ORIGIN_WAITING_RECALCULATE")),D.Lb(2),D.Wc(D.rc(71,57,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.ORIGIN.WAITING_TO_RE_CALCULATE_APPRAISAL_RULE")),D.Lb(5),D.Xc(" ",D.rc(76,59,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.FINAL_ACTION_TYPE.TITLE")," "),D.Lb(4),D.vc("checked",t.appraisalAdditionalCriteria.get("FINAL_ACTION_HAS_FINAL_ACTION")),D.Lb(2),D.Wc(D.rc(82,61,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.FINAL_ACTION_TYPE.HAS_APPRAISAL_RULE")),D.Lb(5),D.Xc(" ",D.rc(87,63,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.FINAL_ACTION.TITLE")," "),D.Lb(4),D.vc("checked",t.appraisalAdditionalCriteria.get("FINAL_ACTION_TYPE_ELIMINATION")),D.Lb(2),D.Wc(D.rc(93,65,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.FINAL_ACTION.ELIMINATION_APPRAISAL_RULE")),D.Lb(4),D.vc("checked",t.appraisalAdditionalCriteria.get("FINAL_ACTION_TYPE_KEEP")),D.Lb(2),D.Wc(D.rc(99,67,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.FINAL_ACTION.KEEP_APPRAISAL_RULE")),D.Lb(4),D.wc("label",D.rc(103,69,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.ELIMINATION_TECHNICAL_ID")),D.vc("validator",null==t.appraisalRuleCriteriaForm||null==(l=t.appraisalRuleCriteriaForm.get("appraisalRuleEliminationIdentifier"))?null:l.validator)}},directives:[u.x,u.q,u.i,T.C,u.p,u.h,u.l,T.mb,l.p,u.c,h.b,h.a,Kc.a],pipes:[P.d,T.Vb],styles:[".check-rule[_ngcontent-%COMP%]{margin-right:25%;margin-left:-15%;margin-top:5px}.title-text[_ngcontent-%COMP%]{font-style:normal;font-weight:700;font-size:16px;color:var(--vitamui-primary)!important}"]}),Er);function pr(e,t){if(1&e){var i=D.ec();D.dc(0,"span",30),D.lc("click",(function(){return D.Kc(i),D.pc(),D.Gc(38).open()})),D.Vc(1),D.qc(2,"translate"),D.cc()}if(2&e){var a=D.pc();D.Lb(1),D.Wc(D.rc(2,1,a.endDateInterval?"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.END_DATE_ACCESS_BEGIN":"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.END_DATE_ACCESS_EQUAL"))}}function fr(e,t){if(1&e){var i=D.ec();D.dc(0,"span",31),D.lc("click",(function(){return D.Kc(i),D.pc(),D.Gc(38).open()})),D.Vc(1),D.qc(2,"dateTime"),D.cc()}if(2&e){var a=D.pc();D.Lb(1),D.Xc("",D.sc(2,1,a.accessRuleCriteriaForm.get("accessRuleStartDate").value,"dd/MM/yyyy")," ")}}function Ir(e,t){if(1&e){var i=D.ec();D.dc(0,"button",32),D.lc("click",(function(){return D.Kc(i),D.pc().addBeginDtAccessRuleCriteria()})),D.dc(1,"i",33),D.Vc(2,"check"),D.cc(),D.cc()}}function Tr(e,t){if(1&e){var i=D.ec();D.dc(0,"p",34),D.lc("click",(function(){return D.Kc(i),D.pc().updateEndDateInterval(!0)})),D.Vc(1),D.qc(2,"translate"),D.cc()}2&e&&(D.Lb(1),D.Xc(" ",D.rc(2,1,"COLLECT.SEARCH_CRITERIA_FILTER.ACCESS_RULE.CREATE_INTERVAL")," "))}function gr(e,t){if(1&e){var i=D.ec();D.dc(0,"span",30),D.lc("click",(function(){return D.Kc(i),D.pc(),D.Gc(6).open()})),D.Vc(1),D.qc(2,"translate"),D.cc()}2&e&&(D.Lb(1),D.Wc(D.rc(2,1,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.END_DATE_ACCESS_END")))}function Lr(e,t){if(1&e){var i=D.ec();D.dc(0,"span",31),D.lc("click",(function(){return D.Kc(i),D.pc(),D.Gc(6).open()})),D.Vc(1),D.qc(2,"dateTime"),D.cc()}if(2&e){var a=D.pc(2);D.Lb(1),D.Xc("",D.sc(2,1,a.accessRuleCriteriaForm.get("accessRuleEndDate").value,"dd/MM/yyyy")," ")}}function br(e,t){if(1&e){var i=D.ec();D.dc(0,"div",13),D.lc("click",(function(){return D.Kc(i),D.Gc(6).open()})),D.Tc(1,gr,3,3,"span",14),D.Tc(2,Lr,3,4,"ng-template",null,35,D.Uc),D.Yb(4,"input",36),D.Yb(5,"mat-datepicker",null,37),D.cc()}if(2&e){var a=D.Gc(3),c=D.Gc(6),r=D.pc();D.Lb(1),D.vc("ngIf",!r.accessRuleCriteriaForm.get("accessRuleEndDate").value)("ngIfElse",a),D.Lb(3),D.vc("matDatepicker",c)("min",r.accessRuleCriteriaForm.get("accessRuleStartDate").value)}}function mr(e,t){if(1&e){var i=D.ec();D.dc(0,"button",32),D.lc("click",(function(){return D.Kc(i),D.pc().addIntervalDtAccessRuleCriteria()})),D.dc(1,"i",33),D.Vc(2,"check"),D.cc(),D.cc()}}function Ar(e,t){if(1&e){var i=D.ec();D.dc(0,"p",34),D.lc("click",(function(){return D.Kc(i),D.pc().updateEndDateInterval(!1)})),D.Vc(1),D.qc(2,"translate"),D.cc()}2&e&&(D.Lb(1),D.Xc(" ",D.rc(2,1,"COLLECT.SEARCH_CRITERIA_FILTER.ACCESS_RULE.DELETE_INTERVAL")," "))}var Sr,_r=((Sr=function(){function e(t,i,a,c){var r=this;o(this,e),this.formBuilder=t,this.dialog=i,this.archiveExchangeDataService=a,this.ruleValidator=c,this.accessCriteriaList=[],this.accessAdditionalCriteria=new Map,this.endDateInterval=!1,this.emptyAccessCriteriaForm={accessRuleIdentifier:"",accessRuleTitle:"",accessRuleStartDate:"",accessRuleEndDate:"",accessRuleOriginInheriteAtLeastOne:!0,accessRuleOriginHasAtLeastOne:!0,accessRuleOriginHasNoOne:!1,accessRuleOriginWaitingRecalculate:!1},this.showUnitPreviewBlock=!1,this.accessRuleCriteriaForm=this.formBuilder.group({accessRuleIdentifier:[null,[ce.c.ruleIdPattern],this.ruleValidator.uniqueRuleId()],accessRuleTitle:["",[]],accessRuleStartDate:["",[]],accessRuleEndDate:["",[]],accessRuleEliminationIdentifier:["",[]]}),Object(A.a)(this.accessRuleCriteriaForm.statusChanges,this.accessRuleCriteriaForm.valueChanges).pipe(Object(O.a)(Ge.UPDATE_DEBOUNCE_TIME),Object(y.a)((function(){return r.accessRuleCriteriaForm.value})),Object(y.a)((function(){return Object(T.sb)(r.accessRuleCriteriaForm.value,r.previousAccessCriteriaValue)})),Object(ti.a)((function(e){return r.isEmpty(e)}))).subscribe((function(){r.resetAccessRuleCriteriaForm()})),this.accessRuleCriteriaForm.get("accessRuleTitle").valueChanges.subscribe((function(e){null!==r.accessRuleCriteriaForm.get("accessRuleTitle").value&&""!==r.accessRuleCriteriaForm.get("accessRuleTitle").value&&(r.addCriteria("RULE_TITLE_ACCESS_RULE",{id:e,value:e},e,!0,T.v.EQ,!1,T.u.STRING,T.Z.ACCESS_RULE),r.resetAccessRuleCriteriaForm())})),this.subscriptionAccessFromMainSearchCriteria=this.archiveExchangeDataService.accessFromMainSearchCriteriaObservable.subscribe((function(e){e&&(r.accessAdditionalCriteria&&e.action===T.d.ADD?r.accessAdditionalCriteria.set(e.valueElt.value,!0):e.action===T.d.REMOVE&&r.accessAdditionalCriteria&&r.accessAdditionalCriteria.has(e.valueElt.value)&&r.accessAdditionalCriteria.set(e.valueElt.value,!1))}))}return d(e,[{key:"checkBoxChange",value:function(e,t){var i=t.target.checked;switch(this.accessAdditionalCriteria.set(e,i),e){case"ORIGIN_HAS_NO_ONE":i?this.addCriteria("RULE_ORIGIN_ACCESS_RULE",{id:"ORIGIN_HAS_NO_ONE",value:"ORIGIN_HAS_NO_ONE"},"ORIGIN_HAS_NO_ONE",!0,T.v.MISSING,!0,T.u.STRING,T.Z.ACCESS_RULE):this.emitRemoveCriteriaEvent("RULE_ORIGIN_ACCESS_RULE",{id:"ORIGIN_HAS_NO_ONE",value:"ORIGIN_HAS_NO_ONE"}),this.previousAccessCriteriaValue.accessRuleOriginHasNoOne=i;break;case"ORIGIN_WAITING_RECALCULATE":i?this.addCriteria("RULE_ORIGIN_ACCESS_RULE",{id:"ORIGIN_WAITING_RECALCULATE",value:"ORIGIN_WAITING_RECALCULATE"},"ORIGIN_WAITING_RECALCULATE",!0,T.v.EQ,!0,T.u.STRING,T.Z.ACCESS_RULE):this.emitRemoveCriteriaEvent("RULE_ORIGIN_ACCESS_RULE",{id:"ORIGIN_WAITING_RECALCULATE",value:"ORIGIN_WAITING_RECALCULATE"}),this.previousAccessCriteriaValue.accessRuleOriginWaitingRecalculate=i;break;case"ORIGIN_HAS_AT_LEAST_ONE":i?this.addCriteria("RULE_ORIGIN_ACCESS_RULE",{id:"ORIGIN_HAS_AT_LEAST_ONE",value:"ORIGIN_HAS_AT_LEAST_ONE"},"ORIGIN_HAS_AT_LEAST_ONE",!0,T.v.EXISTS,!0,T.u.STRING,T.Z.ACCESS_RULE):this.emitRemoveCriteriaEvent("RULE_ORIGIN_ACCESS_RULE",{id:"ORIGIN_HAS_AT_LEAST_ONE",value:"ORIGIN_HAS_AT_LEAST_ONE"}),this.previousAccessCriteriaValue.accessRuleOriginHasAtLeastOne=i}}},{key:"addBeginDtAccessRuleCriteria",value:function(){this.accessRuleCriteriaForm.value.accessRuleStartDate&&(this.addCriteria("RULE_END_DATE_ACCESS_RULE",{id:this.accessRuleCriteriaForm.value.accessRuleStartDate+"-",beginInterval:"",endInterval:this.accessRuleCriteriaForm.value.accessRuleStartDate},this.accessRuleCriteriaForm.value.accessRuleStartDate,!0,T.v.LTE,!1,T.u.INTERVAL,T.Z.ACCESS_RULE),this.accessRuleCriteriaForm.controls.accessRuleStartDate.setValue(null))}},{key:"addCriteriaRulePostCheck",value:function(){this.accessRuleCriteriaForm.value.accessRuleIdentifier&&(this.addCriteria("RULE_IDENTIFIER_ACCESS_RULE",{id:this.accessRuleCriteriaForm.value.accessRuleIdentifier.trim(),value:this.accessRuleCriteriaForm.value.accessRuleIdentifier.trim()},this.accessRuleCriteriaForm.value.accessRuleIdentifier.trim(),!0,T.v.EQ,!1,T.u.STRING,T.Z.ACCESS_RULE),this.accessRuleCriteriaForm.controls.accessRuleIdentifier.setValue(null))}},{key:"addIntervalDtAccessRuleCriteria",value:function(){this.accessRuleCriteriaForm.value.accessRuleStartDate&&this.accessRuleCriteriaForm.value.accessRuleEndDate&&(this.addCriteria("RULE_END_DATE_ACCESS_RULE",{id:this.accessRuleCriteriaForm.value.accessRuleStartDate+"-"+this.accessRuleCriteriaForm.value.accessRuleEndDate,beginInterval:this.accessRuleCriteriaForm.value.accessRuleStartDate,endInterval:this.accessRuleCriteriaForm.value.accessRuleEndDate},this.accessRuleCriteriaForm.value.accessRuleStartDate,!0,T.v.BETWEEN,!1,T.u.INTERVAL,T.Z.ACCESS_RULE),this.accessRuleCriteriaForm.controls.accessRuleStartDate.setValue(null),this.accessRuleCriteriaForm.controls.accessRuleEndDate.setValue(null))}},{key:"isEmpty",value:function(e){return!!e&&(e.accessRuleIdentifier?(this.addCriteria("RULE_IDENTIFIER_ACCESS_RULE",{id:e.accessRuleIdentifier.trim(),value:e.accessRuleIdentifier.trim()},e.accessRuleIdentifier.trim(),!0,T.v.EQ,!1,T.u.STRING,T.Z.ACCESS_RULE),this.resetAccessRuleCriteriaForm(),!0):e.accessRuleTitle?(this.addCriteria("RULE_TITLE_ACCESS_RULE",{id:e.accessRuleTitle.trim(),value:e.accessRuleTitle.trim()},e.accessRuleTitle.trim(),!0,T.v.EQ,!1,T.u.STRING,T.Z.ACCESS_RULE),!0):void 0)}},{key:"updateEndDateInterval",value:function(e){this.endDateInterval=e}},{key:"resetAccessRuleCriteriaForm",value:function(){this.accessRuleCriteriaForm.reset(this.previousAccessCriteriaValue)}},{key:"ngOnInit",value:function(){this.accessAdditionalCriteria=new Map,this.accessAdditionalCriteria.set("ORIGIN_WAITING_RECALCULATE",!0===this.hasWaitingToRecalculateCriteria),this.accessAdditionalCriteria.set("ORIGIN_HAS_NO_ONE",!1),this.accessAdditionalCriteria.set("ORIGIN_HAS_AT_LEAST_ONE",!1),this.previousAccessCriteriaValue={accessRuleIdentifier:"",accessRuleTitle:"",accessRuleStartDate:"",accessRuleEndDate:"",accessRuleOriginInheriteAtLeastOne:!0,accessRuleOriginHasAtLeastOne:!0,accessRuleOriginHasNoOne:!1,accessRuleOriginWaitingRecalculate:this.hasWaitingToRecalculateCriteria},this.addCriteria("RULE_ORIGIN_ACCESS_RULE",{value:"ORIGIN_HAS_AT_LEAST_ONE",id:"ORIGIN_HAS_AT_LEAST_ONE"},"ORIGIN_HAS_AT_LEAST_ONE",!0,T.v.EXISTS,!0,T.u.STRING,T.Z.ACCESS_RULE),this.accessAdditionalCriteria.set("ORIGIN_HAS_AT_LEAST_ONE",!0)}},{key:"emitRemoveCriteriaEvent",value:function(e,t){this.archiveExchangeDataService.sendRemoveFromChildSearchCriteriaAction({keyElt:e,valueElt:t,action:"REMOVE"})}},{key:"addCriteria",value:function(e,t,i,a,c,r,n,s){e&&t&&this.archiveExchangeDataService.addSimpleSearchCriteriaSubject({keyElt:e,valueElt:t,labelElt:i,keyTranslated:a,operator:c,category:s,valueTranslated:r,dataType:n})}},{key:"ngOnDestroy",value:function(){this.subscriptionAccessFromMainSearchCriteria.unsubscribe()}},{key:"accessRuleIdentifier",get:function(){return this.accessRuleCriteriaForm.controls.accessRuleIdentifier}},{key:"accessRuleTitle",get:function(){return this.accessRuleCriteriaForm.controls.accessRuleTitle}},{key:"accessRuleStartDate",get:function(){return this.accessRuleCriteriaForm.controls.accessRuleStartDate}},{key:"accessRuleEndDate",get:function(){return this.accessRuleCriteriaForm.controls.accessRuleEndDate}}]),e}()).\u0275fac=function(e){return new(e||Sr)(D.Xb(u.e),D.Xb(v.b),D.Xb(Le),D.Xb(Xc))},Sr.\u0275cmp=D.Rb({type:Sr,selectors:[["app-access-rule-search"]],inputs:{hasWaitingToRecalculateCriteria:"hasWaitingToRecalculateCriteria"},decls:74,vars:49,consts:[[1,"container"],[3,"formGroup"],[1,"row","justify-content-start"],[1,"form-control"],[1,"title-text"],[1,"col-5","form-control"],["formControlName","accessRuleIdentifier","minlength","1",3,"validator","asyncValidator","label"],["errorKey","required"],["errorKey","ruleIdPattern"],["errorKey","ruleIdExists"],[1,"col-1","form-control"],["formControlName","accessRuleTitle",3,"validator","label"],[1,"col-11","form-control"],[1,"vitamui-input",3,"click"],["class","search-date-label",3,"click",4,"ngIf","ngIfElse"],["showBeginDtAccessRule",""],["size","0","formControlName","accessRuleStartDate",1,"hidden",3,"matDatepicker","max"],["pickerBeginAccessRule",""],["class","validate-date-small-button","type","button","mat-mini-fab","",3,"click",4,"ngIf"],[1,"col-4","form-control"],["class","title-text text-clicable-uppercase",3,"click",4,"ngIf"],["class","vitamui-input",3,"click",4,"ngIf"],[1,"row","justify-content-around"],[1,"row","criteria-choice"],[1,"row"],[1,"criteria-checkbox-choice"],["type","checkbox","id","HAS_AT_LEAST_ONE_ACCESS_RULE_ORIGIN",3,"checked","click"],["id","HAS_NO_ACCESS_RULE_ORIGIN","type","checkbox",3,"checked","click"],["id","WAITING_TO_RE_CALCULATE_ACCESS_RULE_ORIGIN","type","checkbox",3,"checked","click"],[1,"col-3","form-control"],[1,"search-date-label",3,"click"],[3,"click"],["type","button","mat-mini-fab","",1,"validate-date-small-button",3,"click"],[1,"material-icons"],[1,"title-text","text-clicable-uppercase",3,"click"],["showEndDtAccessRule",""],["size","0","formControlName","accessRuleEndDate",1,"hidden",3,"matDatepicker","min"],["pickerEndAccessRule",""]],template:function(e,t){if(1&e){var i=D.ec();D.dc(0,"div",0),D.dc(1,"form",1),D.dc(2,"div",2),D.dc(3,"div",3),D.dc(4,"p",4),D.Vc(5),D.qc(6,"translate"),D.cc(),D.cc(),D.cc(),D.dc(7,"div",2),D.dc(8,"div",5),D.dc(9,"vitamui-common-editable-input",6),D.qc(10,"translate"),D.dc(11,"vitamui-common-field-error",7),D.Vc(12),D.qc(13,"translate"),D.cc(),D.dc(14,"vitamui-common-field-error",8),D.Vc(15),D.qc(16,"translate"),D.cc(),D.dc(17,"vitamui-common-field-error",9),D.Vc(18),D.qc(19,"translate"),D.cc(),D.cc(),D.cc(),D.Yb(20,"div",10),D.dc(21,"div",5),D.Yb(22,"vitamui-common-editable-input",11),D.qc(23,"translate"),D.cc(),D.Yb(24,"div",10),D.cc(),D.dc(25,"div",2),D.dc(26,"div",12),D.dc(27,"p",4),D.Vc(28),D.qc(29,"translate"),D.cc(),D.cc(),D.cc(),D.dc(30,"div",2),D.dc(31,"div",5),D.dc(32,"div",13),D.lc("click",(function(){return D.Kc(i),D.Gc(38).open()})),D.Tc(33,pr,3,3,"span",14),D.Tc(34,fr,3,4,"ng-template",null,15,D.Uc),D.Yb(36,"input",16),D.Yb(37,"mat-datepicker",null,17),D.cc(),D.cc(),D.dc(39,"div",10),D.Tc(40,Ir,3,0,"button",18),D.cc(),D.dc(41,"div",19),D.Tc(42,Tr,3,3,"p",20),D.Tc(43,br,7,4,"div",21),D.cc(),D.dc(44,"div",10),D.Tc(45,mr,3,0,"button",18),D.cc(),D.dc(46,"div",10),D.Tc(47,Ar,3,3,"p",20),D.cc(),D.cc(),D.dc(48,"div",22),D.dc(49,"div",19),D.dc(50,"div",23),D.dc(51,"p",4),D.Vc(52),D.qc(53,"translate"),D.cc(),D.cc(),D.dc(54,"div",24),D.dc(55,"label",25),D.dc(56,"input",26),D.lc("click",(function(e){return t.checkBoxChange("ORIGIN_HAS_AT_LEAST_ONE",e)})),D.cc(),D.dc(57,"span"),D.Vc(58),D.qc(59,"translate"),D.cc(),D.cc(),D.cc(),D.dc(60,"div",24),D.dc(61,"label",25),D.dc(62,"input",27),D.lc("click",(function(e){return t.checkBoxChange("ORIGIN_HAS_NO_ONE",e)})),D.cc(),D.dc(63,"span"),D.Vc(64),D.qc(65,"translate"),D.cc(),D.cc(),D.cc(),D.dc(66,"div",24),D.dc(67,"label",25),D.dc(68,"input",28),D.lc("click",(function(e){return t.checkBoxChange("ORIGIN_WAITING_RECALCULATE",e)})),D.cc(),D.dc(69,"span"),D.Vc(70),D.qc(71,"translate"),D.cc(),D.cc(),D.cc(),D.cc(),D.Yb(72,"div",19),D.Yb(73,"div",29),D.cc(),D.cc(),D.cc()}if(2&e){var a=D.Gc(35),c=D.Gc(38),r=null,n=null,s=null;D.Lb(1),D.vc("formGroup",t.accessRuleCriteriaForm),D.Lb(4),D.Wc(D.rc(6,27,"COLLECT.SEARCH_CRITERIA_FILTER.ACCESS_TITLE")),D.Lb(4),D.wc("label",D.rc(10,29,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.ID_ACCESS")),D.vc("validator",null==t.accessRuleCriteriaForm||null==(r=t.accessRuleCriteriaForm.get("accessRuleIdentifier"))?null:r.validator)("asyncValidator",null==t.accessRuleCriteriaForm||null==(n=t.accessRuleCriteriaForm.get("accessRuleIdentifier"))?null:n.asyncValidator),D.Lb(3),D.Xc("",D.rc(13,31,"COMMON.REQUIRED")," "),D.Lb(3),D.Xc("",D.rc(16,33,"COLLECT.RULE.WRONG_FORMAT")," "),D.Lb(3),D.Xc("",D.rc(19,35,"COLLECT.RULE.CODE_NOT_EXIST")," "),D.Lb(4),D.wc("label",D.rc(23,37,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.TITLE_ACCESS")),D.vc("validator",null==t.accessRuleCriteriaForm||null==(s=t.accessRuleCriteriaForm.get("accessRuleTitle"))?null:s.validator),D.Lb(6),D.Wc(D.rc(29,39,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.END_DATE_ACCESS")),D.Lb(5),D.vc("ngIf",!t.accessRuleCriteriaForm.get("accessRuleStartDate").value)("ngIfElse",a),D.Lb(3),D.vc("matDatepicker",c)("max",t.accessRuleCriteriaForm.get("accessRuleEndDate").value),D.Lb(4),D.vc("ngIf",!t.endDateInterval&&t.accessRuleCriteriaForm.get("accessRuleStartDate").value),D.Lb(2),D.vc("ngIf",!t.endDateInterval),D.Lb(1),D.vc("ngIf",t.endDateInterval),D.Lb(2),D.vc("ngIf",t.endDateInterval&&t.accessRuleCriteriaForm.get("accessRuleStartDate").value&&t.accessRuleCriteriaForm.get("accessRuleEndDate").value),D.Lb(2),D.vc("ngIf",t.endDateInterval),D.Lb(5),D.Xc(" ",D.rc(53,41,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.ORIGIN.TITLE")," "),D.Lb(4),D.vc("checked",t.accessAdditionalCriteria.get("ORIGIN_HAS_AT_LEAST_ONE")),D.Lb(2),D.Wc(D.rc(59,43,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.ORIGIN.HAS_AT_LEAST_ONE_ACCESS_RULE")),D.Lb(4),D.vc("checked",t.accessAdditionalCriteria.get("ORIGIN_HAS_NO_ONE")),D.Lb(2),D.Wc(D.rc(65,45,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.ORIGIN.HAS_NO_ACCESS_RULE")),D.Lb(4),D.vc("checked",t.accessAdditionalCriteria.get("ORIGIN_WAITING_RECALCULATE")),D.Lb(2),D.Wc(D.rc(71,47,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.ORIGIN.WAITING_TO_RE_CALCULATE_ACCESS_RULE"))}},directives:[u.x,u.q,u.i,T.C,u.p,u.h,u.l,T.mb,l.p,u.c,h.b,h.a,Kc.a],pipes:[P.d,T.Vb],styles:['.check-rule[_ngcontent-%COMP%]{margin-right:25%;margin-left:-15%;margin-top:5px}.title-text[_ngcontent-%COMP%]{font-style:normal;font-weight:700;font-size:16px;color:var(--vitamui-primary)!important}.validate-date-small-button[_ngcontent-%COMP%]{background-color:"green";width:30px;height:30px}']}),Sr);function Or(e,t){if(1&e){var i=D.ec();D.dc(0,"span",30),D.lc("click",(function(){return D.Kc(i),D.pc(),D.Gc(38).open()})),D.Vc(1),D.qc(2,"translate"),D.cc()}if(2&e){var a=D.pc();D.Lb(1),D.Wc(D.rc(2,1,a.endDateInterval?"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.END_DATE_REUSE_BEGIN":"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.END_DATE_REUSE_EQUAL"))}}function yr(e,t){if(1&e){var i=D.ec();D.dc(0,"span",31),D.lc("click",(function(){return D.Kc(i),D.pc(),D.Gc(38).open()})),D.Vc(1),D.qc(2,"dateTime"),D.cc()}if(2&e){var a=D.pc();D.Lb(1),D.Xc("",D.sc(2,1,a.reuseRuleCriteriaForm.get("reuseRuleStartDate").value,"dd/MM/yyyy")," ")}}function Nr(e,t){if(1&e){var i=D.ec();D.dc(0,"button",32),D.lc("click",(function(){return D.Kc(i),D.pc().addBeginDtReuseRuleCriteria()})),D.dc(1,"i",33),D.Vc(2,"check"),D.cc(),D.cc()}}function Fr(e,t){if(1&e){var i=D.ec();D.dc(0,"p",34),D.lc("click",(function(){return D.Kc(i),D.pc().updateEndDateInterval(!0)})),D.Vc(1),D.qc(2,"translate"),D.cc()}2&e&&(D.Lb(1),D.Xc(" ",D.rc(2,1,"COLLECT.SEARCH_CRITERIA_FILTER.REUSE_RULE.CREATE_INTERVAL")," "))}function Dr(e,t){if(1&e){var i=D.ec();D.dc(0,"span",30),D.lc("click",(function(){return D.Kc(i),D.pc(),D.Gc(6).open()})),D.Vc(1),D.qc(2,"translate"),D.cc()}2&e&&(D.Lb(1),D.Wc(D.rc(2,1,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.END_DATE_REUSE_END")))}function Ur(e,t){if(1&e){var i=D.ec();D.dc(0,"span",31),D.lc("click",(function(){return D.Kc(i),D.pc(),D.Gc(6).open()})),D.Vc(1),D.qc(2,"dateTime"),D.cc()}if(2&e){var a=D.pc(2);D.Lb(1),D.Xc("",D.sc(2,1,a.reuseRuleCriteriaForm.get("reuseRuleEndDate").value,"dd/MM/yyyy")," ")}}function kr(e,t){if(1&e){var i=D.ec();D.dc(0,"div",13),D.lc("click",(function(){return D.Kc(i),D.Gc(6).open()})),D.Tc(1,Dr,3,3,"span",14),D.Tc(2,Ur,3,4,"ng-template",null,35,D.Uc),D.Yb(4,"input",36),D.Yb(5,"mat-datepicker",null,37),D.cc()}if(2&e){var a=D.Gc(3),c=D.Gc(6),r=D.pc();D.Lb(1),D.vc("ngIf",!r.reuseRuleCriteriaForm.get("reuseRuleEndDate").value)("ngIfElse",a),D.Lb(3),D.vc("matDatepicker",c)("min",r.reuseRuleCriteriaForm.get("reuseRuleStartDate").value)}}function Pr(e,t){if(1&e){var i=D.ec();D.dc(0,"button",32),D.lc("click",(function(){return D.Kc(i),D.pc().addIntervalDtReuseRuleCriteria()})),D.dc(1,"i",33),D.Vc(2,"check"),D.cc(),D.cc()}}function xr(e,t){if(1&e){var i=D.ec();D.dc(0,"p",34),D.lc("click",(function(){return D.Kc(i),D.pc().updateEndDateInterval(!1)})),D.Vc(1),D.qc(2,"translate"),D.cc()}2&e&&(D.Lb(1),D.Xc(" ",D.rc(2,1,"COLLECT.SEARCH_CRITERIA_FILTER.REUSE_RULE.DELETE_INTERVAL")," "))}var wr,Mr=((wr=function(){function e(t,i,a,c){var r=this;o(this,e),this.formBuilder=t,this.dialog=i,this.archiveExchangeDataService=a,this.ruleValidator=c,this.reuseCriteriaList=[],this.reuseAdditionalCriteria=new Map,this.endDateInterval=!1,this.emptyReuseCriteriaForm={reuseRuleIdentifier:"",reuseRuleTitle:"",reuseRuleStartDate:"",reuseRuleEndDate:"",reuseRuleOriginInheriteAtLeastOne:!0,reuseRuleOriginHasAtLeastOne:!0,reuseRuleOriginHasNoOne:!1,reuseRuleOriginWaitingRecalculate:!1},this.showUnitPreviewBlock=!1,this.reuseRuleCriteriaForm=this.formBuilder.group({reuseRuleIdentifier:[null,[ce.c.ruleIdPattern],this.ruleValidator.uniqueRuleId()],reuseRuleTitle:["",[]],reuseRuleStartDate:["",[]],reuseRuleEndDate:["",[]],reuseRuleEliminationIdentifier:["",[]]}),Object(A.a)(this.reuseRuleCriteriaForm.statusChanges,this.reuseRuleCriteriaForm.valueChanges).pipe(Object(O.a)(Ge.UPDATE_DEBOUNCE_TIME),Object(y.a)((function(){return r.reuseRuleCriteriaForm.value})),Object(y.a)((function(){return Object(T.sb)(r.reuseRuleCriteriaForm.value,r.previousReuseCriteriaValue)})),Object(ti.a)((function(e){return r.isEmpty(e)}))).subscribe((function(){r.resetReuseRuleCriteriaForm()})),this.reuseRuleCriteriaForm.get("reuseRuleTitle").valueChanges.subscribe((function(e){null!==r.reuseRuleCriteriaForm.get("reuseRuleTitle").value&&""!==r.reuseRuleCriteriaForm.get("reuseRuleTitle").value&&(r.addCriteria("RULE_TITLE_REUSE_RULE",{id:e,value:e},e,!0,T.v.EQ,!1,T.u.STRING,T.Z.REUSE_RULE),r.resetReuseRuleCriteriaForm())})),this.subscriptionReuseFromMainSearchCriteria=this.archiveExchangeDataService.reuseFromMainSearchCriteriaObservable.subscribe((function(e){e&&(r.reuseAdditionalCriteria&&e.action===T.d.ADD?r.reuseAdditionalCriteria.set(e.valueElt.value,!0):e.action===T.d.REMOVE&&r.reuseAdditionalCriteria&&r.reuseAdditionalCriteria.has(e.valueElt.value)&&r.reuseAdditionalCriteria.set(e.valueElt.value,!1))}))}return d(e,[{key:"checkBoxChange",value:function(e,t){var i=t.target.checked;switch(this.reuseAdditionalCriteria.set(e,i),e){case"ORIGIN_HAS_NO_ONE":i?this.addCriteria("RULE_ORIGIN_REUSE_RULE",{id:"ORIGIN_HAS_NO_ONE",value:"ORIGIN_HAS_NO_ONE"},"ORIGIN_HAS_NO_ONE",!0,T.v.MISSING,!0,T.u.STRING,T.Z.REUSE_RULE):this.emitRemoveCriteriaEvent("RULE_ORIGIN_REUSE_RULE",{id:"ORIGIN_HAS_NO_ONE",value:"ORIGIN_HAS_NO_ONE"}),this.previousReuseCriteriaValue.reuseRuleOriginHasNoOne=i;break;case"ORIGIN_WAITING_RECALCULATE":i?this.addCriteria("RULE_ORIGIN_REUSE_RULE",{id:"ORIGIN_WAITING_RECALCULATE",value:"ORIGIN_WAITING_RECALCULATE"},"ORIGIN_WAITING_RECALCULATE",!0,T.v.EQ,!0,T.u.STRING,T.Z.REUSE_RULE):this.emitRemoveCriteriaEvent("RULE_ORIGIN_REUSE_RULE",{id:"ORIGIN_WAITING_RECALCULATE",value:"ORIGIN_WAITING_RECALCULATE"}),this.previousReuseCriteriaValue.reuseRuleOriginWaitingRecalculate=i;break;case"ORIGIN_HAS_AT_LEAST_ONE":i?this.addCriteria("RULE_ORIGIN_REUSE_RULE",{id:"ORIGIN_HAS_AT_LEAST_ONE",value:"ORIGIN_HAS_AT_LEAST_ONE"},"ORIGIN_HAS_AT_LEAST_ONE",!0,T.v.EXISTS,!0,T.u.STRING,T.Z.REUSE_RULE):this.emitRemoveCriteriaEvent("RULE_ORIGIN_REUSE_RULE",{id:"ORIGIN_HAS_AT_LEAST_ONE",value:"ORIGIN_HAS_AT_LEAST_ONE"}),this.previousReuseCriteriaValue.reuseRuleOriginHasAtLeastOne=i}}},{key:"addBeginDtReuseRuleCriteria",value:function(){this.reuseRuleCriteriaForm.value.reuseRuleStartDate&&(this.addCriteria("RULE_END_DATE_REUSE_RULE",{id:this.reuseRuleCriteriaForm.value.reuseRuleStartDate+"-",beginInterval:"",endInterval:this.reuseRuleCriteriaForm.value.reuseRuleStartDate},this.reuseRuleCriteriaForm.value.reuseRuleStartDate,!0,T.v.LTE,!1,T.u.INTERVAL,T.Z.REUSE_RULE),this.reuseRuleCriteriaForm.controls.reuseRuleStartDate.setValue(null))}},{key:"addCriteriaRulePostCheck",value:function(){this.reuseRuleCriteriaForm.value.reuseRuleIdentifier&&(this.addCriteria("RULE_IDENTIFIER_REUSE_RULE",{id:this.reuseRuleCriteriaForm.value.reuseRuleIdentifier.trim(),value:this.reuseRuleCriteriaForm.value.reuseRuleIdentifier.trim()},this.reuseRuleCriteriaForm.value.reuseRuleIdentifier.trim(),!0,T.v.EQ,!1,T.u.STRING,T.Z.REUSE_RULE),this.reuseRuleCriteriaForm.controls.reuseRuleIdentifier.setValue(null))}},{key:"addIntervalDtReuseRuleCriteria",value:function(){this.reuseRuleCriteriaForm.value.reuseRuleStartDate&&this.reuseRuleCriteriaForm.value.reuseRuleEndDate&&(this.addCriteria("RULE_END_DATE_REUSE_RULE",{id:this.reuseRuleCriteriaForm.value.reuseRuleStartDate+"-"+this.reuseRuleCriteriaForm.value.reuseRuleEndDate,beginInterval:this.reuseRuleCriteriaForm.value.reuseRuleStartDate,endInterval:this.reuseRuleCriteriaForm.value.reuseRuleEndDate},this.reuseRuleCriteriaForm.value.reuseRuleStartDate,!0,T.v.BETWEEN,!1,T.u.INTERVAL,T.Z.REUSE_RULE),this.reuseRuleCriteriaForm.controls.reuseRuleStartDate.setValue(null),this.reuseRuleCriteriaForm.controls.reuseRuleEndDate.setValue(null))}},{key:"isEmpty",value:function(e){return!!e&&(e.reuseRuleIdentifier?(this.addCriteria("RULE_IDENTIFIER_REUSE_RULE",{id:e.reuseRuleIdentifier.trim(),value:e.reuseRuleIdentifier.trim()},e.reuseRuleIdentifier.trim(),!0,T.v.EQ,!1,T.u.STRING,T.Z.REUSE_RULE),this.resetReuseRuleCriteriaForm(),!0):e.reuseRuleTitle?(this.addCriteria("RULE_TITLE_REUSE_RULE",{id:e.reuseRuleTitle.trim(),value:e.reuseRuleTitle.trim()},e.reuseRuleTitle.trim(),!0,T.v.EQ,!1,T.u.STRING,T.Z.REUSE_RULE),!0):void 0)}},{key:"updateEndDateInterval",value:function(e){this.endDateInterval=e}},{key:"resetReuseRuleCriteriaForm",value:function(){this.reuseRuleCriteriaForm.reset(this.previousReuseCriteriaValue)}},{key:"ngOnInit",value:function(){this.reuseAdditionalCriteria=new Map,this.reuseAdditionalCriteria.set("ORIGIN_WAITING_RECALCULATE",!0===this.hasWaitingToRecalculateCriteria),this.reuseAdditionalCriteria.set("ORIGIN_HAS_NO_ONE",!1),this.reuseAdditionalCriteria.set("ORIGIN_HAS_AT_LEAST_ONE",!1),this.previousReuseCriteriaValue={reuseRuleIdentifier:"",reuseRuleTitle:"",reuseRuleStartDate:"",reuseRuleEndDate:"",reuseRuleOriginInheriteAtLeastOne:!0,reuseRuleOriginHasAtLeastOne:!0,reuseRuleOriginHasNoOne:!1,reuseRuleOriginWaitingRecalculate:this.hasWaitingToRecalculateCriteria},this.addCriteria("RULE_ORIGIN_REUSE_RULE",{value:"ORIGIN_HAS_AT_LEAST_ONE",id:"ORIGIN_HAS_AT_LEAST_ONE"},"ORIGIN_HAS_AT_LEAST_ONE",!0,T.v.EXISTS,!0,T.u.STRING,T.Z.REUSE_RULE),this.reuseAdditionalCriteria.set("ORIGIN_HAS_AT_LEAST_ONE",!0)}},{key:"emitRemoveCriteriaEvent",value:function(e,t){this.archiveExchangeDataService.sendRemoveFromChildSearchCriteriaAction({keyElt:e,valueElt:t,action:"REMOVE"})}},{key:"addCriteria",value:function(e,t,i,a,c,r,n,s){e&&t&&this.archiveExchangeDataService.addSimpleSearchCriteriaSubject({keyElt:e,valueElt:t,labelElt:i,keyTranslated:a,operator:c,category:s,valueTranslated:r,dataType:n})}},{key:"ngOnDestroy",value:function(){this.subscriptionReuseFromMainSearchCriteria.unsubscribe()}},{key:"reuseRuleIdentifier",get:function(){return this.reuseRuleCriteriaForm.controls.reuseRuleIdentifier}},{key:"reuseRuleTitle",get:function(){return this.reuseRuleCriteriaForm.controls.reuseRuleTitle}},{key:"reuseRuleStartDate",get:function(){return this.reuseRuleCriteriaForm.controls.reuseRuleStartDate}},{key:"reuseRuleEndDate",get:function(){return this.reuseRuleCriteriaForm.controls.reuseRuleEndDate}}]),e}()).\u0275fac=function(e){return new(e||wr)(D.Xb(u.e),D.Xb(v.b),D.Xb(Le),D.Xb(Xc))},wr.\u0275cmp=D.Rb({type:wr,selectors:[["app-reuse-rule-search"]],inputs:{hasWaitingToRecalculateCriteria:"hasWaitingToRecalculateCriteria"},decls:74,vars:49,consts:[[1,"container"],[3,"formGroup"],[1,"row","justify-content-start"],[1,"form-control"],[1,"title-text"],[1,"col-5","form-control"],["formControlName","reuseRuleIdentifier","minlength","1",3,"validator","asyncValidator","label"],["errorKey","required"],["errorKey","ruleIdPattern"],["errorKey","ruleIdExists"],[1,"col-1","form-control"],["formControlName","reuseRuleTitle",3,"validator","label"],[1,"col-11","form-control"],[1,"vitamui-input",3,"click"],["class","search-date-label",3,"click",4,"ngIf","ngIfElse"],["showBeginDtReuseRule",""],["size","0","formControlName","reuseRuleStartDate",1,"hidden",3,"matDatepicker","max"],["pickerBeginReuseRule",""],["class","validate-date-small-button","type","button","mat-mini-fab","",3,"click",4,"ngIf"],[1,"col-4","form-control"],["class","title-text text-clicable-uppercase",3,"click",4,"ngIf"],["class","vitamui-input",3,"click",4,"ngIf"],[1,"row","justify-content-around"],[1,"row","criteria-choice"],[1,"row"],[1,"criteria-checkbox-choice"],["type","checkbox","id","HAS_AT_LEAST_ONE_REUSE_RULE_ORIGIN",3,"checked","click"],["id","HAS_NO_REUSE_RULE_ORIGIN","type","checkbox",3,"checked","click"],["id","WAITING_TO_RE_CALCULATE_REUSE_RULE_ORIGIN","type","checkbox",3,"checked","click"],[1,"col-3","form-control"],[1,"search-date-label",3,"click"],[3,"click"],["type","button","mat-mini-fab","",1,"validate-date-small-button",3,"click"],[1,"material-icons"],[1,"title-text","text-clicable-uppercase",3,"click"],["showEndDtReuseRule",""],["size","0","formControlName","reuseRuleEndDate",1,"hidden",3,"matDatepicker","min"],["pickerEndReuseRule",""]],template:function(e,t){if(1&e){var i=D.ec();D.dc(0,"div",0),D.dc(1,"form",1),D.dc(2,"div",2),D.dc(3,"div",3),D.dc(4,"p",4),D.Vc(5),D.qc(6,"translate"),D.cc(),D.cc(),D.cc(),D.dc(7,"div",2),D.dc(8,"div",5),D.dc(9,"vitamui-common-editable-input",6),D.qc(10,"translate"),D.dc(11,"vitamui-common-field-error",7),D.Vc(12),D.qc(13,"translate"),D.cc(),D.dc(14,"vitamui-common-field-error",8),D.Vc(15),D.qc(16,"translate"),D.cc(),D.dc(17,"vitamui-common-field-error",9),D.Vc(18),D.qc(19,"translate"),D.cc(),D.cc(),D.cc(),D.Yb(20,"div",10),D.dc(21,"div",5),D.Yb(22,"vitamui-common-editable-input",11),D.qc(23,"translate"),D.cc(),D.Yb(24,"div",10),D.cc(),D.dc(25,"div",2),D.dc(26,"div",12),D.dc(27,"p",4),D.Vc(28),D.qc(29,"translate"),D.cc(),D.cc(),D.cc(),D.dc(30,"div",2),D.dc(31,"div",5),D.dc(32,"div",13),D.lc("click",(function(){return D.Kc(i),D.Gc(38).open()})),D.Tc(33,Or,3,3,"span",14),D.Tc(34,yr,3,4,"ng-template",null,15,D.Uc),D.Yb(36,"input",16),D.Yb(37,"mat-datepicker",null,17),D.cc(),D.cc(),D.dc(39,"div",10),D.Tc(40,Nr,3,0,"button",18),D.cc(),D.dc(41,"div",19),D.Tc(42,Fr,3,3,"p",20),D.Tc(43,kr,7,4,"div",21),D.cc(),D.dc(44,"div",10),D.Tc(45,Pr,3,0,"button",18),D.cc(),D.dc(46,"div",10),D.Tc(47,xr,3,3,"p",20),D.cc(),D.cc(),D.dc(48,"div",22),D.dc(49,"div",19),D.dc(50,"div",23),D.dc(51,"p",4),D.Vc(52),D.qc(53,"translate"),D.cc(),D.cc(),D.dc(54,"div",24),D.dc(55,"label",25),D.dc(56,"input",26),D.lc("click",(function(e){return t.checkBoxChange("ORIGIN_HAS_AT_LEAST_ONE",e)})),D.cc(),D.dc(57,"span"),D.Vc(58),D.qc(59,"translate"),D.cc(),D.cc(),D.cc(),D.dc(60,"div",24),D.dc(61,"label",25),D.dc(62,"input",27),D.lc("click",(function(e){return t.checkBoxChange("ORIGIN_HAS_NO_ONE",e)})),D.cc(),D.dc(63,"span"),D.Vc(64),D.qc(65,"translate"),D.cc(),D.cc(),D.cc(),D.dc(66,"div",24),D.dc(67,"label",25),D.dc(68,"input",28),D.lc("click",(function(e){return t.checkBoxChange("ORIGIN_WAITING_RECALCULATE",e)})),D.cc(),D.dc(69,"span"),D.Vc(70),D.qc(71,"translate"),D.cc(),D.cc(),D.cc(),D.cc(),D.Yb(72,"div",19),D.Yb(73,"div",29),D.cc(),D.cc(),D.cc()}if(2&e){var a=D.Gc(35),c=D.Gc(38),r=null,n=null,s=null;D.Lb(1),D.vc("formGroup",t.reuseRuleCriteriaForm),D.Lb(4),D.Wc(D.rc(6,27,"COLLECT.SEARCH_CRITERIA_FILTER.REUSE_TITLE")),D.Lb(4),D.wc("label",D.rc(10,29,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.ID_REUSE")),D.vc("validator",null==t.reuseRuleCriteriaForm||null==(r=t.reuseRuleCriteriaForm.get("reuseRuleIdentifier"))?null:r.validator)("asyncValidator",null==t.reuseRuleCriteriaForm||null==(n=t.reuseRuleCriteriaForm.get("reuseRuleIdentifier"))?null:n.asyncValidator),D.Lb(3),D.Xc("",D.rc(13,31,"COMMON.REQUIRED")," "),D.Lb(3),D.Xc("",D.rc(16,33,"COLLECT.RULE.WRONG_FORMAT")," "),D.Lb(3),D.Xc("",D.rc(19,35,"COLLECT.RULE.CODE_NOT_EXIST")," "),D.Lb(4),D.wc("label",D.rc(23,37,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.TITLE_REUSE")),D.vc("validator",null==t.reuseRuleCriteriaForm||null==(s=t.reuseRuleCriteriaForm.get("reuseRuleTitle"))?null:s.validator),D.Lb(6),D.Wc(D.rc(29,39,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.END_DATE_REUSE")),D.Lb(5),D.vc("ngIf",!t.reuseRuleCriteriaForm.get("reuseRuleStartDate").value)("ngIfElse",a),D.Lb(3),D.vc("matDatepicker",c)("max",t.reuseRuleCriteriaForm.get("reuseRuleEndDate").value),D.Lb(4),D.vc("ngIf",!t.endDateInterval&&t.reuseRuleCriteriaForm.get("reuseRuleStartDate").value),D.Lb(2),D.vc("ngIf",!t.endDateInterval),D.Lb(1),D.vc("ngIf",t.endDateInterval),D.Lb(2),D.vc("ngIf",t.endDateInterval&&t.reuseRuleCriteriaForm.get("reuseRuleStartDate").value&&t.reuseRuleCriteriaForm.get("reuseRuleEndDate").value),D.Lb(2),D.vc("ngIf",t.endDateInterval),D.Lb(5),D.Xc(" ",D.rc(53,41,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.ORIGIN.TITLE")," "),D.Lb(4),D.vc("checked",t.reuseAdditionalCriteria.get("ORIGIN_HAS_AT_LEAST_ONE")),D.Lb(2),D.Wc(D.rc(59,43,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.ORIGIN.HAS_AT_LEAST_ONE_REUSE_RULE")),D.Lb(4),D.vc("checked",t.reuseAdditionalCriteria.get("ORIGIN_HAS_NO_ONE")),D.Lb(2),D.Wc(D.rc(65,45,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.ORIGIN.HAS_NO_REUSE_RULE")),D.Lb(4),D.vc("checked",t.reuseAdditionalCriteria.get("ORIGIN_WAITING_RECALCULATE")),D.Lb(2),D.Wc(D.rc(71,47,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.ORIGIN.WAITING_TO_RE_CALCULATE_REUSE_RULE"))}},directives:[u.x,u.q,u.i,T.C,u.p,u.h,u.l,T.mb,l.p,u.c,h.b,h.a,Kc.a],pipes:[P.d,T.Vb],styles:['.check-rule[_ngcontent-%COMP%]{margin-right:25%;margin-left:-15%;margin-top:5px}.title-text[_ngcontent-%COMP%]{font-style:normal;font-weight:700;font-size:16px;color:var(--vitamui-primary)!important}.validate-date-small-button[_ngcontent-%COMP%]{background-color:"green";width:30px;height:30px}']}),wr);function Vr(e,t){if(1&e){var i=D.ec();D.dc(0,"span",30),D.lc("click",(function(){return D.Kc(i),D.pc(),D.Gc(38).open()})),D.Vc(1),D.qc(2,"translate"),D.cc()}if(2&e){var a=D.pc();D.Lb(1),D.Wc(D.rc(2,1,a.endDateInterval?"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.END_DATE_DISSEMINATION_BEGIN":"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.END_DATE_DISSEMINATION_EQUAL"))}}function Hr(e,t){if(1&e){var i=D.ec();D.dc(0,"span",31),D.lc("click",(function(){return D.Kc(i),D.pc(),D.Gc(38).open()})),D.Vc(1),D.qc(2,"dateTime"),D.cc()}if(2&e){var a=D.pc();D.Lb(1),D.Xc("",D.sc(2,1,a.disseminationRuleCriteriaForm.get("disseminationRuleStartDate").value,"dd/MM/yyyy")," ")}}function Gr(e,t){if(1&e){var i=D.ec();D.dc(0,"button",32),D.lc("click",(function(){return D.Kc(i),D.pc().addBeginDtDisseminationRuleCriteria()})),D.dc(1,"i",33),D.Vc(2,"check"),D.cc(),D.cc()}}function qr(e,t){if(1&e){var i=D.ec();D.dc(0,"p",34),D.lc("click",(function(){return D.Kc(i),D.pc().updateEndDateInterval(!0)})),D.Vc(1),D.qc(2,"translate"),D.cc()}2&e&&(D.Lb(1),D.Xc(" ",D.rc(2,1,"COLLECT.SEARCH_CRITERIA_FILTER.DISSEMINATION_RULE.CREATE_INTERVAL")," "))}function Br(e,t){if(1&e){var i=D.ec();D.dc(0,"span",30),D.lc("click",(function(){return D.Kc(i),D.pc(),D.Gc(6).open()})),D.Vc(1),D.qc(2,"translate"),D.cc()}2&e&&(D.Lb(1),D.Wc(D.rc(2,1,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.END_DATE_DISSEMINATION_END")))}function Wr(e,t){if(1&e){var i=D.ec();D.dc(0,"span",31),D.lc("click",(function(){return D.Kc(i),D.pc(),D.Gc(6).open()})),D.Vc(1),D.qc(2,"dateTime"),D.cc()}if(2&e){var a=D.pc(2);D.Lb(1),D.Xc("",D.sc(2,1,a.disseminationRuleCriteriaForm.get("disseminationRuleEndDate").value,"dd/MM/yyyy")," ")}}function jr(e,t){if(1&e){var i=D.ec();D.dc(0,"div",13),D.lc("click",(function(){return D.Kc(i),D.Gc(6).open()})),D.Tc(1,Br,3,3,"span",14),D.Tc(2,Wr,3,4,"ng-template",null,35,D.Uc),D.Yb(4,"input",36),D.Yb(5,"mat-datepicker",null,37),D.cc()}if(2&e){var a=D.Gc(3),c=D.Gc(6),r=D.pc();D.Lb(1),D.vc("ngIf",!r.disseminationRuleCriteriaForm.get("disseminationRuleEndDate").value)("ngIfElse",a),D.Lb(3),D.vc("matDatepicker",c)("min",r.disseminationRuleCriteriaForm.get("disseminationRuleStartDate").value)}}function Yr(e,t){if(1&e){var i=D.ec();D.dc(0,"button",32),D.lc("click",(function(){return D.Kc(i),D.pc().addIntervalDtDisseminationRuleCriteria()})),D.dc(1,"i",33),D.Vc(2,"check"),D.cc(),D.cc()}}function Xr(e,t){if(1&e){var i=D.ec();D.dc(0,"p",34),D.lc("click",(function(){return D.Kc(i),D.pc().updateEndDateInterval(!1)})),D.Vc(1),D.qc(2,"translate"),D.cc()}2&e&&(D.Lb(1),D.Xc(" ",D.rc(2,1,"COLLECT.SEARCH_CRITERIA_FILTER.DISSEMINATION_RULE.DELETE_INTERVAL")," "))}var Kr,zr=((Kr=function(){function e(t,i,a,c){var r=this;o(this,e),this.formBuilder=t,this.dialog=i,this.archiveExchangeDataService=a,this.ruleValidator=c,this.disseminationCriteriaList=[],this.disseminationAdditionalCriteria=new Map,this.endDateInterval=!1,this.emptyDisseminationCriteriaForm={disseminationRuleIdentifier:"",disseminationRuleTitle:"",disseminationRuleStartDate:"",disseminationRuleEndDate:"",disseminationRuleOriginInheriteAtLeastOne:!0,disseminationRuleOriginHasAtLeastOne:!0,disseminationRuleOriginHasNoOne:!1,disseminationRuleOriginWaitingRecalculate:!1},this.showUnitPreviewBlock=!1,this.disseminationRuleCriteriaForm=this.formBuilder.group({disseminationRuleIdentifier:[null,[ce.c.ruleIdPattern],this.ruleValidator.uniqueRuleId()],disseminationRuleTitle:["",[]],disseminationRuleStartDate:["",[]],disseminationRuleEndDate:["",[]],disseminationRuleEliminationIdentifier:["",[]]}),Object(A.a)(this.disseminationRuleCriteriaForm.statusChanges,this.disseminationRuleCriteriaForm.valueChanges).pipe(Object(O.a)(Ge.UPDATE_DEBOUNCE_TIME),Object(y.a)((function(){return r.disseminationRuleCriteriaForm.value})),Object(y.a)((function(){return Object(T.sb)(r.disseminationRuleCriteriaForm.value,r.previousDisseminationCriteriaValue)})),Object(ti.a)((function(e){return r.isEmpty(e)}))).subscribe((function(){r.resetDisseminationRuleCriteriaForm()})),this.disseminationRuleCriteriaForm.get("disseminationRuleTitle").valueChanges.subscribe((function(e){null!==r.disseminationRuleCriteriaForm.get("disseminationRuleTitle").value&&""!==r.disseminationRuleCriteriaForm.get("disseminationRuleTitle").value&&(r.addCriteria("RULE_TITLE_DISSEMINATION_RULE",{id:e,value:e},e,!0,T.v.EQ,!1,T.u.STRING,T.Z.DISSEMINATION_RULE),r.resetDisseminationRuleCriteriaForm())})),this.subscriptionDisseminationFromMainSearchCriteria=this.archiveExchangeDataService.disseminationFromMainSearchCriteriaObservable.subscribe((function(e){e&&(r.disseminationAdditionalCriteria&&e.action===T.d.ADD?r.disseminationAdditionalCriteria.set(e.valueElt.value,!0):e.action===T.d.REMOVE&&r.disseminationAdditionalCriteria&&r.disseminationAdditionalCriteria.has(e.valueElt.value)&&r.disseminationAdditionalCriteria.set(e.valueElt.value,!1))}))}return d(e,[{key:"checkBoxChange",value:function(e,t){var i=t.target.checked;switch(this.disseminationAdditionalCriteria.set(e,i),e){case"ORIGIN_HAS_NO_ONE":i?this.addCriteria("RULE_ORIGIN_DISSEMINATION_RULE",{id:"ORIGIN_HAS_NO_ONE",value:"ORIGIN_HAS_NO_ONE"},"ORIGIN_HAS_NO_ONE",!0,T.v.MISSING,!0,T.u.STRING,T.Z.DISSEMINATION_RULE):this.emitRemoveCriteriaEvent("RULE_ORIGIN_DISSEMINATION_RULE",{id:"ORIGIN_HAS_NO_ONE",value:"ORIGIN_HAS_NO_ONE"}),this.previousDisseminationCriteriaValue.disseminationRuleOriginHasNoOne=i;break;case"ORIGIN_WAITING_RECALCULATE":i?this.addCriteria("RULE_ORIGIN_DISSEMINATION_RULE",{id:"ORIGIN_WAITING_RECALCULATE",value:"ORIGIN_WAITING_RECALCULATE"},"ORIGIN_WAITING_RECALCULATE",!0,T.v.EQ,!0,T.u.STRING,T.Z.DISSEMINATION_RULE):this.emitRemoveCriteriaEvent("RULE_ORIGIN_DISSEMINATION_RULE",{id:"ORIGIN_WAITING_RECALCULATE",value:"ORIGIN_WAITING_RECALCULATE"}),this.previousDisseminationCriteriaValue.disseminationRuleOriginWaitingRecalculate=i;break;case"ORIGIN_HAS_AT_LEAST_ONE":i?this.addCriteria("RULE_ORIGIN_DISSEMINATION_RULE",{id:"ORIGIN_HAS_AT_LEAST_ONE",value:"ORIGIN_HAS_AT_LEAST_ONE"},"ORIGIN_HAS_AT_LEAST_ONE",!0,T.v.EXISTS,!0,T.u.STRING,T.Z.DISSEMINATION_RULE):this.emitRemoveCriteriaEvent("RULE_ORIGIN_DISSEMINATION_RULE",{id:"ORIGIN_HAS_AT_LEAST_ONE",value:"ORIGIN_HAS_AT_LEAST_ONE"}),this.previousDisseminationCriteriaValue.disseminationRuleOriginHasAtLeastOne=i}}},{key:"addBeginDtDisseminationRuleCriteria",value:function(){this.disseminationRuleCriteriaForm.value.disseminationRuleStartDate&&(this.addCriteria("RULE_END_DATE_DISSEMINATION_RULE",{id:this.disseminationRuleCriteriaForm.value.disseminationRuleStartDate+"-",beginInterval:"",endInterval:this.disseminationRuleCriteriaForm.value.disseminationRuleStartDate},this.disseminationRuleCriteriaForm.value.disseminationRuleStartDate,!0,T.v.LTE,!1,T.u.INTERVAL,T.Z.DISSEMINATION_RULE),this.disseminationRuleCriteriaForm.controls.disseminationRuleStartDate.setValue(null))}},{key:"addCriteriaRulePostCheck",value:function(){this.disseminationRuleCriteriaForm.value.disseminationRuleIdentifier&&(this.addCriteria("RULE_IDENTIFIER_DISSEMINATION_RULE",{id:this.disseminationRuleCriteriaForm.value.disseminationRuleIdentifier.trim(),value:this.disseminationRuleCriteriaForm.value.disseminationRuleIdentifier.trim()},this.disseminationRuleCriteriaForm.value.disseminationRuleIdentifier.trim(),!0,T.v.EQ,!1,T.u.STRING,T.Z.DISSEMINATION_RULE),this.disseminationRuleCriteriaForm.controls.disseminationRuleIdentifier.setValue(null))}},{key:"addIntervalDtDisseminationRuleCriteria",value:function(){this.disseminationRuleCriteriaForm.value.disseminationRuleStartDate&&this.disseminationRuleCriteriaForm.value.disseminationRuleEndDate&&(this.addCriteria("RULE_END_DATE_DISSEMINATION_RULE",{id:this.disseminationRuleCriteriaForm.value.disseminationRuleStartDate+"-"+this.disseminationRuleCriteriaForm.value.disseminationRuleEndDate,beginInterval:this.disseminationRuleCriteriaForm.value.disseminationRuleStartDate,endInterval:this.disseminationRuleCriteriaForm.value.disseminationRuleEndDate},this.disseminationRuleCriteriaForm.value.disseminationRuleStartDate,!0,T.v.BETWEEN,!1,T.u.INTERVAL,T.Z.DISSEMINATION_RULE),this.disseminationRuleCriteriaForm.controls.disseminationRuleStartDate.setValue(null),this.disseminationRuleCriteriaForm.controls.disseminationRuleEndDate.setValue(null))}},{key:"isEmpty",value:function(e){return!!e&&(e.disseminationRuleIdentifier?(this.addCriteria("RULE_IDENTIFIER_DISSEMINATION_RULE",{id:e.disseminationRuleIdentifier.trim(),value:e.disseminationRuleIdentifier.trim()},e.disseminationRuleIdentifier.trim(),!0,T.v.EQ,!1,T.u.STRING,T.Z.DISSEMINATION_RULE),this.resetDisseminationRuleCriteriaForm(),!0):e.disseminationRuleTitle?(this.addCriteria("RULE_TITLE_DISSEMINATION_RULE",{id:e.disseminationRuleTitle.trim(),value:e.disseminationRuleTitle.trim()},e.disseminationRuleTitle.trim(),!0,T.v.EQ,!1,T.u.STRING,T.Z.DISSEMINATION_RULE),!0):void 0)}},{key:"updateEndDateInterval",value:function(e){this.endDateInterval=e}},{key:"resetDisseminationRuleCriteriaForm",value:function(){this.disseminationRuleCriteriaForm.reset(this.previousDisseminationCriteriaValue)}},{key:"ngOnInit",value:function(){this.disseminationAdditionalCriteria=new Map,this.disseminationAdditionalCriteria.set("ORIGIN_WAITING_RECALCULATE",!0===this.hasWaitingToRecalculateCriteria),this.disseminationAdditionalCriteria.set("ORIGIN_HAS_NO_ONE",!1),this.disseminationAdditionalCriteria.set("ORIGIN_HAS_AT_LEAST_ONE",!1),this.previousDisseminationCriteriaValue={disseminationRuleIdentifier:"",disseminationRuleTitle:"",disseminationRuleStartDate:"",disseminationRuleEndDate:"",disseminationRuleOriginInheriteAtLeastOne:!0,disseminationRuleOriginHasAtLeastOne:!0,disseminationRuleOriginHasNoOne:!1,disseminationRuleOriginWaitingRecalculate:this.hasWaitingToRecalculateCriteria},this.addCriteria("RULE_ORIGIN_DISSEMINATION_RULE",{value:"ORIGIN_HAS_AT_LEAST_ONE",id:"ORIGIN_HAS_AT_LEAST_ONE"},"ORIGIN_HAS_AT_LEAST_ONE",!0,T.v.EXISTS,!0,T.u.STRING,T.Z.DISSEMINATION_RULE),this.disseminationAdditionalCriteria.set("ORIGIN_HAS_AT_LEAST_ONE",!0)}},{key:"emitRemoveCriteriaEvent",value:function(e,t){this.archiveExchangeDataService.sendRemoveFromChildSearchCriteriaAction({keyElt:e,valueElt:t,action:"REMOVE"})}},{key:"addCriteria",value:function(e,t,i,a,c,r,n,s){e&&t&&this.archiveExchangeDataService.addSimpleSearchCriteriaSubject({keyElt:e,valueElt:t,labelElt:i,keyTranslated:a,operator:c,category:s,valueTranslated:r,dataType:n})}},{key:"ngOnDestroy",value:function(){this.subscriptionDisseminationFromMainSearchCriteria.unsubscribe()}},{key:"disseminationRuleIdentifier",get:function(){return this.disseminationRuleCriteriaForm.controls.disseminationRuleIdentifier}},{key:"disseminationRuleTitle",get:function(){return this.disseminationRuleCriteriaForm.controls.disseminationRuleTitle}},{key:"disseminationRuleStartDate",get:function(){return this.disseminationRuleCriteriaForm.controls.disseminationRuleStartDate}},{key:"disseminationRuleEndDate",get:function(){return this.disseminationRuleCriteriaForm.controls.disseminationRuleEndDate}}]),e}()).\u0275fac=function(e){return new(e||Kr)(D.Xb(u.e),D.Xb(v.b),D.Xb(Le),D.Xb(Xc))},Kr.\u0275cmp=D.Rb({type:Kr,selectors:[["app-dissemination-rule-search"]],inputs:{hasWaitingToRecalculateCriteria:"hasWaitingToRecalculateCriteria"},decls:74,vars:49,consts:[[1,"container"],[3,"formGroup"],[1,"row","justify-content-start"],[1,"form-control"],[1,"title-text"],[1,"col-5","form-control"],["formControlName","disseminationRuleIdentifier","minlength","1",3,"validator","asyncValidator","label"],["errorKey","required"],["errorKey","ruleIdPattern"],["errorKey","ruleIdExists"],[1,"col-1","form-control"],["formControlName","disseminationRuleTitle",3,"validator","label"],[1,"col-11","form-control"],[1,"vitamui-input",3,"click"],["class","search-date-label",3,"click",4,"ngIf","ngIfElse"],["showBeginDtDisseminationRule",""],["size","0","formControlName","disseminationRuleStartDate",1,"hidden",3,"matDatepicker","max"],["pickerBeginDisseminationRule",""],["class","validate-date-small-button","type","button","mat-mini-fab","",3,"click",4,"ngIf"],[1,"col-4","form-control"],["class","title-text text-clicable-uppercase",3,"click",4,"ngIf"],["class","vitamui-input",3,"click",4,"ngIf"],[1,"row","justify-content-around"],[1,"row","criteria-choice"],[1,"row"],[1,"criteria-checkbox-choice"],["type","checkbox","id","HAS_AT_LEAST_ONE_DISSEMINATION_RULE_ORIGIN",3,"checked","click"],["id","HAS_NO_DISSEMINATION_RULE_ORIGIN","type","checkbox",3,"checked","click"],["id","WAITING_TO_RE_CALCULATE_DISSEMINATION_RULE_ORIGIN","type","checkbox",3,"checked","click"],[1,"col-3","form-control"],[1,"search-date-label",3,"click"],[3,"click"],["type","button","mat-mini-fab","",1,"validate-date-small-button",3,"click"],[1,"material-icons"],[1,"title-text","text-clicable-uppercase",3,"click"],["showEndDtDisseminationRule",""],["size","0","formControlName","disseminationRuleEndDate",1,"hidden",3,"matDatepicker","min"],["pickerEndDisseminationRule",""]],template:function(e,t){if(1&e){var i=D.ec();D.dc(0,"div",0),D.dc(1,"form",1),D.dc(2,"div",2),D.dc(3,"div",3),D.dc(4,"p",4),D.Vc(5),D.qc(6,"translate"),D.cc(),D.cc(),D.cc(),D.dc(7,"div",2),D.dc(8,"div",5),D.dc(9,"vitamui-common-editable-input",6),D.qc(10,"translate"),D.dc(11,"vitamui-common-field-error",7),D.Vc(12),D.qc(13,"translate"),D.cc(),D.dc(14,"vitamui-common-field-error",8),D.Vc(15),D.qc(16,"translate"),D.cc(),D.dc(17,"vitamui-common-field-error",9),D.Vc(18),D.qc(19,"translate"),D.cc(),D.cc(),D.cc(),D.Yb(20,"div",10),D.dc(21,"div",5),D.Yb(22,"vitamui-common-editable-input",11),D.qc(23,"translate"),D.cc(),D.Yb(24,"div",10),D.cc(),D.dc(25,"div",2),D.dc(26,"div",12),D.dc(27,"p",4),D.Vc(28),D.qc(29,"translate"),D.cc(),D.cc(),D.cc(),D.dc(30,"div",2),D.dc(31,"div",5),D.dc(32,"div",13),D.lc("click",(function(){return D.Kc(i),D.Gc(38).open()})),D.Tc(33,Vr,3,3,"span",14),D.Tc(34,Hr,3,4,"ng-template",null,15,D.Uc),D.Yb(36,"input",16),D.Yb(37,"mat-datepicker",null,17),D.cc(),D.cc(),D.dc(39,"div",10),D.Tc(40,Gr,3,0,"button",18),D.cc(),D.dc(41,"div",19),D.Tc(42,qr,3,3,"p",20),D.Tc(43,jr,7,4,"div",21),D.cc(),D.dc(44,"div",10),D.Tc(45,Yr,3,0,"button",18),D.cc(),D.dc(46,"div",10),D.Tc(47,Xr,3,3,"p",20),D.cc(),D.cc(),D.dc(48,"div",22),D.dc(49,"div",19),D.dc(50,"div",23),D.dc(51,"p",4),D.Vc(52),D.qc(53,"translate"),D.cc(),D.cc(),D.dc(54,"div",24),D.dc(55,"label",25),D.dc(56,"input",26),D.lc("click",(function(e){return t.checkBoxChange("ORIGIN_HAS_AT_LEAST_ONE",e)})),D.cc(),D.dc(57,"span"),D.Vc(58),D.qc(59,"translate"),D.cc(),D.cc(),D.cc(),D.dc(60,"div",24),D.dc(61,"label",25),D.dc(62,"input",27),D.lc("click",(function(e){return t.checkBoxChange("ORIGIN_HAS_NO_ONE",e)})),D.cc(),D.dc(63,"span"),D.Vc(64),D.qc(65,"translate"),D.cc(),D.cc(),D.cc(),D.dc(66,"div",24),D.dc(67,"label",25),D.dc(68,"input",28),D.lc("click",(function(e){return t.checkBoxChange("ORIGIN_WAITING_RECALCULATE",e)})),D.cc(),D.dc(69,"span"),D.Vc(70),D.qc(71,"translate"),D.cc(),D.cc(),D.cc(),D.cc(),D.Yb(72,"div",19),D.Yb(73,"div",29),D.cc(),D.cc(),D.cc()}if(2&e){var a=D.Gc(35),c=D.Gc(38),r=null,n=null,s=null;D.Lb(1),D.vc("formGroup",t.disseminationRuleCriteriaForm),D.Lb(4),D.Wc(D.rc(6,27,"COLLECT.SEARCH_CRITERIA_FILTER.DISSEMINATION_TITLE")),D.Lb(4),D.wc("label",D.rc(10,29,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.ID_DISSEMINATION")),D.vc("validator",null==t.disseminationRuleCriteriaForm||null==(r=t.disseminationRuleCriteriaForm.get("disseminationRuleIdentifier"))?null:r.validator)("asyncValidator",null==t.disseminationRuleCriteriaForm||null==(n=t.disseminationRuleCriteriaForm.get("disseminationRuleIdentifier"))?null:n.asyncValidator),D.Lb(3),D.Xc("",D.rc(13,31,"COMMON.REQUIRED")," "),D.Lb(3),D.Xc("",D.rc(16,33,"COLLECT.RULE.WRONG_FORMAT")," "),D.Lb(3),D.Xc("",D.rc(19,35,"COLLECT.RULE.CODE_NOT_EXIST")," "),D.Lb(4),D.wc("label",D.rc(23,37,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.TITLE_DISSEMINATION")),D.vc("validator",null==t.disseminationRuleCriteriaForm||null==(s=t.disseminationRuleCriteriaForm.get("disseminationRuleTitle"))?null:s.validator),D.Lb(6),D.Wc(D.rc(29,39,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.END_DATE_DISSEMINATION")),D.Lb(5),D.vc("ngIf",!t.disseminationRuleCriteriaForm.get("disseminationRuleStartDate").value)("ngIfElse",a),D.Lb(3),D.vc("matDatepicker",c)("max",t.disseminationRuleCriteriaForm.get("disseminationRuleEndDate").value),D.Lb(4),D.vc("ngIf",!t.endDateInterval&&t.disseminationRuleCriteriaForm.get("disseminationRuleStartDate").value),D.Lb(2),D.vc("ngIf",!t.endDateInterval),D.Lb(1),D.vc("ngIf",t.endDateInterval),D.Lb(2),D.vc("ngIf",t.endDateInterval&&t.disseminationRuleCriteriaForm.get("disseminationRuleStartDate").value&&t.disseminationRuleCriteriaForm.get("disseminationRuleEndDate").value),D.Lb(2),D.vc("ngIf",t.endDateInterval),D.Lb(5),D.Xc(" ",D.rc(53,41,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.ORIGIN.TITLE")," "),D.Lb(4),D.vc("checked",t.disseminationAdditionalCriteria.get("ORIGIN_HAS_AT_LEAST_ONE")),D.Lb(2),D.Wc(D.rc(59,43,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.ORIGIN.HAS_AT_LEAST_ONE_DISSEMINATION_RULE")),D.Lb(4),D.vc("checked",t.disseminationAdditionalCriteria.get("ORIGIN_HAS_NO_ONE")),D.Lb(2),D.Wc(D.rc(65,45,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.ORIGIN.HAS_NO_DISSEMINATION_RULE")),D.Lb(4),D.vc("checked",t.disseminationAdditionalCriteria.get("ORIGIN_WAITING_RECALCULATE")),D.Lb(2),D.Wc(D.rc(71,47,"COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.ORIGIN.WAITING_TO_RE_CALCULATE_DISSEMINATION_RULE"))}},directives:[u.x,u.q,u.i,T.C,u.p,u.h,u.l,T.mb,l.p,u.c,h.b,h.a,Kc.a],pipes:[P.d,T.Vb],styles:['.check-rule[_ngcontent-%COMP%]{margin-right:25%;margin-left:-15%;margin-top:5px}.title-text[_ngcontent-%COMP%]{font-style:normal;font-weight:700;font-size:16px;color:var(--vitamui-primary)!important}.validate-date-small-button[_ngcontent-%COMP%]{background-color:"green";width:30px;height:30px}']}),Kr);function Zr(e,t){if(1&e){var i=D.ec();D.dc(0,"mat-sidenav",7),D.dc(1,"app-filing-holding-scheme",8),D.lc("showArchiveUnitDetails",(function(e){return D.Kc(i),D.pc().showPreviewArchiveUnit(e)})),D.cc(),D.cc()}if(2&e){var a=D.pc();D.vc("fixedInViewport",!0)("opened",a.show),D.Lb(1),D.vc("transactionId",null==a.transaction?null:a.transaction.id)("searchHasMatches",a.searchHasResults)("searchRequestTotalResults",a.totalResults)}}function $r(e,t){if(1&e){var i=D.ec();D.dc(0,"app-archive-preview",9),D.lc("previewClose",(function(){return D.Kc(i),D.pc().closePanel()}))("showExtendedLateralPanel",(function(){return D.Kc(i),D.pc().showExtendedLateralPanel()}))("backToNormalLateralPanel",(function(){return D.Kc(i),D.pc().backToNormalLateralPanel()})),D.cc()}if(2&e){var a=D.pc();D.vc("archiveUnit",a.openedItem)("accessContractAllowUpdating",a.accessContractAllowUpdating)("hasUpdateDescriptiveUnitMetadataRole",a.hasUpdateDescriptiveUnitMetadataRole)("transactionId",a.transaction.id)}}function Qr(e,t){if(1&e){var i=D.ec();D.dc(0,"button",66),D.lc("click",(function(){D.Kc(i);var e=D.pc(2);return e.hiddenTreeBlock(e.show)})),D.qc(1,"translate"),D.dc(2,"i",67),D.Vc(3,"chevron_right"),D.cc(),D.cc()}2&e&&(D.wc("matTooltip",D.rc(1,2,"COLLECT.SHOW_TREES_PLANS")),D.vc("matTooltipShowDelay",300))}function Jr(e,t){if(1&e){var i=D.ec();D.bc(0),D.dc(1,"app-criteria-search",68),D.lc("criteriaRemoveEvent",(function(e){return D.Kc(i),D.pc(3).removeCriteriaEvent(e)})),D.cc(),D.ac()}if(2&e){var a=t.ngIf,c=D.pc().$implicit;D.Lb(1),D.vc("criteriaKey",c)("criteriaVal",a)}}function en(e,t){if(1&e&&(D.bc(0),D.Tc(1,Jr,2,2,"ng-container",65),D.ac()),2&e){var i=t.$implicit,a=D.pc(2);D.Lb(1),D.vc("ngIf",a.searchCriterias.get(i))}}function tn(e,t){if(1&e){var i=D.ec();D.dc(0,"div",69),D.dc(1,"button",70),D.dc(2,"button",71),D.lc("click",(function(){return D.Kc(i),D.pc(2).clearCriterias()})),D.dc(3,"i",28),D.Vc(4,"delete"),D.cc(),D.cc(),D.cc(),D.cc()}}function an(e,t){1&e&&(D.dc(0,"div",72),D.Yb(1,"mat-spinner",73),D.cc())}function cn(e,t){if(1&e){var i=D.ec();D.dc(0,"i",76),D.lc("click",(function(){return D.Kc(i),D.pc(3).showHideFacets(!1)})),D.cc()}2&e&&D.vc("ngClass","vitamui-icon vitamui-icon-cross vitamui-row-icon")}function rn(e,t){if(1&e&&(D.dc(0,"div",40),D.Tc(1,cn,1,1,"i",74),D.Yb(2,"app-archive-search-rules-facets",75),D.cc()),2&e){var i=D.pc(2);D.Lb(1),D.vc("ngIf",!i.pendingComputeFacets&&i.showingFacets&&i.submited),D.Lb(1),D.vc("exactCount",!i.waitingToGetFixedCount)("appraisalRuleFacets",null==i.archiveSearchResultFacets?null:i.archiveSearchResultFacets.appraisalRuleFacets)("accessRuleFacets",null==i.archiveSearchResultFacets?null:i.archiveSearchResultFacets.accessRuleFacets)("storageRuleFacets",null==i.archiveSearchResultFacets?null:i.archiveSearchResultFacets.storageRuleFacets)("reuseRuleFacets",null==i.archiveSearchResultFacets?null:i.archiveSearchResultFacets.reuseRuleFacets)("disseminationRuleFacets",null==i.archiveSearchResultFacets?null:i.archiveSearchResultFacets.disseminationRuleFacets)("holdRuleFacets",null==i.archiveSearchResultFacets?null:i.archiveSearchResultFacets.holdRuleFacets)("classificationRuleFacets",null==i.archiveSearchResultFacets?null:i.archiveSearchResultFacets.classificationRuleFacets)("tenantIdentifier",i.tenantIdentifier)("totalResults",i.totalResults)("defaultFacetTabIndex",i.defaultFacetTabIndex)}}function nn(e,t){if(1&e){var i=D.ec();D.dc(0,"a",78),D.lc("click",(function(){return D.Kc(i),D.pc(3).showHidePanel(!0)})),D.Vc(1),D.qc(2,"translate"),D.cc()}2&e&&(D.Lb(1),D.Wc(D.rc(2,1,"COLLECT.SHOW_SEARCH_CRITERIA")))}function sn(e,t){if(1&e){var i=D.ec();D.dc(0,"a",78),D.lc("click",(function(){return D.Kc(i),D.pc(3).showHideFacets(!0)})),D.Vc(1),D.qc(2,"translate"),D.cc()}2&e&&(D.Lb(1),D.Wc(D.rc(2,1,"COLLECT.COMPUTE_RULES_FACETS")))}function ln(e,t){if(1&e&&(D.dc(0,"div",72),D.Tc(1,nn,3,3,"a",77),D.Tc(2,sn,3,3,"a",77),D.cc()),2&e){var i=D.pc(2);D.Lb(1),D.vc("ngIf",!i.showCriteriaPanel),D.Lb(1),D.vc("ngIf",!i.pendingComputeFacets&&!i.showingFacets&&i.submited)}}function on(e,t){if(1&e){var i=D.ec();D.dc(0,"span",79),D.lc("click",(function(){D.Kc(i);var e=D.pc().$implicit;return D.pc(2).sendRuleCategorySelected(e.name)})),D.Vc(1),D.qc(2,"translate"),D.cc(),D.dc(3,"button",80),D.lc("click",(function(){D.Kc(i);var e=D.pc().$implicit;return D.pc(2).removeCriteriaCategory(e.name)})),D.Yb(4,"i",81),D.cc()}if(2&e){var a=D.pc().$implicit;D.Lb(1),D.Xc(" ",D.rc(2,1,"COLLECT.CRITERIA_CATEGORY_SHORT_NAME."+a.name)," ")}}function un(e,t){if(1&e){var i=D.ec();D.dc(0,"div",40),D.dc(1,"div",82),D.dc(2,"a",78),D.lc("click",(function(){return D.Kc(i),D.pc(3).removeCriteriaByCategory("STORAGE_RULE")})),D.Vc(3),D.qc(4,"translate"),D.cc(),D.cc(),D.Yb(5,"app-storage-rule-search",83),D.cc()}if(2&e){var a=D.pc(3);D.Lb(3),D.Wc(D.rc(4,2,"COLLECT.REMOVE_SEARCH_CRITERIA_BY_CATEGORY")),D.Lb(2),D.vc("hasWaitingToRecalculateCriteria",a.containsWaitingToRecalculateInheritenceRuleCriteria())}}function dn(e,t){if(1&e){var i=D.ec();D.dc(0,"div",40),D.dc(1,"div",82),D.dc(2,"a",78),D.lc("click",(function(){return D.Kc(i),D.pc(3).removeCriteriaByCategory("APPRAISAL_RULE")})),D.Vc(3),D.qc(4,"translate"),D.cc(),D.cc(),D.Yb(5,"app-appraisal-rule-search",83),D.cc()}if(2&e){var a=D.pc(3);D.Lb(3),D.Wc(D.rc(4,2,"COLLECT.REMOVE_SEARCH_CRITERIA_BY_CATEGORY")),D.Lb(2),D.vc("hasWaitingToRecalculateCriteria",a.containsWaitingToRecalculateInheritenceRuleCriteria())}}function hn(e,t){if(1&e){var i=D.ec();D.dc(0,"div",40),D.dc(1,"div",82),D.dc(2,"a",78),D.lc("click",(function(){return D.Kc(i),D.pc(3).removeCriteriaByCategory("ACCESS_RULE")})),D.Vc(3),D.qc(4,"translate"),D.cc(),D.cc(),D.Yb(5,"app-access-rule-search",83),D.cc()}if(2&e){var a=D.pc(3);D.Lb(3),D.Wc(D.rc(4,2,"COLLECT.REMOVE_SEARCH_CRITERIA_BY_CATEGORY")),D.Lb(2),D.vc("hasWaitingToRecalculateCriteria",a.containsWaitingToRecalculateInheritenceRuleCriteria())}}function vn(e,t){if(1&e){var i=D.ec();D.dc(0,"div",40),D.dc(1,"div",82),D.dc(2,"a",78),D.lc("click",(function(){return D.Kc(i),D.pc(3).removeCriteriaByCategory("REUSE_RULE")})),D.Vc(3),D.qc(4,"translate"),D.cc(),D.cc(),D.Yb(5,"app-reuse-rule-search",83),D.cc()}if(2&e){var a=D.pc(3);D.Lb(3),D.Wc(D.rc(4,2,"COLLECT.REMOVE_SEARCH_CRITERIA_BY_CATEGORY")),D.Lb(2),D.vc("hasWaitingToRecalculateCriteria",a.containsWaitingToRecalculateInheritenceRuleCriteria())}}function Cn(e,t){if(1&e){var i=D.ec();D.dc(0,"div",40),D.dc(1,"div",82),D.dc(2,"a",78),D.lc("click",(function(){return D.Kc(i),D.pc(3).removeCriteriaByCategory("DISSEMINATION_RULE")})),D.Vc(3),D.qc(4,"translate"),D.cc(),D.cc(),D.Yb(5,"app-dissemination-rule-search",83),D.cc()}if(2&e){var a=D.pc(3);D.Lb(3),D.Wc(D.rc(4,2,"COLLECT.REMOVE_SEARCH_CRITERIA_BY_CATEGORY")),D.Lb(2),D.vc("hasWaitingToRecalculateCriteria",a.containsWaitingToRecalculateInheritenceRuleCriteria())}}function En(e,t){if(1&e&&(D.dc(0,"mat-tab"),D.Tc(1,on,5,3,"ng-template",42),D.bc(2),D.Tc(3,un,6,4,"div",36),D.ac(),D.bc(4),D.Tc(5,dn,6,4,"div",36),D.ac(),D.bc(6),D.Tc(7,hn,6,4,"div",36),D.ac(),D.bc(8),D.Tc(9,vn,6,4,"div",36),D.ac(),D.bc(10),D.Tc(11,Cn,6,4,"div",36),D.ac(),D.cc()),2&e){var i=t.$implicit;D.Lb(3),D.vc("ngIf","STORAGE_RULE"===i.name),D.Lb(2),D.vc("ngIf","APPRAISAL_RULE"===i.name),D.Lb(2),D.vc("ngIf","ACCESS_RULE"===i.name),D.Lb(2),D.vc("ngIf","REUSE_RULE"===i.name),D.Lb(2),D.vc("ngIf","DISSEMINATION_RULE"===i.name)}}function Rn(e,t){if(1&e&&(D.dc(0,"button",84),D.Vc(1),D.qc(2,"translate"),D.Yb(3,"i",85),D.cc()),2&e){D.pc();var i=D.Gc(57);D.vc("matMenuTriggerFor",i),D.Lb(1),D.Xc(" ",D.rc(2,2,"COLLECT.CRITERIA_CATEGORY.ADD")," ")}}function pn(e,t){if(1&e){var i=D.ec();D.dc(0,"div",82),D.dc(1,"a",78),D.lc("click",(function(){return D.Kc(i),D.pc(2).showHidePanel(!1)})),D.Vc(2),D.qc(3,"translate"),D.cc(),D.cc()}2&e&&(D.Lb(2),D.Wc(D.rc(3,1,"COLLECT.HIDE_SEARCH_CRITERIA")))}function fn(e,t){1&e&&(D.bc(0),D.Yb(1,"i",96),D.ac())}function In(e,t){1&e&&(D.bc(0),D.Yb(1,"i",97),D.ac())}function Tn(e,t){if(1&e&&(D.bc(0),D.dc(1,"span",95),D.Tc(2,fn,2,0,"ng-container",65),D.Tc(3,In,2,0,"ng-container",65),D.cc(),D.ac()),2&e){var i=D.pc().$implicit;D.Lb(2),D.vc("ngIf",!i["#object"]),D.Lb(1),D.vc("ngIf",!!i["#object"])}}function gn(e,t){1&e&&(D.bc(0),D.Yb(1,"i",98),D.ac())}function Ln(e,t){1&e&&(D.bc(0),D.Yb(1,"i",99),D.ac())}function bn(e,t){if(1&e){var i=D.ec();D.dc(0,"div",86),D.dc(1,"div",87),D.dc(2,"div",51),D.dc(3,"input",88),D.lc("click",(function(e){D.Kc(i);var a=t.$implicit;return D.pc(2).checkChildrenBoxChange(a["#id"],e)})),D.cc(),D.cc(),D.dc(4,"div",89),D.lc("click",(function(){D.Kc(i);var e=t.$implicit;return D.pc(2).showPreviewArchiveUnit(e)})),D.dc(5,"span",90),D.Tc(6,Tn,4,2,"ng-container",91),D.Tc(7,gn,2,0,"ng-container",91),D.Tc(8,Ln,2,0,"ng-container",91),D.cc(),D.cc(),D.dc(9,"div",92),D.lc("click",(function(){D.Kc(i);var e=t.$implicit;return D.pc(2).showPreviewArchiveUnit(e)})),D.dc(10,"p",93),D.qc(11,"unitI18n"),D.dc(12,"b"),D.Vc(13),D.qc(14,"unitI18n"),D.cc(),D.Yb(15,"br"),D.Vc(16),D.qc(17,"truncate"),D.qc(18,"unitI18n"),D.cc(),D.cc(),D.dc(19,"div",94),D.lc("click",(function(){D.Kc(i);var e=t.$implicit;return D.pc(2).showPreviewArchiveUnit(e)})),D.Vc(20),D.qc(21,"dateTime"),D.cc(),D.dc(22,"div",94),D.lc("click",(function(){D.Kc(i);var e=t.$implicit;return D.pc(2).showPreviewArchiveUnit(e)})),D.Vc(23),D.qc(24,"dateTime"),D.cc(),D.dc(25,"div",94),D.lc("click",(function(){D.Kc(i);var e=t.$implicit;return D.pc(2).showPreviewArchiveUnit(e)})),D.dc(26,"p",93),D.Vc(27),D.cc(),D.cc(),D.cc(),D.cc()}if(2&e){var a=t.$implicit,c=D.pc(2);D.Lb(3),D.vc("checked",c.isAllChecked),D.Lb(2),D.vc("ngSwitch",c.getArchiveUnitType(a)),D.Lb(1),D.vc("ngSwitchCase",c.UnitType.INGEST),D.Lb(1),D.vc("ngSwitchCase",c.UnitType.HOLDING_UNIT),D.Lb(1),D.vc("ngSwitchCase",c.UnitType.FILING_UNIT),D.Lb(2),D.wc("matTooltip",D.sc(11,15,a,"Description")),D.vc("matTooltipShowDelay",300),D.Lb(3),D.Xc(" ",D.sc(14,18,a,"Title"),""),D.Lb(3),D.Xc(" ",D.sc(17,21,D.sc(18,24,a,"Description"),100)," "),D.Lb(4),D.Xc(" ",D.sc(21,27,a.StartDate,"dd/MM/yyyy")," "),D.Lb(3),D.Xc(" ",D.sc(24,30,a.EndDate,"dd/MM/yyyy")," "),D.Lb(3),D.yc("matTooltip","",a["#originating_agency"],"   (",a["#originating_agencies"],")"),D.vc("matTooltipShowDelay",300),D.Lb(1),D.Xc(" ",a["#originating_agency"]," ")}}function mn(e,t){1&e&&D.Yb(0,"mat-spinner",100)}function An(e,t){if(1&e){var i=D.ec();D.dc(0,"button",101),D.lc("click",(function(){return D.Kc(i),D.pc(2).loadMore()})),D.Vc(1),D.qc(2,"translate"),D.cc()}2&e&&(D.Lb(1),D.Xc(" ",D.rc(2,1,"COLLECT.SHOW_MORE_RESULTS")," "))}function Sn(e,t){1&e&&(D.dc(0,"span"),D.Vc(1),D.qc(2,"translate"),D.cc()),2&e&&(D.Lb(1),D.Wc(D.rc(2,1,"COLLECT.NO_MORE_RESULTS")))}function _n(e,t){if(1&e){var i=D.ec();D.dc(0,"div",10),D.dc(1,"div",11),D.dc(2,"div",12),D.Tc(3,Qr,4,4,"button",13),D.cc(),D.cc(),D.dc(4,"div",14),D.dc(5,"div",15),D.Yb(6,"app-title-and-description-criteria-search-collect"),D.cc(),D.dc(7,"div",16),D.dc(8,"button",17),D.lc("click",(function(){return D.Kc(i),D.pc().submit()})),D.Vc(9),D.qc(10,"translate"),D.cc(),D.cc(),D.dc(11,"div",18),D.dc(12,"vitamui-common-menu-button",19),D.qc(13,"translate"),D.dc(14,"button",20),D.lc("click",(function(){return D.Kc(i),D.pc().openUpdateUnitsForm()})),D.Vc(15),D.qc(16,"translate"),D.cc(),D.dc(17,"button",20),D.lc("click",(function(){return D.Kc(i),D.pc().validateTransaction()})),D.qc(18,"async"),D.Vc(19),D.qc(20,"translate"),D.cc(),D.dc(21,"button",20),D.lc("click",(function(){return D.Kc(i),D.pc().sendTransaction()})),D.qc(22,"async"),D.Vc(23),D.qc(24,"translate"),D.cc(),D.cc(),D.cc(),D.cc(),D.dc(25,"div",14),D.dc(26,"div",21),D.dc(27,"div",22),D.Tc(28,en,2,1,"ng-container",23),D.cc(),D.cc(),D.dc(29,"div",24),D.dc(30,"div",25),D.dc(31,"button",26),D.dc(32,"button",27),D.dc(33,"i",28),D.Vc(34,"save"),D.cc(),D.cc(),D.cc(),D.dc(35,"mat-menu",29,30),D.dc(37,"button",31),D.lc("click",(function(){return D.Kc(i),D.pc().mapSearchCriteriaHistory()})),D.dc(38,"i",32),D.Vc(39,"add"),D.cc(),D.Vc(40),D.qc(41,"translate"),D.cc(),D.dc(42,"app-search-criteria-list",33),D.lc("storedSearchCriteriaHistory",(function(e){return D.Kc(i),D.pc().showStoredSearchCriteria(e)})),D.cc(),D.cc(),D.Tc(43,tn,5,0,"div",34),D.cc(),D.cc(),D.cc(),D.Tc(44,an,2,0,"div",35),D.Tc(45,rn,3,12,"div",36),D.Tc(46,ln,3,2,"div",35),D.dc(47,"div",37),D.dc(48,"mat-tab-group",38),D.lc("selectedIndexChange",(function(e){return D.Kc(i),D.pc().selectedCategoryChange(e)})),D.dc(49,"mat-tab",39),D.qc(50,"translate"),D.dc(51,"div",40),D.Yb(52,"app-simple-criteria-search"),D.cc(),D.cc(),D.Tc(53,En,12,5,"mat-tab",23),D.dc(54,"mat-tab",41),D.Tc(55,Rn,4,4,"ng-template",42),D.cc(),D.dc(56,"mat-menu",29,43),D.dc(58,"button",31),D.lc("click",(function(){return D.Kc(i),D.pc().addCriteriaCategory("STORAGE_RULE")})),D.Vc(59),D.qc(60,"translate"),D.cc(),D.dc(61,"button",31),D.lc("click",(function(){return D.Kc(i),D.pc().addCriteriaCategory("APPRAISAL_RULE")})),D.Vc(62),D.qc(63,"translate"),D.cc(),D.dc(64,"button",31),D.lc("click",(function(){return D.Kc(i),D.pc().addCriteriaCategory("GEL")})),D.Vc(65),D.qc(66,"translate"),D.cc(),D.dc(67,"button",31),D.lc("click",(function(){return D.Kc(i),D.pc().addCriteriaCategory("ACCESS_RULE")})),D.Vc(68),D.qc(69,"translate"),D.cc(),D.dc(70,"button",31),D.lc("click",(function(){return D.Kc(i),D.pc().addCriteriaCategory("DISSEMINATION_RULE")})),D.Vc(71),D.qc(72,"translate"),D.cc(),D.dc(73,"button",31),D.lc("click",(function(){return D.Kc(i),D.pc().addCriteriaCategory("REUSE_RULE")})),D.Vc(74),D.qc(75,"translate"),D.cc(),D.dc(76,"button",31),D.lc("click",(function(){return D.Kc(i),D.pc().addCriteriaCategory("CLASSIFICATION")})),D.Vc(77),D.qc(78,"translate"),D.cc(),D.cc(),D.cc(),D.cc(),D.Tc(79,pn,4,3,"div",44),D.dc(80,"div",45),D.lc("vitamuiScroll",(function(){return D.Kc(i),D.pc().loadMore()})),D.dc(81,"div",46),D.dc(82,"div",47),D.dc(83,"vitamui-common-archive-unit-count",48),D.lc("archiveUnitCountChange",(function(e){return D.Kc(i),D.pc().onArchiveUnitCountChange(e)}))("selectedArchiveUnitCountChange",(function(e){return D.Kc(i),D.pc().itemSelected=e}))("pendingChange",(function(e){return D.Kc(i),D.pc().pending=e})),D.cc(),D.Yb(84,"div",24),D.dc(85,"div",49),D.dc(86,"i",50),D.lc("click",(function(){return D.Kc(i),D.pc().exportArchiveUnitsToCsvFile()})),D.cc(),D.cc(),D.cc(),D.dc(87,"div",47),D.dc(88,"div",51),D.dc(89,"input",52),D.lc("change",(function(e){return D.Kc(i),D.pc().checkParentBoxChange(e)})),D.cc(),D.cc(),D.dc(90,"div",51),D.dc(91,"span"),D.Vc(92),D.qc(93,"translate"),D.cc(),D.dc(94,"vitamui-common-order-by-button",53),D.lc("orderByChange",(function(e){return D.Kc(i),D.pc().orderBy=e}))("directionChange",(function(e){return D.Kc(i),D.pc().direction=e}))("orderChange",(function(){return D.Kc(i),D.pc().emitOrderChange()})),D.cc(),D.cc(),D.dc(95,"div",54),D.dc(96,"span"),D.Vc(97),D.qc(98,"translate"),D.Yb(99,"br"),D.Vc(100),D.qc(101,"translate"),D.cc(),D.dc(102,"vitamui-common-order-by-button",55),D.lc("orderByChange",(function(e){return D.Kc(i),D.pc().orderBy=e}))("directionChange",(function(e){return D.Kc(i),D.pc().direction=e}))("orderChange",(function(){return D.Kc(i),D.pc().emitOrderChange()})),D.cc(),D.cc(),D.dc(103,"div",56),D.dc(104,"span"),D.Vc(105),D.qc(106,"translate"),D.cc(),D.dc(107,"vitamui-common-order-by-button",57),D.lc("orderByChange",(function(e){return D.Kc(i),D.pc().orderBy=e}))("directionChange",(function(e){return D.Kc(i),D.pc().direction=e}))("orderChange",(function(){return D.Kc(i),D.pc().emitOrderChange()})),D.cc(),D.cc(),D.dc(108,"div",56),D.dc(109,"span"),D.Vc(110),D.qc(111,"translate"),D.cc(),D.dc(112,"vitamui-common-order-by-button",58),D.lc("orderByChange",(function(e){return D.Kc(i),D.pc().orderBy=e}))("directionChange",(function(e){return D.Kc(i),D.pc().direction=e}))("orderChange",(function(){return D.Kc(i),D.pc().emitOrderChange()})),D.cc(),D.cc(),D.dc(113,"div",56),D.dc(114,"span"),D.Vc(115),D.qc(116,"translate"),D.cc(),D.dc(117,"vitamui-common-order-by-button",59),D.lc("orderByChange",(function(e){return D.Kc(i),D.pc().orderBy=e}))("directionChange",(function(e){return D.Kc(i),D.pc().direction=e}))("orderChange",(function(){return D.Kc(i),D.pc().emitOrderChange()})),D.cc(),D.cc(),D.cc(),D.dc(118,"div",60),D.Tc(119,bn,28,33,"div",61),D.cc(),D.dc(120,"div",62),D.Tc(121,mn,1,0,"mat-spinner",63),D.Tc(122,An,3,3,"button",64),D.Tc(123,Sn,3,3,"span",65),D.cc(),D.cc(),D.cc(),D.cc()}if(2&e){var a=D.Gc(36),c=D.pc();D.Lb(3),D.vc("ngIf",!c.show),D.Lb(5),D.vc("disabled",!(c.searchCriteriaKeys&&0!==c.searchCriteriaKeys.length)),D.Lb(1),D.Xc(" ",D.rc(10,69,"COLLECT.LAUNCH_SEARCH_ACTION")," "),D.Lb(3),D.wc("matTooltip",D.rc(13,71,"COLLECT.OTHER_ACTION")),D.vc("overlayPos","end")("icon","vitamui-icon-more-horiz"),D.Lb(2),D.vc("disabled",c.updateUnitsMetadataDisabled()||c.isArchiveUnitsEmpty()),D.Lb(1),D.Xc(" ",D.rc(16,73,"COLLECT.UPDATE_UNITS_METADATA.ACTION_UPDATE")," "),D.Lb(2),D.vc("disabled",c.isArchiveUnitsEmpty()||D.rc(18,75,c.isNotOpen$)),D.Lb(2),D.Xc(" ",D.rc(20,77,"COLLECT.VALIDATE_ACTION")," "),D.Lb(2),D.vc("disabled",D.rc(22,79,c.isNotReady$)),D.Lb(2),D.Xc(" ",D.rc(24,81,"COLLECT.INGEST_ACTION")," "),D.Lb(5),D.vc("ngForOf",c.searchCriteriaKeys),D.Lb(3),D.vc("matMenuTriggerFor",a),D.Lb(6),D.vc("disabled",!c.searchCriterias||0===c.searchCriterias.size),D.Lb(3),D.Xc(" ",D.rc(41,83,"COLLECT.SEARCH_CRITERIA_SAVER.NEW_SAVE_MENU")," "),D.Lb(3),D.vc("ngIf",c.searchCriterias&&c.searchCriterias.size>0),D.Lb(1),D.vc("ngIf",c.pendingComputeFacets),D.Lb(1),D.vc("ngIf",!c.pendingComputeFacets&&c.submited&&c.rulesFacetsComputed&&c.showingFacets),D.Lb(1),D.vc("ngIf",!c.pending),D.Lb(1),D.vc("hidden",!c.showCriteriaPanel),D.Lb(1),D.vc("selectedIndex",c.additionalSearchCriteriaCategoryIndex),D.Lb(1),D.wc("label",D.rc(50,85,"COLLECT.SEARCH_CRITERIA_FILTER.TITLE")),D.Lb(4),D.vc("ngForOf",c.additionalSearchCriteriaCategories),D.Lb(5),D.vc("disabled",c.isCategoryAdded("STORAGE_RULE")),D.Lb(1),D.Xc(" ",D.rc(60,87,"COLLECT.CRITERIA_CATEGORY_SHORT_NAME.STORAGE_RULE")," "),D.Lb(2),D.vc("disabled",c.isCategoryAdded("APPRAISAL_RULE")),D.Lb(1),D.Xc(" ",D.rc(63,89,"COLLECT.CRITERIA_CATEGORY_SHORT_NAME.APPRAISAL_RULE")," "),D.Lb(2),D.vc("disabled",c.isCategoryAdded("GEL")||!0),D.Lb(1),D.Xc(" ",D.rc(66,91,"COLLECT.CRITERIA_CATEGORY_SHORT_NAME.GEL")," "),D.Lb(2),D.vc("disabled",c.isCategoryAdded("ACCESS_RULE")),D.Lb(1),D.Xc(" ",D.rc(69,93,"COLLECT.CRITERIA_CATEGORY_SHORT_NAME.ACCESS_RULE")," "),D.Lb(2),D.vc("disabled",c.isCategoryAdded("DISSEMINATION_RULE")),D.Lb(1),D.Xc(" ",D.rc(72,95,"COLLECT.CRITERIA_CATEGORY_SHORT_NAME.DISSEMINATION_RULE")," "),D.Lb(2),D.vc("disabled",c.isCategoryAdded("REUSE_RULE")),D.Lb(1),D.Xc(" ",D.rc(75,97,"COLLECT.CRITERIA_CATEGORY_SHORT_NAME.REUSE_RULE")," "),D.Lb(2),D.vc("disabled",c.isCategoryAdded("CLASSIFICATION")||!0),D.Lb(1),D.Xc(" ",D.rc(78,99,"COLLECT.CRITERIA_CATEGORY_SHORT_NAME.CLASSIFICATION")," "),D.Lb(2),D.vc("ngIf",c.showCriteriaPanel),D.Lb(4),D.vc("search",c.search$)("archiveUnitCount",c.totalResults)("selectedArchiveUnitCount",c.itemSelected)("threshold",1e4)("pending",c.pending)("allChecked",c.isAllChecked),D.Lb(2),D.vc("ngClass",null!=c.criteriaSearchList&&c.criteriaSearchList.length>0&&c.totalResults>0&&c.itemSelected>0?"enabled-div":"disabled-div"),D.Lb(4),D.vc("checked",c.isAllChecked)("indeterminate",c.isIndeterminate),D.Lb(3),D.Wc(D.rc(93,101,"COLLECT.ARCHIVE_UNIT.FIELDS.TYPE")),D.Lb(2),D.vc("orderBy",c.orderBy)("direction",c.direction),D.Lb(3),D.Xc("",D.rc(98,103,"COLLECT.ARCHIVE_UNIT.FIELDS.NAME")," "),D.Lb(3),D.Wc(D.rc(101,105,"COLLECT.ARCHIVE_UNIT.FIELDS.DESCRIPTION")),D.Lb(2),D.vc("orderBy",c.orderBy)("direction",c.direction),D.Lb(3),D.Xc("",D.rc(106,107,"COLLECT.ARCHIVE_UNIT.FIELDS.START_DATE")," "),D.Lb(2),D.vc("orderBy",c.orderBy)("direction",c.direction),D.Lb(3),D.Xc("",D.rc(111,109,"COLLECT.ARCHIVE_UNIT.FIELDS.END_DATE")," "),D.Lb(2),D.vc("orderBy",c.orderBy)("direction",c.direction),D.Lb(3),D.Wc(D.rc(116,111,"COLLECT.ARCHIVE_UNIT.FIELDS.SP")),D.Lb(2),D.vc("orderBy",c.orderBy)("direction",c.direction),D.Lb(2),D.vc("ngForOf",c.archiveUnits)("ngForTrackBy",c.trackBy),D.Lb(2),D.vc("ngIf",c.pending),D.Lb(1),D.vc("ngIf",!c.pending&&c.canLoadMore),D.Lb(1),D.vc("ngIf",!c.pending&&!c.canLoadMore)}}var On,yn,Nn,Fn,Dn=((On=function(e){function t(e,i,a,c,n,s,l,u,d,h){var v;return o(this,t),(v=r(this,t,[e,i])).route=e,v.externalParameterService=a,v.translateService=c,v.archiveUnitCollectService=n,v.archiveHelperService=s,v.archiveExchangeDataService=l,v.archiveFacetsService=u,v.snackBar=d,v.dialog=h,v.UnitType=T.kb,v.subscriptions=new L.a,v.foundAccessContract=!1,v.accessContractAllowUpdating=!1,v.hasUpdateDescriptiveUnitMetadataRole=!1,v.isLPExtended=!1,v.show=!0,v.criteriaSearchList=[],v.nbQueryCriteria=0,v.additionalSearchCriteriaCategoryIndex=0,v.included=!1,v.showCriteriaPanel=!0,v.showSearchCriteriaPanel=!1,v.listOfUAIdToInclude=[],v.listOfUAIdToExclude=[],v.listOfUACriteriaSearch=[],v.nodeArray=[],v.pending=!1,v.submited=!1,v.currentPage=0,v.itemSelected=0,v.itemNotSelected=0,v.waitingToGetFixedCount=!1,v.totalResults=0,v.orderBy="Title",v.direction=T.z.ASCENDANT,v.DEFAULT_RESULT_THRESHOLD=1e4,v.searchHasResults=!1,v.pageNumbers=0,v.canLoadMore=!1,v.pendingGetFixedCount=!1,v.pendingComputeFacets=!1,v.archiveSearchResultFacets=new T.i,v.rulesFacetsComputed=!1,v.showingFacets=!1,v.defaultFacetTabIndex=1,v.submitedGetFixedCount=!1,v.rulesFacetsCanBeComputed=!1,v.filterChange=new b.a,v.orderChange=new b.a,v.isNotOpen$=new m.a(!0),v.isNotReady$=new m.a(!0),v.ofStaticAttachementUnit=function(e){return"STATIC_ATTACHEMENT"===e.Title},v.ofDynamicAttachementUnit=function(e){return e.Title.startsWith("DYNAMIC_ATTACHEMENT_")},v.subscriptionSimpleSearchCriteriaAdd=v.archiveExchangeDataService.receiveSimpleSearchCriteriaSubject().subscribe((function(e){e&&v.archiveHelperService.addCriteria(v.searchCriterias,v.searchCriteriaKeys,v.nbQueryCriteria,e.keyElt,e.valueElt,e.labelElt,e.keyTranslated,e.operator,e.category,e.valueTranslated,e.dataType,!1)})),v.subscriptions.add(v.archiveExchangeDataService.getNodes().subscribe((function(e){if(!e.checked)return e.count=null,void v.removeCriteria(e.id===T.Q?T.Q:"NODE",{id:e.id,value:e.id},!1);e.id===T.Q?v.archiveHelperService.addCriteria(v.searchCriterias,v.searchCriteriaKeys,v.nbQueryCriteria,T.Q,{id:T.Q,value:T.Q},e.title,!0,T.v.MISSING,T.Z.FIELDS,!1,T.u.STRING,!1):v.archiveHelperService.addCriteria(v.searchCriterias,v.searchCriteriaKeys,v.nbQueryCriteria,"NODE",{id:e.id,value:e.id},e.title,!0,T.v.EQ,T.Z.NODES,!1,T.u.STRING,!1)}))),v.archiveExchangeDataService.receiveRemoveFromChildSearchCriteriaSubject().subscribe((function(e){e&&(e.valueElt?v.removeCriteria(e.keyElt,e.valueElt,!1):v.removeCriteriaAllValues(e.keyElt,!1))})),v}return s(t,e),d(t,[{key:"ngOnDestroy",value:function(){var e,t,i,a,c,r,n,s,l,o;null===(e=this.accessContractSub)||void 0===e||e.unsubscribe(),null===(t=this.accessContractSubscription)||void 0===t||t.unsubscribe(),null===(i=this.subscriptionSimpleSearchCriteriaAdd)||void 0===i||i.unsubscribe(),null===(a=this.subscriptionFilingHoldingSchemeNodes)||void 0===a||a.unsubscribe(),null===(c=this.subscriptionNodes)||void 0===c||c.unsubscribe(),null===(r=this.errorMessageSub)||void 0===r||r.unsubscribe(),null===(n=this.searchCriteriaChangeSubscription)||void 0===n||n.unsubscribe(),null===(s=this.subscriptions)||void 0===s||s.unsubscribe(),null===(l=this.transactionSubscription)||void 0===l||l.unsubscribe(),null===(o=this.uaMetadataUpdateDialogSub)||void 0===o||o.unsubscribe()}},{key:"ngOnInit",value:function(){var e=this;this.additionalSearchCriteriaCategoryIndex=0,this.additionalSearchCriteriaCategories=[],this.searchCriteriaKeys=[],this.searchCriterias=new Map,this.initializeSelectionParams(),this.addInitialCriteriaValues(),this.transactionSubscription=this.route.params.pipe(Object(S.a)((function(t){e.projectId=t.projectId,e.tenantIdentifier=t.tenantIdentifier})),Object(_.a)((function(t){var i=t.projectId,a=t.transactionId;return a?e.archiveUnitCollectService.getTransactionById(a):e.archiveUnitCollectService.getLastTransactionByProjectId(i)})),Object(S.a)((function(t){e.transaction=t}))).subscribe((function(t){e.fetchUserAccessContractFromExternalParameters(),t?(e.isNotOpen$.next(t.status!==T.ib.OPEN),e.isNotReady$.next(t.status!==T.ib.READY)):(e.isNotOpen$.next(!0),e.isNotReady$.next(!0)),e.submit()})),this.projectName=this.route.snapshot.queryParamMap.get("projectName"),this.subscriptions.add(Object(A.a)(this.orderChange,this.filterChange).pipe(Object(O.a)(400)).subscribe((function(){e.submit()}))),this.subscriptions.add(this.archiveExchangeDataService.getToggle().subscribe((function(t){e.show=t}))),this.hasUpdateUnitDescriptiveMetadataPermission()}},{key:"hasUpdateUnitDescriptiveMetadataPermission",value:function(){var e=this;this.archiveUnitCollectService.hasCollectRole("ROLE_UPDATE_UNIT_DESC_METADATA",Number(this.tenantIdentifier)).subscribe((function(t){e.hasUpdateDescriptiveUnitMetadataRole=t}))}},{key:"addInitialCriteriaValues",value:function(){this.archiveHelperService.addCriteria(this.searchCriterias,this.searchCriteriaKeys,this.nbQueryCriteria,"ALL_ARCHIVE_UNIT_TYPES",{value:"ARCHIVE_UNIT_WITH_OBJECTS",id:"ARCHIVE_UNIT_WITH_OBJECTS"},this.translateService.instant("COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.UNIT_TYPE.ARCHIVE_UNIT_WITH_OBJECTS"),!0,T.v.EQ,T.Z.FIELDS,!1,T.u.STRING,!1),this.archiveHelperService.addCriteria(this.searchCriterias,this.searchCriteriaKeys,this.nbQueryCriteria,"ALL_ARCHIVE_UNIT_TYPES",{value:"ARCHIVE_UNIT_WITHOUT_OBJECTS",id:"ARCHIVE_UNIT_WITHOUT_OBJECTS"},this.translateService.instant("COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.UNIT_TYPE.ARCHIVE_UNIT_WITHOUT_OBJECTS"),!0,T.v.EQ,T.Z.FIELDS,!1,T.u.STRING,!1)}},{key:"initializeSelectionParams",value:function(){this.pending=!0,this.showCriteriaPanel=!1,this.showSearchCriteriaPanel=!1,this.currentPage=0,this.archiveUnits=[],this.criteriaSearchList=[],this.itemSelected=0,this.isIndeterminate=!1,this.itemNotSelected=0,this.isAllChecked=!1}},{key:"fetchUserAccessContractFromExternalParameters",value:function(){var e=this;this.accessContractSub=this.externalParameterService.getUserExternalParameters().subscribe((function(t){var i=t.get(T.E.PARAM_ACCESS_CONTRACT);i&&i.length>0?(e.accessContract=i,e.foundAccessContract=!0,e.fetchVitamAccessContract(),0===e.archiveUnits.length&&e.searchArchiveUnits(!0)):e.errorMessageSub=e.translateService.get("COLLECT.ACCESS_CONTRACT_NOT_FOUND").pipe(Object(y.a)((function(t){e.snackBar.open(t,null,{panelClass:"vitamui-snack-bar",duration:1e4})}))).subscribe()}))}},{key:"fetchVitamAccessContract",value:function(){var e=this;this.accessContractSubscription=this.archiveUnitCollectService.getAccessContractById(this.accessContract).subscribe((function(t){e.accessContractAllowUpdating=t.writingPermission,e.accessContractUpdatingRestrictedDesc=t.writingRestrictedDesc}),(function(t){e.logger.error("AccessContract not found :",t.message);var i=e.translateService.instant("COLLECT.ACCESS_CONTRACT_NOT_FOUND_IN_VITAM");e.snackBar.open(i+": "+e.accessContract,null,{panelClass:"vitamui-snack-bar",duration:1e4})}))}},{key:"submit",value:function(){var e;for(var t in this.submited=!0,this.initializeSelectionParams(),this.archiveHelperService.buildNodesListForQUery(this.searchCriterias,this.criteriaSearchList),this.archiveHelperService.buildFieldsCriteriaListForQUery(this.searchCriterias,this.criteriaSearchList),T.X)this.archiveHelperService.buildManagementRulesCriteriaListForQuery(t,this.searchCriterias,this.criteriaSearchList);this.criteriaSearchList&&this.criteriaSearchList.length>0&&(this.search$=this.archiveUnitCollectService.getTotalTrackHitsByCriteria(this.criteriaSearchList,(null===(e=this.transaction)||void 0===e?void 0:e.id)||null),this.rulesFacetsComputed=!1,this.rulesFacetsCanBeComputed=this.archiveHelperService.checkIfRulesFacetsCanBeComputed(this.searchCriterias),this.searchArchiveUnits(this.rulesFacetsCanBeComputed),this.showingFacets=this.rulesFacetsCanBeComputed)}},{key:"searchArchiveUnits",value:function(e){var t,i=this;e&&(this.pendingComputeFacets=!0,this.showingFacets=!1),this.pending=!0;var a={criteriaList:this.criteriaSearchList,pageNumber:this.currentPage,size:10,sortingCriteria:{criteria:this.orderBy,sorting:this.direction},trackTotalHits:!1,computeFacets:e};this.archiveExchangeDataService.emitSearchCriterias(a),this.archiveUnitCollectService.searchArchiveUnitsByCriteria(a,(null===(t=this.transaction)||void 0===t?void 0:t.id)||null).subscribe((function(t){e&&(i.archiveSearchResultFacets=i.archiveFacetsService.extractRulesFacetsResults(t.facets),i.defaultFacetTabIndex=i.archiveHelperService.findDefaultFacetTabIndex(i.searchCriterias),i.pendingComputeFacets=!1,i.rulesFacetsComputed=!0),0===i.currentPage?(i.archiveUnits=t.results,i.searchHasResults=!Object(N.b)(t.results),i.archiveSearchResultFacets.nodesFacets=i.archiveFacetsService.extractNodesFacetsResults(t.facets),i.totalResults=t.totalResults,i.filterAttachementUnit(),i.archiveExchangeDataService.emitTotalResults(i.totalResults),i.archiveExchangeDataService.emitFacets(i.archiveSearchResultFacets.nodesFacets)):t.results&&t.results.forEach((function(e){return i.archiveUnits.push(e)})),i.pageNumbers=t.pageNumbers,i.waitingToGetFixedCount=i.totalResults===i.DEFAULT_RESULT_THRESHOLD,i.isAllChecked&&(i.itemSelected=i.totalResults-i.itemNotSelected),i.canLoadMore=i.currentPage<i.pageNumbers-1,i.archiveHelperService.updateCriteriaStatus(i.searchCriterias,T.Y.IN_PROGRESS,T.Y.INCLUDED),i.pending=!1,i.included=!0}),(function(t){i.logger.error("Error message :",t.message),i.canLoadMore=!1,i.pending=!1,e&&(i.pendingComputeFacets=!1,i.archiveExchangeDataService.emitFacets([]))}))}},{key:"filterAttachementUnit",value:function(){var e=this.archiveUnits.findIndex(this.ofStaticAttachementUnit);e>-1&&(this.archiveUnits.splice(e,1),this.totalResults-=1),(e=this.archiveUnits.findIndex(this.ofDynamicAttachementUnit))>-1&&(this.archiveUnits.splice(e,1),this.totalResults-=1)}},{key:"onArchiveUnitCountChange",value:function(e){this.totalResults=e,this.archiveExchangeDataService.emitTotalResults(e)}},{key:"showExtendedLateralPanel",value:function(){this.isLPExtended=!0}},{key:"backToNormalLateralPanel",value:function(){this.isLPExtended=!1}},{key:"emitOrderChange",value:function(){this.orderChange.next()}},{key:"showPreviewArchiveUnit",value:function(e){this.openPanel(e)}},{key:"checkParentBoxChange",value:function(e){var t=e.target.checked;this.isAllChecked=t,this.itemSelected=t?this.totalResults:0,t||(this.isIndeterminate=!1),this.listOfUAIdToInclude=[],this.listOfUAIdToExclude=[],this.listOfUACriteriaSearch=[]}},{key:"checkChildrenBoxChange",value:function(e,t){var i=t.target.checked;this.isAllChecked&&!i?(this.listOfUACriteriaSearch=[],this.isIndeterminate=!0,this.listOfUAIdToExclude.push({value:e,id:e}),this.listOfUAIdToInclude=[],this.itemSelected>0&&(this.itemSelected--,this.itemNotSelected++)):(this.itemNotSelected=0,i?(this.listOfUACriteriaSearch=[],this.itemSelected++,this.itemSelected===this.totalResults&&(this.isIndeterminate=!1),this.listOfUAIdToInclude.push({value:e,id:e}),this.listOfUAIdToExclude.splice(0,this.listOfUAIdToExclude.length)):(this.listOfUAIdToInclude=this.listOfUAIdToInclude.filter((function(t){return t.id!==e})),this.itemSelected>0&&this.itemSelected--))}},{key:"removeCriteriaEvent",value:function(e){e.valueElt?this.removeCriteria(e.keyElt,e.valueElt,!0):this.removeCriteriaAllValues(e.keyElt,!0)}},{key:"removeCriteriaAllValues",value:function(e,t){var i=this;this.searchCriterias&&this.searchCriterias.size>0&&this.searchCriterias.forEach((function(a,c){c===e&&a.values.forEach((function(e){i.removeCriteria(c,e.value,t)}))}))}},{key:"removeCriteria",value:function(e,t,i){this.archiveHelperService.removeCriteria(e,t,i,this.searchCriteriaKeys,this.searchCriterias,this.nbQueryCriteria),this.searchCriterias&&0===this.searchCriterias.size&&(this.submited=!1,this.showCriteriaPanel=!0,this.showSearchCriteriaPanel=!1,this.searchCriteriaKeys=[],this.searchCriterias=new Map,this.criteriaSearchList=[],this.searchArchiveUnits(!1),this.archiveExchangeDataService.emitNodeTarget(null))}},{key:"clearCriterias",value:function(){var e=this;Object.assign([],this.searchCriteriaKeys).forEach((function(t){e.searchCriterias.has(t)&&e.searchCriterias.get(t).values.forEach((function(i){e.removeCriteria(t,i.value,!0)}))})),this.searchCriterias=new Map,this.searchCriteriaKeys=[],this.included=!1,this.nbQueryCriteria=0,this.pageNumbers=0,this.totalResults=0,this.itemSelected=0,this.isAllChecked=!1,this.isIndeterminate=!1,this.itemNotSelected=0,this.canLoadMore=!1}},{key:"setFilingHoldingScheme",value:function(){var e=this;this.subscriptionFilingHoldingSchemeNodes=this.archiveExchangeDataService.getFilingHoldingNodes().subscribe((function(t){e.nodeArray=t}))}},{key:"checkAllNodes",value:function(e){this.archiveHelperService.recursiveCheck(this.nodeArray,e)}},{key:"selectedCategoryChange",value:function(e){this.additionalSearchCriteriaCategoryIndex=e}},{key:"hiddenTreeBlock",value:function(e){this.show=!e}},{key:"addCriteriaCategory",value:function(e){this.archiveExchangeDataService.emitRuleCategory(e),-1===this.additionalSearchCriteriaCategories.findIndex((function(t){return t.name===e}))&&(this.additionalSearchCriteriaCategories.push({name:e,index:this.additionalSearchCriteriaCategories.length+1}),this.additionalSearchCriteriaCategories.forEach((function(e,t){e.index=t+1})),this.additionalSearchCriteriaCategoryIndex=this.additionalSearchCriteriaCategories.length)}},{key:"sendRuleCategorySelected",value:function(e){this.archiveExchangeDataService.emitRuleCategory(e)}},{key:"isCategoryAdded",value:function(e){return-1!==this.additionalSearchCriteriaCategories.findIndex((function(t){return t.name===e}))}},{key:"removeCriteriaCategory",value:function(e){var t=this;this.additionalSearchCriteriaCategories.forEach((function(i,a){i.name===e&&(t.additionalSearchCriteriaCategories.splice(a,1),a===t.additionalSearchCriteriaCategoryIndex-1?t.additionalSearchCriteriaCategoryIndex=0:t.additionalSearchCriteriaCategoryIndex>0&&(t.additionalSearchCriteriaCategoryIndex=t.additionalSearchCriteriaCategoryIndex-1))})),this.additionalSearchCriteriaCategories.forEach((function(e,t){e.index=t+1})),this.removeCriteriaByCategory(e)}},{key:"removeCriteriaByCategory",value:function(e){var t=this;this.searchCriterias&&this.searchCriterias.size>0&&(e===T.Z.APPRAISAL_RULE&&this.searchCriterias.forEach((function(e,i){"ELIMINATION_TECHNICAL_ID"===i&&e.values.forEach((function(e){t.removeCriteria(i,e.value,!0)}))})),this.searchCriterias.forEach((function(i,a){T.Z[i.category]===e&&i.values.forEach((function(e){t.removeCriteria(a,e.value,!0)}))})))}},{key:"showHidePanel",value:function(e){this.showCriteriaPanel=e}},{key:"containsWaitingToRecalculateInheritenceRuleCriteria",value:function(){return this.searchCriterias&&this.searchCriterias.has("WAITING_RECALCULATE")}},{key:"mapSearchCriteriaHistory",value:function(){var e,t=[];this.searchCriterias.forEach((function(e){var i=[];e.values.forEach((function(e){i.push(e.value)})),t.push({criteria:e.key,values:i,category:T.Z[e.category],operator:e.operator,keyTranslated:e.keyTranslated,valueTranslated:e.valueTranslated,dataType:e.dataType})})),e={id:null,name:"",savingDate:(new Date).toISOString(),searchCriteriaList:t},this.openCriteriaPopup(e)}},{key:"openCriteriaPopup",value:function(e){var t=new v.e;t.panelClass="vitamui-modal",t.disableClose=!1,t.data={searchCriteriaHistory:e,originalSearchCriteria:this.searchCriterias,nbCriterias:this.archiveExchangeDataService.nbFilters(e)},this.dialog.open(He,t).afterClosed().subscribe((function(e){}))}},{key:"launchComputingManagementRulesFacets",value:function(){var e=this;this.pendingComputeFacets=!0;var t={criteriaList:this.criteriaSearchList,pageNumber:0,size:1,sortingCriteria:{criteria:this.orderBy,sorting:this.direction},trackTotalHits:!1,computeFacets:!0};this.loadExactCount(),this.archiveUnitCollectService.searchArchiveUnitsByCriteria(t,this.transaction?this.transaction.id:null).subscribe((function(t){e.archiveSearchResultFacets=e.archiveFacetsService.extractRulesFacetsResults(t.facets),e.pendingComputeFacets=!1,e.rulesFacetsComputed=!0,e.showingFacets=!0,e.defaultFacetTabIndex=e.archiveHelperService.findDefaultFacetTabIndex(e.searchCriterias)}),(function(t){e.pendingComputeFacets=!1,e.logger.error("Error message :",t.message)}))}},{key:"loadExactCount",value:function(){var e,t=this;this.criteriaSearchList&&this.criteriaSearchList.length>0&&(this.pendingGetFixedCount=!0,this.submitedGetFixedCount=!0,this.archiveUnitCollectService.getTotalTrackHitsByCriteria(this.criteriaSearchList,(null===(e=null==this?void 0:this.transaction)||void 0===e?void 0:e.id)||null).subscribe((function(e){-1!==e&&(t.totalResults=e,t.isAllChecked&&(t.itemSelected=t.totalResults-t.itemNotSelected),t.waitingToGetFixedCount=!1),t.pendingGetFixedCount=!1}),(function(e){t.pendingGetFixedCount=!1,t.logger.error("Error message :",e.message)})))}},{key:"loadMore",value:function(){this.pending||(this.canLoadMore=this.currentPage<this.pageNumbers-1,this.canLoadMore&&(this.submited=!0,this.currentPage=this.currentPage+1,this.hasSearchCriterias()&&this.searchArchiveUnits(!1)))}},{key:"hasSearchCriterias",value:function(){return this.criteriaSearchList&&this.criteriaSearchList.length>0||this.totalResults>=10}},{key:"showHideFacets",value:function(e){!0===e?!0===this.rulesFacetsComputed?this.showingFacets=!0:this.launchFacetsComputing():this.showingFacets=!1}},{key:"launchFacetsComputing",value:function(){!this.pendingComputeFacets&&this.criteriaSearchList&&this.criteriaSearchList.length>0&&this.launchComputingManagementRulesFacets()}},{key:"showStoredSearchCriteria",value:function(e){this.searchCriterias.size>0&&(this.searchCriterias=new Map,this.searchCriteriaKeys=[],this.included=!1),this.reMapSearchCriteriaFromSearchCriteriaHistory(e)}},{key:"reMapSearchCriteriaFromSearchCriteriaHistory",value:function(e){var t=this;e.searchCriteriaList.forEach((function(e){t.fillTreeNodeAsSearchCriteriaHistory(e);var i=e.criteria;e.values.forEach((function(a){e.category===T.Z[T.Z.APPRAISAL_RULE]||e.category===T.Z[T.Z.NODES]||e.category===T.Z[T.Z.ACCESS_RULE]||e.category===T.Z[T.Z.STORAGE_RULE]||e.category===T.Z[T.Z.REUSE_RULE]||e.category===T.Z[T.Z.DISSEMINATION_RULE]?(t.addCriteriaCategory(e.category),t.archiveHelperService.addCriteria(t.searchCriterias,t.searchCriteriaKeys,t.nbQueryCriteria,i,a,a.value,e.keyTranslated,e.operator,e.category,e.valueTranslated,e.dataType,!0)):e.category===T.Z[T.Z.FIELDS]&&t.archiveHelperService.addCriteria(t.searchCriterias,t.searchCriteriaKeys,t.nbQueryCriteria,i,a,"ALL_ARCHIVE_UNIT_TYPES"===i?t.translateService.instant("COLLECT.SEARCH_CRITERIA_FILTER.FIELDS.UNIT_TYPE."+a.id):a.value,e.keyTranslated,e.operator,T.Z.FIELDS,e.valueTranslated,e.dataType,!0)}))}))}},{key:"fillTreeNodeAsSearchCriteriaHistory",value:function(e){var t=this;e&&e.category===T.Z[T.Z.NODES]&&(e.values.forEach((function(e){t.archiveHelperService.fillNodeTitle(t.nodeArray,e.value,t.searchCriterias,t.searchCriteriaKeys,t.nbQueryCriteria)})),this.nodeArray=null,this.archiveExchangeDataService.emitToggle(!0))}},{key:"exportArchiveUnitsToCsvFile",value:function(){this.criteriaSearchList&&this.criteriaSearchList.length>0&&(this.listOfUACriteriaSearch=this.prepareListOfUACriteriaSearch(),this.archiveUnitCollectService.exportCsvSearchArchiveUnitsByCriteria({criteriaList:this.listOfUACriteriaSearch,pageNumber:this.currentPage,size:10,sortingCriteria:{criteria:this.orderBy,sorting:this.direction},language:this.translateService.currentLang},this.transaction.id))}},{key:"prepareListOfUACriteriaSearch",value:function(){return this.archiveHelperService.prepareUAIdList(this.criteriaSearchList,this.listOfUAIdToInclude,this.listOfUAIdToExclude,this.isAllChecked,this.isIndeterminate)}},{key:"validateTransaction",value:function(){var e=this;this.archiveUnitCollectService.validateTransaction(this.transaction.id).subscribe((function(){e.isNotOpen$.next(!0),e.isNotReady$.next(!1);var t=e.translateService.instant("COLLECT.VALIDATE_TRANSACTION_VALIDATED");e.snackBar.open(t,null,{panelClass:"vitamui-snack-bar",duration:1e4})}))}},{key:"sendTransaction",value:function(){var e=this;this.archiveUnitCollectService.sendTransaction(this.transaction.id).subscribe((function(){e.isNotReady$.next(!0);var t=e.translateService.instant("COLLECT.INGEST_TRANSACTION_LAUNCHED");e.snackBar.open(t,null,{panelClass:"vitamui-snack-bar",duration:1e4})}))}},{key:"openUpdateUnitsForm",value:function(){var e=this.dialog.open(it,{panelClass:"vitamui-modal",disableClose:!0,data:{selectedTransaction:this.transaction,tenantIdentifier:this.tenantIdentifier}});this.uaMetadataUpdateDialogSub=e.afterClosed().subscribe((function(e){}))}},{key:"updateUnitsMetadataDisabled",value:function(){return!this.transaction||this.transaction.status!==T.ib.OPEN}},{key:"isArchiveUnitsEmpty",value:function(){return 0===this.archiveUnits.length}},{key:"getArchiveUnitType",value:function(e){if(e)return e["#unitType"]}},{key:"trackBy",value:function(e,t){return t["#id"]}}]),t}(T.cb)).\u0275fac=function(e){return new(e||On)(D.Xb(g.a),D.Xb(T.J),D.Xb(T.F),D.Xb(P.e),D.Xb(re),D.Xb(Be),D.Xb(Le),D.Xb(qe),D.Xb(k.b),D.Xb(v.b))},On.\u0275cmp=D.Rb({type:On,selectors:[["app-archive-search-collect"]],features:[D.Ib],decls:11,vars:11,consts:[[3,"autosize","hasBackdrop"],["mode","side","vitamuiCommonResizeSidebar","left",3,"fixedInViewport","opened",4,"ngIf"],["mode","side","position","end",3,"ngClass","fixedInViewport"],["panel",""],[3,"archiveUnit","accessContractAllowUpdating","hasUpdateDescriptiveUnitMetadataRole","transactionId","previewClose","showExtendedLateralPanel","backToNormalLateralPanel",4,"ngIf"],[1,"vitamui-heading"],["class","vitamui-content",4,"ngIf"],["mode","side","vitamuiCommonResizeSidebar","left",3,"fixedInViewport","opened"],[3,"transactionId","searchHasMatches","searchRequestTotalResults","showArchiveUnitDetails"],[3,"archiveUnit","accessContractAllowUpdating","hasUpdateDescriptiveUnitMetadataRole","transactionId","previewClose","showExtendedLateralPanel","backToNormalLateralPanel"],[1,"vitamui-content"],[1,"row","row","justify-content-around"],[1,"col-12"],["type","button","class","btn secondary right-arround left-not-arround","matTooltipClass","vitamui-tooltip",3,"matTooltip","matTooltipShowDelay","click",4,"ngIf"],[1,"row","justify-content-around"],[1,"col-6","form-control"],[1,"col-3","form-control","text-right"],["type","button",1,"btn","primary",3,"disabled","click"],[1,"col-1","form-control"],["matTooltipClass","vitamui-tooltip",3,"overlayPos","icon","matTooltip"],["mat-menu-item","",3,"disabled","click"],[1,"col-11"],[1,"area-criteria"],[4,"ngFor","ngForOf"],[1,"col-1"],[1,"d-flex","justify-content-end","button-space"],[1,"mat-boutton",3,"matMenuTriggerFor"],["type","button",1,"circle","editable-field-cancel","clickable"],[1,"material-icons","primary-save-icon"],[1,"my-menu"],["menu","matMenu"],["mat-menu-item","",1,"btn-new-save",3,"disabled","click"],[1,"material-icons","btn-add"],[3,"storedSearchCriteriaHistory"],["class","d-flex justify-content-end div-btn-delete",4,"ngIf"],["class","row",4,"ngIf"],["class","card-criteria",4,"ngIf"],[3,"hidden"],[3,"selectedIndex","selectedIndexChange"],[3,"label"],[1,"card-criteria"],["disabled",""],["mat-tab-label",""],["menuTabs","matMenu"],["class","row justify-content-end text-on-right-side",4,"ngIf"],["vitamuiCommonInfiniteScroll","",3,"vitamuiScroll"],[1,"vitamui-table"],[1,"vitamui-table-head"],[1,"col-8",3,"search","archiveUnitCount","selectedArchiveUnitCount","threshold","pending","allChecked","archiveUnitCountChange","selectedArchiveUnitCountChange","pendingChange"],[1,"col-3","area-download",3,"ngClass"],[1,"vitamui-icon","vitamui-icon-import-csv","vitamui-row-icon","clickable",3,"click"],[1,"col-1","d-flex","align-items-center"],["type","checkbox",1,"criteria-choice-input",3,"checked","indeterminate","change"],["orderByKey","DescriptionLevel",3,"orderBy","direction","orderByChange","directionChange","orderChange"],[1,"col-4","d-flex","align-items-center"],["orderByKey","Title",3,"orderBy","direction","orderByChange","directionChange","orderChange"],[1,"col-2","d-flex","align-items-center"],["orderByKey","StartDate",3,"orderBy","direction","orderByChange","directionChange","orderChange"],["orderByKey","EndDate",3,"orderBy","direction","orderByChange","directionChange","orderChange"],["orderByKey","#originating_agencies",3,"orderBy","direction","orderByChange","directionChange","orderChange"],[1,"vitamui-table-body"],["class","vitamui-table-rows",4,"ngFor","ngForOf","ngForTrackBy"],[1,"vitamui-table-footer"],["diameter","50","color","accent",4,"ngIf"],["class","btn",3,"click",4,"ngIf"],[4,"ngIf"],["type","button","matTooltipClass","vitamui-tooltip",1,"btn","secondary","right-arround","left-not-arround",3,"matTooltip","matTooltipShowDelay","click"],[1,"material-icons"],[3,"criteriaKey","criteriaVal","criteriaRemoveEvent"],[1,"d-flex","justify-content-end","div-btn-delete"],[1,"mat-boutton"],["type","button",1,"circle","editable-field-cancel","clickable",3,"click"],[1,"row"],["diameter","20","color","accent",1,"spinner-wrapper"],["id","show-hide-facet-button","class","vitamui-icon vitamui-icon-chevron-down vitamui-row-icon clickable",3,"ngClass","click",4,"ngIf"],[1,"facet-div",3,"exactCount","appraisalRuleFacets","accessRuleFacets","storageRuleFacets","reuseRuleFacets","disseminationRuleFacets","holdRuleFacets","classificationRuleFacets","tenantIdentifier","totalResults","defaultFacetTabIndex"],["id","show-hide-facet-button",1,"vitamui-icon","vitamui-icon-chevron-down","vitamui-row-icon","clickable",3,"ngClass","click"],["class","hide-ink",3,"click",4,"ngIf"],[1,"hide-ink",3,"click"],[3,"click"],[1,"mat-boutton","clickable",3,"click"],[1,"vitamui-icon","vitamui-icon-cross","vitamui-row-icon"],[1,"row","justify-content-end","text-on-right-side"],[3,"hasWaitingToRecalculateCriteria"],[1,"mat-boutton","clickable",3,"matMenuTriggerFor"],[1,"vitamui-icon","vitamui-icon-plus","vitamui-row-icon"],[1,"vitamui-table-rows"],[1,"vitamui-row","d-flex","align-items-center"],["type","checkbox",1,"criteria-choice-input",3,"checked","click"],[1,"col-1","d-flex","align-items-center","clickable",3,"click"],[1,"table-filter-icon",3,"ngSwitch"],[4,"ngSwitchCase"],[1,"col-4","d-flex","align-items-center","clickable",3,"click"],["matTooltipClass","vitamui-tooltip",3,"matTooltip","matTooltipShowDelay"],[1,"col-2","d-flex","align-items-center","clickable",3,"click"],[1,"table-filter-icon"],[1,"vitamui-icon","vitamui-icon-folder","vitamui-row-icon","status-badge"],[1,"vitamui-icon","vitamui-icon-file","vitamui-row-icon","status-badge"],[1,"vitamui-icon","vitamui-icon-ic24-arborescence","vitamui-row-icon","status-badge"],[1,"vitamui-icon","vitamui-icon-plan-classement","vitamui-row-icon","status-badge"],["diameter","50","color","accent"],[1,"btn",3,"click"]],template:function(e,t){1&e&&(D.dc(0,"mat-sidenav-container",0),D.Tc(1,Zr,2,5,"mat-sidenav",1),D.dc(2,"mat-sidenav",2,3),D.Tc(4,$r,1,4,"app-archive-preview",4),D.cc(),D.dc(5,"mat-sidenav-content"),D.dc(6,"div",5),D.dc(7,"vitamui-common-title-breadcrumb"),D.Vc(8),D.qc(9,"translate"),D.cc(),D.cc(),D.Tc(10,_n,124,113,"div",6),D.cc(),D.cc()),2&e&&(D.vc("autosize",!0)("hasBackdrop",!1),D.Lb(1),D.vc("ngIf",t.foundAccessContract),D.Lb(1),D.vc("ngClass",t.isLPExtended?"extended-lateral-panel":"normal-lateral-panel")("fixedInViewport",!0),D.Lb(2),D.vc("ngIf",t.openedItem),D.Lb(4),D.Yc(" ",D.rc(9,9,"COLLECT.TITLE_SEARCH_AREA")," : ",t.projectName," "),D.Lb(2),D.vc("ngIf",t.foundAccessContract))},directives:[p.b,l.p,p.a,l.n,p.c,T.Kb,T.Ob,Qt,fa,Ia,T.Eb,me.a,Ae.a,l.o,Ae.c,Ae.d,Oa,f.b,f.a,Ba,f.c,T.K,T.Gb,T.S,_c,E.b,jc,rr,Rr,_r,Mr,zr,l.r,l.s],pipes:[P.d,l.b,T.jb,T.Yb,T.Vb],styles:[".btn-validate[_ngcontent-%COMP%]{background-color:#155724}.text-title[_ngcontent-%COMP%]{font-family:Mulish;font-style:normal;font-weight:400;font-size:16px;line-height:24px;display:flex;align-items:center;color:#757575}.margin-btn[_ngcontent-%COMP%]{margin-right:140px}.facet-area[_ngcontent-%COMP%]{display:block;overflow:auto} .mat-menu-panel{max-width:-moz-fit-content!important;max-width:fit-content!important}.link-without-underline[_ngcontent-%COMP%]{cursor:pointer;color:#702382;font-weight:700;margin-top:10px;margin-bottom:10px}.mat-dialog-actions-right[_ngcontent-%COMP%]{justify-content:flex-end}.red-text[_ngcontent-%COMP%]{color:red;font-size:x-large;font-weight:700}.icon-style[_ngcontent-%COMP%]{font-size:50px;line-height:5px}.vertical-line[_ngcontent-%COMP%]{border-left:2px solid red;display:block;height:100%;margin:0 22px}.disabled-div[_ngcontent-%COMP%]{pointer-events:none}.enabled-div[_ngcontent-%COMP%]{pointer-events:painted}.facet-div[_ngcontent-%COMP%]{width:100%;padding:10px}#show-hide-facet-button[_ngcontent-%COMP%]{position:relative;float:right;cursor:pointer;width:40px;border:1px solid #bdbdbd;box-sizing:border-box;border-radius:20px;padding:10px;font-size:large;font-weight:700}"]}),On),Un=[{path:"",component:Dn},{path:"/{transactionId}",component:Dn}],kn=((Fn=d((function e(){o(this,e)}))).\u0275mod=D.Vb({type:Fn}),Fn.\u0275inj=D.Ub({factory:function(e){return new(e||Fn)},imports:[[l.c,g.g.forChild(Un)],g.g]}),Fn),Pn=((Nn=d((function e(){o(this,e)}))).\u0275mod=D.Vb({type:Nn}),Nn.\u0275inj=D.Ub({factory:function(e){return new(e||Nn)},imports:[[l.c,v.g,T.s,P.c,T.lb]]}),Nn),xn=((yn=d((function e(){o(this,e)}))).\u0275mod=D.Vb({type:yn}),yn.\u0275inj=D.Ub({factory:function(e){return new(e||yn)},imports:[[l.c,kn,p.d,T.lb,E.a,C.d,R.b,u.u,f.d,h.c,v.g,Pn,I.c]]}),yn)},etrl:function(e,t,i){var a,c;void 0===(c="function"==typeof(a=function(){"use strict";function t(e,t,i){var a=new XMLHttpRequest;a.open("GET",e),a.responseType="blob",a.onload=function(){n(a.response,t,i)},a.onerror=function(){console.error("could not download file")},a.send()}function i(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function a(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(t){var i=document.createEvent("MouseEvents");i.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(i)}}var c="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,r=c.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),n=c.saveAs||("object"!=typeof window||window!==c?function(){}:"download"in HTMLAnchorElement.prototype&&!r?function(e,r,n){var s=c.URL||c.webkitURL,l=document.createElement("a");l.download=r=r||e.name||"download",l.rel="noopener","string"==typeof e?(l.href=e,l.origin===location.origin?a(l):i(l.href)?t(e,r,n):a(l,l.target="_blank")):(l.href=s.createObjectURL(e),setTimeout((function(){s.revokeObjectURL(l.href)}),4e4),setTimeout((function(){a(l)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,c,r){if(c=c||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(function(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}(e,r),c);else if(i(e))t(e,c,r);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout((function(){a(n)}))}}:function(e,i,a,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),"string"==typeof e)return t(e,i,a);var s="application/octet-stream"===e.type,l=/constructor/i.test(c.HTMLElement)||c.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||s&&l||r)&&"undefined"!=typeof FileReader){var u=new FileReader;u.onloadend=function(){var e=u.result;e=o?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=e:location=e,n=null},u.readAsDataURL(e)}else{var d=c.URL||c.webkitURL,h=d.createObjectURL(e);n?n.location=h:location.href=h,n=null,setTimeout((function(){d.revokeObjectURL(h)}),4e4)}});c.saveAs=n.saveAs=n,e.exports=n})?a.apply(t,[]):a)||(e.exports=c)}}])}();