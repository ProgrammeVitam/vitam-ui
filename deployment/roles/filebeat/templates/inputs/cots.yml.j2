#jinja2: lstrip_blocks: True
#
# Consul
#
# Disabled by default because of a bug with spring.cloud.consul when calling consul (too many error logs).
{% if filebeat.cots.consul.enable_log | bool %}
- type: filestream
  id: {{ vitam_site_name }}-consul
  enabled: {{ filebeat.cots.consul.enable_log | bool | lower }}
  paths:
    - "{{ vitam_defaults.folder.root_path }}/log/consul/consul*.log"
  fields_under_root: true
  fields:
    kind: log
    vitam_component: consul
    source: vitamui
    type: cots
  processors:
    - dissect:
        tokenizer: '%{date_time} [%{log_level}]  %{logger}: %{log_message}'
        target_prefix: ""
    - drop_fields:
        fields: ["date_time"]
  parsers:
    - multiline:
        type: pattern
        pattern: '^[[:space:]]'
        negate: false
        match: after
{% endif %}
