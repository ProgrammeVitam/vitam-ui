<div class="header">
  <vitamui-common-progress-bar [count]="stepCount" [index]="stepIndex"></vitamui-common-progress-bar>
</div>
<form [formGroup]="form" (ngSubmit)="onSubmit()" (keydown.enter)="$event.preventDefault()">
  <vitamui-common-stepper [selectedIndex]="stepIndex" (selectionChange)="stepIndex = $event.selectedIndex">
    <!-- Step 1 -->
    <cdk-step>
      <div class="content">
        <h5>{{ 'CONTRACT_MANAGEMENT.CONTRACTS_CREATION.CREATION_ACTION' | translate }}</h5>
        <h4>{{ 'CONTRACT_MANAGEMENT.CONTRACTS_CREATION.INFORMATIONS' | translate }}</h4>

        <div class="form-group">
          <div class="row">
            <div class="col">
              <vitamui-common-slide-toggle [formControl]="statusControl">{{
                'CONTRACT_MANAGEMENT.CONTRACTS_CREATION.CONTRACT_STATUS' | translate
              }}</vitamui-common-slide-toggle>
            </div>
          </div>
          <div class="row">
            <div class="col-10 form-control">
              <vitamui-common-input
                formControlName="name"
                minlength="3"
                maxlength="100"
                required
                placeholder="{{ 'CONTRACT_MANAGEMENT.CONTRACTS_CREATION.NAME' | translate }}"
              >
                <ng-container *ngIf="form.get('name')?.touched">
                  <vitamui-common-input-error *ngIf="!!form.get('name')?.errors?.required">{{
                    'CONTRACT_MANAGEMENT.CONTRACTS_CREATION.MANDATORY_FIELD' | translate
                  }}</vitamui-common-input-error>

                  <vitamui-common-input-error *ngIf="!!form?.get('name')?.errors?.nameExists">
                    {{ 'CONTRACT_MANAGEMENT.CONTRACTS_CREATION.NAME_ALREADY_EXIST' | translate }}
                  </vitamui-common-input-error>
                </ng-container>
              </vitamui-common-input>
            </div>

            <div class="col-10 form-control" *ngIf="isSlaveMode">
              <vitamui-common-input
                formControlName="identifier"
                minlength="3"
                maxlength="100"
                required
                placeholder="{{ 'CONTRACT_MANAGEMENT.CONTRACTS_CREATION.IDENTIFIER' | translate }}"
              >
                <ng-container *ngIf="form.get('identifier')?.touched">
                  <vitamui-common-input-error
                    *ngIf="!!form.get('identifier')?.errors?.required"
                    i18n="Required field error hint@@formErrorRequiredField"
                  >
                    {{ 'CONTRACT_MANAGEMENT.CONTRACTS_CREATION.MANDATORY_FIELD' | translate }}
                  </vitamui-common-input-error>
                  <vitamui-common-input-error *ngIf="!!form?.get('identifier')?.errors?.identifierExists">
                    {{ 'CONTRACT_MANAGEMENT.CONTRACTS_CREATION.IDENTIFIER_ALREADY_EXIST' | translate }}
                  </vitamui-common-input-error>
                </ng-container>
              </vitamui-common-input>
            </div>

            <div class="col-12 form-control">
              <vitamui-common-textarea
                formControlName="description"
                placeholder="{{ 'CONTRACT_MANAGEMENT.CONTRACTS_CREATION.DESCRIPTION' | translate }}"
                [rows]="4"
                required="required"
              >
                <ng-container *ngIf="form.get('description')?.touched">
                  <vitamui-common-input-error *ngIf="!!form.get('description')?.errors?.required">
                    {{ 'COMMON.REQUIRED' | translate }}
                  </vitamui-common-input-error>
                </ng-container>
              </vitamui-common-textarea>
            </div>
          </div>
        </div>
        <div class="actions">
          <button type="button" class="btn primary" cdkStepperNext [disabled]="firstStepInvalid()">{{ 'COMMON.NEXT' | translate }}</button>
          <button type="button" class="btn cancel" (click)="onCancel()">{{ 'COMMON.UNDO' | translate }}</button>
        </div>
      </div>
    </cdk-step>
    <!-- Step 2 -->
    <cdk-step>
      <div class="content">
        <h5>{{ 'CONTRACT_MANAGEMENT.CONTRACTS_CREATION.CREATION_ACTION' | translate }}</h5>
        <h4>
          {{ 'CONTRACT_MANAGEMENT.CONTRACTS_CREATION.STORAGE_POLICIES' | translate }}
          <i
            class="vitamui-icon vitamui-icon-info"
            matTooltip=" {{ 'CONTRACT_MANAGEMENT.CONTRACTS_CREATION.STORAGE_POLICIES_TOOLTIP' | translate }}"
            matTooltipClass="vitamui-tooltip"
          ></i>
        </h4>

        <div class="form-group">
          <div class="row">
            <div formGroupName="storage" style="width: 100%">
              <div class="col-12 form-control">
                <vitamui-common-input
                  formControlName="unitStrategy"
                  placeholder="{{ 'CONTRACT_MANAGEMENT.CONTRACTS_CREATION.UNIT_STRATEGY' | translate }}"
                >
                </vitamui-common-input>
              </div>
              <div class="col-12 form-control">
                <vitamui-common-input
                  formControlName="objectGroupStrategy"
                  placeholder=" {{ 'CONTRACT_MANAGEMENT.CONTRACTS_CREATION.OBJECT_GROUP_STRATEGY' | translate }}"
                >
                </vitamui-common-input>
              </div>
              <div class="col-12 form-control">
                <vitamui-common-input
                  formControlName="objectStrategy"
                  placeholder="{{ 'CONTRACT_MANAGEMENT.CONTRACTS_CREATION.OBJECT_STRATEGY' | translate }}"
                >
                </vitamui-common-input>
              </div>
            </div>
          </div>
        </div>
        <div class="actions">
          <button type="button" class="btn primary" cdkStepperPrevious [disabled]="isDisabledButton">
            {{ 'COMMON.BACK' | translate }}
          </button>
          <button type="submit" class="btn primary" [disabled]="secondStepInvalid() || isDisabledButton">
            {{ 'COMMON.SUBMIT' | translate }}
          </button>
          <button type="button" class="btn cancel" [disabled]="isDisabledButton" (click)="onCancel()">
            {{ 'COMMON.UNDO' | translate }}
          </button>
        </div>
      </div>
    </cdk-step>
  </vitamui-common-stepper>
</form>
