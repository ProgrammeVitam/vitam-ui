<table
  class="vitamui-table"
  vitamuiCommonInfiniteScroll
  (vitamuiScroll)="onScroll()"
>
  <thead>
    <tr>
      <th>
        <div class="vitamui-table-header">
          <button
            class="vitamui-filter-button"
            [vitamuiCommonTableFilter]="statusFilterTemplate"
          >
            <i class="material-icons vitamui-row-icon">filter_list</i>
          </button>

          <ng-template #statusFilterTemplate>
            <vitamui-common-table-filter [(filter)]="this.filterMap['status']" (filterChange)="onFilterChange('status', $event)">
              <vitamui-common-table-filter-option value="ENABLED">
                <div class="table-filter-icon" i18n="@@groupStatusEnabled">
                  <i class="vitamui-icon vitamui-icon-user status-badge status-badge-green close"></i>
                  <span class="badge-state">Actif</span>
                </div>
              </vitamui-common-table-filter-option>
              <vitamui-common-table-filter-option value="DISABLED">
                <div class="table-filter-icon" i18n="@@groupStatusDisabled">
                  <i class="vitamui-icon vitamui-icon-user status-badge status-badge-grey close"></i>
                  <span class="badge-state">Désactivé</span>
                </div>
              </vitamui-common-table-filter-option>
            </vitamui-common-table-filter>
          </ng-template>

          <i class="vitamui-icon vitamui-icon-keys vitamui-row-icon"></i>
          <vitamui-common-order-by-button orderByKey="status" [(orderBy)]="orderBy" [(direction)]="direction"
              (orderChange)="emitOrderChange()"></vitamui-common-order-by-button>
        </div>
      </th>
      <th>
        <div class="vitamui-table-header">
          <span i18n="Group name@@profileGroupListHeaderName">Nom du groupe</span>
          <vitamui-common-order-by-button orderByKey="name" [(orderBy)]="orderBy" [(direction)]="direction"
                                          (orderChange)="emitOrderChange()"></vitamui-common-order-by-button>
        </div>
      </th>
      <th>
        <div class="vitamui-table-header">
          <span i18n="Group ID@@profileGroupListHeaderID">Identifiant</span>
          <vitamui-common-order-by-button orderByKey="identifier" [(orderBy)]="orderBy" [(direction)]="direction"
                                          (orderChange)="emitOrderChange()"></vitamui-common-order-by-button>
        </div>
      </th>
      <th>
        <div class="vitamui-table-header">
          <span i18n="Description@@profileGroupListHeaderDescription">Description</span>
          <vitamui-common-order-by-button orderByKey="description" [(orderBy)]="orderBy" [(direction)]="direction"
                                          (orderChange)="emitOrderChange()"></vitamui-common-order-by-button>
        </div>
      </th>
      <th>
        <div class="vitamui-table-header">
          <button class="vitamui-filter-button" [vitamuiCommonTableFilter]="levelFilterTemplate"
                  [class.active]="filterMap['level'] && filterMap['level'].length > 0" #levelFilterTrigger="vitamuiCommonTableFilter">
            <i class="material-icons vitamui-row-icon">filter_list</i>
          </button>

          <ng-template #levelFilterTemplate>
            <vitamui-common-table-filter-search
              [(filter)]="filterMap['level']"
              [options]="levelFilterOptions"
              (filterChange)="onFilterChange('level', $event)"
              (filterClose)="levelFilterTrigger?.close()"
              emptyValueOption="-Niveau vide-"
              i18n-emptyValueOption="@@groupsListLevelFilterEmpty"
            ></vitamui-common-table-filter-search>
          </ng-template>

          <span i18n="Description@@profileGroupListHeaderLevel">Niveau</span>
          <vitamui-common-order-by-button orderByKey="level" [(orderBy)]="orderBy" [(direction)]="direction"
                                          (orderChange)="emitOrderChange()"></vitamui-common-order-by-button>
        </div>
      </th>
    </tr>
  </thead>

  <tbody>
    <tr *ngFor="let group of dataSource" class="clickable" (click)="groupClick.emit(group)">
      <td>
        <i
          class="vitamui-icon vitamui-icon-keys vitamui-row-icon status-badge"
          [class.status-badge-green]="group?.enabled"
          [class.status-badge-red]="!group?.enabled"
        ></i>
      </td>
      <td>{{ group.name }}</td>
      <td>{{ group.identifier }}</td>
      <td>{{ group.description | truncate:50 }}</td>
      <td>{{ group.level }}</td>
    </tr>
  </tbody>

</table>

<div class="vitamui-table-footer">
  <mat-spinner *ngIf="pending" diameter="50" color="accent"></mat-spinner>
  <button *ngIf="!pending && infiniteScrollDisabled && groupService.canLoadMore" (click)="loadMore()" class="btn" i18n="Show more results@@tableMoreResultButton">
    Afficher plus de résultats...
  </button>
  <!-- <span *ngIf="!pending && !profileGroupService.canLoadMore">Fin des résultats</span> -->
</div>
