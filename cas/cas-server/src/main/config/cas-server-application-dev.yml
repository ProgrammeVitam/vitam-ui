spring:
  cloud:
    consul: #disabled for dev
      enabled: false
      discovery:
        enabled: false
        register: false


server:
  ssl:
    #client-auth: want
    key-store: ../../dev-deployment/environments/keystores/server/localhost/keystore_cas-server.jks
    key-store-password: changeme
    key-password: changeme
    enabled-protocols: TLSv1.2,TLSv1.3
    ciphers: ECDHE-RSA-AES256-GCM-SHA512:DHE-RSA-AES256-GCM-SHA512:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-SHA384
    #trust-store: ../../dev-deployment/environments/keystores/server/truststore_server.jks
    #trust-store-password: changeme
  host: dev.vitamui.com
  port: 8080
  servlet:
    context-path: /cas

# Authent with x509 certificate :
#cas.authn.x509.sslHeaderName: x-ssl-cert
#vitamui.authn.x509.enabled: true
#vitamui.authn.x509.mandatory: false
#vitamui.authn.x509.emailAttribute: 'SUBJECT_ALTERNATE_NAME'
#vitamui.authn.x509.emailAttributeParsing: '.*RFC822Name=(.*)'
#vitamui.authn.x509.emailAttributeExpansion:
#vitamui.authn.x509.identifierAttribute: 'subject_dn'
#vitamui.authn.x509.identifierAttributeParsing: '.*, OID.2.16.840.1.113730.3.1.3=(.*), C=.*'
#vitamui.authn.x509.identifierAttributeExpansion:
#vitamui.authn.x509.defaultDomain: 'domain.com'

management:
  server:
    port: 7080
    ssl:
      enabled: false
#management.metrics.export.prometheus.enabled: true


vitamui.cas.tenant.identifier: -1
vitamui.cas.identity: cas
iam-client:
  server-host: localhost
  server-port: 8083
  secure: true
  ssl-configuration:
    keystore:
      key-path: ../../dev-deployment/environments/keystores/server/localhost/keystore_cas-server.jks
      key-password: changeme
      type: JKS
    truststore:
      key-path: ../../dev-deployment/environments/keystores/server/truststore_server.jks
      key-password: changeme
    hostname-verification: false


cas.authn.accept.users:


cas.message-bundle.base-names: classpath:overriden_messages,classpath:messages


cas.host.name: cas
cas.tgc.path: /cas
cas.tgc.secure: true
cas.tgc.crypto.enabled: false
cas.webflow.crypto.enabled: true
cas.authn.pm.reset.crypto.enabled: true
cas.webflow.crypto.signing.key: =oebPIRe18A0cAeBdZCHkVlLPa_Kbthxo70iRpAhbk84dQGQj_8AOEMvEg3y7GAKYxtpF5nn6nx7vj5iU-eHStg
cas.webflow.crypto.encryption.key: 3FzNquczUjhmeJyqu251Ow
cas.authn.pm.reset.crypto.encryption.key: w7ZxSCZsGix3Xl6pFg-1viJIeFIWdrwEjxUvDyyVCM8
cas.authn.pm.reset.crypto.signing.key: TIUaCcEAjUW_HV-1hJRrcVobZ3CCEwJC8u60vPH2nspslA3TkRFjAsceEUugp9mb6rGQiFj1IY2HJuf3FmXM5w
cas.authn.oauth.crypto.encryption.key: 0mfCTGphgW6sLEG2xsmnb-dzQZ-9wQfjOWDrXdUg4lg
cas.authn.oauth.crypto.signing.key: kSs5OT5bTV6E9Ba0biGZ3taVlmlBFmoMyvG4JB0pSiZJml3CqyfHlexueJAv2BT4YG9gQ1IP_hvu1leejdFzng
cas.authn.oauth.access-token.crypto.encryption.key: RGAYHpTTKJ-YMbh7Yrt3Xd6VQH_myXYISwThfo-9OKI
cas.authn.oauth.access-token.crypto.signing.key: j8AZtUo6i4BI2n3bu2Elr9d3aIOL35vec0AjUBubP6rgj5arKWB9lRcWq9bjxGIwoAbFv-1MRmiScXlIIX0BGg

cas.server.prefix: https://dev.vitamui.com:8080/cas
login.url: ${cas.server.prefix}/login

cas.service-registry.mongo.client-uri: mongodb://mongod_dbuser_cas:mongod_dbpwd_cas@localhost:27018/cas

#cas.service-registry.mongo.port: 27018
#cas.service-registry.mongo.database-name: cas
#cas.service-registry.mongo.authentication-database-name: cas
#cas.service-registry.mongo.replica-set: rs0
cas.service-registry.mongo.collection: services
#cas.service-registry.mongo.user-id: mongod_dbuser_cas
#cas.service-registry.mongo.password: mongod_dbpwd_cas


cas.authn.surrogate.separator: ","
cas.authn.surrogate.mail.attribute-name: fakeNameToBeSureToFindNoAttributeAndNeverSendAnEmail


# 24 hours cache for login delegation
# Must be at least 24 hours as this cache is also used for password management and its 24-hour-creation email
cas.ticket.tst.time-to-kill-in-seconds: 86400


cas.authn.pm.core.enabled: true
cas.authn.pm.core.password-policy-pattern: '^(?=(.*[$@!%*#£?&=\-\/:;\(\)"\.,\?!''\[\]{}^\+\=_\\\|~<>`]){2,})(?=(?:.*[a-z]){2,})(?=(?:.*[A-Z]){2,})(?=(?:.*[\d]){2,})[A-Za-zÀ-ÿ0-9$@!%*#£?&=\-\/:;\(\)"\.,\?!''\[\]{}^\+\=_\\\|~<>`]{${password.length},}$'
cas.authn.pm.reset.mail.subject: Requete de reinitialisation de mot de passe
cas.authn.pm.reset.mail.text: "Changez de mot de passe via le lien: %s"
cas.authn.pm.reset.mail.from: serveur-cas@noreply.com
# 1 Day : 24 * 60 Minutes to reset password
cas.authn.pm.reset.expiration: PT1440M
cas.authn.pm.reset.number-of-uses: 2
cas.authn.pm.reset.mail.attribute-name: email
cas.authn.pm.reset.security-questions-enabled: false
cas.authn.pm.reset.include-server-ip-address: false
cas.authn.pm.core.auto-login: true


cas.authn.mfa.simple.sms.from: 'changeme'
cas.authn.mfa.simple.sms.text: 'Code : ${tokenWithoutPrefix}'
cas.authn.mfa.simple.sms.attribute-name: mobile
cas.authn.mfa.simple.token.core.time-to-kill-in-seconds: 3600
cas.authn.mfa.simple.token.core.token-length: 4
cas.authn.mfa.triggers.principal.global-principal-attribute-name-triggers: computedOtp
cas.authn.mfa.triggers.principal.global-principal-attribute-value-regex: 'true'
cas.authn.mfa.simple.mail.text: xxx


spring.mail.host: localhost
spring.mail.port: 2525
spring.mail.username: no-reply@vitamui.com
spring.mail.password: password
spring.mail.testConnection: false
spring.mail.properties.mail.smtp.auth: false
spring.mail.properties.mail.smtp.starttls.enable: false


cas.authn.throttle.failure.threshold: 2
cas.authn.throttle.failure.range-seconds: 3


cas:
  logout:
    follow-service-redirects: true
    redirect-parameter: next


management.endpoints.enabled-by-default: true
management.endpoints.web.exposure.include: '*'
cas.monitor.endpoints.endpoint.defaults.access[0]: PERMIT


# for SMS:
cas.sms-provider.sms-mode.url: https://rest.smsmode.com/sms/v1/messages
cas.sms-provider.sms-mode.access-token: changeme


vitamui.portal.url: https://dev.vitamui.com:4200/


token.api.cas: tokcas_ie6UZsEcHIWrfv2x


ip.header: X-Real-IP


# 8 hours in seconds
# the old api.token.ttl property
cas.authn.oauth.access-token.max-time-to-live-in-seconds: 28800

cas.authn.oidc.core.issuer: ${cas.server.prefix}/oidc


cas.authn.oidc.jwks.file-system.jwks-file: file:./src/main/config/keystore.jwks

server-identity:
  identityName: CAS
  identityRole: SSO
  identityServerId: 1


# Example to override theme colors, logo, favicon, platform name ...
theme:
  #  vitamui-platform-name: VITAM-UI
  #  vitamui-favicon: /absolute/path/to/favicon.ico
  #  vitamui-logo-large: /absolute/path/to/logo.png
  primary: '#702382'
  secondary: '#241f63'
  background: '#FFFFFF'

# Jaeger
opentracing:
  jaeger:
    enabled: true
    logSpans: true
    expandExceptionLogs: true
    udp-sender:
      host: localhost
      port: 6831

#debug: true
logging:
  config: src/main/config/logback-dev.xml
  level:
    org.springframework.amqp: 'OFF'
    org.springframework.context.annotation: 'OFF'
    org.springframework.boot.devtools: 'OFF'
    org.apereo.inspektr.audit.support: 'OFF'

# Cas CORS (necessary for mobile app)
cas.http-web-request.cors.enabled: true
cas.http-web-request.cors.allow-credentials: false
cas.http-web-request.cors.allow-origins: [ '*' ]
cas.http-web-request.cors.allow-methods: [ '*' ]
cas.http-web-request.cors.allow-headers: [ '*' ]

# Password configuration
password:
  length: 12 # 8 for custom profile
  max-old-password: 12 # 3 for custom profile
  check-occurrence: true # false for custom profile
  occurrences-chars-number: 3 # absent for custom profile
  profile: "anssi" # default profile is anssi (Agence Nationale de la Sécurité des Systèmes d'Information), custom otherwise
  constraints:
    defaults:
      fr:
        messages:
          - Avoir une taille d'au moins ${password.length} caractères
        special-chars:
          title: 'Contenir au moins 2 caractères issus de chaque catégorie, pour au moins 3 des catégories suivantes:'
          messages:
            - Minuscules (a-z)
            - Majuscules (A-Z)
            - Numériques (0-9)
            - Caractères spéciaux (!"#$%&£'()*+,-./:;<=>?@[]^_`{|}~)
      en:
        messages:
          - Have a size of at least ${password.length} characters
        special-chars:
          title: 'Contain at least 2 characters from each category, for at least 3 of the following categories:'
          messages:
            - Uppercases (a-z)
            - Lowercases (A-Z)
            - Digital (0-9)
            - Special Characters (!"#$%&£'()*+,-./:;<=>?@[]^_`{|}~)
      de:
        messages:
          - Mindestens ${password.length} Zeichen lang sein
        special-chars:
          title: 'Mindestens 2 Zeichen aus jeder Kategorie enthalten, für mindestens 3 der folgenden Kategorien:'
          messages:
            - Großbuchstaben (a-z)
            - Kleinbuchstaben (A-Z)
            - Digital (0-9)
            - Spezielle Charaktere (!"#$%&£'()*+,-./:;<=>?@[]^_`{|}~)
    customs:
      fr:
        title: 'Pour des raisons de sécurité, votre mot de passe doit:'
        messages:
          - Au moins ${password.length} caractères
          - Des minuscules et des majuscules
          - Au moins un chiffre et un caractère spécial (!"#$%&£'()*+,-./:;<=>?@[]^_`{|}~)
      en:
        title: 'For security reasons, your password must:'
        messages:
          - At least ${password.length} characters
          - Lowercase and uppercase
          - At least one number and one special character (!"#$%&£'()*+,-./:;<=>?@[]^_`{|}~)
      de:
        title: 'Aus Sicherheitsgründen muss Ihr Passwort:'
        messages:
          - Mindestens ${password.length} Zeichen
          - Klein- und Großbuchstaben
          - Mindestens eine Zahl und ein Sonderzeichen (!"#$%&£'()*+,-./:;<=>?@[]^_`{|}~)


---
spring:
  config:
    activate:
      on-profile: gateway

cas.http-web-request.cors.allow-credentials: true
cas.http-web-request.cors.allow-origins:
  - "https://dev.vitamui.com:4200"
  - "https://dev.vitamui.com:4201"
  - "https://dev.vitamui.com:4202"
  - "https://dev.vitamui.com:4203"
  - "https://dev.vitamui.com:4204"
  - "https://dev.vitamui.com:4205"
  - "https://dev.vitamui.com:4208"
  - "https://dev.vitamui.com:4209"
  - "https://dev.vitamui.com:4210"
  - "https://dev.vitamui.com:4251"
  - "https://localhost:4200"
  - "https://localhost:4201"
  - "https://localhost:4202"
  - "https://localhost:4203"
  - "https://localhost:4204"
  - "https://localhost:4205"
  - "https://localhost:4208"
  - "https://localhost:4209"
  - "https://localhost:4210"
  - "https://localhost:4251"
  - "https://localhost"
